[0m01:19:04.180463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D65D302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66D73ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66D739D0>]}


============================== 01:19:04.184943 | 75b150c7-78ca-4585-8cba-b797e5672011 ==============================
[0m01:19:04.184943 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:04.185646 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:19:04.212765 [info ] [MainThread]: dbt version: 1.10.9
[0m01:19:04.213335 [info ] [MainThread]: python version: 3.13.6
[0m01:19:04.213882 [info ] [MainThread]: python path: c:\Projects\ga_retail_project\.venv\Scripts\python.exe
[0m01:19:04.215225 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:19:07.068739 [info ] [MainThread]: Using profiles dir at C:\Users\dovie\.dbt
[0m01:19:07.069310 [info ] [MainThread]: Using profiles.yml file at C:\Users\dovie\.dbt\profiles.yml
[0m01:19:07.070045 [info ] [MainThread]: Using dbt_project.yml file at C:\Projects\ga_retail_project\dbt_project.yml
[0m01:19:07.070524 [info ] [MainThread]: adapter type: bigquery
[0m01:19:07.071750 [info ] [MainThread]: adapter version: 1.10.1
[0m01:19:07.173896 [info ] [MainThread]: Configuration:
[0m01:19:07.174421 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:07.175043 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:07.177438 [info ] [MainThread]: Required dependencies:
[0m01:19:07.177951 [debug] [MainThread]: Executing "git --help"
[0m01:19:07.204842 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:07.205327 [debug] [MainThread]: STDERR: "b''"
[0m01:19:07.205662 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:07.206205 [info ] [MainThread]: Connection:
[0m01:19:07.207286 [info ] [MainThread]:   method: service-account
[0m01:19:07.209220 [info ] [MainThread]:   database: e2e-dbt-project
[0m01:19:07.209666 [info ] [MainThread]:   execution_project: e2e-dbt-project
[0m01:19:07.210578 [info ] [MainThread]:   schema: stg
[0m01:19:07.211099 [info ] [MainThread]:   location: US
[0m01:19:07.211896 [info ] [MainThread]:   priority: None
[0m01:19:07.212426 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:19:07.213457 [info ] [MainThread]:   impersonate_service_account: None
[0m01:19:07.213907 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:19:07.214806 [info ] [MainThread]:   job_retries: 1
[0m01:19:07.215261 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:19:07.216063 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:19:07.217820 [info ] [MainThread]:   timeout_seconds: 300
[0m01:19:07.218264 [info ] [MainThread]:   client_id: None
[0m01:19:07.219954 [info ] [MainThread]:   token_uri: None
[0m01:19:07.220401 [info ] [MainThread]:   compute_region: None
[0m01:19:07.221305 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:19:07.221914 [info ] [MainThread]:   gcs_bucket: None
[0m01:19:07.222805 [info ] [MainThread]:   dataproc_batch: None
[0m01:19:07.224981 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:19:07.825474 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:19:07.825875 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:07.826179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:09.726808 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8e641c8-cc9d-42b5-88f7-7832a4896090&page=queryresults
[0m01:19:10.429976 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:10.430865 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:10.432941 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:10.432702 after 6.42 seconds
[0m01:19:10.433496 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:10.434027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BA06650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BB70DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B88A030>]}
[0m01:19:10.434580 [debug] [MainThread]: Flushing usage events
[0m01:19:11.970060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:24:16.999962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859B6E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C72BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C72B9D0>]}


============================== 01:24:17.004462 | 6709a55e-22cb-4ba3-86f8-891a035bab36 ==============================
[0m01:24:17.004462 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:24:17.005196 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --models staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:24:17.005573 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m01:24:17.006145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C606FD0>]}
[0m01:24:19.978186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C015B350>]}
[0m01:24:20.038216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11B9050>]}
[0m01:24:20.038834 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:24:20.624022 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:24:20.624889 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:24:20.625406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11ED040>]}
[0m01:24:22.539818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:24:22.544909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C17EA510>]}
[0m01:24:22.596358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:24:22.609045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:24:22.645304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C1660120>]}
[0m01:24:22.645717 [info ] [MainThread]: Found 1 model, 496 macros
[0m01:24:22.646225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C18304D0>]}
[0m01:24:22.648019 [info ] [MainThread]: 
[0m01:24:22.648513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:24:22.648948 [info ] [MainThread]: 
[0m01:24:22.650713 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:24:22.651942 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:24:22.652256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:24.183260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_stg)
[0m01:24:24.184079 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_stg"
"
[0m01:24:24.192390 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_stg"} */
create schema if not exists `e2e-dbt-project`.`stg_stg`
  
[0m01:24:24.192847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:26.314657 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b662cf0a-ba8b-4da5-ad0c-ce48aa3ba483&page=queryresults
[0m01:24:27.469238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_stg'
[0m01:24:27.469572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:28.829402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C15CBEE0>]}
[0m01:24:28.829842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:28.845852 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:24:28.846372 [info ] [Thread-1 (]: 1 of 1 START sql view model stg_stg.stg_sessions ............................... [RUN]
[0m01:24:28.847074 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:24:28.847405 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:24:28.854205 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:24:28.856635 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:24:28.884137 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:24:28.885735 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;;


[0m01:24:28.886150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:24:30.308885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:010320ae-27c2-49b5-9934-67612b748866&page=queryresults
[0m01:24:30.309358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:010320ae-27c2-49b5-9934-67612b748866&page=queryresults
[0m01:24:30.394860 [debug] [Thread-1 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.397137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859BA18190>]}
[0m01:24:30.397757 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model stg_stg.stg_sessions ...................... [[31mERROR[0m in 1.55s]
[0m01:24:30.398620 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:24:30.399173 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m01:24:30.401185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:30.402755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:30.403035 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_stg' was properly closed.
[0m01:24:30.403299 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_stg' was properly closed.
[0m01:24:30.403557 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:24:30.404111 [info ] [MainThread]: 
[0m01:24:30.404662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m01:24:30.406497 [debug] [MainThread]: Command end result
[0m01:24:30.538786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:24:30.540809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:24:30.546308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:24:30.546578 [info ] [MainThread]: 
[0m01:24:30.547139 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:24:30.547634 [info ] [MainThread]: 
[0m01:24:30.549340 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m01:24:30.550069 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.550986 [info ] [MainThread]: 
[0m01:24:30.551556 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.553506 [info ] [MainThread]: 
[0m01:24:30.554437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:24:30.555755 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:24:30.557297 [debug] [MainThread]: Command `dbt run` failed at 01:24:30.557180 after 13.73 seconds
[0m01:24:30.557630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11CF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859BA26150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C7804B0>]}
[0m01:24:30.557950 [debug] [MainThread]: Flushing usage events
[0m01:24:32.430228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:33.123070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554D6A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E6EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E6EB9D0>]}


============================== 01:29:33.127364 | 481ea315-0bbf-4814-82d2-c8fcfcb18970 ==============================
[0m01:29:33.127364 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:29:33.128053 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:29:36.062698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554D9FF6F0>]}
[0m01:29:36.125013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557213B350>]}
[0m01:29:36.125630 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:29:36.705985 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:29:36.781405 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:29:36.781947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573768550>]}
[0m01:29:37.761128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:29:37.765778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255735D65D0>]}
[0m01:29:37.822660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:29:37.824725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:29:37.851968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573879C50>]}
[0m01:29:37.852380 [info ] [MainThread]: Found 1 model, 496 macros
[0m01:29:37.852911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255736A3C70>]}
[0m01:29:37.854235 [info ] [MainThread]: 
[0m01:29:37.854769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:29:37.855718 [info ] [MainThread]: 
[0m01:29:37.859602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:29:37.860591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:29:37.860903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:39.320690 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:29:39.321055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:40.712193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557388A510>]}
[0m01:29:40.712626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:40.718810 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:29:40.719419 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions ................................... [RUN]
[0m01:29:40.720201 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:29:40.720664 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:29:40.727980 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:29:40.728939 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:29:40.756959 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:29:40.757859 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m01:29:40.758259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:29:42.552176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dba2bc15-2e45-468c-b7ae-c44eacaec7fc&page=queryresults
[0m01:29:43.343691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557395DA70>]}
[0m01:29:43.344324 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions .............................. [[32mCREATE VIEW (0 processed)[0m in 2.62s]
[0m01:29:43.345153 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:29:43.346823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:43.348368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:43.348649 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:29:43.348911 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:29:43.349170 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:29:43.349459 [info ] [MainThread]: 
[0m01:29:43.349961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m01:29:43.350825 [debug] [MainThread]: Command end result
[0m01:29:43.369716 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:29:43.371710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:29:43.377487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:29:43.377789 [info ] [MainThread]: 
[0m01:29:43.378577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:29:43.379739 [info ] [MainThread]: 
[0m01:29:43.381057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:29:43.382191 [debug] [MainThread]: Command `dbt run` succeeded at 01:29:43.382082 after 10.42 seconds
[0m01:29:43.382600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255738E27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573603770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573832BD0>]}
[0m01:29:43.382915 [debug] [MainThread]: Flushing usage events
[0m01:29:45.303895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:10.929020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8538502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85489BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85489B9D0>]}


============================== 01:35:10.933253 | b4451d18-9dc4-4afb-97ea-5e87d6bedd78 ==============================
[0m01:35:10.933253 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:35:10.933911 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:35:13.838965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D853BAF6F0>]}
[0m01:35:13.898149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8782DB350>]}
[0m01:35:13.898764 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:35:14.482382 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:35:14.546370 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:35:14.546987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879908550>]}
[0m01:35:15.717271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:35:15.721827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87985A210>]}
[0m01:35:15.902154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:15.904264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:15.947819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87949E0B0>]}
[0m01:35:15.948473 [info ] [MainThread]: Found 1 model, 4 data tests, 496 macros
[0m01:35:15.949157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879ACA750>]}
[0m01:35:15.950866 [info ] [MainThread]: 
[0m01:35:15.951377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:35:15.951859 [info ] [MainThread]: 
[0m01:35:15.953561 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:15.954624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:35:15.954919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:17.450060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87992CC50>]}
[0m01:35:17.450492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:17.456703 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.457838 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.457317 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:35:17.458828 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:35:17.459149 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.470056 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.471182 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.477945 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:35:17.458248 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sessions_visit_id ................................. [RUN]
[0m01:35:17.478470 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:35:17.479911 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c'
[0m01:35:17.480732 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:35:17.481152 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.479084 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:35:17.481743 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.487280 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:35:17.487778 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.488272 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:35:17.492116 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:35:17.511503 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:35:17.512076 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.515592 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:35:17.516938 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.519427 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:35:17.520312 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.520797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:35:17.521333 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.523429 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:35:17.524178 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.526445 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:35:17.554085 [debug] [Thread-4 (]: On test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`stg`.`stg_sessions`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:35:17.554527 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:35:17.554962 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.555343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:35:17.555834 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.556218 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:35:19.799858 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84b60964-c6f0-43cb-8a35-ab6b0e4acbb4&page=queryresults
[0m01:35:19.809492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:16c0009d-5b6f-473e-a52d-4af729c3ac65&page=queryresults
[0m01:35:19.829526 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:113966da-ff41-4638-80f4-0d8daddca8c1&page=queryresults
[0m01:35:19.859032 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8a780124-b9a1-473e-a46e-e23ecacb6aa0&page=queryresults
[0m01:35:21.206790 [error] [Thread-4 (]: 4 of 4 FAIL 47 unique_stg_sessions_visit_id .................................... [[31mFAIL 47[0m in 3.73s]
[0m01:35:21.207612 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:21.245108 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.79s]
[0m01:35:21.246017 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:21.253284 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.77s]
[0m01:35:21.254126 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:21.263396 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.78s]
[0m01:35:21.264255 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:21.266010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:35:21.267480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:21.267745 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:35:21.267995 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:35:21.268240 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c' was properly closed.
[0m01:35:21.268488 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:35:21.268732 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:35:21.269012 [info ] [MainThread]: 
[0m01:35:21.269491 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m01:35:21.270955 [debug] [MainThread]: Command end result
[0m01:35:21.292578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:21.294660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:21.300490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:35:21.300756 [info ] [MainThread]: 
[0m01:35:21.301276 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:35:21.301808 [info ] [MainThread]: 
[0m01:35:21.302969 [error] [MainThread]: [31mFailure in test unique_stg_sessions_visit_id (models\staging\stg_sessions.yml)[0m
[0m01:35:21.304299 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m01:35:21.304929 [info ] [MainThread]: 
[0m01:35:21.305824 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\unique_stg_sessions_visit_id.sql
[0m01:35:21.306264 [info ] [MainThread]: 
[0m01:35:21.307559 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:35:21.309111 [debug] [MainThread]: Command `dbt test` failed at 01:35:21.308993 after 10.54 seconds
[0m01:35:21.309452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879AD54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8797DA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8797DACB0>]}
[0m01:35:21.309774 [debug] [MainThread]: Flushing usage events
[0m01:35:24.794101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:07.243935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023924C202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023925C63ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023925C639D0>]}


============================== 01:39:07.248428 | de180b3d-dd87-46fb-96ae-a2017d459646 ==============================
[0m01:39:07.248428 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:07.249120 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:07.398192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de180b3d-dd87-46fb-96ae-a2017d459646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023924F7F6F0>]}
[0m01:39:07.436963 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-84y3m91y'
[0m01:39:07.437337 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m01:39:07.451760 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m01:39:07.453468 [debug] [MainThread]: Command `dbt deps` failed at 01:39:07.453345 after 0.37 seconds
[0m01:39:07.453798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926ED85A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926ED86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926E5D550>]}
[0m01:39:07.454186 [debug] [MainThread]: Flushing usage events
[0m01:39:08.708521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:46.488258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2BA402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2CA7FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2CA7F9D0>]}


============================== 01:41:46.492557 | 32fdca99-578a-4661-997b-3c79e53b6941 ==============================
[0m01:41:46.492557 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:41:46.493252 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:41:46.634588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32fdca99-578a-4661-997b-3c79e53b6941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2BD9F6F0>]}
[0m01:41:46.666037 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-g6umd5z_'
[0m01:41:46.666521 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:41:48.178870 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:41:48.180291 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:41:48.679528 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:41:48.692108 [info ] [MainThread]: Updating lock file in file path: C:\Projects\ga_retail_project/package-lock.yml
[0m01:41:48.700835 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-v3yz5_sn'
[0m01:41:48.703668 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:41:50.283885 [info ] [MainThread]: Installed from version 1.1.1
[0m01:41:50.284434 [info ] [MainThread]: Updated version available: 1.3.0
[0m01:41:50.285055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '32fdca99-578a-4661-997b-3c79e53b6941', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C97E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C97D9D0>]}
[0m01:41:50.285410 [info ] [MainThread]: 
[0m01:41:50.287457 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:41:50.289672 [debug] [MainThread]: Command `dbt deps` succeeded at 01:41:50.289551 after 3.97 seconds
[0m01:41:50.290011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2DCCD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2DC707D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C25B890>]}
[0m01:41:50.290347 [debug] [MainThread]: Flushing usage events
[0m01:41:53.023105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:42:10.977664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C24F02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C353BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C353B9D0>]}


============================== 01:42:10.981908 | 737f83a6-b995-477d-a192-f8d2e8c05566 ==============================
[0m01:42:10.981908 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:42:10.982636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:42:13.986317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C28536F0>]}
[0m01:42:14.054628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E6F6B350>]}
[0m01:42:14.055240 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:42:14.666280 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:42:14.753280 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:42:14.753900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E6FF8850>]}
[0m01:42:16.506127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:42:16.511138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E702DF40>]}
[0m01:42:16.581522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:16.583719 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:16.622184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E812B150>]}
[0m01:42:16.622591 [info ] [MainThread]: Found 1 model, 4 data tests, 610 macros
[0m01:42:16.623161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E85E3E10>]}
[0m01:42:16.624886 [info ] [MainThread]: 
[0m01:42:16.626127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:42:16.626961 [info ] [MainThread]: 
[0m01:42:16.627719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:42:16.628757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:42:16.629043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:18.172630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E86A9850>]}
[0m01:42:18.173097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:42:18.180196 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.180791 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.181165 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.181523 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.181900 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sessions_visit_id ................................. [RUN]
[0m01:42:18.182412 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:42:18.184507 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c'
[0m01:42:18.185386 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:42:18.183064 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:42:18.186528 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.187275 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.183672 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:42:18.188173 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:42:18.203542 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:42:18.211491 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:42:18.212045 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:42:18.212466 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.213150 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.216441 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:42:18.219990 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:42:18.220360 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.240478 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:42:18.241163 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.244724 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:42:18.245338 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.247370 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:42:18.247909 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.250162 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:42:18.250778 [debug] [Thread-4 (]: On test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`stg`.`stg_sessions`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:18.251196 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:42:18.277085 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.277948 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:42:18.278450 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.278810 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:42:18.303953 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.304355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:42:20.570640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1dae1ab6-af2d-4119-97cd-d54ac9c53822&page=queryresults
[0m01:42:20.572173 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:215df39c-2c11-4e4a-b993-0db786c2e68f&page=queryresults
[0m01:42:20.581243 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6c31f82b-5660-4c6d-8583-abb557e07633&page=queryresults
[0m01:42:20.581913 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ead7c366-5502-43ae-bde8-a89dfc6814bd&page=queryresults
[0m01:42:21.997603 [error] [Thread-4 (]: 4 of 4 FAIL 47 unique_stg_sessions_visit_id .................................... [[31mFAIL 47[0m in 3.81s]
[0m01:42:21.998578 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:22.005046 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.79s]
[0m01:42:22.005938 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:22.025663 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.84s]
[0m01:42:22.026598 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:22.084576 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.90s]
[0m01:42:22.085513 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:22.087224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:42:22.088851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:22.089133 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:42:22.089389 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c' was properly closed.
[0m01:42:22.089669 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:42:22.089983 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:42:22.090228 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:42:22.090515 [info ] [MainThread]: 
[0m01:42:22.091156 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m01:42:22.092970 [debug] [MainThread]: Command end result
[0m01:42:22.122123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:22.124185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:22.130208 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:42:22.130487 [info ] [MainThread]: 
[0m01:42:22.131007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:42:22.131548 [info ] [MainThread]: 
[0m01:42:22.133106 [error] [MainThread]: [31mFailure in test unique_stg_sessions_visit_id (models\staging\stg_sessions.yml)[0m
[0m01:42:22.133900 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m01:42:22.134742 [info ] [MainThread]: 
[0m01:42:22.137486 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\unique_stg_sessions_visit_id.sql
[0m01:42:22.138001 [info ] [MainThread]: 
[0m01:42:22.138917 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:42:22.140665 [debug] [MainThread]: Command `dbt test` failed at 01:42:22.140476 after 11.29 seconds
[0m01:42:22.141109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E88EF330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E8753B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E8753D90>]}
[0m01:42:22.141480 [debug] [MainThread]: Flushing usage events
[0m01:42:23.153387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:21.048466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335ECA02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335FCEBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335FCEB9D0>]}


============================== 01:43:21.052818 | 2871dfca-cb37-4e22-bce6-12ed5b8c9ce5 ==============================
[0m01:43:21.052818 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:43:21.053523 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:43:24.017564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335EFFF6F0>]}
[0m01:43:24.093831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330377B350>]}
[0m01:43:24.094471 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:43:24.650932 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:43:24.830798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:43:24.831416 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m01:43:25.171242 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:43:25.171959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304E45350>]}
[0m01:43:25.235895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:43:25.240429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304CC34D0>]}
[0m01:43:25.310140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:43:25.312260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:43:25.349866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305109E10>]}
[0m01:43:25.350264 [info ] [MainThread]: Found 1 model, 4 data tests, 610 macros
[0m01:43:25.350806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305016D00>]}
[0m01:43:25.352256 [info ] [MainThread]: 
[0m01:43:25.352757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:43:25.353273 [info ] [MainThread]: 
[0m01:43:25.356184 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:25.357238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:43:25.357764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:26.750009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304FC5FD0>]}
[0m01:43:26.750408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:26.756564 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.757537 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.758274 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.757027 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m01:43:26.759119 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.760860 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m01:43:26.759581 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:43:26.762433 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.763189 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:43:26.760132 [info ] [Thread-4 (]: 4 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:43:26.771970 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:43:26.761848 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:43:26.772600 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.773112 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:43:26.773881 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:43:26.779835 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.783496 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:43:26.783978 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.787873 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:43:26.788255 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.792217 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:43:26.811858 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:43:26.812879 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.814948 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:43:26.815345 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.817324 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:43:26.818117 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.820303 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:43:26.821456 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.821939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:43:26.822622 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.823103 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:43:26.823505 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m01:43:26.823966 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.824737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:26.825305 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:43:29.119908 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:31b456bf-861f-4827-848d-9173bf6f0260&page=queryresults
[0m01:43:29.169151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c16f831c-b966-4f7c-899a-d8309d8068d0&page=queryresults
[0m01:43:29.199748 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0d8298b3-4572-44d6-8a38-17ababc313ae&page=queryresults
[0m01:43:29.240309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b125e2d9-dc26-4a0d-8270-4e4578f84a1f&page=queryresults
[0m01:43:30.547940 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.78s]
[0m01:43:30.548829 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:30.553141 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.78s]
[0m01:43:30.554084 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:30.556880 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.80s]
[0m01:43:30.557825 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:30.583622 [info ] [Thread-4 (]: 4 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.81s]
[0m01:43:30.584459 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:30.586015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:30.587570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:30.587853 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:43:30.588126 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m01:43:30.588393 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:43:30.588654 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:43:30.588921 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:43:30.589259 [info ] [MainThread]: 
[0m01:43:30.589743 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m01:43:30.591393 [debug] [MainThread]: Command end result
[0m01:43:30.615953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:43:30.618163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:43:30.624841 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:43:30.625441 [info ] [MainThread]: 
[0m01:43:30.626258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:43:30.627088 [info ] [MainThread]: 
[0m01:43:30.628816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:43:30.629588 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:43:30.630918 [debug] [MainThread]: Command `dbt test` succeeded at 01:43:30.630801 after 9.74 seconds
[0m01:43:30.631249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304FD3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305175810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233051759F0>]}
[0m01:43:30.631578 [debug] [MainThread]: Flushing usage events
[0m01:43:32.563305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:26.488652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD4502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE49BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE49B9D0>]}


============================== 18:14:26.496217 | 733ff81e-8c04-40ed-92cd-e3efba5aed4f ==============================
[0m18:14:26.496217 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:14:26.496968 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:14:32.980709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD7AF6F0>]}
[0m18:14:33.044000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA204B350>]}
[0m18:14:33.044628 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:14:33.844733 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:14:35.253595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:35.254228 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:14:35.587141 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m18:14:35.587797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3715450>]}
[0m18:14:35.664801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:14:35.669760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3591C70>]}
[0m18:14:35.746745 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:14:35.759134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:14:35.808781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA39DA190>]}
[0m18:14:35.809383 [info ] [MainThread]: Found 1 model, 6 data tests, 610 macros
[0m18:14:35.809948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A89640>]}
[0m18:14:35.811611 [info ] [MainThread]: 
[0m18:14:35.812030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:35.812677 [info ] [MainThread]: 
[0m18:14:35.814309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:35.815801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:14:35.816185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:37.482500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA38C6150>]}
[0m18:14:37.483071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:37.493436 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.494820 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.494168 [info ] [Thread-4 (]: 4 of 6 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:14:37.495973 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:14:37.496342 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.506484 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:14:37.507215 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.495270 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [RUN]
[0m18:14:37.508714 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91'
[0m18:14:37.509473 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.515286 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m18:14:37.515997 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.507734 [info ] [Thread-2 (]: 2 of 6 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:14:37.517509 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:14:37.517830 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.521328 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:14:37.522112 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.516660 [info ] [Thread-3 (]: 3 of 6 START test not_null_stg_sessions_revenue_usd ............................ [RUN]
[0m18:14:37.531138 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636'
[0m18:14:37.544019 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:14:37.544622 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.545112 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.549737 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"
[0m18:14:37.550630 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.553551 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m18:14:37.556342 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:14:37.557089 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:14:37.558015 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:14:37.558607 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.564087 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"
[0m18:14:37.564887 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m18:14:37.565334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:37.616810 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:14:37.617284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:14:37.619175 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from `e2e-dbt-project`.`stg`.`stg_sessions`
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m18:14:37.645465 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:14:39.826821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d12c3122-8982-4c06-a290-19fe7880b3ce&page=queryresults
[0m18:14:39.827513 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d12c3122-8982-4c06-a290-19fe7880b3ce&page=queryresults
[0m18:14:39.945475 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:39.946039 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.44s]
[0m18:14:39.946852 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:39.947237 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.948087 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql.
[0m18:14:39.947588 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:14:39.949230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m18:14:39.949590 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.955495 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:14:39.956304 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.958174 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:14:39.959026 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:14:39.959399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:39.985588 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d0e729a8-600d-49b1-a405-11206c71ce69&page=queryresults
[0m18:14:39.997397 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a87cda1-fa9b-4461-bb7a-e07075e3a2e9&page=queryresults
[0m18:14:39.998452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef559f40-b2dc-4249-bd05-63c40a5e21c4&page=queryresults
[0m18:14:41.577381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eb8f55ab-ed2b-4f7d-b997-b1ea28d4f7d4&page=queryresults
[0m18:14:43.355841 [error] [Thread-3 (]: 3 of 6 FAIL 2513 not_null_stg_sessions_revenue_usd ............................. [[31mFAIL 2513[0m in 5.82s]
[0m18:14:43.356783 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:43.357144 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.357468 [info ] [Thread-3 (]: 6 of 6 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:14:43.358088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:14:43.358456 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.362156 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:14:43.363001 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.365428 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:14:43.366153 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:14:43.366550 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:43.413419 [info ] [Thread-2 (]: 2 of 6 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 5.90s]
[0m18:14:43.414716 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:43.417498 [info ] [Thread-4 (]: 4 of 6 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 5.92s]
[0m18:14:43.418357 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:43.422276 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.47s]
[0m18:14:43.423283 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:45.091751 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c3f9120-0882-4188-a401-43af1fad5cf7&page=queryresults
[0m18:14:46.605513 [info ] [Thread-3 (]: 6 of 6 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.25s]
[0m18:14:46.606467 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:46.608017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:46.610394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:46.610800 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:14:46.611070 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:14:46.611327 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:14:46.611581 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:14:46.611835 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:14:46.612136 [info ] [MainThread]: 
[0m18:14:46.613070 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m18:14:46.616187 [debug] [MainThread]: Command end result
[0m18:14:46.656341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:14:46.659353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:14:46.667541 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:14:46.667911 [info ] [MainThread]: 
[0m18:14:46.668551 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:14:46.669104 [info ] [MainThread]: 
[0m18:14:46.678119 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)[0m
[0m18:14:46.678720 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:46.679789 [info ] [MainThread]: 
[0m18:14:46.680314 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:46.682449 [info ] [MainThread]: 
[0m18:14:46.683040 [error] [MainThread]: [31mFailure in test not_null_stg_sessions_revenue_usd (models\staging\stg_sessions.yml)[0m
[0m18:14:46.684208 [error] [MainThread]:   Got 2513 results, configured to fail if != 0
[0m18:14:46.684691 [info ] [MainThread]: 
[0m18:14:46.685836 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\not_null_stg_sessions_revenue_usd.sql
[0m18:14:46.686388 [info ] [MainThread]: 
[0m18:14:46.689158 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m18:14:46.689967 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:46.692847 [debug] [MainThread]: Command `dbt test` failed at 18:14:46.692730 after 20.41 seconds
[0m18:14:46.693242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA38A9230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A665D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A66710>]}
[0m18:14:46.693592 [debug] [MainThread]: Flushing usage events
[0m18:14:48.714970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:58.528189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B10D302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B11D7BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B11D7B9D0>]}


============================== 18:30:58.532536 | 8b18ea0c-e301-41a4-8db5-156dbe6ecad6 ==============================
[0m18:30:58.532536 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:30:58.533189 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m18:31:01.634898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1108F6F0>]}
[0m18:31:01.696090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B357AB350>]}
[0m18:31:01.696695 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:31:02.294802 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:31:02.475288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:02.475932 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:31:02.826229 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m18:31:02.826945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B36E7DC50>]}
[0m18:31:02.888281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:31:02.893045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B36CBDC70>]}
[0m18:31:02.960534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:31:02.962608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:31:02.996235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3713CAD0>]}
[0m18:31:02.996635 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m18:31:02.997188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371F9570>]}
[0m18:31:02.999216 [info ] [MainThread]: 
[0m18:31:02.999829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:31:03.000841 [info ] [MainThread]: 
[0m18:31:03.002706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:03.003866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:31:03.004378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.576588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B37056150>]}
[0m18:31:04.577029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:04.583178 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.584134 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.584641 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.583608 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:31:04.585188 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.585568 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:31:04.586863 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m18:31:04.586068 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0  [RUN]
[0m18:31:04.588163 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:31:04.588885 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.589559 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8'
[0m18:31:04.587389 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:31:04.590131 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.601095 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:31:04.601578 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.602085 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:31:04.606044 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:31:04.613406 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.617856 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"
[0m18:31:04.621660 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:31:04.622522 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.642360 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:31:04.643584 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.646425 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:31:04.646920 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.648916 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:31:04.649644 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.651884 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"
[0m18:31:04.652537 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:04.652997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:31:04.653709 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:31:04.654068 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:31:04.654651 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:31:04.655014 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:04.655431 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd revenue_usd is null OR revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m18:31:04.655801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:06.765844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8bb0a1d1-ca89-4bf3-bd08-19c88638a3f0&page=queryresults
[0m18:31:06.766369 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8bb0a1d1-ca89-4bf3-bd08-19c88638a3f0&page=queryresults
[0m18:31:06.776354 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:06.776889 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0  [[31mERROR[0m in 2.19s]
[0m18:31:06.777785 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:06.778581 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.779304 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql.
[0m18:31:06.779742 [info ] [Thread-1 (]: 5 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:31:06.781610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:31:06.782368 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.790451 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:31:06.791378 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.793438 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:31:06.794288 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:06.795098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:06.905565 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e10fa8f4-8dc2-43af-bf3a-c3a2e4682d6f&page=queryresults
[0m18:31:07.096180 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:997ecdc5-b346-4e49-8272-7e035c364dcf&page=queryresults
[0m18:31:07.097676 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84713ec1-98ce-4a93-ab94-4ffd6c7fdfd4&page=queryresults
[0m18:31:08.425432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b4f6a032-e5e6-4ead-98a0-ecc8b1ea73a4&page=queryresults
[0m18:31:08.501810 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.91s]
[0m18:31:08.506241 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:08.509286 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.92s]
[0m18:31:08.510814 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:08.582327 [info ] [Thread-2 (]: 2 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.98s]
[0m18:31:08.583612 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:09.801186 [info ] [Thread-1 (]: 5 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.02s]
[0m18:31:09.802090 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:09.803858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:09.805306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:09.805574 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:31:09.805830 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:31:09.806075 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:31:09.806365 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:31:09.806615 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:31:09.806902 [info ] [MainThread]: 
[0m18:31:09.807369 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m18:31:09.808936 [debug] [MainThread]: Command end result
[0m18:31:09.832543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:31:09.834700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:31:09.840877 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:31:09.841160 [info ] [MainThread]: 
[0m18:31:09.841706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:09.842250 [info ] [MainThread]: 
[0m18:31:09.843341 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)[0m
[0m18:31:09.843908 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:09.845328 [info ] [MainThread]: 
[0m18:31:09.847094 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:09.847934 [info ] [MainThread]: 
[0m18:31:09.848447 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:31:09.854114 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:31:09.857159 [debug] [MainThread]: Command `dbt test` failed at 18:31:09.857038 after 11.47 seconds
[0m18:31:09.857493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3700DC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371D5DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371D5D10>]}
[0m18:31:09.857861 [debug] [MainThread]: Flushing usage events
[0m18:31:10.919964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:46.768827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD336402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3468BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3468B9D0>]}


============================== 18:45:46.773239 | e8d69b3d-7fd4-4e03-8d59-713074d895c6 ==============================
[0m18:45:46.773239 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:45:46.773938 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:45:51.922565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3399F6F0>]}
[0m18:45:51.985772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD580CB350>]}
[0m18:45:51.986454 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:45:52.655586 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:45:53.317833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:53.318507 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:45:53.727970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:45:53.732618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59799050>]}
[0m18:45:53.809828 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:45:53.813027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:45:53.851375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59923110>]}
[0m18:45:53.851793 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m18:45:53.852329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59A68AD0>]}
[0m18:45:53.853834 [info ] [MainThread]: 
[0m18:45:53.854336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:53.854808 [info ] [MainThread]: 
[0m18:45:53.856428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:45:53.857455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:45:53.857746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:55.529306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59B19980>]}
[0m18:45:55.529763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:55.536242 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.536925 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.537359 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.538181 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.537772 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:45:55.538874 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:45:55.539438 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:45:55.540644 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m18:45:55.541321 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:45:55.540006 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0  [RUN]
[0m18:45:55.541975 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:45:55.542391 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.543036 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.543572 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1'
[0m18:45:55.543984 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.559015 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:45:55.561982 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:45:55.562460 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.566642 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:45:55.571149 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"
[0m18:45:55.572150 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.592580 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:45:55.593485 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.597079 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:45:55.597644 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.599785 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"
[0m18:45:55.600478 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.602844 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:45:55.603961 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:45:55.604555 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:55.605081 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:45:55.605513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:45:55.605926 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:45:55.606384 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd coalesce(revenue_usd, 0) >= 0)


  
  
      
    ) dbt_internal_test
[0m18:45:55.634541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:45:55.661216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:45:57.859680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e859a363-23dc-4edd-88ac-84530b00e5f3&page=queryresults
[0m18:45:57.860157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e859a363-23dc-4edd-88ac-84530b00e5f3&page=queryresults
[0m18:45:57.961055 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:45:57.961620 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0  [[31mERROR[0m in 2.42s]
[0m18:45:57.962498 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:57.962916 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.963929 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql.
[0m18:45:57.963328 [info ] [Thread-1 (]: 5 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:45:57.965258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:45:57.965618 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.971618 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:45:57.972431 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.974300 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:45:57.975002 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:45:57.975368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:58.158482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d45c9eb3-f405-44e9-b000-97a2e89d7003&page=queryresults
[0m18:45:58.179392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92488992-9e52-43f8-9dc1-24db799b2966&page=queryresults
[0m18:45:58.180826 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0378fcc0-9450-4da1-aa0e-d9be3cfb19b4&page=queryresults
[0m18:45:59.661644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:47c58602-bf07-4767-a1f7-8ffa4eb79d19&page=queryresults
[0m18:46:00.477795 [info ] [Thread-2 (]: 2 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.94s]
[0m18:46:00.481362 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:46:00.480591 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 4.94s]
[0m18:46:00.482401 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:46:00.503806 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 4.96s]
[0m18:46:00.505438 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:46:01.134796 [info ] [Thread-1 (]: 5 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.17s]
[0m18:46:01.135948 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:46:01.137866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:01.139395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:01.139758 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:46:01.140050 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:46:01.140325 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:46:01.140598 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:46:01.140868 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:46:01.141244 [info ] [MainThread]: 
[0m18:46:01.141971 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m18:46:01.145283 [debug] [MainThread]: Command end result
[0m18:46:01.172970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:46:01.175416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:46:01.181995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:46:01.182335 [info ] [MainThread]: 
[0m18:46:01.182880 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:46:01.183730 [info ] [MainThread]: 
[0m18:46:01.184930 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)[0m
[0m18:46:01.185544 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:46:01.186433 [info ] [MainThread]: 
[0m18:46:01.187081 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:46:01.188745 [info ] [MainThread]: 
[0m18:46:01.189549 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:46:01.190748 [debug] [MainThread]: Command `dbt test` failed at 18:46:01.190636 after 14.60 seconds
[0m18:46:01.191101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD34654650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59930AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59933330>]}
[0m18:46:01.191436 [debug] [MainThread]: Flushing usage events
[0m18:46:02.503567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:47.466304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201620502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002016309BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002016309B9D0>]}


============================== 19:05:47.470734 | c3937411-edce-4599-ac05-ed9072195dff ==============================
[0m19:05:47.470734 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:05:47.471613 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions stg_sessions_revenue_nonnegative', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m19:05:50.547665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201623AF6F0>]}
[0m19:05:50.610299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020106B4B350>]}
[0m19:05:50.610929 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:05:51.193081 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:05:51.414016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:05:51.414497 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_sessions_revenue_nonnegative.sql
[0m19:05:51.415011 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m19:05:51.882286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m19:05:51.887144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010821E650>]}
[0m19:05:51.964982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:05:51.967067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:05:52.005023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201085D1130>]}
[0m19:05:52.005447 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m19:05:52.006065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010857A6D0>]}
[0m19:05:52.007852 [info ] [MainThread]: 
[0m19:05:52.008534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:52.009083 [info ] [MainThread]: 
[0m19:05:52.010690 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:52.011941 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m19:05:52.012304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:53.550057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020108641D90>]}
[0m19:05:53.550503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:53.556414 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.557298 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.558082 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.556877 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m19:05:53.558803 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.559259 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m19:05:53.560546 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m19:05:53.561884 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m19:05:53.559745 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m19:05:53.562593 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.563199 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.563668 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m19:05:53.561084 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m19:05:53.572023 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m19:05:53.580730 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m19:05:53.581199 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.581706 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m19:05:53.585413 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m19:05:53.586018 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.589652 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m19:05:53.590137 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.613317 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m19:05:53.614250 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.618360 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m19:05:53.618835 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.620784 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m19:05:53.621483 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.623680 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m19:05:53.624648 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.625340 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m19:05:53.631822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:05:53.632569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:53.633020 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.633531 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.634274 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:05:53.634835 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:05:55.910568 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bb2838a1-b557-4789-8bea-2bcb5c101e5f&page=queryresults
[0m19:05:55.911280 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1208734b-137c-485c-a70e-10fd22cb5c0e&page=queryresults
[0m19:05:55.919721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6310cf1f-37ae-430c-92bb-0baee2976336&page=queryresults
[0m19:05:56.130871 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3eb35db7-792a-4580-b79d-a3efa086d3d6&page=queryresults
[0m19:05:57.357206 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.79s]
[0m19:05:57.358138 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:57.358863 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.359416 [info ] [Thread-3 (]: 5 of 5 START test stg_sessions_revenue_nonnegative ............................. [RUN]
[0m19:05:57.359981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m19:05:57.360439 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.362749 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m19:05:57.363891 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.366583 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m19:05:57.367588 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m19:05:57.367951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:05:57.395656 [info ] [Thread-1 (]: 1 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.84s]
[0m19:05:57.397109 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:57.414389 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.85s]
[0m19:05:57.415333 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:57.664016 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 4.08s]
[0m19:05:57.664967 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:59.064001 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5ebd700d-bcdc-440e-988c-de5c7cd4aff8&page=queryresults
[0m19:06:00.497346 [info ] [Thread-3 (]: 5 of 5 PASS stg_sessions_revenue_nonnegative ................................... [[32mPASS[0m in 3.14s]
[0m19:06:00.498348 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:06:00.500215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:00.502044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:00.502413 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m19:06:00.502796 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m19:06:00.503076 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m19:06:00.503394 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m19:06:00.503836 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m19:06:00.504130 [info ] [MainThread]: 
[0m19:06:00.504624 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m19:06:00.506323 [debug] [MainThread]: Command end result
[0m19:06:00.530119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:06:00.532243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:06:00.538899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m19:06:00.539501 [info ] [MainThread]: 
[0m19:06:00.540146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:00.540929 [info ] [MainThread]: 
[0m19:06:00.542084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:06:00.543923 [debug] [MainThread]: Command `dbt test` succeeded at 19:06:00.543810 after 13.20 seconds
[0m19:06:00.544320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020163064650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010863D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020108B20310>]}
[0m19:06:00.544645 [debug] [MainThread]: Flushing usage events
[0m19:06:01.756099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:34.576254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEF8E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF092BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF092B9D0>]}


============================== 00:45:34.589047 | f8bdb259-df50-4a0f-aeb8-9445e5712345 ==============================
[0m00:45:34.589047 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:45:34.591947 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:45:41.877346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEFC3F6F0>]}
[0m00:45:41.942868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA9603B350>]}
[0m00:45:41.943476 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:45:42.745840 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:45:42.852086 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:45:42.852584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA97099F50>]}
[0m00:45:45.600119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:45:45.604568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA970CBF20>]}
[0m00:45:45.682551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:45:45.684955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:45:45.737567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA972699B0>]}
[0m00:45:45.737964 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m00:45:45.738350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA97727C70>]}
[0m00:45:45.739662 [info ] [MainThread]: 
[0m00:45:45.740038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:45:45.740376 [info ] [MainThread]: 
[0m00:45:45.740846 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:45:45.741672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:45:45.742069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:45.742415 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json''
[0m00:45:45.743892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:45.744376 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json''
[0m00:45:45.745015 [info ] [MainThread]: 
[0m00:45:45.745428 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m00:45:45.745909 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json'
[0m00:45:45.746916 [debug] [MainThread]: Command `dbt run` failed at 00:45:45.746816 after 11.35 seconds
[0m00:45:45.747222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF08F4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA975B6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA975B6830>]}
[0m00:45:45.747532 [debug] [MainThread]: Flushing usage events
[0m00:45:48.029304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:43.346211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FC602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024690CABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024690CAB9D0>]}


============================== 00:47:43.350571 | 8c46ff46-bfbe-4dc9-aa41-5f632ce32596 ==============================
[0m00:47:43.350571 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:47:43.351312 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m00:47:46.371360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FFBF6F0>]}
[0m00:47:46.431654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B475B350>]}
[0m00:47:46.432240 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:47:47.045607 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:47:47.221172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:47.221486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:47.226136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:47:47.265053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B47EB750>]}
[0m00:47:47.347796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:47:47.350509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:47:47.378829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B48219A0>]}
[0m00:47:47.379236 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m00:47:47.379623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B591ECF0>]}
[0m00:47:47.380944 [info ] [MainThread]: 
[0m00:47:47.381322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:47.381659 [info ] [MainThread]: 
[0m00:47:47.382138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:47:47.383153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:47:47.383626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:48.973536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:47:48.973968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:50.364116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B5E731E0>]}
[0m00:47:50.364518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:50.379358 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m00:47:50.380152 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions ................................... [RUN]
[0m00:47:50.381089 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m00:47:50.381687 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m00:47:50.394475 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m00:47:50.395442 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m00:47:50.423175 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m00:47:50.424583 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m00:47:50.425156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:47:52.134149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a6d68210-9d3b-4536-80ad-8df6ebd6cd8e&page=queryresults
[0m00:47:54.706008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B5F053D0>]}
[0m00:47:54.706596 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions .............................. [[32mCREATE VIEW (0 processed)[0m in 4.32s]
[0m00:47:54.707348 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m00:47:54.708758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:54.710144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:54.710404 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:47:54.710708 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:47:54.710940 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m00:47:54.711203 [info ] [MainThread]: 
[0m00:47:54.711558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m00:47:54.712215 [debug] [MainThread]: Command end result
[0m00:47:54.736282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:47:54.738389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:47:54.743772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:47:54.744140 [info ] [MainThread]: 
[0m00:47:54.744548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:54.744894 [info ] [MainThread]: 
[0m00:47:54.745299 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:47:54.746145 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:54.746046 after 11.56 seconds
[0m00:47:54.746447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B642CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FF9ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FF9BF70>]}
[0m00:47:54.746752 [debug] [MainThread]: Flushing usage events
[0m00:47:57.518482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:31.933525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9BF702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9CFBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9CFBB9D0>]}


============================== 00:50:31.937814 | a14a0c43-7a6b-4642-aa62-95476ddd455d ==============================
[0m00:50:31.937814 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:50:31.938623 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions_with_fx', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:50:35.266048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9C2CF6F0>]}
[0m00:50:35.328328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC09FB350>]}
[0m00:50:35.328936 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:50:35.958902 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:50:36.152561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:50:36.153033 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:50:36.425541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:50:36.430086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC20BC850>]}
[0m00:50:36.516266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:50:36.518749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:50:36.548684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC0ABD9A0>]}
[0m00:50:36.549109 [info ] [MainThread]: Found 2 models, 5 data tests, 610 macros
[0m00:50:36.549513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC21D34D0>]}
[0m00:50:36.551280 [info ] [MainThread]: 
[0m00:50:36.551801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:50:36.552163 [info ] [MainThread]: 
[0m00:50:36.552671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:50:36.553940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:50:36.554398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:38.037089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:50:38.037475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:39.393454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC21B9300>]}
[0m00:50:39.393880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:50:39.398610 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.399248 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions_with_fx ........................... [RUN]
[0m00:50:39.400024 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m00:50:39.400860 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.408173 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m00:50:39.416800 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.444153 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m00:50:39.445531 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m00:50:39.446014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:50:41.233615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:08c3f55b-0065-4859-8efe-d1e3b9f98948&page=queryresults
[0m00:50:41.890650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC22C4C50>]}
[0m00:50:41.891228 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions_with_fx ...................... [[32mCREATE VIEW (0 processed)[0m in 2.49s]
[0m00:50:41.891951 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:41.893520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:50:41.894936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:41.895211 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:50:41.895493 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:50:41.895740 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m00:50:41.896018 [info ] [MainThread]: 
[0m00:50:41.896400 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m00:50:41.897088 [debug] [MainThread]: Command end result
[0m00:50:41.923852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:50:41.925960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:50:41.931418 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:50:41.931729 [info ] [MainThread]: 
[0m00:50:41.932316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:50:41.932864 [info ] [MainThread]: 
[0m00:50:41.933247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:50:41.934258 [debug] [MainThread]: Command `dbt run` succeeded at 00:50:41.934153 after 10.17 seconds
[0m00:50:41.934605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC2659860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC2298370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9C2ABF70>]}
[0m00:50:41.934921 [debug] [MainThread]: Flushing usage events
[0m00:50:43.826099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:56.581776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF13B902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BDB9D0>]}


============================== 00:51:56.586050 | 3a00790a-1f8c-41a7-9a52-171b810b61c1 ==============================
[0m00:51:56.586050 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:51:56.586697 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_sessions_with_fx_local_nonnegative', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m00:51:59.830654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF13EF36F0>]}
[0m00:51:59.894950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF3862B350>]}
[0m00:51:59.895552 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:52:00.551007 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:52:00.722175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:52:00.722631 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_sessions_with_fx_local_nonnegative.sql
[0m00:52:00.880335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:52:00.884874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39CF8B50>]}
[0m00:52:00.974585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:52:00.976899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:52:01.024417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E77A70>]}
[0m00:52:01.024824 [info ] [MainThread]: Found 2 models, 6 data tests, 610 macros
[0m00:52:01.025218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39EC9630>]}
[0m00:52:01.026583 [info ] [MainThread]: 
[0m00:52:01.026976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:52:01.027322 [info ] [MainThread]: 
[0m00:52:01.027800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:52:01.031666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:52:01.032017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:02.447537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39ED1640>]}
[0m00:52:02.447938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:02.453247 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.453897 [info ] [Thread-1 (]: 1 of 1 START test stg_sessions_with_fx_local_nonnegative ....................... [RUN]
[0m00:52:02.454625 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative'
[0m00:52:02.455118 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.462002 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m00:52:02.463097 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.486113 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m00:52:02.487212 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m00:52:02.487702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:52:04.366604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:39c5e8c0-22e8-4ea3-9cc8-b09c2ee56492&page=queryresults
[0m00:52:06.254410 [info ] [Thread-1 (]: 1 of 1 PASS stg_sessions_with_fx_local_nonnegative ............................. [[32mPASS[0m in 3.80s]
[0m00:52:06.255334 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:06.257140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:52:06.258752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:06.259041 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:52:06.259279 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m00:52:06.259539 [info ] [MainThread]: 
[0m00:52:06.259898 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m00:52:06.260557 [debug] [MainThread]: Command end result
[0m00:52:06.285351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:52:06.287502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:52:06.293490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:52:06.293788 [info ] [MainThread]: 
[0m00:52:06.294289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:06.294727 [info ] [MainThread]: 
[0m00:52:06.295125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:52:06.296009 [debug] [MainThread]: Command `dbt test` succeeded at 00:52:06.295909 after 9.85 seconds
[0m00:52:06.296324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E71910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E72BA0>]}
[0m00:52:06.296693 [debug] [MainThread]: Flushing usage events
[0m00:52:07.550457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:26.565325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E230902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E240DBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E240DB9D0>]}


============================== 01:08:26.569643 | 3df9123c-d8ab-4b4a-96e2-2ed117d96da1 ==============================
[0m01:08:26.569643 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:08:26.570363 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select staging.stg_sessions_with_fx', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:08:29.667180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E233EF6F0>]}
[0m01:08:29.728449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E47B1B350>]}
[0m01:08:29.729100 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:08:30.398817 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:08:30.584676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:08:30.585003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:08:30.590262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:08:30.625662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E48B7B850>]}
[0m01:08:30.709373 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:08:30.711671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:08:30.739065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E48BA99A0>]}
[0m01:08:30.739512 [info ] [MainThread]: Found 2 models, 6 data tests, 610 macros
[0m01:08:30.739941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E4928C670>]}
[0m01:08:30.741311 [info ] [MainThread]: 
[0m01:08:30.741745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:08:30.742096 [info ] [MainThread]: 
[0m01:08:30.742614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:08:30.743451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:08:30.743803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:32.335158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:08:32.335545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:33.732854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E47B1FE10>]}
[0m01:08:33.733417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:33.738693 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:33.739631 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions_with_fx ........................... [RUN]
[0m01:08:33.740659 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:08:33.741238 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:33.754127 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:08:33.755943 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:33.782478 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:08:33.783577 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m01:08:33.784089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:08:35.531348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c49c5a82-ab9f-407c-ad28-3de5efc3ebf6&page=queryresults
[0m01:08:36.209401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E492C5610>]}
[0m01:08:36.209970 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions_with_fx ...................... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m01:08:36.210604 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:36.212185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:36.213578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:36.213844 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:08:36.214087 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:08:36.214327 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:08:36.214596 [info ] [MainThread]: 
[0m01:08:36.214956 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m01:08:36.215622 [debug] [MainThread]: Command end result
[0m01:08:36.239817 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:08:36.242010 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:08:36.247278 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:08:36.247659 [info ] [MainThread]: 
[0m01:08:36.248081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:36.248628 [info ] [MainThread]: 
[0m01:08:36.249223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:08:36.250447 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:36.250342 after 9.85 seconds
[0m01:08:36.250766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E497F0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E233CADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E233CBF70>]}
[0m01:08:36.251078 [debug] [MainThread]: Flushing usage events
[0m01:08:38.194105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:22.189127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FDB202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FEB6BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FEB6B9D0>]}


============================== 01:27:22.193438 | 1d6b7be0-cd3f-4925-8f31-13bb3d840028 ==============================
[0m01:27:22.193438 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:27:22.194128 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select staging.stg_hits_products', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:27:25.371034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FDE7F6F0>]}
[0m01:27:25.431912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A269B350>]}
[0m01:27:25.432509 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:27:26.086908 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:27:26.297442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:27:26.297898 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\stg_hits_products.sql
[0m01:27:26.535172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:27:26.540232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3D70C50>]}
[0m01:27:26.619915 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:26.622201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:26.649355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A27599A0>]}
[0m01:27:26.649768 [info ] [MainThread]: Found 3 models, 6 data tests, 610 macros
[0m01:27:26.650153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3EAAEB0>]}
[0m01:27:26.651553 [info ] [MainThread]: 
[0m01:27:26.651927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:27:26.652334 [info ] [MainThread]: 
[0m01:27:26.652875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:26.653712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:27:26.654069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:28.293988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:27:28.294369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:29.643532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3E45300>]}
[0m01:27:29.643978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:29.648981 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:27:29.649820 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_hits_products .............................. [RUN]
[0m01:27:29.650731 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:27:29.651058 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:27:29.657092 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:27:29.658602 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:27:29.686800 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:27:29.687944 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_hits_products`
  OPTIONS()
  as WITH raw AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)              AS hit_date,
    fullVisitorId                           AS visitor_id,
    visitId                                 AS visit_id,
    hits.transaction.transactionId          AS transaction_id,
    p.productSKU                            AS product_sku,
    p.v2ProductName                         AS product_name,
    p.v2ProductCategory                     AS product_category,
    p.productQuantity                       AS product_quantity,
    p.productPrice / 1e6                    AS product_price_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       UNNEST(hits) AS hits,
       UNNEST(hits.product) AS p
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
    AND p.productSKU IS NOT NULL
)
SELECT *
FROM raw;


[0m01:27:29.688537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:27:31.481814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:00c9cf1d-9ceb-4842-a942-6e80f5047c93&page=queryresults
[0m01:27:32.167036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3F56690>]}
[0m01:27:32.167624 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_hits_products ......................... [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m01:27:32.168344 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:27:32.169697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:32.171384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:32.171673 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:27:32.171918 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:27:32.172332 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:27:32.172752 [info ] [MainThread]: 
[0m01:27:32.173135 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m01:27:32.173818 [debug] [MainThread]: Command end result
[0m01:27:32.200269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:32.203003 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:32.208694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:27:32.209379 [info ] [MainThread]: 
[0m01:27:32.209881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:32.210580 [info ] [MainThread]: 
[0m01:27:32.211236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:27:32.212193 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:32.212088 after 10.15 seconds
[0m01:27:32.212513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3B67E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3F42AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FDE5BF70>]}
[0m01:27:32.212828 [debug] [MainThread]: Flushing usage events
[0m01:27:34.284521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:04.179835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ABB602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ACBABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ACBAB9D0>]}


============================== 01:30:04.184161 | 3465f166-9d53-44b4-8206-b5e1f8374956 ==============================
[0m01:30:04.184161 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:30:04.184852 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select stg_hits_products_quality', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:30:07.161437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ABEBF6F0>]}
[0m01:30:07.221624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D05DB350>]}
[0m01:30:07.222225 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:30:07.860559 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:30:08.041013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:30:08.041473 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_hits_products_quality.sql
[0m01:30:08.211590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:30:08.216089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1B35050>]}
[0m01:30:08.309356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:30:08.312249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:30:08.352232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E2FA70>]}
[0m01:30:08.352833 [info ] [MainThread]: Found 3 models, 7 data tests, 610 macros
[0m01:30:08.353237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E81470>]}
[0m01:30:08.354605 [info ] [MainThread]: 
[0m01:30:08.354999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:30:08.355354 [info ] [MainThread]: 
[0m01:30:08.355849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:30:08.361760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:30:08.362172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:09.813233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E88EF0>]}
[0m01:30:09.813634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:09.818628 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m01:30:09.818976 [info ] [Thread-1 (]: 1 of 1 START test stg_hits_products_quality .................................... [RUN]
[0m01:30:09.819823 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.stg_hits_products_quality'
[0m01:30:09.820137 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m01:30:09.828127 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m01:30:09.829547 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m01:30:09.855097 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m01:30:09.856494 [debug] [Thread-1 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from `e2e-dbt-project`.`stg`.`stg_hits_products`
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from `e2e-dbt-project`.`stg`.`stg_hits_products`
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m01:30:09.856878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:30:11.712736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc8f5eb2-f999-494e-b25c-15bfdcf9721e&page=queryresults
[0m01:30:13.289050 [info ] [Thread-1 (]: 1 of 1 PASS stg_hits_products_quality .......................................... [[32mPASS[0m in 3.47s]
[0m01:30:13.289945 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m01:30:13.291451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:13.293137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:13.293419 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:30:13.293670 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_hits_products_quality' was properly closed.
[0m01:30:13.293945 [info ] [MainThread]: 
[0m01:30:13.294326 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m01:30:13.295022 [debug] [MainThread]: Command end result
[0m01:30:13.318967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:30:13.321119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:30:13.327597 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:30:13.327930 [info ] [MainThread]: 
[0m01:30:13.328340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:13.328692 [info ] [MainThread]: 
[0m01:30:13.329065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:30:13.329930 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:13.329831 after 9.32 seconds
[0m01:30:13.330241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ACB80590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E2AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E2ABA0>]}
[0m01:30:13.330553 [debug] [MainThread]: Flushing usage events
[0m01:30:16.247043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:46.963290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ACCF02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ADD3BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ADD3B9D0>]}


============================== 01:35:46.967277 | 150383de-d435-49d6-af10-ad801a98cf9c ==============================
[0m01:35:46.967277 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:35:46.967966 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:35:50.035934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AD04F6F0>]}
[0m01:35:50.096822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D176B350>]}
[0m01:35:50.097392 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:35:50.707874 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:35:50.893876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:35:50.894471 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\fct_sales_item.sql
[0m01:35:51.135037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D2DE1050>]}
[0m01:35:51.212943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:51.215319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:51.244543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D27FD9A0>]}
[0m01:35:51.244968 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m01:35:51.245390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D2F96F90>]}
[0m01:35:51.246766 [info ] [MainThread]: 
[0m01:35:51.247150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:35:51.247486 [info ] [MainThread]: 
[0m01:35:51.247955 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:51.248792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:35:51.249192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:52.797964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_mart)
[0m01:35:52.798470 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_mart"
"
[0m01:35:52.806634 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_mart"} */
create schema if not exists `e2e-dbt-project`.`stg_mart`
  
[0m01:35:52.807021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:54.595898 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8214e342-e219-416d-8ab8-5f9d5f0b5089&page=queryresults
[0m01:35:55.713176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_mart'
[0m01:35:55.713666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:55.714039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:35:55.714485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:57.442262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D2F29230>]}
[0m01:35:57.442882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:57.449714 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:35:57.450668 [info ] [Thread-1 (]: 1 of 1 START sql table model stg_mart.fct_sales_item ........................... [RUN]
[0m01:35:57.451742 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:35:57.452407 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:35:57.465131 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:35:57.466560 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:35:57.502106 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:35:57.503804 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`stg_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:35:57.504474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:35:59.511364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fa0bed8f-b5f4-4a9e-84ba-5ab4e95e2704&page=queryresults
[0m01:36:05.434297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D3026A50>]}
[0m01:36:05.434882 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stg_mart.fct_sales_item ...................... [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 7.98s]
[0m01:36:05.435750 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:36:05.437542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:05.439065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:05.439353 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_mart' was properly closed.
[0m01:36:05.439597 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_mart' was properly closed.
[0m01:36:05.439827 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:36:05.440059 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:36:05.440321 [info ] [MainThread]: 
[0m01:36:05.440679 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m01:36:05.441340 [debug] [MainThread]: Command end result
[0m01:36:05.467608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:36:05.469718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:36:05.474948 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:36:05.475250 [info ] [MainThread]: 
[0m01:36:05.475680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:36:05.476044 [info ] [MainThread]: 
[0m01:36:05.476554 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:36:05.477586 [debug] [MainThread]: Command `dbt run` succeeded at 01:36:05.477483 after 18.68 seconds
[0m01:36:05.477909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D3669E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D35F6FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AD02BF70>]}
[0m01:36:05.487145 [debug] [MainThread]: Flushing usage events
[0m01:36:06.769445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:50:20.407626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC39B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC49CEAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC49CF110>]}


============================== 01:50:20.411985 | e86f0aef-d220-4807-baf0-569308bf192f ==============================
[0m01:50:20.411985 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:50:20.412694 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item --target mart', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:50:20.415203 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 15
    ------------------------------
    12 |       location: US
    13 |       maximum_bytes_billed: 1000000000   # 1 GB safety cap
    14 | 
    15 |      mart:                     # marts target
    16 |       type: bigquery
    17 |       method: service-account
    18 |       project: e2e-dbt-project
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 15, column 6
  
[0m01:50:20.416285 [debug] [MainThread]: Command `dbt run` failed at 01:50:20.416171 after 0.13 seconds
[0m01:50:20.416615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC48D4D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC48F16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC48ECD10>]}
[0m01:50:20.416971 [debug] [MainThread]: Flushing usage events
[0m01:50:21.707222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:52:15.767546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540BB902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540CBDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540CBDB9D0>]}


============================== 01:52:15.771944 | e9433c92-e95f-451f-b00a-917ba80187a8 ==============================
[0m01:52:15.771944 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:52:15.772636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item --target mart', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:52:20.102967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540BEEF6F0>]}
[0m01:52:20.185277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543060B9B0>]}
[0m01:52:20.185888 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:52:20.974514 [debug] [MainThread]: checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101, vars: {}, profile: , target: mart, version: 1.10.9
[0m01:52:21.102762 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:52:21.103314 [debug] [MainThread]: previous checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101, current checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23
[0m01:52:21.103862 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:52:21.104479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543166A150>]}
[0m01:52:23.120442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431CC8410>]}
[0m01:52:23.250293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:23.253810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:23.289357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431D46270>]}
[0m01:52:23.289786 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m01:52:23.290252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431CE01F0>]}
[0m01:52:23.292364 [info ] [MainThread]: 
[0m01:52:23.292828 [info ] [MainThread]: Concurrency: 1 threads (target='mart')
[0m01:52:23.293184 [info ] [MainThread]: 
[0m01:52:23.293968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:52:23.295023 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:52:23.295573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:24.992843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_mart_mart)
[0m01:52:24.993354 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "mart_mart"
"
[0m01:52:25.002127 [debug] [ThreadPool]: On create_e2e-dbt-project_mart_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "mart", "connection_name": "create_e2e-dbt-project_mart_mart"} */
create schema if not exists `e2e-dbt-project`.`mart_mart`
  
[0m01:52:25.002535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:26.712484 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eba8ea3d-5b14-4d53-a925-d3438ac1a9e3&page=queryresults
[0m01:52:27.810995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_mart_mart'
[0m01:52:27.811422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:29.306920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project_mart_mart, now list_e2e-dbt-project_mart)
[0m01:52:29.307312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:30.768559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431ED1850>]}
[0m01:52:30.769301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:30.776069 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:52:30.776944 [info ] [Thread-1 (]: 1 of 1 START sql table model mart_mart.fct_sales_item .......................... [RUN]
[0m01:52:30.778265 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:52:30.778950 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:52:30.792538 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:52:30.794141 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:52:30.844604 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:52:30.845710 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "mart", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`mart_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`mart`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`mart`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:52:30.846376 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:32.611000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ad53dd6a-25da-4e8d-8c41-5a0bd4838289&page=queryresults
[0m01:52:32.611584 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ad53dd6a-25da-4e8d-8c41-5a0bd4838289&page=queryresults
[0m01:52:32.722491 [debug] [Thread-1 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:52:32.724456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543251DF40>]}
[0m01:52:32.725029 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart_mart.fct_sales_item ................. [[31mERROR[0m in 1.95s]
[0m01:52:32.725761 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:52:32.726291 [debug] [Thread-4 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m01:52:32.727886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:32.729340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:32.729616 [debug] [MainThread]: Connection 'create_e2e-dbt-project_mart_mart' was properly closed.
[0m01:52:32.730038 [debug] [MainThread]: Connection 'list_e2e-dbt-project_mart' was properly closed.
[0m01:52:32.730320 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:52:32.730635 [info ] [MainThread]: 
[0m01:52:32.731178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m01:52:32.731996 [debug] [MainThread]: Command end result
[0m01:52:32.765403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:32.767883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:32.773245 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:52:32.773549 [info ] [MainThread]: 
[0m01:52:32.773977 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:52:32.774396 [info ] [MainThread]: 
[0m01:52:32.774825 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m01:52:32.775248 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:52:32.775606 [info ] [MainThread]: 
[0m01:52:32.776010 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:52:32.776359 [info ] [MainThread]: 
[0m01:52:32.776739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:52:32.777625 [debug] [MainThread]: Command `dbt run` failed at 01:52:32.777523 after 17.19 seconds
[0m01:52:32.777953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431BBC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543264FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431B69B50>]}
[0m01:52:32.778269 [debug] [MainThread]: Flushing usage events
[0m01:52:35.661606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:16.305100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A30602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A40A3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A40A39D0>]}


============================== 01:54:16.309403 | 8525fd67-18fa-4245-b921-0c469509799d ==============================
[0m01:54:16.309403 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:54:16.310091 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug --target mart', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:54:16.336112 [info ] [MainThread]: dbt version: 1.10.9
[0m01:54:16.336633 [info ] [MainThread]: python version: 3.13.6
[0m01:54:16.337166 [info ] [MainThread]: python path: c:\Projects\ga_retail_project\.venv\Scripts\python.exe
[0m01:54:16.337573 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m01:54:19.254098 [info ] [MainThread]: Using profiles dir at C:\Users\dovie\.dbt
[0m01:54:19.254547 [info ] [MainThread]: Using profiles.yml file at C:\Users\dovie\.dbt\profiles.yml
[0m01:54:19.254893 [info ] [MainThread]: Using dbt_project.yml file at C:\Projects\ga_retail_project\dbt_project.yml
[0m01:54:19.255307 [info ] [MainThread]: adapter type: bigquery
[0m01:54:19.255643 [info ] [MainThread]: adapter version: 1.10.1
[0m01:54:19.361335 [info ] [MainThread]: Configuration:
[0m01:54:19.361795 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:54:19.362148 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:54:19.362492 [info ] [MainThread]: Required dependencies:
[0m01:54:19.362849 [debug] [MainThread]: Executing "git --help"
[0m01:54:19.411495 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:54:19.411901 [debug] [MainThread]: STDERR: "b''"
[0m01:54:19.412263 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:54:19.412675 [info ] [MainThread]: Connection:
[0m01:54:19.413058 [info ] [MainThread]:   method: service-account
[0m01:54:19.413456 [info ] [MainThread]:   database: e2e-dbt-project
[0m01:54:19.413985 [info ] [MainThread]:   execution_project: e2e-dbt-project
[0m01:54:19.414388 [info ] [MainThread]:   schema: mart
[0m01:54:19.414743 [info ] [MainThread]:   location: US
[0m01:54:19.415090 [info ] [MainThread]:   priority: None
[0m01:54:19.415434 [info ] [MainThread]:   maximum_bytes_billed: 1000000000
[0m01:54:19.415773 [info ] [MainThread]:   impersonate_service_account: None
[0m01:54:19.416114 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:54:19.416486 [info ] [MainThread]:   job_retries: 1
[0m01:54:19.416836 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:54:19.417174 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m01:54:19.417511 [info ] [MainThread]:   timeout_seconds: None
[0m01:54:19.417845 [info ] [MainThread]:   client_id: None
[0m01:54:19.418180 [info ] [MainThread]:   token_uri: None
[0m01:54:19.418514 [info ] [MainThread]:   compute_region: None
[0m01:54:19.418847 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:54:19.419182 [info ] [MainThread]:   gcs_bucket: None
[0m01:54:19.419515 [info ] [MainThread]:   dataproc_batch: None
[0m01:54:19.420030 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:54:20.039683 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:54:20.040020 [debug] [MainThread]: On debug: select 1 as id
[0m01:54:20.040302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:21.758863 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d99860c-7666-404b-9c26-6a5d33d8acdc&page=queryresults
[0m01:54:22.410574 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:54:22.411166 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:54:22.412242 [debug] [MainThread]: Command `dbt debug` succeeded at 01:54:22.412120 after 6.28 seconds
[0m01:54:22.412558 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:54:22.412901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A33BC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C8D595B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C7BAE250>]}
[0m01:54:22.413340 [debug] [MainThread]: Flushing usage events
[0m01:54:23.760034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:33.716505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547C8502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547D89BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547D89B9D0>]}


============================== 01:54:33.720927 | 67bcddbc-2bf0-4857-b776-6a2012572c2a ==============================
[0m01:54:33.720927 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:54:33.721595 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item --target mart', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:54:36.749595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547CBAF6F0>]}
[0m01:54:36.823214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254213AB9B0>]}
[0m01:54:36.823808 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:54:37.444353 [debug] [MainThread]: checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101, vars: {}, profile: , target: mart, version: 1.10.9
[0m01:54:37.622960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:37.623285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:37.665347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422624050>]}
[0m01:54:37.748669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:54:37.751363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:54:37.781161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542146D6D0>]}
[0m01:54:37.781669 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m01:54:37.782066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B244B0>]}
[0m01:54:37.783584 [info ] [MainThread]: 
[0m01:54:37.783978 [info ] [MainThread]: Concurrency: 1 threads (target='mart')
[0m01:54:37.784360 [info ] [MainThread]: 
[0m01:54:37.784850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:54:37.785702 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:54:37.786051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:39.252054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_mart_mart'
[0m01:54:39.252441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:40.600578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project_mart_mart, now list_e2e-dbt-project_mart)
[0m01:54:40.600932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:41.987550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254213AFEE0>]}
[0m01:54:41.988423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:41.992585 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:54:41.993021 [info ] [Thread-1 (]: 1 of 1 START sql table model mart_mart.fct_sales_item .......................... [RUN]
[0m01:54:41.994030 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:54:41.994710 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:54:42.008849 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:54:42.010596 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:54:42.054177 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:54:42.055489 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "mart", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`mart_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`mart`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`mart`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:54:42.055958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:54:43.921093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:172c1236-e1b1-409a-9a2a-d0a392310479&page=queryresults
[0m01:54:43.921607 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:172c1236-e1b1-409a-9a2a-d0a392310479&page=queryresults
[0m01:54:43.930273 [debug] [Thread-1 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:54:43.932808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B3CA10>]}
[0m01:54:43.933440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart_mart.fct_sales_item ................. [[31mERROR[0m in 1.94s]
[0m01:54:43.934160 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:54:43.934806 [debug] [Thread-4 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m01:54:43.936985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:43.939329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:43.939775 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:54:43.940205 [debug] [MainThread]: Connection 'list_e2e-dbt-project_mart' was properly closed.
[0m01:54:43.940634 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:54:43.941105 [info ] [MainThread]: 
[0m01:54:43.941699 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m01:54:43.942824 [debug] [MainThread]: Command end result
[0m01:54:43.970010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:54:43.972133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:54:43.977447 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:54:43.977826 [info ] [MainThread]: 
[0m01:54:43.978314 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:54:43.978755 [info ] [MainThread]: 
[0m01:54:43.979249 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m01:54:43.980095 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:54:43.980782 [info ] [MainThread]: 
[0m01:54:43.981382 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:54:43.981809 [info ] [MainThread]: 
[0m01:54:43.982233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:54:43.983150 [debug] [MainThread]: Command `dbt run` failed at 01:54:43.983046 after 10.39 seconds
[0m01:54:43.983492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542291ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B8E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B8E5D0>]}
[0m01:54:43.983829 [debug] [MainThread]: Flushing usage events
[0m01:54:44.991288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:06:41.635413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218EF5702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F05BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F05BB9D0>]}


============================== 02:06:41.641581 | 8fdec8f7-7930-4b93-a03c-b4360e458a95 ==============================
[0m02:06:41.641581 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:06:41.642507 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:06:46.193421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218EF8CF6F0>]}
[0m02:06:46.295437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218941AB350>]}
[0m02:06:46.296325 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:06:47.308054 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:06:47.453491 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:06:47.454235 [debug] [MainThread]: previous checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, current checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101
[0m02:06:47.454664 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:06:47.455408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189423A150>]}
[0m02:06:49.964070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021895868410>]}
[0m02:06:50.097668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:06:50.101463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:06:50.142769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218958E2270>]}
[0m02:06:50.143396 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m02:06:50.144052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189587C1F0>]}
[0m02:06:50.146167 [info ] [MainThread]: 
[0m02:06:50.146784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:06:50.147341 [info ] [MainThread]: 
[0m02:06:50.148105 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:06:50.149491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:06:50.150162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:52.214838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_mart)
[0m02:06:52.215598 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_mart"
"
[0m02:06:52.228567 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_mart"} */
create schema if not exists `e2e-dbt-project`.`stg_mart`
  
[0m02:06:52.229139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:54.383521 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4e0eff6e-a526-4d81-95e6-57ad1e1f59fc&page=queryresults
[0m02:06:55.328960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_mart'
[0m02:06:55.330015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m02:06:55.330470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:55.331001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:58.021499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021895A65850>]}
[0m02:06:58.022270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:58.030421 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:06:58.031569 [info ] [Thread-1 (]: 1 of 1 START sql table model stg_mart.fct_sales_item ........................... [RUN]
[0m02:06:58.033034 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:06:58.034039 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:06:58.055353 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:06:58.057450 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:06:58.153353 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:06:58.155264 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`stg_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m02:06:58.156542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:07:00.911216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6b102357-92fc-476b-876c-3bc023a15a43&page=queryresults
[0m02:07:04.279034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189611DB20>]}
[0m02:07:04.279959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stg_mart.fct_sales_item ...................... [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 6.24s]
[0m02:07:04.281100 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:07:04.283150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:04.285829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:04.286267 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_mart' was properly closed.
[0m02:07:04.286671 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_mart' was properly closed.
[0m02:07:04.287063 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m02:07:04.287461 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:07:04.287904 [info ] [MainThread]: 
[0m02:07:04.288514 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.14 seconds (14.14s).
[0m02:07:04.289644 [debug] [MainThread]: Command end result
[0m02:07:04.328671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:07:04.332446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:07:04.341452 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:07:04.342221 [info ] [MainThread]: 
[0m02:07:04.343240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:07:04.344099 [info ] [MainThread]: 
[0m02:07:04.345102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:07:04.347275 [debug] [MainThread]: Command `dbt run` succeeded at 02:07:04.347055 after 22.98 seconds
[0m02:07:04.348150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218959676B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218959B2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218ED33B650>]}
[0m02:07:04.349002 [debug] [MainThread]: Flushing usage events
[0m02:07:05.844949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:49.421083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C5002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D54BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D54B9D0>]}


============================== 02:19:49.427556 | e4dc1f72-4986-4689-81b9-3b8de6c3df80 ==============================
[0m02:19:49.427556 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:19:49.428511 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:19:54.167791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C85F6F0>]}
[0m02:19:54.267669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB0F8B350>]}
[0m02:19:54.268605 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:19:55.364965 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:19:55.536750 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:19:55.537598 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:19:55.538380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB1FEA150>]}
[0m02:19:58.112480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB2648410>]}
[0m02:19:58.245002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:19:58.248610 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:19:58.290032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB26C6270>]}
[0m02:19:58.290660 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m02:19:58.291287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB265C120>]}
[0m02:19:58.293740 [info ] [MainThread]: 
[0m02:19:58.294363 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:19:58.294926 [info ] [MainThread]: 
[0m02:19:58.295739 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:19:58.301490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:19:58.302253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:58.303365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:19:58.304192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:00.865969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m02:20:00.866701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_mart)
[0m02:20:00.867489 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m02:20:00.868199 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_mart"
"
[0m02:20:00.885545 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_mart"} */
create schema if not exists `e2e-dbt-project`.`analytics_mart`
  
[0m02:20:00.890632 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m02:20:00.891214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:00.891800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:03.505036 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c6405488-abf1-494e-bc1d-c7b586eb6462&page=queryresults
[0m02:20:03.586477 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4741598e-ba5e-4ac0-981d-cb259d2aead0&page=queryresults
[0m02:20:04.709028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:20:04.709774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:04.710524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:20:04.711244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:07.356580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB2860B90>]}
[0m02:20:07.357293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:07.367297 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:20:07.368193 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:20:07.368979 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:20:07.370402 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:20:07.371589 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:20:07.372526 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:20:07.373400 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:20:07.374117 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:20:07.385311 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:20:07.389165 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:20:07.391764 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:20:07.392594 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:20:07.443510 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:20:07.444167 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:20:07.446261 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m02:20:07.447385 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as WITH raw AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)              AS hit_date,
    fullVisitorId                           AS visitor_id,
    visitId                                 AS visit_id,
    hits.transaction.transactionId          AS transaction_id,
    p.productSKU                            AS product_sku,
    p.v2ProductName                         AS product_name,
    p.v2ProductCategory                     AS product_category,
    p.productQuantity                       AS product_quantity,
    p.productPrice / 1e6                    AS product_price_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       UNNEST(hits) AS hits,
       UNNEST(hits.product) AS p
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
    AND p.productSKU IS NOT NULL
)
SELECT *
FROM raw;


[0m02:20:07.448398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:20:07.449154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:20:10.123055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8fa09d1-8003-45ce-b6dc-81c717bbcb03&page=queryresults
[0m02:20:10.162355 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:745c5ac3-e897-44c9-9fdf-89f7cb2c8d9e&page=queryresults
[0m02:20:10.669653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB287AA40>]}
[0m02:20:10.670604 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m02:20:10.671766 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:20:10.747512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB207B4D0>]}
[0m02:20:10.748393 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.38s]
[0m02:20:10.749517 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:20:10.750459 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:10.751240 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:20:10.752364 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:20:10.752927 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:10.756852 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:20:10.758199 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:10.762442 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:20:10.763980 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m02:20:10.764741 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:20:13.126369 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:48659b0e-61e7-4f22-9648-30d5ba6f76e3&page=queryresults
[0m02:20:13.691512 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D51A2D0>]}
[0m02:20:13.692381 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.94s]
[0m02:20:13.693513 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:13.694462 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:20:13.695234 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m02:20:13.696189 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:20:13.696727 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:20:13.700896 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:20:13.702329 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:20:13.746937 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:20:13.748658 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m02:20:13.749424 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:20:16.139111 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d116551-a8af-4355-89f1-2944c5337e6c&page=queryresults
[0m02:20:19.686026 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB301F2A0>]}
[0m02:20:19.686944 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.99s]
[0m02:20:19.688062 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:20:19.690125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:19.692999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:19.693479 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:20:19.693885 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:20:19.694277 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:20:19.694667 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:20:19.695055 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:20:19.695449 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:20:19.695898 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m02:20:19.696295 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:20:19.696805 [info ] [MainThread]: 
[0m02:20:19.697426 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 21.40 seconds (21.40s).
[0m02:20:19.699253 [debug] [MainThread]: Command end result
[0m02:20:19.740151 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:20:19.743496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:20:19.752598 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:20:19.753143 [info ] [MainThread]: 
[0m02:20:19.754043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:19.754929 [info ] [MainThread]: 
[0m02:20:19.755869 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:20:19.758030 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:19.757808 after 30.61 seconds
[0m02:20:19.758925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB30291F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB3028530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB3029790>]}
[0m02:20:19.759789 [debug] [MainThread]: Flushing usage events
[0m02:20:21.353501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:40.796517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4935F02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49463BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49463B9D0>]}


============================== 02:26:40.800894 | 3e6d3213-74d0-40b8-b59c-59b09f5cbe64 ==============================
[0m02:26:40.800894 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:26:40.801591 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:26:43.681745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49394F6F0>]}
[0m02:26:43.741758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B806B350>]}
[0m02:26:43.742349 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:26:44.385075 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:26:44.561086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:26:44.561441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:26:44.600717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B92E4050>]}
[0m02:26:44.681658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:26:44.683922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:26:44.712729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B8129F40>]}
[0m02:26:44.713114 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m02:26:44.713522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B97E84B0>]}
[0m02:26:44.715131 [info ] [MainThread]: 
[0m02:26:44.715498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:26:44.715825 [info ] [MainThread]: 
[0m02:26:44.716285 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:26:44.721434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:26:44.721956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:44.722336 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:26:44.722815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:46.558182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m02:26:46.558662 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m02:26:46.568171 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m02:26:46.568549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:26:48.182542 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c1f6df16-8fd8-43ef-97a2-c99b5f30e4eb&page=queryresults
[0m02:26:49.293244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:26:49.293729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:49.294103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:26:49.294547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:50.967137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B979F5F0>]}
[0m02:26:50.967831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:26:50.974518 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:26:50.975258 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:26:50.976111 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:26:50.977789 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:26:50.976818 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:26:50.978618 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:26:50.979445 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:26:50.985207 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:26:50.985634 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:26:50.989220 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:26:50.990360 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:26:51.000810 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:26:51.014951 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:26:51.018418 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:26:51.019687 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m02:26:51.020476 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as WITH raw AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)              AS hit_date,
    fullVisitorId                           AS visitor_id,
    visitId                                 AS visit_id,
    hits.transaction.transactionId          AS transaction_id,
    p.productSKU                            AS product_sku,
    p.v2ProductName                         AS product_name,
    p.v2ProductCategory                     AS product_category,
    p.productQuantity                       AS product_quantity,
    p.productPrice / 1e6                    AS product_price_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       UNNEST(hits) AS hits,
       UNNEST(hits.product) AS p
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
    AND p.productSKU IS NOT NULL
)
SELECT *
FROM raw;


[0m02:26:51.021116 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:26:51.021573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:26:53.087160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dccef246-aa58-4b4b-b584-973f1134f5a0&page=queryresults
[0m02:26:53.106943 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cf6d5878-42b2-4668-967e-1bfa1ad52a23&page=queryresults
[0m02:26:53.644566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B98062D0>]}
[0m02:26:53.645163 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.67s]
[0m02:26:53.645964 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:26:53.700839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B9E214F0>]}
[0m02:26:53.701384 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.72s]
[0m02:26:53.702200 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:26:53.703110 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:53.704013 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:26:53.704686 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:26:53.705002 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:53.709126 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:26:53.710343 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:53.714497 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:26:53.715760 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m02:26:53.716438 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:26:55.459967 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:63f5c0a0-6aca-4c5c-ab5c-a7757f52b3fb&page=queryresults
[0m02:26:55.983359 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B9EB3CF0>]}
[0m02:26:55.983896 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.28s]
[0m02:26:55.984704 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:55.985440 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:26:55.985848 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m02:26:55.986354 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:26:55.986662 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:26:55.992183 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:26:55.993714 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:26:56.010711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:26:57.398424 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:26:57.399447 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m02:26:58.363190 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9b59ba5e-97e8-45a6-8176-d6ad1a8543d4&page=queryresults
[0m02:27:01.350523 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B9D68D50>]}
[0m02:27:01.351073 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.36s]
[0m02:27:01.351900 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:27:01.353745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:01.355405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:01.355728 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:27:01.355997 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:27:01.356226 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:27:01.356455 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:27:01.356681 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:27:01.356907 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:27:01.357138 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m02:27:01.357363 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:27:01.357664 [info ] [MainThread]: 
[0m02:27:01.358028 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 16.64 seconds (16.64s).
[0m02:27:01.359108 [debug] [MainThread]: Command end result
[0m02:27:01.389065 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:27:01.391414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:27:01.397077 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:27:01.397383 [info ] [MainThread]: 
[0m02:27:01.397791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:27:01.398214 [info ] [MainThread]: 
[0m02:27:01.398592 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:27:01.399470 [debug] [MainThread]: Command `dbt run` succeeded at 02:27:01.399369 after 20.77 seconds
[0m02:27:01.399790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4946904B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48DEF83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49450FD70>]}
[0m02:27:01.400108 [debug] [MainThread]: Flushing usage events
[0m02:27:03.227232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:06.352091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C9BB02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CABFBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CABFB9D0>]}


============================== 19:52:06.359360 | bee06f01-15ee-4099-8366-43945b798df9 ==============================
[0m19:52:06.359360 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:52:06.360461 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:52:16.902730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C9F0F6F0>]}
[0m19:52:16.990632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EE63B350>]}
[0m19:52:16.991314 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:52:18.116759 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:52:20.491479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:20.491922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:20.548907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EF8B8050>]}
[0m19:52:20.656269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:52:20.680481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:52:20.791897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EF6CDF40>]}
[0m19:52:20.792541 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m19:52:20.793109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFDB04B0>]}
[0m19:52:20.795333 [info ] [MainThread]: 
[0m19:52:20.795852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:20.796303 [info ] [MainThread]: 
[0m19:52:20.796956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:52:20.798161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m19:52:20.798662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:22.817899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m19:52:22.820657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:22.822933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m19:52:22.824909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:24.932546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EE63FE10>]}
[0m19:52:24.933341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:24.943501 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m19:52:24.944518 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m19:52:24.945695 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m19:52:24.946464 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m19:52:24.960937 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m19:52:24.962874 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m19:52:24.981453 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:26.724967 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m19:52:26.726685 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m19:52:27.842983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aa62697d-414e-432c-915f-146b96c5a01a&page=queryresults
[0m19:52:33.734685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFD79F10>]}
[0m19:52:33.735791 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 8.79s]
[0m19:52:33.737093 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m19:52:33.738809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:33.740982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:33.741359 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m19:52:33.741694 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m19:52:33.742030 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m19:52:33.742367 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m19:52:33.743188 [info ] [MainThread]: 
[0m19:52:33.743765 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m19:52:33.744692 [debug] [MainThread]: Command end result
[0m19:52:33.777112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:52:33.779652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:52:33.786866 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m19:52:33.787529 [info ] [MainThread]: 
[0m19:52:33.788171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:33.788610 [info ] [MainThread]: 
[0m19:52:33.789069 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:52:33.790213 [debug] [MainThread]: Command `dbt run` succeeded at 19:52:33.790082 after 27.65 seconds
[0m19:52:33.790609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFE1CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFD7F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C9EEBF70>]}
[0m19:52:33.791005 [debug] [MainThread]: Flushing usage events
[0m19:52:35.871597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:24.365661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4657702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4667BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4667BB9D0>]}


============================== 20:00:24.370950 | a0a5c7f9-63f6-4702-a297-943ad17ac2d0 ==============================
[0m20:00:24.370950 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:00:24.371750 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:00:27.787641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E465ACF6F0>]}
[0m20:00:27.855171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A2EB350>]}
[0m20:00:27.855797 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:00:28.691328 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:00:28.896084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:28.896431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:28.944345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40B564050>]}
[0m20:00:29.049243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:00:29.051906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:00:29.085378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A3A9F40>]}
[0m20:00:29.085917 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:00:29.086391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BA644B0>]}
[0m20:00:29.088369 [info ] [MainThread]: 
[0m20:00:29.088880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:29.089304 [info ] [MainThread]: 
[0m20:00:29.089895 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:29.090915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m20:00:29.091339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:30.977591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m20:00:30.979732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:30.981282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m20:00:30.982637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:33.043739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A2EFE10>]}
[0m20:00:33.044648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:33.053713 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m20:00:33.054538 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m20:00:33.055498 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m20:00:33.055969 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m20:00:33.067668 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m20:00:33.069243 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m20:00:33.086679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:34.630025 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m20:00:34.631205 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m20:00:35.682826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ce30d1c0-1aea-4a10-813b-b2aa414bd45c&page=queryresults
[0m20:00:39.052671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BA1DF10>]}
[0m20:00:39.053502 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 6.00s]
[0m20:00:39.054969 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m20:00:39.056770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:39.058621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:39.058957 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m20:00:39.059268 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m20:00:39.059581 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m20:00:39.059963 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m20:00:39.060300 [info ] [MainThread]: 
[0m20:00:39.060776 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m20:00:39.061663 [debug] [MainThread]: Command end result
[0m20:00:39.098601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:00:39.101220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:00:39.108224 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m20:00:39.108602 [info ] [MainThread]: 
[0m20:00:39.109293 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:39.109887 [info ] [MainThread]: 
[0m20:00:39.110415 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:00:39.111586 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:39.111461 after 14.93 seconds
[0m20:00:39.112015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BAD4EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BA2F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E465AABF70>]}
[0m20:00:39.112409 [debug] [MainThread]: Flushing usage events
[0m20:00:41.378195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:43.828110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D855D502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D856D9BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D856D9B9D0>]}


============================== 20:10:43.833197 | 3a87c50f-0490-4c0a-b432-9268b8860846 ==============================
[0m20:10:43.833197 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:10:43.833964 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt ls --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:10:48.113272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8560AF6F0>]}
[0m20:10:48.194007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87A7C7240>]}
[0m20:10:48.194747 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:10:48.991720 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:10:49.200702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:49.201380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:49.258753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BA44750>]}
[0m20:10:49.402631 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:10:49.407211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:10:49.454963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87A897E30>]}
[0m20:10:49.455509 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:10:49.456011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BE27BD0>]}
[0m20:10:49.457015 [info ] [MainThread]: ga_retail_project.mart.fct_sales_item
[0m20:10:49.459253 [debug] [MainThread]: Command `dbt ls` succeeded at 20:10:49.459063 after 5.84 seconds
[0m20:10:49.459715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BE6F6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D856D64650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BE7DE50>]}
[0m20:10:49.460138 [debug] [MainThread]: Flushing usage events
[0m20:10:50.950527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:55.222911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA6EB02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA7EFBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA7EFB9D0>]}


============================== 20:21:55.228077 | 65613caa-3485-4d32-953d-1aa343e99bdd ==============================
[0m20:21:55.228077 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:21:55.228805 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:21:59.793153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA720F6F0>]}
[0m20:21:59.878054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECB93B350>]}
[0m20:21:59.878827 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:22:00.829501 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:22:01.101186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:01.101576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:01.164121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECCBB4050>]}
[0m20:22:01.295819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:22:01.298700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:22:01.346136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECB9FDF40>]}
[0m20:22:01.346732 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:22:01.347289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECD0AC4B0>]}
[0m20:22:01.349835 [info ] [MainThread]: 
[0m20:22:01.350696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:01.351451 [info ] [MainThread]: 
[0m20:22:01.352372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:01.353624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m20:22:01.354095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:03.210251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_mart)
[0m20:22:03.211789 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_mart"
"
[0m20:22:03.231431 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_mart"} */
create schema if not exists `e2e-dbt-project`.`analytics_mart`
  
[0m20:22:03.232172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:05.648331 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:46489948-2187-48bc-a102-d922ec44a463&page=queryresults
[0m20:22:06.895854 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m20:22:06.896470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:06.896950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m20:22:06.897511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:09.163279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECCFDA750>]}
[0m20:22:09.164331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:09.174471 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m20:22:09.175297 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m20:22:09.176279 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m20:22:09.176902 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m20:22:09.188592 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m20:22:09.190085 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m20:22:09.250688 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m20:22:09.252182 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m20:22:09.252898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:22:11.134139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92f75740-c633-437b-9ada-f05588276fdd&page=queryresults
[0m20:22:11.135025 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92f75740-c633-437b-9ada-f05588276fdd&page=queryresults
[0m20:22:11.291858 [debug] [Thread-1 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Dataset e2e-dbt-project:analytics_stg was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m20:22:11.295033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECD5B9D90>]}
[0m20:22:11.295939 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics_mart.fct_sales_item ............ [[31mERROR[0m in 2.12s]
[0m20:22:11.296939 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m20:22:11.297817 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Dataset e2e-dbt-project:analytics_stg was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m20:22:11.300372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:11.302572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:11.303001 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_mart' was properly closed.
[0m20:22:11.303373 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m20:22:11.303719 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m20:22:11.304059 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m20:22:11.304462 [info ] [MainThread]: 
[0m20:22:11.304965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.95 seconds (9.95s).
[0m20:22:11.305930 [debug] [MainThread]: Command end result
[0m20:22:11.351965 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:22:11.354873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:22:11.363438 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m20:22:11.363943 [info ] [MainThread]: 
[0m20:22:11.364648 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:22:11.365202 [info ] [MainThread]: 
[0m20:22:11.365825 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m20:22:11.366441 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Dataset e2e-dbt-project:analytics_stg was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m20:22:11.366971 [info ] [MainThread]: 
[0m20:22:11.367581 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m20:22:11.368098 [info ] [MainThread]: 
[0m20:22:11.368644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:22:11.369880 [debug] [MainThread]: Command `dbt run` failed at 20:22:11.369745 after 16.39 seconds
[0m20:22:11.370313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECCEBF280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA5702FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECD6BC870>]}
[0m20:22:11.370747 [debug] [MainThread]: Flushing usage events
[0m20:22:13.525531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:20.114346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023253B802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023254BCBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023254BCB9D0>]}


============================== 20:23:20.119706 | 0f080b75-4ce6-47bb-af4b-d10dbcf83d08 ==============================
[0m20:23:20.119706 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:23:20.120465 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item.sql --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m20:23:24.538603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023253EDF6F0>]}
[0m20:23:24.623994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002327860B350>]}
[0m20:23:24.624858 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:23:25.631380 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:23:25.876417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:25.876827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:25.930447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023279884050>]}
[0m20:23:26.074368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:23:26.078729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:23:26.119591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232786C9F40>]}
[0m20:23:26.120138 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:23:26.120651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023279D804B0>]}
[0m20:23:26.121611 [warn ] [MainThread]: The selection criterion 'mart.fct_sales_item.sql' does not match any enabled nodes
[0m20:23:26.123532 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:23:26.126892 [debug] [MainThread]: Command end result
[0m20:23:26.168859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:23:26.171861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:23:26.176042 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m20:23:26.178050 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:26.177812 after 6.23 seconds
[0m20:23:26.178739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232786F0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023254BA0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023279CBB410>]}
[0m20:23:26.179307 [debug] [MainThread]: Flushing usage events
[0m20:23:28.471191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:18.359508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029789C202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002978AC6BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002978AC6B9D0>]}


============================== 00:49:18.368736 | 03f43f4d-630a-4a63-93b8-92446033340a ==============================
[0m00:49:18.368736 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:49:18.369414 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:49:24.914321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03f43f4d-630a-4a63-93b8-92446033340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029789F7F6F0>]}
[0m00:49:24.977772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03f43f4d-630a-4a63-93b8-92446033340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AE6AB350>]}
[0m00:49:24.978433 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:49:25.762717 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:49:27.255271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m00:49:27.255827 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\sources.yml
[0m00:49:27.256210 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\staging_models.yml
[0m00:49:27.256895 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:49:27.257610 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m00:49:27.258181 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m00:49:27.689694 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:49:27.698779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '03f43f4d-630a-4a63-93b8-92446033340a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AF925650>]}
[0m00:49:27.746649 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named stg_sessions. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for stg_sessions in one of these files:
   - models\staging\stg_sessions.yml
  models\staging\staging_models.yml
[0m00:49:27.747849 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:49:27.748835 [debug] [MainThread]: Command `dbt run` failed at 00:49:27.748729 after 9.59 seconds
[0m00:49:27.749159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AFFB75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AFFB76B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002978AC47E70>]}
[0m00:49:27.749476 [debug] [MainThread]: Flushing usage events
[0m00:49:29.378049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:53:51.970029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA8B602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA9BABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA9BAB9D0>]}


============================== 00:53:51.974236 | f2875b2a-6be5-42f6-afd2-3e82c5df8cfa ==============================
[0m00:53:51.974236 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:53:51.975162 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m00:53:55.162788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2875b2a-6be5-42f6-afd2-3e82c5df8cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA8EBF6F0>]}
[0m00:53:55.234811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2875b2a-6be5-42f6-afd2-3e82c5df8cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCD5EB350>]}
[0m00:53:55.235455 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:53:55.911042 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:53:56.111388 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m00:53:56.111941 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\staging_models.yml
[0m00:53:56.112348 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\sources.yml
[0m00:53:56.112821 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:53:56.113179 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m00:53:56.113485 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m00:53:56.471964 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:53:56.472484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2875b2a-6be5-42f6-afd2-3e82c5df8cfa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCE865250>]}
[0m00:53:56.491168 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd_0__revenue_usd (models\staging\staging_models.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'argument'
[0m00:53:56.492838 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:53:56.494876 [debug] [MainThread]: Command `dbt run` failed at 00:53:56.494696 after 4.71 seconds
[0m00:53:56.495510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCEECA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCEECAA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA9B87E70>]}
[0m00:53:56.496125 [debug] [MainThread]: Flushing usage events
[0m00:53:58.538727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:53.245222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B30E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B412BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B412B9D0>]}


============================== 00:56:53.249778 | 6a00362b-0971-4ee1-b722-0139bdf957f9 ==============================
[0m00:56:53.249778 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:56:53.250446 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m00:56:56.458813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B34436F0>]}
[0m00:56:56.528172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D7B6B350>]}
[0m00:56:56.529107 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:56:57.217525 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:56:57.404221 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m00:56:57.404791 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\sources.yml
[0m00:56:57.405176 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\staging_models.yml
[0m00:56:57.405649 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m00:56:57.406004 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:56:57.406311 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m00:56:57.844603 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:56:57.845122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D8DE5650>]}
[0m00:56:58.017215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D946FA70>]}
[0m00:56:58.128617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:56:58.143933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:56:58.203133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D9328050>]}
[0m00:56:58.203535 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 610 macros
[0m00:56:58.203961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D961BAD0>]}
[0m00:56:58.205747 [info ] [MainThread]: 
[0m00:56:58.206142 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:56:58.206491 [info ] [MainThread]: 
[0m00:56:58.206970 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:56:58.211675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:56:58.212086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:58.212894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:56:58.213336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:00.093288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m00:57:00.094025 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m00:57:00.104092 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m00:57:00.104485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:57:01.782781 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8d835f2a-6323-46ed-8d81-6ce9ca907390&page=queryresults
[0m00:57:04.574784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m00:57:04.575376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:04.575846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m00:57:04.576494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:06.348993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D9646810>]}
[0m00:57:06.349458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:57:06.365184 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m00:57:06.365602 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m00:57:06.366182 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m00:57:06.366966 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m00:57:06.367932 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m00:57:06.368632 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m00:57:06.369030 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m00:57:06.369577 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m00:57:06.378942 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m00:57:06.384000 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m00:57:06.385394 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m00:57:06.405903 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m00:57:06.415924 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m00:57:06.420564 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m00:57:06.422125 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m00:57:06.422928 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m00:57:06.423598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:57:06.423966 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:57:08.309909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f013a605-e83a-4d5a-adb8-696262578205&page=queryresults
[0m00:57:08.310422 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f013a605-e83a-4d5a-adb8-696262578205&page=queryresults
[0m00:57:08.368693 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0894f2c6-ecf5-4cd0-8f97-729bbee64c89&page=queryresults
[0m00:57:08.369177 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0894f2c6-ecf5-4cd0-8f97-729bbee64c89&page=queryresults
[0m00:57:08.424069 [debug] [Thread-2 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m00:57:08.430035 [debug] [Thread-1 (]: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m00:57:08.431284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D9D09440>]}
[0m00:57:08.432189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B3418190>]}
[0m00:57:08.431880 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics_stg.stg_sessions ................ [[31mERROR[0m in 2.06s]
[0m00:57:08.433421 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m00:57:08.434243 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m00:57:08.432746 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics_stg.stg_hits_products ........... [[31mERROR[0m in 2.06s]
[0m00:57:08.435565 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m00:57:08.436319 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m00:57:08.437642 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_hits_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql.
[0m00:57:08.436837 [info ] [Thread-3 (]: 3 of 4 SKIP relation analytics_stg.stg_sessions_with_fx ........................ [[33mSKIP[0m]
[0m00:57:08.438458 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m00:57:08.439156 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m00:57:08.439537 [info ] [Thread-4 (]: 4 of 4 SKIP relation analytics_mart.fct_sales_item ............................. [[33mSKIP[0m]
[0m00:57:08.440011 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m00:57:08.441419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:57:08.444387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:08.444936 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:57:08.445439 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:57:08.446353 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:57:08.446771 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m00:57:08.447030 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m00:57:08.447280 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m00:57:08.447616 [info ] [MainThread]: 
[0m00:57:08.448018 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m00:57:08.448899 [debug] [MainThread]: Command end result
[0m00:57:08.478303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:57:08.480622 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:57:08.486006 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:57:08.486324 [info ] [MainThread]: 
[0m00:57:08.486742 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:57:08.487147 [info ] [MainThread]: 
[0m00:57:08.487581 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m00:57:08.488007 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m00:57:08.488363 [info ] [MainThread]: 
[0m00:57:08.488766 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m00:57:08.489120 [info ] [MainThread]: 
[0m00:57:08.489535 [error] [MainThread]: [31mFailure in model stg_hits_products (models\staging\stg_hits_products.sql)[0m
[0m00:57:08.489954 [error] [MainThread]:   Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m00:57:08.490310 [info ] [MainThread]: 
[0m00:57:08.490714 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_hits_products.sql
[0m00:57:08.491067 [info ] [MainThread]: 
[0m00:57:08.491580 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m00:57:08.492624 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:57:08.493973 [debug] [MainThread]: Command `dbt run` failed at 00:57:08.493850 after 15.43 seconds
[0m00:57:08.494332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D94978D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D96ACC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B41804B0>]}
[0m00:57:08.494667 [debug] [MainThread]: Flushing usage events
[0m00:57:09.739986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:46.325588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A46B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A56F7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A56F79D0>]}


============================== 00:58:46.330627 | 5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a ==============================
[0m00:58:46.330627 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:58:46.331272 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m00:58:49.694869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A4A0F6F0>]}
[0m00:58:49.761939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C912B350>]}
[0m00:58:49.762577 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:58:50.463588 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:58:50.685197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:58:50.686049 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\staging_models.yml
[0m00:58:51.047049 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:58:51.047760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CA7AC450>]}
[0m00:58:51.065379 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd_0__product_price_usd (models\staging\staging_models.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'argument'
[0m00:58:51.066006 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:58:51.067123 [debug] [MainThread]: Command `dbt run` failed at 00:58:51.067013 after 4.91 seconds
[0m00:58:51.067448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CA982F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CA983020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A56D7E70>]}
[0m00:58:51.067787 [debug] [MainThread]: Flushing usage events
[0m00:58:52.383625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:00.945984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DBD902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCDC7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCDC79D0>]}


============================== 01:02:00.950205 | b4609e6a-8c8c-4d5a-90a0-29168ce6bc49 ==============================
[0m01:02:00.950205 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:02:00.950826 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:02:01.094182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4609e6a-8c8c-4d5a-90a0-29168ce6bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DC0EF6F0>]}
[0m01:02:01.174170 [debug] [MainThread]: Command `dbt clean` succeeded at 01:02:01.174056 after 0.40 seconds
[0m01:02:01.174508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCCDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCCD480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE0B0650>]}
[0m01:02:01.174851 [debug] [MainThread]: Flushing usage events
[0m01:02:03.275792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:11.073369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78BAD02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CB0FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CB0F9D0>]}


============================== 01:02:11.077971 | 38fe4b7d-2edf-429e-ad1e-93a21cdf9222 ==============================
[0m01:02:11.077971 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:02:11.078700 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:02:11.223195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38fe4b7d-2edf-429e-ad1e-93a21cdf9222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78BE2F6F0>]}
[0m01:02:11.274924 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-p8eo85ti'
[0m01:02:11.275450 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:02:12.284673 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:02:12.285991 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:02:12.814417 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:02:12.824940 [info ] [MainThread]: Updating lock file in file path: C:\Projects\ga_retail_project/package-lock.yml
[0m01:02:12.834839 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-l5tq9roc'
[0m01:02:12.837696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:02:13.968649 [info ] [MainThread]: Installed from version 1.3.0
[0m01:02:13.969118 [info ] [MainThread]: Up to date!
[0m01:02:13.969546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38fe4b7d-2edf-429e-ad1e-93a21cdf9222', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CA0D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CA0E360>]}
[0m01:02:13.971274 [debug] [MainThread]: Command `dbt deps` succeeded at 01:02:13.971160 after 3.02 seconds
[0m01:02:13.971598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DDC9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78C2EB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DD734D0>]}
[0m01:02:13.971927 [debug] [MainThread]: Flushing usage events
[0m01:02:15.157554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:24.229534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D04B602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D05BABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D05BAB9D0>]}


============================== 01:02:24.233730 | dd4bcd40-4f59-4d13-96c0-83ac7fb39a93 ==============================
[0m01:02:24.233730 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:02:24.234370 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:02:27.482238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D04EBF6F0>]}
[0m01:02:27.545954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D295DB350>]}
[0m01:02:27.546601 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:02:28.213344 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:02:28.214456 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:02:28.214870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2A638850>]}
[0m01:02:29.934594 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m01:02:29.935120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2AB9E210>]}
[0m01:02:29.951592 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd_0__revenue_usd (models\staging\staging_models.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'argument'
[0m01:02:29.952203 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:02:29.953155 [debug] [MainThread]: Command `dbt run` failed at 01:02:29.953049 after 5.85 seconds
[0m01:02:29.953475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D05B87E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2AFACD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2ABDE340>]}
[0m01:02:29.953788 [debug] [MainThread]: Flushing usage events
[0m01:02:31.022480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:45.180868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767B702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768BBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768BBB9D0>]}


============================== 01:04:45.185263 | 01cf8896-f7d6-41cd-951b-d3383868729c ==============================
[0m01:04:45.185263 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:04:45.185928 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:04:48.546821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767ECF6F0>]}
[0m01:04:48.610288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70C6EB350>]}
[0m01:04:48.610955 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:04:49.290431 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:04:49.291468 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:04:49.291885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70C778850>]}
[0m01:04:50.906777 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:04:50.907310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DCAFC50>]}
[0m01:04:51.200696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DF2A350>]}
[0m01:04:51.308114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:04:51.311262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:04:51.343182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DF4FC70>]}
[0m01:04:51.343652 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 612 macros
[0m01:04:51.344129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DD574D0>]}
[0m01:04:51.346523 [info ] [MainThread]: 
[0m01:04:51.346988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:04:51.347346 [info ] [MainThread]: 
[0m01:04:51.347845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:04:51.351715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:04:51.352245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:51.352642 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:04:51.353144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:53.329550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:04:53.330050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:53.330724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:04:53.331135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:55.131159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DD4F960>]}
[0m01:04:55.131910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:55.137945 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:04:55.139382 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:04:55.138884 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:04:55.140751 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:04:55.140151 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:04:55.141295 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:04:55.142325 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:04:55.150733 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:04:55.151266 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:04:55.156206 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:04:55.158776 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:04:55.191688 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:04:55.198371 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:04:55.201469 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:04:55.205188 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:04:55.205932 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:04:55.206615 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:04:55.208832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:57.221459 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f601bb7d-d243-460c-8946-7e771b0beeb6&page=queryresults
[0m01:04:57.221967 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f601bb7d-d243-460c-8946-7e771b0beeb6&page=queryresults
[0m01:04:57.232641 [debug] [Thread-2 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:04:57.234814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767EA8190>]}
[0m01:04:57.235445 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics_stg.stg_sessions ................ [[31mERROR[0m in 2.09s]
[0m01:04:57.236190 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:04:57.236881 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m01:04:57.238345 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:04:57.238747 [info ] [Thread-3 (]: 3 of 4 SKIP relation analytics_stg.stg_sessions_with_fx ........................ [[33mSKIP[0m]
[0m01:04:57.239260 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:04:57.281391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:34697e29-e5dc-449e-8c62-45fc6fc0a835&page=queryresults
[0m01:04:57.282131 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:34697e29-e5dc-449e-8c62-45fc6fc0a835&page=queryresults
[0m01:04:57.289455 [debug] [Thread-1 (]: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:04:57.290037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70D848C50>]}
[0m01:04:57.290598 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics_stg.stg_hits_products ........... [[31mERROR[0m in 2.15s]
[0m01:04:57.291311 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:04:57.291962 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_hits_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql.
[0m01:04:57.292969 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:04:57.293663 [info ] [Thread-4 (]: 4 of 4 SKIP relation analytics_mart.fct_sales_item ............................. [[33mSKIP[0m]
[0m01:04:57.294501 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:04:57.296531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:57.298440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:57.298882 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:04:57.299204 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:04:57.299462 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:04:57.299752 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:04:57.300015 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:04:57.300264 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:04:57.300596 [info ] [MainThread]: 
[0m01:04:57.301388 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m01:04:57.302411 [debug] [MainThread]: Command end result
[0m01:04:57.333609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:04:57.335996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:04:57.341633 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:04:57.341940 [info ] [MainThread]: 
[0m01:04:57.342431 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:04:57.342851 [info ] [MainThread]: 
[0m01:04:57.343334 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m01:04:57.343790 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:04:57.344184 [info ] [MainThread]: 
[0m01:04:57.344637 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m01:04:57.345163 [info ] [MainThread]: 
[0m01:04:57.346087 [error] [MainThread]: [31mFailure in model stg_hits_products (models\staging\stg_hits_products.sql)[0m
[0m01:04:57.346915 [error] [MainThread]:   Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:04:57.347332 [info ] [MainThread]: 
[0m01:04:57.347764 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:04:57.348126 [info ] [MainThread]: 
[0m01:04:57.348511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m01:04:57.349067 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:04:57.350019 [debug] [MainThread]: Command `dbt run` failed at 01:04:57.349914 after 12.34 seconds
[0m01:04:57.350357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768C244B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7624783D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70D9042F0>]}
[0m01:04:57.350681 [debug] [MainThread]: Flushing usage events
[0m01:04:59.354735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:37.714884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC9BE02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAC17ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAC179D0>]}


============================== 01:19:37.719104 | 27b55ded-382f-4427-8145-d43226f6accd ==============================
[0m01:19:37.719104 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:37.719763 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:19:37.857784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b55ded-382f-4427-8145-d43226f6accd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC9F436F0>]}
[0m01:19:37.936207 [debug] [MainThread]: Command `dbt clean` succeeded at 01:19:37.936095 after 0.39 seconds
[0m01:19:37.936537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAB1DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAB1D480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCBE20650>]}
[0m01:19:37.936871 [debug] [MainThread]: Flushing usage events
[0m01:19:39.226463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:47.701184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A550502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56093ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A560939D0>]}


============================== 01:19:47.705354 | 1cddcd3e-2e97-4b8d-a23e-0c4dcd249fae ==============================
[0m01:19:47.705354 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:47.706013 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:19:47.845245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cddcd3e-2e97-4b8d-a23e-0c4dcd249fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A553AF6F0>]}
[0m01:19:47.879566 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-4blhr2k5'
[0m01:19:47.880055 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:19:49.448157 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:19:49.449453 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:19:49.969820 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:19:49.973940 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:19:51.644257 [info ] [MainThread]: Installed from version 1.3.0
[0m01:19:51.644713 [info ] [MainThread]: Up to date!
[0m01:19:51.645175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1cddcd3e-2e97-4b8d-a23e-0c4dcd249fae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55F8D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55F8E360>]}
[0m01:19:51.647046 [debug] [MainThread]: Command `dbt deps` succeeded at 01:19:51.646921 after 4.06 seconds
[0m01:19:51.647441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A572AD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5586B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A572507D0>]}
[0m01:19:51.647812 [debug] [MainThread]: Flushing usage events
[0m01:19:52.661791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:58.469493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C023902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C033DBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C033DB9D0>]}


============================== 01:19:58.473724 | 55c6937c-0ca7-4c61-8112-783f018c33fc ==============================
[0m01:19:58.473724 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:58.474469 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:20:01.381661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C026EF6F0>]}
[0m01:20:01.441751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C26E2B350>]}
[0m01:20:01.442340 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:20:02.095501 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:20:02.096484 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:20:02.096900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C26EB8850>]}
[0m01:20:03.610127 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:20:03.610631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C283EFB60>]}
[0m01:20:03.880455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C284467B0>]}
[0m01:20:03.977951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:20:03.989841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:20:04.020471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285F3EE0>]}
[0m01:20:04.020948 [info ] [MainThread]: Found 4 models, 17 data tests, 2 sources, 612 macros
[0m01:20:04.021365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285CF350>]}
[0m01:20:04.023180 [info ] [MainThread]: 
[0m01:20:04.023642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:20:04.024048 [info ] [MainThread]: 
[0m01:20:04.024539 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:04.029644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:20:04.030160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:04.030587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:20:04.031082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:05.821298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:20:05.821755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:05.822177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:20:05.822774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:07.542191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2847B280>]}
[0m01:20:07.542886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:07.549778 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:20:07.550290 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:20:07.550959 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:20:07.552592 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:20:07.551522 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:20:07.553191 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:20:07.553815 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:20:07.561811 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:20:07.562202 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:20:07.563922 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:20:07.566361 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:20:07.578663 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:20:07.600888 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:20:07.603251 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:20:07.606033 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:20:07.606872 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:20:07.607437 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:20:07.607877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:09.762965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c04b89e0-eedf-4207-b709-53d8ce64625a&page=queryresults
[0m01:20:09.763655 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:881d0ac7-6971-4f05-a6ea-cf8ec86e0ba6&page=queryresults
[0m01:20:10.427752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2843DEF0>]}
[0m01:20:10.428114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28D26960>]}
[0m01:20:10.428639 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.87s]
[0m01:20:10.429774 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:20:10.429110 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.87s]
[0m01:20:10.430578 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:20:10.431319 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:10.431726 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:20:10.432245 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:20:10.432563 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:10.435551 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:20:10.437050 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:10.440073 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:20:10.441327 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:20:10.441796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:20:12.186041 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9cada048-8cbb-49af-8b97-6d92a3604ca5&page=queryresults
[0m01:20:12.779895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285B5400>]}
[0m01:20:12.780575 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m01:20:12.781379 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:12.782206 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:20:12.782621 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:20:12.783328 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:20:12.783641 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:20:12.786271 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:20:12.787555 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:20:12.816066 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:20:12.817636 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:20:12.818209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:20:14.788981 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:60d056e6-b468-433c-835e-726a675c0c4b&page=queryresults
[0m01:20:17.815442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285D7830>]}
[0m01:20:17.816014 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.03s]
[0m01:20:17.816879 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:20:17.818893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:17.820471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:17.820766 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:20:17.821004 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:20:17.821237 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:20:17.821470 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:20:17.821701 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:20:17.821930 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:20:17.822160 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:20:17.822395 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:20:17.822696 [info ] [MainThread]: 
[0m01:20:17.823066 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 13.80 seconds (13.80s).
[0m01:20:17.824154 [debug] [MainThread]: Command end result
[0m01:20:17.851762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:20:17.853921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:20:17.860017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:20:17.860322 [info ] [MainThread]: 
[0m01:20:17.860723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:17.861193 [info ] [MainThread]: 
[0m01:20:17.861559 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:20:17.862078 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:20:17.862948 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:17.862850 after 19.51 seconds
[0m01:20:17.863310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2881FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28EF3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28EF38F0>]}
[0m01:20:17.863627 [debug] [MainThread]: Flushing usage events
[0m01:20:18.892713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:13.198137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015529F702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AFA7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AFA79D0>]}


============================== 01:23:13.202317 | 44d87b2d-7b40-4994-87a1-a8324e4056fd ==============================
[0m01:23:13.202317 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:23:13.203020 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:23:13.343959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d87b2d-7b40-4994-87a1-a8324e4056fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552A2CF6F0>]}
[0m01:23:13.427218 [debug] [MainThread]: Command `dbt clean` succeeded at 01:23:13.427103 after 0.39 seconds
[0m01:23:13.427550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AEADD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AEAD480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552C1B0650>]}
[0m01:23:13.427882 [debug] [MainThread]: Flushing usage events
[0m01:23:17.150441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:28.426006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AD6002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE637ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE6379D0>]}


============================== 01:23:28.430204 | 64f279e7-365d-4378-945f-0521127169d3 ==============================
[0m01:23:28.430204 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:23:28.430866 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:23:28.571955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f279e7-365d-4378-945f-0521127169d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AD95F6F0>]}
[0m01:23:28.606797 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-q6w_jo61'
[0m01:23:28.607176 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:23:30.255154 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:23:30.256475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:23:30.877635 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:23:30.881722 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:23:31.659834 [info ] [MainThread]: Installed from version 1.3.0
[0m01:23:31.660513 [info ] [MainThread]: Up to date!
[0m01:23:31.661147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '64f279e7-365d-4378-945f-0521127169d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE53D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE53E360>]}
[0m01:23:31.663430 [debug] [MainThread]: Command `dbt deps` succeeded at 01:23:31.663268 after 3.36 seconds
[0m01:23:31.663914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AF83D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ADE1B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AF7F47D0>]}
[0m01:23:31.664418 [debug] [MainThread]: Flushing usage events
[0m01:23:32.728144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:38.434621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC24602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC34ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC34AB9D0>]}


============================== 01:23:38.439086 | 4719e6d2-bc9b-4979-81aa-d62fa60d6192 ==============================
[0m01:23:38.439086 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:23:38.439766 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:23:41.357641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC27C36F0>]}
[0m01:23:41.418040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE6EEB350>]}
[0m01:23:41.418632 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:23:42.072972 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:23:42.074013 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:23:42.074456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE6F78850>]}
[0m01:23:43.871990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE84AF3E0>]}
[0m01:23:43.967269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:23:43.970337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:23:43.999334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE86D09F0>]}
[0m01:23:43.999737 [info ] [MainThread]: Found 4 models, 17 data tests, 2 sources, 612 macros
[0m01:23:44.000130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE86B3A00>]}
[0m01:23:44.001902 [info ] [MainThread]: 
[0m01:23:44.002278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:23:44.002612 [info ] [MainThread]: 
[0m01:23:44.003147 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:23:44.006767 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:23:44.007240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:44.007618 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:23:44.008100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:45.789120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:23:45.789602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:45.789986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:23:45.790443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:47.457430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8538AD0>]}
[0m01:23:47.457865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:47.463118 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:23:47.463629 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:23:47.464235 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:23:47.466132 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:23:47.466731 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:23:47.478198 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:23:47.465445 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:23:47.479126 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:23:47.479599 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:23:47.482763 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:23:47.485691 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:23:47.506554 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:23:47.517420 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:23:47.520046 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:23:47.523786 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:23:47.524754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:23:47.525586 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:23:47.552034 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:23:49.496920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:908d7177-79c9-4d4f-9e5a-7fca40b7832a&page=queryresults
[0m01:23:49.537520 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:889ffe41-d4a8-45da-b565-c79b19c3fa3a&page=queryresults
[0m01:23:50.178151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE867D440>]}
[0m01:23:50.179027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC26A4910>]}
[0m01:23:50.178721 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.71s]
[0m01:23:50.180234 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:23:50.179594 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.70s]
[0m01:23:50.181036 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:23:50.181754 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:50.182188 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:23:50.182725 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:23:50.183051 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:50.186042 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:23:50.195357 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:50.198327 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:23:50.199656 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:23:50.200166 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:23:52.730065 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9c35e6f0-795e-468a-93d3-625a9cb951b1&page=queryresults
[0m01:23:53.313999 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE807D250>]}
[0m01:23:53.314558 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 3.13s]
[0m01:23:53.315385 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:53.316086 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:23:53.316500 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:23:53.317149 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:23:53.317462 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:23:53.320065 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:23:53.321506 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:23:53.331216 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:23:54.700932 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:23:54.702402 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:23:55.483511 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c11a93b8-c703-45e9-9ec7-026bbd051091&page=queryresults
[0m01:23:59.090883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8F8A580>]}
[0m01:23:59.091448 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.77s]
[0m01:23:59.092276 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:23:59.093901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:23:59.095456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:59.095716 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:23:59.095958 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:23:59.096194 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:23:59.096485 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:23:59.096721 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:23:59.096955 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:23:59.097188 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:23:59.097425 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:23:59.097731 [info ] [MainThread]: 
[0m01:23:59.098140 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 15.09 seconds (15.09s).
[0m01:23:59.100668 [debug] [MainThread]: Command end result
[0m01:23:59.137573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:23:59.139840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:23:59.145419 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:23:59.145761 [info ] [MainThread]: 
[0m01:23:59.146191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:59.146821 [info ] [MainThread]: 
[0m01:23:59.147519 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:23:59.149073 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:59.148926 after 20.83 seconds
[0m01:23:59.149609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE88E3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8FAF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8FAF830>]}
[0m01:23:59.150457 [debug] [MainThread]: Flushing usage events
[0m01:24:00.198605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:06.010683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA19602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA29ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA29AB9D0>]}


============================== 01:27:06.015271 | f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c ==============================
[0m01:27:06.015271 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:27:06.015931 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select int_sessions_enriched', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:27:08.976597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA1CBF6F0>]}
[0m01:27:09.035978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC640B350>]}
[0m01:27:09.036548 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:27:09.697497 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:27:09.910961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:27:09.911504 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\intermediate\intermediate_models.yml
[0m01:27:09.911826 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\intermediate\int_sessions_enriched.sql
[0m01:27:10.340110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7A9D250>]}
[0m01:27:10.435563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:10.437868 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:10.467355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC64CDF40>]}
[0m01:27:10.467796 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m01:27:10.468198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7C41E10>]}
[0m01:27:10.469704 [info ] [MainThread]: 
[0m01:27:10.470094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:27:10.470438 [info ] [MainThread]: 
[0m01:27:10.470962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:10.471830 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:27:10.472195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:12.027815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_int)
[0m01:27:12.028303 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_int"
"
[0m01:27:12.036158 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_int"} */
create schema if not exists `e2e-dbt-project`.`analytics_int`
  
[0m01:27:12.036492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:13.809024 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aeae75e5-b93c-4786-a1db-12ef33211f97&page=queryresults
[0m01:27:14.643725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:27:14.644219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:14.644604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:27:14.645094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:14.646380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:27:14.648476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:16.604235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7E0EC30>]}
[0m01:27:16.604679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:16.609486 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:27:16.609936 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:27:16.610704 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m01:27:16.611044 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:27:16.618885 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:27:16.620230 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:27:16.645318 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:27:16.646724 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
  OPTIONS()
  as 

with sessions as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),

hits as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m01:27:16.647365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:27:18.614655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab066982-b285-4912-992b-858e82936938&page=queryresults
[0m01:27:19.252787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC8400D10>]}
[0m01:27:19.253389 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.64s]
[0m01:27:19.254327 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:27:19.255927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:19.257422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:19.257684 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_int' was properly closed.
[0m01:27:19.257925 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:27:19.258161 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:27:19.258395 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:27:19.258629 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m01:27:19.259208 [info ] [MainThread]: 
[0m01:27:19.260102 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m01:27:19.261309 [debug] [MainThread]: Command end result
[0m01:27:19.291697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:19.294433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:19.299718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:27:19.300030 [info ] [MainThread]: 
[0m01:27:19.300459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:19.300818 [info ] [MainThread]: 
[0m01:27:19.301194 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:27:19.302081 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:19.301980 after 13.43 seconds
[0m01:27:19.302401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC798F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9E874910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7DF25D0>]}
[0m01:27:19.302720 [debug] [MainThread]: Flushing usage events
[0m01:27:21.375977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:40.333472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AB1202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AC16BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AC16B9D0>]}


============================== 01:28:40.337647 | bae87e26-eb16-4188-ad73-690ce207e4a4 ==============================
[0m01:28:40.337647 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:28:40.338317 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select int_sessions_enriched', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:28:43.338906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AB4836F0>]}
[0m01:28:43.402849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4CFBDB350>]}
[0m01:28:43.403479 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:28:44.050193 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:28:44.250392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:44.250710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:44.298868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D0C38B50>]}
[0m01:28:44.402106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:28:44.404675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:28:44.446830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D13B2B70>]}
[0m01:28:44.447237 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m01:28:44.447636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D13F2270>]}
[0m01:28:44.449251 [info ] [MainThread]: 
[0m01:28:44.449627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:28:44.449962 [info ] [MainThread]: 
[0m01:28:44.450502 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:44.454121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:28:44.454736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:44.455255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:28:44.455776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:44.456216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:28:44.456639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:46.319888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D1421CC0>]}
[0m01:28:46.320619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:46.328705 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:46.329216 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:46.329797 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:46.330180 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:46.330522 [info ] [Thread-4 (]: 4 of 5 START test not_null_int_sessions_enriched_visit_id ...................... [RUN]
[0m01:28:46.330952 [info ] [Thread-3 (]: 3 of 5 START test not_null_int_sessions_enriched_session_date .................. [RUN]
[0m01:28:46.332931 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9'
[0m01:28:46.331631 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m01:28:46.332215 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [RUN]
[0m01:28:46.333983 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da'
[0m01:28:46.334664 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:46.335560 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0'
[0m01:28:46.336404 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e'
[0m01:28:46.337028 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:46.363136 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:46.368212 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m01:28:46.368643 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:46.373680 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m01:28:46.381633 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"
[0m01:28:46.386503 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"
[0m01:28:46.395806 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:46.420761 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m01:28:46.421326 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:46.421992 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:46.425690 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"
[0m01:28:46.426256 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:46.428886 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m01:28:46.431572 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"
[0m01:28:46.432843 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:28:46.433470 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:28:46.434035 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`

where not(revenue_usd revenue_usd >= 0 or revenue_usd is null)


  
  
      
    ) dbt_internal_test
[0m01:28:46.434900 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:28:46.435411 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:28:46.435942 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m01:28:46.436383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:28:46.461499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:28:48.547007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b6a33791-d64d-46c2-8575-406f1a1af8db&page=queryresults
[0m01:28:48.547486 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b6a33791-d64d-46c2-8575-406f1a1af8db&page=queryresults
[0m01:28:48.565822 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c03c9f7e-f331-4c09-b801-2e547662cc64&page=queryresults
[0m01:28:48.566297 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c03c9f7e-f331-4c09-b801-2e547662cc64&page=queryresults
[0m01:28:48.577695 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m01:28:48.578257 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.24s]
[0m01:28:48.579075 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:48.579441 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:48.580087 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql.
[0m01:28:48.584407 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m01:28:48.580706 [info ] [Thread-1 (]: 5 of 5 START test not_null_int_sessions_enriched_visitor_id .................... [RUN]
[0m01:28:48.585502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m01:28:48.585846 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:48.589858 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m01:28:48.584946 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [[31mERROR[0m in 2.25s]
[0m01:28:48.591015 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:48.591564 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql.
[0m01:28:48.592187 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:48.594187 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m01:28:48.594997 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:28:48.595367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:48.835669 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6407bd18-3277-435d-9251-7969116d0964&page=queryresults
[0m01:28:48.936041 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ca4543e3-e33c-450d-bb6c-f710d69750cf&page=queryresults
[0m01:28:50.322072 [info ] [Thread-3 (]: 3 of 5 PASS not_null_int_sessions_enriched_session_date ........................ [[32mPASS[0m in 3.99s]
[0m01:28:50.322941 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:50.477888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1b9ceab1-fd9d-478c-8661-3db86c343515&page=queryresults
[0m01:28:50.579901 [info ] [Thread-4 (]: 4 of 5 PASS not_null_int_sessions_enriched_visit_id ............................ [[32mPASS[0m in 4.25s]
[0m01:28:50.580741 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:51.851780 [info ] [Thread-1 (]: 5 of 5 PASS not_null_int_sessions_enriched_visitor_id .......................... [[32mPASS[0m in 3.27s]
[0m01:28:51.852661 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:51.854133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:51.855611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:51.855970 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:28:51.856222 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:28:51.856465 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:28:51.856708 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9' was properly closed.
[0m01:28:51.856951 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da' was properly closed.
[0m01:28:51.857192 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52' was properly closed.
[0m01:28:51.857437 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e' was properly closed.
[0m01:28:51.857727 [info ] [MainThread]: 
[0m01:28:51.858104 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m01:28:51.859407 [debug] [MainThread]: Command end result
[0m01:28:51.889088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:28:51.891345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:28:51.897838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:28:51.898152 [info ] [MainThread]: 
[0m01:28:51.898564 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:28:51.898997 [info ] [MainThread]: 
[0m01:28:51.899426 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)[0m
[0m01:28:51.899854 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m01:28:51.900224 [info ] [MainThread]: 
[0m01:28:51.900629 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m01:28:51.900981 [info ] [MainThread]: 
[0m01:28:51.901392 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)[0m
[0m01:28:51.901814 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m01:28:51.902292 [info ] [MainThread]: 
[0m01:28:51.902781 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m01:28:51.903131 [info ] [MainThread]: 
[0m01:28:51.903507 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m01:28:51.904397 [debug] [MainThread]: Command `dbt test` failed at 01:28:51.904297 after 11.73 seconds
[0m01:28:51.904726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AC140590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D14CAE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D14CB070>]}
[0m01:28:51.905041 [debug] [MainThread]: Flushing usage events
[0m01:28:53.241198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:21.079927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D90A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DA0E3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DA0E39D0>]}


============================== 01:39:21.084333 | ddb5a681-d73e-40e6-a3b1-086c1209869c ==============================
[0m01:39:21.084333 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:21.084988 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:21.223580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb5a681-d73e-40e6-a3b1-086c1209869c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D93FF6F0>]}
[0m01:39:21.308434 [debug] [MainThread]: Command `dbt clean` succeeded at 01:39:21.308318 after 0.35 seconds
[0m01:39:21.308776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D9FDDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D9FDD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DB370650>]}
[0m01:39:21.309119 [debug] [MainThread]: Flushing usage events
[0m01:39:22.594030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:34.860951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5322B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5332FBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5332FB9D0>]}


============================== 01:39:34.865187 | 579b303b-35e5-4eab-8f0a-78063355581d ==============================
[0m01:39:34.865187 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:34.865863 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:37.807697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '579b303b-35e5-4eab-8f0a-78063355581d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D53260F6F0>]}
[0m01:39:37.870419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '579b303b-35e5-4eab-8f0a-78063355581d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556D1B350>]}
[0m01:39:37.871026 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:39:38.512551 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m01:39:38.513869 [debug] [MainThread]: Command `dbt run` failed at 01:39:38.513760 after 3.78 seconds
[0m01:39:38.514192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556DA9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556DA9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556CFB890>]}
[0m01:39:38.514508 [debug] [MainThread]: Flushing usage events
[0m01:39:39.618423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:51.417565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B51802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B61C3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B61C39D0>]}


============================== 01:39:51.421773 | 71112e7c-7553-4ae4-961d-23dd82fa4592 ==============================
[0m01:39:51.421773 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:51.422494 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:51.566430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71112e7c-7553-4ae4-961d-23dd82fa4592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B54DF6F0>]}
[0m01:39:51.598442 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-0u4v5co9'
[0m01:39:51.598817 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:39:53.469772 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:39:53.471071 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:39:53.989916 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:39:53.994061 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:39:55.188655 [info ] [MainThread]: Installed from version 1.3.0
[0m01:39:55.189280 [info ] [MainThread]: Up to date!
[0m01:39:55.189911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '71112e7c-7553-4ae4-961d-23dd82fa4592', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B60BD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B60BE360>]}
[0m01:39:55.191880 [debug] [MainThread]: Command `dbt deps` succeeded at 01:39:55.191765 after 3.89 seconds
[0m01:39:55.192194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B747D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B599B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B74307D0>]}
[0m01:39:55.192512 [debug] [MainThread]: Flushing usage events
[0m01:39:56.232285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:00.984069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285520802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285530CBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285530CB9D0>]}


============================== 01:40:00.988315 | 8d649b20-ab4a-45c0-ac64-542ddb7d51f2 ==============================
[0m01:40:00.988315 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:40:00.988976 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:40:03.950786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285523DF6F0>]}
[0m01:40:04.010140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028576B0B350>]}
[0m01:40:04.010761 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:40:04.648179 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:40:04.649184 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:40:04.649586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028577B68850>]}
[0m01:40:06.462141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285780CF890>]}
[0m01:40:06.560106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:40:06.579226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:40:06.611062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028577BF7BD0>]}
[0m01:40:06.611484 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m01:40:06.611879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285783F7C70>]}
[0m01:40:06.613793 [info ] [MainThread]: 
[0m01:40:06.614178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:40:06.614576 [info ] [MainThread]: 
[0m01:40:06.615066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:06.618775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:40:06.619259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:06.619649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:40:06.620235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:40:06.620532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:06.620925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:08.565310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m01:40:08.565816 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m01:40:08.581889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_mart)
[0m01:40:08.582542 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m01:40:08.583294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_int)
[0m01:40:08.583744 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_mart"
"
[0m01:40:08.584111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:08.584719 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_int"
"
[0m01:40:08.586836 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_mart"} */
create schema if not exists `e2e-dbt-project`.`analytics_mart`
  
[0m01:40:08.588508 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_int"} */
create schema if not exists `e2e-dbt-project`.`analytics_int`
  
[0m01:40:08.588904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:08.616566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:10.878579 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d4c6788-804d-4091-af66-cd4bbbae7d98&page=queryresults
[0m01:40:11.079490 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:14883060-6906-4bcd-ad64-837f092cbf67&page=queryresults
[0m01:40:11.080400 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2f7a05d2-20d7-4d03-a714-07bc7feb7087&page=queryresults
[0m01:40:12.172549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:40:12.173035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:12.173412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:40:12.173912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:12.174292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:40:12.174702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:14.072004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285782B0E90>]}
[0m01:40:14.072693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:14.079941 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:40:14.080543 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:40:14.081128 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:40:14.082049 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:40:14.083027 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:40:14.083812 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:40:14.084505 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:40:14.085046 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:40:14.091340 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:40:14.095159 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:40:14.097898 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:40:14.121162 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:40:14.131796 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:40:14.133981 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:40:14.137595 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:40:14.138251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:14.138763 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:40:14.139233 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:40:16.031318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ee47f03d-c390-41b6-82e5-b79c99e2e9b3&page=queryresults
[0m01:40:16.061918 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:257f128c-c5b5-4f98-9734-928306f465f1&page=queryresults
[0m01:40:16.619046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285783B7490>]}
[0m01:40:16.619617 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.53s]
[0m01:40:16.620440 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:40:16.621093 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:16.621528 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:40:16.622092 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:40:16.622617 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:16.625454 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:40:16.634890 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:16.637554 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:40:16.639363 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:40:16.640006 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:40:16.675548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028577D86490>]}
[0m01:40:16.676103 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m01:40:16.676890 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:40:18.598370 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:24308039-4a6a-4a35-ae69-1f6f6ce5a385&page=queryresults
[0m01:40:19.159978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578535950>]}
[0m01:40:19.160596 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.54s]
[0m01:40:19.161380 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:19.162230 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:40:19.162693 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:40:19.163329 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m01:40:19.163668 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:40:19.166502 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:40:19.167668 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:40:19.170399 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:40:19.171655 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
  OPTIONS()
  as 

with sessions as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),

hits as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m01:40:19.172298 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:40:21.297252 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2affacad-99bc-4c2e-bd23-e4ceb5f6710a&page=queryresults
[0m01:40:21.892225 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578146A50>]}
[0m01:40:21.892784 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.73s]
[0m01:40:21.893551 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:40:21.894291 [debug] [Thread-2 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:40:21.894768 [info ] [Thread-2 (]: 5 of 5 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:40:21.895294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.fct_sales_item)
[0m01:40:21.895644 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:40:21.898104 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:40:21.899445 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:40:21.928509 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:40:21.929894 [debug] [Thread-2 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m01:40:21.930546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:23.972921 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b56a1583-6658-4408-b026-2fa7c2b8b984&page=queryresults
[0m01:40:27.697147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578ACB7D0>]}
[0m01:40:27.697741 [info ] [Thread-2 (]: 5 of 5 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.80s]
[0m01:40:27.698514 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:40:27.700000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:27.701924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:27.702198 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_int' was properly closed.
[0m01:40:27.702446 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:40:27.702691 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:40:27.702933 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:40:27.703171 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:40:27.703409 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:40:27.703653 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:40:27.703889 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:40:27.704147 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:40:27.704386 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m01:40:27.704703 [info ] [MainThread]: 
[0m01:40:27.705128 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 21.09 seconds (21.09s).
[0m01:40:27.706550 [debug] [MainThread]: Command end result
[0m01:40:27.738079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:40:27.740292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:40:27.746330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:40:27.746659 [info ] [MainThread]: 
[0m01:40:27.747284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:40:27.747817 [info ] [MainThread]: 
[0m01:40:27.748344 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:40:27.749415 [debug] [MainThread]: Command `dbt run` succeeded at 01:40:27.749307 after 26.88 seconds
[0m01:40:27.749789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285782F3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578025910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578174590>]}
[0m01:40:27.750112 [debug] [MainThread]: Flushing usage events
[0m01:40:30.098017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:13.578375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885E1102F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885F15BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885F15B9D0>]}


============================== 01:45:13.582697 | c112aaec-2199-49cf-95e2-2d677375d50b ==============================
[0m01:45:13.582697 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:45:13.583386 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:45:16.552169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885E46F6F0>]}
[0m01:45:16.613298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028802BAB350>]}
[0m01:45:16.613923 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:45:17.242937 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:45:17.455749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:45:17.456295 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\mart_models.yml
[0m01:45:17.456659 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\fct_sales_item.sql
[0m01:45:17.891891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028802C39450>]}
[0m01:45:17.986768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:45:17.989068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:45:18.019294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028802C71D60>]}
[0m01:45:18.019726 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:45:18.020133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288043E5E10>]}
[0m01:45:18.021702 [info ] [MainThread]: 
[0m01:45:18.022084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:45:18.022420 [info ] [MainThread]: 
[0m01:45:18.023009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:45:18.023910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:45:18.024274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:19.580526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:45:19.581031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:19.581411 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:45:19.581908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:19.582296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:45:19.582810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:21.453429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028804457860>]}
[0m01:45:21.453859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:45:21.459447 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:45:21.460015 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:45:21.460706 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:45:21.461156 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:45:21.473512 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:45:21.475312 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:45:21.491444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:45:22.941913 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:45:22.942848 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      

with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m01:45:23.790654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:feee1bda-a5b1-4735-821e-62b98788f048&page=queryresults
[0m01:45:27.100763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002880439BC50>]}
[0m01:45:27.101347 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.64s]
[0m01:45:27.102159 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:45:27.103848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:45:27.105353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:27.105614 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:45:27.105860 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:45:27.106155 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:45:27.106609 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:45:27.106853 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:45:27.107128 [info ] [MainThread]: 
[0m01:45:27.107628 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m01:45:27.108391 [debug] [MainThread]: Command end result
[0m01:45:27.138680 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:45:27.141040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:45:27.146485 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:45:27.146903 [info ] [MainThread]: 
[0m01:45:27.147324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:27.147767 [info ] [MainThread]: 
[0m01:45:27.148139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:45:27.149058 [debug] [MainThread]: Command `dbt run` succeeded at 01:45:27.148959 after 13.75 seconds
[0m01:45:27.149375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288044A6A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028804648730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028804649090>]}
[0m01:45:27.149689 [debug] [MainThread]: Flushing usage events
[0m01:45:28.425193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:25.668653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196128802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196138CBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196138CB9D0>]}


============================== 01:46:25.672817 | 8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38 ==============================
[0m01:46:25.672817 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:46:25.673462 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:46:28.795469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019612BE36F0>]}
[0m01:46:28.859762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196372FB350>]}
[0m01:46:28.860385 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:46:29.528361 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:46:29.736929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:29.737301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:29.788955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019637388B50>]}
[0m01:46:29.897804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:46:29.900378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:46:29.941058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638AD6B70>]}
[0m01:46:29.941471 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:46:29.941873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638AD26D0>]}
[0m01:46:29.943506 [info ] [MainThread]: 
[0m01:46:29.943898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:46:29.944250 [info ] [MainThread]: 
[0m01:46:29.944748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:46:29.950344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:46:29.950879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:29.951280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:46:29.951897 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:46:29.952173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:29.953591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:31.848659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638B4AA90>]}
[0m01:46:31.849217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:31.855037 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:31.855439 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:31.855877 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:31.856446 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:31.856851 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null  [RUN]
[0m01:46:31.857224 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m01:46:31.857808 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [RUN]
[0m01:46:31.859338 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626'
[0m01:46:31.858413 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m01:46:31.860217 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m01:46:31.860822 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4'
[0m01:46:31.861423 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:31.862101 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112'
[0m01:46:31.862646 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:31.863133 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:31.890218 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626"
[0m01:46:31.890771 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:31.899830 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:46:31.907385 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4"
[0m01:46:31.916223 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112"
[0m01:46:31.918485 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:31.918890 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:31.941875 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626"
[0m01:46:31.944388 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:46:31.945117 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:31.947260 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4"
[0m01:46:31.948410 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:31.951934 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112"
[0m01:46:31.952926 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd product_price_usd >= 0 or product_price_usd is null)


  
  
      
    ) dbt_internal_test
[0m01:46:31.953697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:31.954262 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:46:31.954640 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd revenue_usd >= 0 or revenue_usd is null)


  
  
      
    ) dbt_internal_test
[0m01:46:31.955164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:46:31.955600 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:46:31.956123 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m01:46:31.957629 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:46:33.916656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:60371551-f464-49ab-a1a2-09b367cf3a38&page=queryresults
[0m01:46:33.917162 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:60371551-f464-49ab-a1a2-09b367cf3a38&page=queryresults
[0m01:46:33.926276 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql
[0m01:46:33.926799 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null  [[31mERROR[0m in 2.07s]
[0m01:46:33.927552 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:33.927941 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:33.928596 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql.
[0m01:46:33.929198 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m01:46:33.931122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m01:46:33.931704 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:33.937411 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:46:33.938399 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:33.940483 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:46:33.941341 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:46:33.941718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:33.967874 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5209b578-16d4-4727-ba3f-7d10e57ac242&page=queryresults
[0m01:46:33.968378 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5209b578-16d4-4727-ba3f-7d10e57ac242&page=queryresults
[0m01:46:33.975125 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql
[0m01:46:33.975610 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [[31mERROR[0m in 2.11s]
[0m01:46:33.976379 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:33.977100 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql.
[0m01:46:33.986466 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78b93b30-32ac-4b44-8632-1341b396c01f&page=queryresults
[0m01:46:33.986986 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78b93b30-32ac-4b44-8632-1341b396c01f&page=queryresults
[0m01:46:33.993463 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql
[0m01:46:33.993979 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.13s]
[0m01:46:33.994710 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:33.995379 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql.
[0m01:46:34.377161 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dd3d8647-a312-4b5c-90bc-1c238754d180&page=queryresults
[0m01:46:35.414073 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.55s]
[0m01:46:35.415267 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:36.019039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:136bc500-865a-45c6-814c-da7c46ac4d47&page=queryresults
[0m01:46:36.902084 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.97s]
[0m01:46:36.902916 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:36.904529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:36.906010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:36.906278 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:46:36.906527 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:46:36.906771 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:46:36.907015 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m01:46:36.907258 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m01:46:36.907503 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4' was properly closed.
[0m01:46:36.907750 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112' was properly closed.
[0m01:46:36.908039 [info ] [MainThread]: 
[0m01:46:36.908416 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m01:46:36.909701 [debug] [MainThread]: Command end result
[0m01:46:36.940452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:46:36.942593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:46:36.949769 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:46:36.950171 [info ] [MainThread]: 
[0m01:46:36.950618 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:46:36.951026 [info ] [MainThread]: 
[0m01:46:36.951455 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)[0m
[0m01:46:36.951886 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql
[0m01:46:36.952247 [info ] [MainThread]: 
[0m01:46:36.952657 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql
[0m01:46:36.953010 [info ] [MainThread]: 
[0m01:46:36.953424 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)[0m
[0m01:46:36.953845 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql
[0m01:46:36.954198 [info ] [MainThread]: 
[0m01:46:36.954600 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql
[0m01:46:36.954950 [info ] [MainThread]: 
[0m01:46:36.955360 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)[0m
[0m01:46:36.955778 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql
[0m01:46:36.956130 [info ] [MainThread]: 
[0m01:46:36.956561 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql
[0m01:46:36.956909 [info ] [MainThread]: 
[0m01:46:36.957285 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m01:46:36.958165 [debug] [MainThread]: Command `dbt test` failed at 01:46:36.958065 after 11.43 seconds
[0m01:46:36.958494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196138A0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638B83B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638B83D80>]}
[0m01:46:36.958815 [debug] [MainThread]: Flushing usage events
[0m01:46:38.331491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:52:27.945100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C45A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C55EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C55EB9D0>]}


============================== 01:52:27.950524 | a34f32c1-1e96-431c-b151-13e2f653799c ==============================
[0m01:52:27.950524 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:52:27.951198 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:52:31.103388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C49036F0>]}
[0m01:52:31.168020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283E901B350>]}
[0m01:52:31.168649 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:52:31.844181 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:52:32.056401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:32.057103 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m01:52:32.526071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA6B1A50>]}
[0m01:52:32.635722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:32.638220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:32.669730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283E90E1D60>]}
[0m01:52:32.670159 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:52:32.670587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA8527B0>]}
[0m01:52:32.672117 [info ] [MainThread]: 
[0m01:52:32.672524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:52:32.672879 [info ] [MainThread]: 
[0m01:52:32.673532 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:52:32.674410 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:52:32.674778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:34.298021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:52:34.298577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:34.299485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:52:34.300189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:34.301013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:52:34.301986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:36.557623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA8CF860>]}
[0m01:52:36.558029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:36.563226 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:52:36.563820 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:52:36.564520 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:52:36.564857 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:52:36.573146 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:52:36.574224 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:52:36.589965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:38.059361 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:52:38.060315 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      

with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m01:52:39.087822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9252e4ce-8e53-4ecc-8b1c-4d3989a93140&page=queryresults
[0m01:52:41.999514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA5ABA10>]}
[0m01:52:42.001042 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.43s]
[0m01:52:42.001919 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:52:42.003501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:42.005024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:42.005293 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:52:42.005546 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:52:42.005796 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:52:42.006043 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:52:42.006289 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:52:42.006610 [info ] [MainThread]: 
[0m01:52:42.006991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m01:52:42.007692 [debug] [MainThread]: Command end result
[0m01:52:42.039917 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:42.042221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:42.047850 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:52:42.048169 [info ] [MainThread]: 
[0m01:52:42.048612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:42.049029 [info ] [MainThread]: 
[0m01:52:42.049496 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:52:42.050754 [debug] [MainThread]: Command `dbt run` succeeded at 01:52:42.050636 after 14.29 seconds
[0m01:52:42.051110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA58F330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA1ECF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA1EFED0>]}
[0m01:52:42.051450 [debug] [MainThread]: Flushing usage events
[0m01:52:43.411584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:53:55.333700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA08302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA187BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA187B9D0>]}


============================== 01:53:55.337884 | 8f9e4c07-5cae-4289-9121-c85b93150312 ==============================
[0m01:53:55.337884 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:53:55.338531 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:53:58.520891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA0B8F6F0>]}
[0m01:53:58.586350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC52AB350>]}
[0m01:53:58.586960 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:53:59.262745 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:53:59.475935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:53:59.476287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:53:59.529681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC5338B50>]}
[0m01:53:59.637910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:53:59.641216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:53:59.681942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6B16B70>]}
[0m01:53:59.682382 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:53:59.682780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6AFE6D0>]}
[0m01:53:59.684466 [info ] [MainThread]: 
[0m01:53:59.684853 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:53:59.685196 [info ] [MainThread]: 
[0m01:53:59.685688 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:53:59.689365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:53:59.689957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:59.690672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:53:59.691352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:59.691872 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:53:59.693454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:01.612077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6AA3A00>]}
[0m01:54:01.612524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:01.617926 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:01.618326 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:01.618747 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:01.619144 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:01.619718 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL  [RUN]
[0m01:54:01.620127 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL  [RUN]
[0m01:54:01.621830 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2'
[0m01:54:01.620554 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL  [RUN]
[0m01:54:01.622778 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755'
[0m01:54:01.620969 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m01:54:01.623737 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:01.624629 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717'
[0m01:54:01.625292 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:01.625888 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m01:54:01.649839 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2"
[0m01:54:01.650548 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:01.655519 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755"
[0m01:54:01.656041 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:01.661396 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717"
[0m01:54:01.670292 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:54:01.671885 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:01.691454 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:01.695205 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755"
[0m01:54:01.695551 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:01.697756 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2"
[0m01:54:01.700051 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:54:01.700541 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:01.704557 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717"
[0m01:54:01.704984 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local revenue_local >= 0 OR revenue_local IS NULL)


  
  
      
    ) dbt_internal_test
[0m01:54:01.705593 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:54:01.706237 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd revenue_usd >= 0 OR revenue_usd IS NULL)


  
  
      
    ) dbt_internal_test
[0m01:54:01.706919 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:54:01.708845 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:01.709290 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:54:01.785100 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd product_price_usd >= 0 OR product_price_usd IS NULL)


  
  
      
    ) dbt_internal_test
[0m01:54:01.785578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:54:03.689683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:115c46e2-82f4-4a9f-b172-61105b6650ef&page=queryresults
[0m01:54:03.690198 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:115c46e2-82f4-4a9f-b172-61105b6650ef&page=queryresults
[0m01:54:03.699296 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql
[0m01:54:03.699831 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL  [[31mERROR[0m in 2.08s]
[0m01:54:03.700568 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:03.700942 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:03.701567 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql.
[0m01:54:03.702153 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m01:54:03.703456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m01:54:03.703812 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:03.707879 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:54:03.709147 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:03.711454 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:54:03.712278 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:03.712651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:03.753055 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f007b27-a51b-49ce-a914-0a3842f115ad&page=queryresults
[0m01:54:03.754010 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc6192ca-8e3e-403f-9df0-01e482ea50a4&page=queryresults
[0m01:54:03.753567 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f007b27-a51b-49ce-a914-0a3842f115ad&page=queryresults
[0m01:54:03.754435 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc6192ca-8e3e-403f-9df0-01e482ea50a4&page=queryresults
[0m01:54:03.764092 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql
[0m01:54:03.764646 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL  [[31mERROR[0m in 2.14s]
[0m01:54:03.765392 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:03.766105 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql.
[0m01:54:03.769779 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql
[0m01:54:03.770262 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL  [[31mERROR[0m in 2.15s]
[0m01:54:03.770998 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:03.771692 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql.
[0m01:54:04.090513 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4bb5b302-ab47-4e1b-af43-3c889bef66a9&page=queryresults
[0m01:54:05.098720 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.47s]
[0m01:54:05.099553 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:05.582917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a3d1156a-d966-4f4e-854e-75a0933ab7a7&page=queryresults
[0m01:54:06.445425 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.74s]
[0m01:54:06.446253 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:06.447961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:06.449620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:06.449888 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:54:06.450138 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:54:06.450383 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:54:06.450627 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2' was properly closed.
[0m01:54:06.450873 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755' was properly closed.
[0m01:54:06.451114 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m01:54:06.451353 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m01:54:06.451640 [info ] [MainThread]: 
[0m01:54:06.452178 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m01:54:06.453447 [debug] [MainThread]: Command end result
[0m01:54:06.484094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:54:06.486317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:54:06.493803 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:54:06.494145 [info ] [MainThread]: 
[0m01:54:06.494761 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:54:06.495145 [info ] [MainThread]: 
[0m01:54:06.495576 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)[0m
[0m01:54:06.496005 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql
[0m01:54:06.496360 [info ] [MainThread]: 
[0m01:54:06.496764 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql
[0m01:54:06.497118 [info ] [MainThread]: 
[0m01:54:06.497530 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)[0m
[0m01:54:06.497949 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql
[0m01:54:06.498301 [info ] [MainThread]: 
[0m01:54:06.499068 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql
[0m01:54:06.499426 [info ] [MainThread]: 
[0m01:54:06.499841 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)[0m
[0m01:54:06.500259 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql
[0m01:54:06.500611 [info ] [MainThread]: 
[0m01:54:06.501014 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql
[0m01:54:06.501364 [info ] [MainThread]: 
[0m01:54:06.501737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m01:54:06.502704 [debug] [MainThread]: Command `dbt test` failed at 01:54:06.502599 after 11.30 seconds
[0m01:54:06.503039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA1850590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6B87B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6B87D80>]}
[0m01:54:06.503363 [debug] [MainThread]: Flushing usage events
[0m01:54:08.645642 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:41.542627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074B6902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074C6DBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074C6DB9D0>]}


============================== 02:04:41.546919 | 5aed7bfd-039f-4c76-a05f-52946a0c7ba4 ==============================
[0m02:04:41.546919 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:04:41.547572 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:04:44.682377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aed7bfd-039f-4c76-a05f-52946a0c7ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074B9EF6F0>]}
[0m02:04:44.749009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aed7bfd-039f-4c76-a05f-52946a0c7ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002077012B350>]}
[0m02:04:44.749642 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:04:45.446302 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:04:45.656038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:04:45.657181 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m02:04:46.112967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aed7bfd-039f-4c76-a05f-52946a0c7ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207717BDC50>]}
[0m02:04:46.219073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:46.221490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:46.264611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aed7bfd-039f-4c76-a05f-52946a0c7ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020771C03A70>]}
[0m02:04:46.265101 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:04:46.265511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aed7bfd-039f-4c76-a05f-52946a0c7ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207718A5FD0>]}
[0m02:04:46.267172 [info ] [MainThread]: 
[0m02:04:46.267574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:04:46.267927 [info ] [MainThread]: 
[0m02:04:46.268419 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:46.272871 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:04:46.273584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:46.274335 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:04:46.275022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:46.275563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:04:46.276021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:48.386900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aed7bfd-039f-4c76-a05f-52946a0c7ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020771BD2F70>]}
[0m02:04:48.387578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:48.394925 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:04:48.395449 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:04:48.396133 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:04:48.396789 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:04:48.397494 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_  [RUN]
[0m02:04:48.398092 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_  [RUN]
[0m02:04:48.399920 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0'
[0m02:04:48.400505 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e'
[0m02:04:48.401126 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:04:48.398874 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_  [RUN]
[0m02:04:48.401699 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:04:48.411577 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0"
[0m02:04:48.399321 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:04:48.412373 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409'
[0m02:04:48.416724 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e"
[0m02:04:48.417639 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:04:48.418125 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:04:48.418815 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:04:48.422367 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:04:48.424699 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409"
[0m02:04:48.432102 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:04:48.438298 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:04:48.463241 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0"
[0m02:04:48.466242 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e"
[0m02:04:48.467512 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:04:48.470632 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:04:48.471189 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:04:48.473880 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409"
[0m02:04:48.474676 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (revenue_usd >= 0 OR revenue_usd IS NULL))


  
  
      
    ) dbt_internal_test
[0m02:04:48.475301 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:04:48.475777 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (revenue_local >= 0 OR revenue_local IS NULL))


  
  
      
    ) dbt_internal_test
[0m02:04:48.476330 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:04:48.502195 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:48.502937 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:04:48.503479 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (product_price_usd >= 0 OR product_price_usd IS NULL))


  
  
      
    ) dbt_internal_test
[0m02:04:48.505008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:50.836875 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:77d140ef-4316-40dc-8a48-e3efb3a2827a&page=queryresults
[0m02:04:50.837368 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:77d140ef-4316-40dc-8a48-e3efb3a2827a&page=queryresults
[0m02:04:50.847036 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql
[0m02:04:50.847592 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_  [[31mERROR[0m in 2.45s]
[0m02:04:50.848398 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:04:50.848763 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:04:50.849383 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql.
[0m02:04:50.851717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3a8222c9-9b41-41b1-b5c9-fed3b7046038&page=queryresults
[0m02:04:50.850020 [info ] [Thread-3 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:04:50.852642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:04:50.852997 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:04:50.857323 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:04:50.852153 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3a8222c9-9b41-41b1-b5c9-fed3b7046038&page=queryresults
[0m02:04:50.861116 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:04:50.863559 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:04:50.867543 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql
[0m02:04:50.868071 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_  [[31mERROR[0m in 2.46s]
[0m02:04:50.868653 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:50.869245 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:04:50.870140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:04:50.870868 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql.
[0m02:04:50.898452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aed785d6-5fba-4237-bf52-d4afe70e3788&page=queryresults
[0m02:04:50.898963 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aed785d6-5fba-4237-bf52-d4afe70e3788&page=queryresults
[0m02:04:50.907064 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql
[0m02:04:50.907632 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_  [[31mERROR[0m in 2.51s]
[0m02:04:50.908711 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:04:50.909408 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql.
[0m02:04:50.910307 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ee86cd33-46d3-4f54-8fa2-b05116b92fb1&page=queryresults
[0m02:04:51.902207 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.48s]
[0m02:04:51.903024 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:04:52.658321 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d9b45551-00cd-486a-a246-666df0215a7d&page=queryresults
[0m02:04:53.561108 [info ] [Thread-3 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.71s]
[0m02:04:53.561927 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:04:53.563434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:53.565001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:53.565282 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:04:53.565537 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:04:53.565784 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:04:53.566028 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:04:53.566278 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e' was properly closed.
[0m02:04:53.566533 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409' was properly closed.
[0m02:04:53.566780 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:04:53.567071 [info ] [MainThread]: 
[0m02:04:53.567458 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m02:04:53.568797 [debug] [MainThread]: Command end result
[0m02:04:53.601215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:53.603592 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:53.617955 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:04:53.618737 [info ] [MainThread]: 
[0m02:04:53.619909 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:04:53.620786 [info ] [MainThread]: 
[0m02:04:53.622053 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)[0m
[0m02:04:53.624277 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql
[0m02:04:53.625568 [info ] [MainThread]: 
[0m02:04:53.627087 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql
[0m02:04:53.627877 [info ] [MainThread]: 
[0m02:04:53.628696 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)[0m
[0m02:04:53.629599 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql
[0m02:04:53.630472 [info ] [MainThread]: 
[0m02:04:53.631230 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql
[0m02:04:53.631839 [info ] [MainThread]: 
[0m02:04:53.632861 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)[0m
[0m02:04:53.633886 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql
[0m02:04:53.634519 [info ] [MainThread]: 
[0m02:04:53.635287 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql
[0m02:04:53.636079 [info ] [MainThread]: 
[0m02:04:53.636817 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:04:53.639512 [debug] [MainThread]: Command `dbt test` failed at 02:04:53.639258 after 12.28 seconds
[0m02:04:53.640228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002074C6B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020771BECE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020771BEEF10>]}
[0m02:04:53.640991 [debug] [MainThread]: Flushing usage events
[0m02:04:55.711789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:20:58.268235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481AA302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481BA7BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481BA7B9D0>]}


============================== 02:20:58.272584 | b9018712-c6d8-462e-bcc0-0057c8f31ed1 ==============================
[0m02:20:58.272584 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:20:58.273223 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:21:01.464323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9018712-c6d8-462e-bcc0-0057c8f31ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481AD8F6F0>]}
[0m02:21:01.535006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9018712-c6d8-462e-bcc0-0057c8f31ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002483F4BB350>]}
[0m02:21:01.535762 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:21:02.248339 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:21:02.477338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:21:02.477674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:21:02.528892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9018712-c6d8-462e-bcc0-0057c8f31ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002483F548B50>]}
[0m02:21:02.633530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:21:02.635974 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:21:02.677202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9018712-c6d8-462e-bcc0-0057c8f31ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024840D22B70>]}
[0m02:21:02.677611 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:21:02.678007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9018712-c6d8-462e-bcc0-0057c8f31ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024840D0E6D0>]}
[0m02:21:02.680081 [info ] [MainThread]: 
[0m02:21:02.681101 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:21:02.681820 [info ] [MainThread]: 
[0m02:21:02.683110 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:21:02.691613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:21:02.692351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:02.692906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:21:02.693674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:02.694128 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:21:02.694838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:04.734056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9018712-c6d8-462e-bcc0-0057c8f31ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024840CB3A00>]}
[0m02:21:04.734580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:04.740825 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:21:04.741247 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:21:04.741626 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:21:04.742056 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:21:04.742631 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:21:04.743107 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_  [RUN]
[0m02:21:04.743706 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_  [RUN]
[0m02:21:04.745189 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:21:04.744454 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_  [RUN]
[0m02:21:04.745887 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409'
[0m02:21:04.746341 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0'
[0m02:21:04.746741 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:21:04.747488 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e'
[0m02:21:04.748074 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:21:04.748530 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:21:04.767954 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:21:04.768408 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:21:04.782140 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409"
[0m02:21:04.787483 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0"
[0m02:21:04.793311 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e"
[0m02:21:04.794688 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:21:04.818525 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:21:04.819326 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:21:04.819691 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:21:04.822337 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e"
[0m02:21:04.822695 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:21:04.824594 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0"
[0m02:21:04.828152 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409"
[0m02:21:04.828531 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:21:04.829310 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:21:04.856555 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (revenue_local >= 0 OR revenue_local IS NULL))


  
  
      
    ) dbt_internal_test
[0m02:21:04.857083 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:21:04.857923 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (product_price_usd >= 0 OR product_price_usd IS NULL))


  
  
      
    ) dbt_internal_test
[0m02:21:04.858403 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (revenue_usd >= 0 OR revenue_usd IS NULL))


  
  
      
    ) dbt_internal_test
[0m02:21:04.858790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:21:04.885206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:21:07.053956 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c3ef74b9-c2fa-4a35-bb8f-4108d1cfa805&page=queryresults
[0m02:21:07.054455 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c3ef74b9-c2fa-4a35-bb8f-4108d1cfa805&page=queryresults
[0m02:21:07.063610 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql
[0m02:21:07.064148 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_  [[31mERROR[0m in 2.32s]
[0m02:21:07.064933 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0
[0m02:21:07.065326 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:21:07.065962 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql.
[0m02:21:07.066770 [info ] [Thread-3 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:21:07.068283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_.754e3a03e0, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:21:07.068722 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:21:07.072680 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:21:07.073888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:678b8e17-31c0-48c0-99d6-5dcbbbbca1ee&page=queryresults
[0m02:21:07.074408 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:21:07.076924 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:21:07.074877 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:678b8e17-31c0-48c0-99d6-5dcbbbbca1ee&page=queryresults
[0m02:21:07.080833 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:21:07.081580 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:21:07.087184 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql
[0m02:21:07.087728 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_  [[31mERROR[0m in 2.34s]
[0m02:21:07.129056 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409
[0m02:21:07.130191 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql.
[0m02:21:07.135533 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:081fcfed-e788-48f1-9f6c-85e63ebd971e&page=queryresults
[0m02:21:07.136100 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:081fcfed-e788-48f1-9f6c-85e63ebd971e&page=queryresults
[0m02:21:07.144680 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql
[0m02:21:07.145890 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_  [[31mERROR[0m in 2.40s]
[0m02:21:07.147371 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e
[0m02:21:07.148233 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql.
[0m02:21:07.152845 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6086f4d7-a36c-43cf-a8d8-0fb8e2af3d7a&page=queryresults
[0m02:21:08.108822 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.36s]
[0m02:21:08.109625 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:21:08.895447 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1e6d0494-112f-4f38-8a7c-27ea447f415d&page=queryresults
[0m02:21:09.828508 [info ] [Thread-3 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.76s]
[0m02:21:09.829344 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:21:09.830763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:21:09.832594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:09.833057 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:21:09.833584 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:21:09.834078 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:21:09.834379 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:21:09.834685 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_.44431f7409' was properly closed.
[0m02:21:09.834972 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:21:09.835242 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_.aa844ec40e' was properly closed.
[0m02:21:09.835561 [info ] [MainThread]: 
[0m02:21:09.836005 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m02:21:09.837368 [debug] [MainThread]: Command end result
[0m02:21:09.868296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:21:09.870645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:21:09.876828 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:21:09.877128 [info ] [MainThread]: 
[0m02:21:09.877548 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:21:09.877931 [info ] [MainThread]: 
[0m02:21:09.878369 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)[0m
[0m02:21:09.878831 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___revenue_usd_0_OR_revenue_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql
[0m02:21:09.879200 [info ] [MainThread]: 
[0m02:21:09.879615 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7625c3d6026a5e297d4887e5f078f152.sql
[0m02:21:09.879977 [info ] [MainThread]: 
[0m02:21:09.880406 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)[0m
[0m02:21:09.880839 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___product_price_usd_0_OR_product_price_usd_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql
[0m02:21:09.881202 [info ] [MainThread]: 
[0m02:21:09.881616 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_990df665946fbc1855226a4b15e1874c.sql
[0m02:21:09.882049 [info ] [MainThread]: 
[0m02:21:09.882474 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)[0m
[0m02:21:09.883107 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___revenue_local_0_OR_revenue_local_IS_NULL_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql
[0m02:21:09.883819 [info ] [MainThread]: 
[0m02:21:09.884522 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_fd32343b5fece0012dadb94a4df2fb2c.sql
[0m02:21:09.885044 [info ] [MainThread]: 
[0m02:21:09.885752 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:21:09.887322 [debug] [MainThread]: Command `dbt test` failed at 02:21:09.887177 after 11.80 seconds
[0m02:21:09.887859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002481BA50590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024840D9BB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024840D9BD80>]}
[0m02:21:09.888415 [debug] [MainThread]: Flushing usage events
[0m02:21:11.176993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:22:06.306606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875CF202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875DF6BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875DF6B9D0>]}


============================== 02:22:06.310689 | 7a64e343-3f9a-4a68-a035-131bea9bbf36 ==============================
[0m02:22:06.310689 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:22:06.311338 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:22:09.587891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a64e343-3f9a-4a68-a035-131bea9bbf36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875D27F6F0>]}
[0m02:22:09.652362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a64e343-3f9a-4a68-a035-131bea9bbf36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187019AB350>]}
[0m02:22:09.653602 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:22:10.346596 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:22:10.561920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:22:10.562627 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m02:22:11.042127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a64e343-3f9a-4a68-a035-131bea9bbf36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018703039C50>]}
[0m02:22:11.150948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:22:11.154006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:22:11.195587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a64e343-3f9a-4a68-a035-131bea9bbf36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001870347FA70>]}
[0m02:22:11.196016 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:22:11.196423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a64e343-3f9a-4a68-a035-131bea9bbf36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018703125E10>]}
[0m02:22:11.198105 [info ] [MainThread]: 
[0m02:22:11.198505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:22:11.198859 [info ] [MainThread]: 
[0m02:22:11.199354 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:22:11.203673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:22:11.204082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:11.204707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:22:11.205023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:11.205765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:22:11.232029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:13.134703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a64e343-3f9a-4a68-a035-131bea9bbf36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001870344BC70>]}
[0m02:22:13.135458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:22:13.142719 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e
[0m02:22:13.143346 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:22:13.143747 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442
[0m02:22:13.144186 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc
[0m02:22:13.144798 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END  [RUN]
[0m02:22:13.145165 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:22:13.146960 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e'
[0m02:22:13.145685 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END  [RUN]
[0m02:22:13.147523 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:22:13.147965 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e
[0m02:22:13.146118 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END  [RUN]
[0m02:22:13.148612 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442'
[0m02:22:13.149059 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:22:13.159037 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e"
[0m02:22:13.159575 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc'
[0m02:22:13.159952 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442
[0m02:22:13.166602 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:22:13.167135 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc
[0m02:22:13.176738 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442"
[0m02:22:13.180564 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc"
[0m02:22:13.181369 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e
[0m02:22:13.207493 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e"
[0m02:22:13.208223 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442
[0m02:22:13.211089 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442"
[0m02:22:13.211989 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:22:13.215945 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:22:13.216394 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd CASE WHEN product_price_usd IS NULL THEN TRUE ELSE product_price_usd >= 0 END)


  
  
      
    ) dbt_internal_test
[0m02:22:13.216981 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:22:13.217427 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc
[0m02:22:13.219326 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc"
[0m02:22:13.245319 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd CASE WHEN revenue_usd IS NULL THEN TRUE ELSE revenue_usd >= 0 END)


  
  
      
    ) dbt_internal_test
[0m02:22:13.246095 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:22:13.247010 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:22:13.247726 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:22:13.273767 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local CASE WHEN revenue_local IS NULL THEN TRUE ELSE revenue_local >= 0 END)


  
  
      
    ) dbt_internal_test
[0m02:22:13.274265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:22:15.294727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ac21ac77-9e3f-4610-985d-a150bc0d9abc&page=queryresults
[0m02:22:15.295264 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ac21ac77-9e3f-4610-985d-a150bc0d9abc&page=queryresults
[0m02:22:15.304956 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7e2c0031c699b46d8b31368014c037bd.sql
[0m02:22:15.305543 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END  [[31mERROR[0m in 2.16s]
[0m02:22:15.306297 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e
[0m02:22:15.306684 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:22:15.307341 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7e2c0031c699b46d8b31368014c037bd.sql.
[0m02:22:15.307953 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:22:15.309310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END.850b34a68e, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:22:15.309808 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:22:15.313299 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:22:15.314178 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:22:15.316622 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:22:15.317698 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:22:15.318138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:15.345475 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a56e694-a4f3-475b-b18c-62cddb19abe1&page=queryresults
[0m02:22:15.345976 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a56e694-a4f3-475b-b18c-62cddb19abe1&page=queryresults
[0m02:22:15.353084 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a82f96b98248696f67c6192d82e323be.sql
[0m02:22:15.353808 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END  [[31mERROR[0m in 2.19s]
[0m02:22:15.354927 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc
[0m02:22:15.355945 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a82f96b98248696f67c6192d82e323be.sql.
[0m02:22:15.364298 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:980b00b1-16f3-473e-a09d-c879aec2b7db&page=queryresults
[0m02:22:15.364801 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:980b00b1-16f3-473e-a09d-c879aec2b7db&page=queryresults
[0m02:22:15.371989 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8a5a0992f57ca0c4f0dd123f064de799.sql
[0m02:22:15.372563 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END  [[31mERROR[0m in 2.22s]
[0m02:22:15.373302 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442
[0m02:22:15.373977 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8a5a0992f57ca0c4f0dd123f064de799.sql.
[0m02:22:15.464352 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d16ec821-96ef-4c97-bd93-3be279b74431&page=queryresults
[0m02:22:16.410896 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.26s]
[0m02:22:16.411679 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:22:17.006331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab9bbec7-87e5-466d-a4a2-6b697d18c61a&page=queryresults
[0m02:22:17.880028 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.57s]
[0m02:22:17.880961 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:22:17.882425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:22:17.883924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:17.884194 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:22:17.884445 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:22:17.884691 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:22:17.884937 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:22:17.885182 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:22:17.885429 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END.e0d249e442' was properly closed.
[0m02:22:17.885680 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END.5292ba46cc' was properly closed.
[0m02:22:17.885973 [info ] [MainThread]: 
[0m02:22:17.886619 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m02:22:17.889375 [debug] [MainThread]: Command end result
[0m02:22:17.922811 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:22:17.926140 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:22:17.933046 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:22:17.933418 [info ] [MainThread]: 
[0m02:22:17.934082 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:22:17.934701 [info ] [MainThread]: 
[0m02:22:17.935219 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END (models\mart\mart_models.yml)[0m
[0m02:22:17.935724 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__CASE_WHEN_product_price_usd_IS_NULL_THEN_TRUE_ELSE_product_price_usd_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7e2c0031c699b46d8b31368014c037bd.sql
[0m02:22:17.936173 [info ] [MainThread]: 
[0m02:22:17.937086 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7e2c0031c699b46d8b31368014c037bd.sql
[0m02:22:17.938047 [info ] [MainThread]: 
[0m02:22:17.938942 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END (models\mart\mart_models.yml)[0m
[0m02:22:17.939744 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__CASE_WHEN_revenue_local_IS_NULL_THEN_TRUE_ELSE_revenue_local_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a82f96b98248696f67c6192d82e323be.sql
[0m02:22:17.940341 [info ] [MainThread]: 
[0m02:22:17.940968 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a82f96b98248696f67c6192d82e323be.sql
[0m02:22:17.941390 [info ] [MainThread]: 
[0m02:22:17.941906 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END (models\mart\mart_models.yml)[0m
[0m02:22:17.942709 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__CASE_WHEN_revenue_usd_IS_NULL_THEN_TRUE_ELSE_revenue_usd_0_END (models\mart\mart_models.yml)
  Syntax error: Expected "," but got keyword CASE at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8a5a0992f57ca0c4f0dd123f064de799.sql
[0m02:22:17.943321 [info ] [MainThread]: 
[0m02:22:17.944048 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8a5a0992f57ca0c4f0dd123f064de799.sql
[0m02:22:17.944659 [info ] [MainThread]: 
[0m02:22:17.945290 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:22:17.946777 [debug] [MainThread]: Command `dbt test` failed at 02:22:17.946630 after 11.78 seconds
[0m02:22:17.947351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001875DF34650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001870346CD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001870346F280>]}
[0m02:22:17.947945 [debug] [MainThread]: Flushing usage events
[0m02:22:20.439697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:23:31.815272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5DF302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5EF7BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5EF7B9D0>]}


============================== 02:23:31.819576 | dd08f5e5-e58b-407b-9368-19bb72c14753 ==============================
[0m02:23:31.819576 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:23:31.820230 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:23:34.886611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd08f5e5-e58b-407b-9368-19bb72c14753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5E28F6F0>]}
[0m02:23:34.952297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd08f5e5-e58b-407b-9368-19bb72c14753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F02AAB350>]}
[0m02:23:34.952914 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:23:35.698243 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:23:35.952451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:23:35.953176 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m02:23:36.440420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd08f5e5-e58b-407b-9368-19bb72c14753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0414DC50>]}
[0m02:23:36.547731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:23:36.550189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:23:36.593148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd08f5e5-e58b-407b-9368-19bb72c14753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F043ABA70>]}
[0m02:23:36.593707 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:23:36.594121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd08f5e5-e58b-407b-9368-19bb72c14753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F04225710>]}
[0m02:23:36.595825 [info ] [MainThread]: 
[0m02:23:36.596223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:23:36.596582 [info ] [MainThread]: 
[0m02:23:36.597090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:23:36.600875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:23:36.601341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:36.601752 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:23:36.602363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:23:36.602703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:36.603043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:38.504097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd08f5e5-e58b-407b-9368-19bb72c14753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F04553E10>]}
[0m02:23:38.504810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:38.512434 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2
[0m02:23:38.513269 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294
[0m02:23:38.513887 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:23:38.514502 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7
[0m02:23:38.515182 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0  [RUN]
[0m02:23:38.515800 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0  [RUN]
[0m02:23:38.517952 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2'
[0m02:23:38.516407 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:23:38.518845 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294'
[0m02:23:38.519265 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2
[0m02:23:38.517110 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0  [RUN]
[0m02:23:38.519816 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:23:38.520170 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294
[0m02:23:38.530515 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2"
[0m02:23:38.531194 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7'
[0m02:23:38.531567 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:23:38.535654 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294"
[0m02:23:38.536145 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7
[0m02:23:38.544749 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:23:38.549636 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7"
[0m02:23:38.550102 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2
[0m02:23:38.550752 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294
[0m02:23:38.578537 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2"
[0m02:23:38.580974 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294"
[0m02:23:38.581802 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:23:38.584774 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:23:38.585129 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7
[0m02:23:38.587495 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7"
[0m02:23:38.588278 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd product_price_usd IS NULL OR product_price_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m02:23:38.588956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:23:38.589572 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd revenue_usd IS NULL OR revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m02:23:38.590122 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:23:38.590925 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:23:38.591782 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:23:38.594025 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local revenue_local IS NULL OR revenue_local >= 0)


  
  
      
    ) dbt_internal_test
[0m02:23:38.619219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:23:40.565049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7e182253-6205-4c61-b1f4-6a8625bfce29&page=queryresults
[0m02:23:40.565546 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7e182253-6205-4c61-b1f4-6a8625bfce29&page=queryresults
[0m02:23:40.575223 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8603f275112d4d0e605c5cbbb9f0a0a7.sql
[0m02:23:40.575889 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0  [[31mERROR[0m in 2.06s]
[0m02:23:40.576662 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2
[0m02:23:40.577056 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:23:40.577719 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8603f275112d4d0e605c5cbbb9f0a0a7.sql.
[0m02:23:40.578302 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:23:40.579634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0.44b16634c2, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:23:40.579995 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:23:40.583890 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:23:40.584799 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:23:40.586786 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:23:40.587600 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:23:40.588014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:40.624507 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c5585935-7f6b-4b2b-a9a2-8b4a19255130&page=queryresults
[0m02:23:40.625189 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c5585935-7f6b-4b2b-a9a2-8b4a19255130&page=queryresults
[0m02:23:40.631544 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a6c1ae1350bfe04626a49ea0e4a35252.sql
[0m02:23:40.632081 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0  [[31mERROR[0m in 2.11s]
[0m02:23:40.632803 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294
[0m02:23:40.633487 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a6c1ae1350bfe04626a49ea0e4a35252.sql.
[0m02:23:40.634767 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:216cdbd2-a341-4318-a57d-999cc2236d13&page=queryresults
[0m02:23:40.635210 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:216cdbd2-a341-4318-a57d-999cc2236d13&page=queryresults
[0m02:23:40.642192 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_e6caf83399ffddba82e0172669b10c8a.sql
[0m02:23:40.642731 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0  [[31mERROR[0m in 2.11s]
[0m02:23:40.643450 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7
[0m02:23:40.644105 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_e6caf83399ffddba82e0172669b10c8a.sql.
[0m02:23:40.804610 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:361f80bb-5e6f-42f7-9b1b-62647175c2cb&page=queryresults
[0m02:23:41.770974 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.25s]
[0m02:23:41.771780 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:23:42.276996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a66d1bd2-f63a-4bca-a7e7-24853d5b699f&page=queryresults
[0m02:23:43.110661 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.53s]
[0m02:23:43.111455 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:23:43.113053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:43.114524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:43.114789 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:23:43.115043 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:23:43.115292 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:23:43.115537 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:23:43.115785 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0.b5dcbc7294' was properly closed.
[0m02:23:43.116040 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:23:43.116305 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0.32269da7f7' was properly closed.
[0m02:23:43.116593 [info ] [MainThread]: 
[0m02:23:43.116970 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.52 seconds (6.52s).
[0m02:23:43.118224 [debug] [MainThread]: Command end result
[0m02:23:43.148337 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:23:43.150663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:23:43.157126 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:23:43.157554 [info ] [MainThread]: 
[0m02:23:43.158210 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:23:43.158767 [info ] [MainThread]: 
[0m02:23:43.159218 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0 (models\mart\mart_models.yml)[0m
[0m02:23:43.159665 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_IS_NULL_OR_product_price_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8603f275112d4d0e605c5cbbb9f0a0a7.sql
[0m02:23:43.160030 [info ] [MainThread]: 
[0m02:23:43.160443 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8603f275112d4d0e605c5cbbb9f0a0a7.sql
[0m02:23:43.160805 [info ] [MainThread]: 
[0m02:23:43.161231 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0 (models\mart\mart_models.yml)[0m
[0m02:23:43.161663 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_IS_NULL_OR_revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a6c1ae1350bfe04626a49ea0e4a35252.sql
[0m02:23:43.162031 [info ] [MainThread]: 
[0m02:23:43.162444 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_a6c1ae1350bfe04626a49ea0e4a35252.sql
[0m02:23:43.162803 [info ] [MainThread]: 
[0m02:23:43.163229 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0 (models\mart\mart_models.yml)[0m
[0m02:23:43.163659 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_IS_NULL_OR_revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_e6caf83399ffddba82e0172669b10c8a.sql
[0m02:23:43.164021 [info ] [MainThread]: 
[0m02:23:43.164437 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_e6caf83399ffddba82e0172669b10c8a.sql
[0m02:23:43.164797 [info ] [MainThread]: 
[0m02:23:43.165178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:23:43.166237 [debug] [MainThread]: Command `dbt test` failed at 02:23:43.166129 after 11.48 seconds
[0m02:23:43.166580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5EF44650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F04568D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0456AF10>]}
[0m02:23:43.166913 [debug] [MainThread]: Flushing usage events
[0m02:23:45.248768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:30.620544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF10602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF20ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF20AB9D0>]}


============================== 02:26:30.624646 | a94af7bc-3449-424c-bbc3-37444e4a49a8 ==============================
[0m02:26:30.624646 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:26:30.625293 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:26:33.820296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a94af7bc-3449-424c-bbc3-37444e4a49a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF13BF6F0>]}
[0m02:26:33.884320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a94af7bc-3449-424c-bbc3-37444e4a49a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E95CAB350>]}
[0m02:26:33.885031 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:26:34.563267 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:26:34.777373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:26:34.778070 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m02:26:35.248494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a94af7bc-3449-424c-bbc3-37444e4a49a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9733DC50>]}
[0m02:26:35.354929 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:26:35.357509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:26:35.398173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a94af7bc-3449-424c-bbc3-37444e4a49a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E975ABA70>]}
[0m02:26:35.398591 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:26:35.398997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a94af7bc-3449-424c-bbc3-37444e4a49a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97421FD0>]}
[0m02:26:35.401204 [info ] [MainThread]: 
[0m02:26:35.401753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:26:35.402260 [info ] [MainThread]: 
[0m02:26:35.403072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:26:35.407114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:26:35.407594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:35.408080 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:26:35.408396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:35.408966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:26:35.434569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:37.403489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a94af7bc-3449-424c-bbc3-37444e4a49a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97753E10>]}
[0m02:26:37.404278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:26:37.417784 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132
[0m02:26:37.418392 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d
[0m02:26:37.419028 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:26:37.419481 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0
[0m02:26:37.420210 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0  [RUN]
[0m02:26:37.420905 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0  [RUN]
[0m02:26:37.421496 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:26:37.422897 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132'
[0m02:26:37.423608 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d'
[0m02:26:37.422162 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0  [RUN]
[0m02:26:37.424176 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:26:37.424634 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132
[0m02:26:37.425216 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d
[0m02:26:37.425802 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0'
[0m02:26:37.426387 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:26:37.439927 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132"
[0m02:26:37.443633 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d"
[0m02:26:37.444035 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0
[0m02:26:37.449891 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:26:37.454644 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0"
[0m02:26:37.455481 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d
[0m02:26:37.456113 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132
[0m02:26:37.488751 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d"
[0m02:26:37.489855 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132"
[0m02:26:37.490366 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0
[0m02:26:37.490712 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:26:37.493011 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0"
[0m02:26:37.494849 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:26:37.495942 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd COALESCE(revenue_usd, 0) >= 0)


  
  
      
    ) dbt_internal_test
[0m02:26:37.496650 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:26:37.497337 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd COALESCE(product_price_usd, 0) >= 0)


  
  
      
    ) dbt_internal_test
[0m02:26:37.497762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:26:37.498480 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:26:37.498889 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:26:37.499270 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local COALESCE(revenue_local, 0) >= 0)


  
  
      
    ) dbt_internal_test
[0m02:26:37.550377 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:26:39.513287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab329107-41a8-4625-8ee9-c8b28d44c179&page=queryresults
[0m02:26:39.513785 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab329107-41a8-4625-8ee9-c8b28d44c179&page=queryresults
[0m02:26:39.523244 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_895a3b9f0d40b6a30ed28234151b9a8c.sql
[0m02:26:39.523801 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0  [[31mERROR[0m in 2.10s]
[0m02:26:39.524553 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d
[0m02:26:39.525343 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:26:39.526003 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_895a3b9f0d40b6a30ed28234151b9a8c.sql.
[0m02:26:39.527990 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3ceeac26-6aa0-4af2-909f-ea5bc0b7c959&page=queryresults
[0m02:26:39.526597 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:26:39.528906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0.ea09dac91d, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:26:39.529266 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:26:39.533419 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:26:39.528421 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3ceeac26-6aa0-4af2-909f-ea5bc0b7c959&page=queryresults
[0m02:26:39.538497 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:26:39.540589 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:26:39.543914 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5f92b795e981962603fc5535b74ab9ff.sql
[0m02:26:39.544422 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0  [[31mERROR[0m in 2.12s]
[0m02:26:39.545005 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:26:39.545592 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0
[0m02:26:39.546032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:26:39.546758 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5f92b795e981962603fc5535b74ab9ff.sql.
[0m02:26:39.612108 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8a7138f2-fb37-44ab-a5d6-fc628572e999&page=queryresults
[0m02:26:39.612631 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8a7138f2-fb37-44ab-a5d6-fc628572e999&page=queryresults
[0m02:26:39.619813 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_c19d681713cb96d4ef8541979c524c79.sql
[0m02:26:39.620336 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0  [[31mERROR[0m in 2.20s]
[0m02:26:39.621081 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132
[0m02:26:39.621761 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_c19d681713cb96d4ef8541979c524c79.sql.
[0m02:26:39.792705 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:59d7a3fc-7b4a-4d59-bf01-a951a44f49fc&page=queryresults
[0m02:26:40.770509 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.35s]
[0m02:26:40.771334 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:26:41.275120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1aa06c01-e4ca-405e-8328-0efc22554a23&page=queryresults
[0m02:26:42.127973 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.60s]
[0m02:26:42.128794 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:26:42.130238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:26:42.131784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:26:42.132058 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:26:42.132314 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:26:42.132566 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:26:42.132819 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0.55215a4132' was properly closed.
[0m02:26:42.133072 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:26:42.133482 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:26:42.134211 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0.83c67e7ee0' was properly closed.
[0m02:26:42.134734 [info ] [MainThread]: 
[0m02:26:42.135371 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m02:26:42.137686 [debug] [MainThread]: Command end result
[0m02:26:42.172714 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:26:42.174962 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:26:42.181208 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:26:42.181507 [info ] [MainThread]: 
[0m02:26:42.181982 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:26:42.182381 [info ] [MainThread]: 
[0m02:26:42.182822 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0 (models\mart\mart_models.yml)[0m
[0m02:26:42.183259 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__COALESCE_product_price_usd_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_895a3b9f0d40b6a30ed28234151b9a8c.sql
[0m02:26:42.183809 [info ] [MainThread]: 
[0m02:26:42.184575 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_895a3b9f0d40b6a30ed28234151b9a8c.sql
[0m02:26:42.185778 [info ] [MainThread]: 
[0m02:26:42.186311 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0 (models\mart\mart_models.yml)[0m
[0m02:26:42.186759 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__COALESCE_revenue_local_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5f92b795e981962603fc5535b74ab9ff.sql
[0m02:26:42.187194 [info ] [MainThread]: 
[0m02:26:42.187698 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5f92b795e981962603fc5535b74ab9ff.sql
[0m02:26:42.188064 [info ] [MainThread]: 
[0m02:26:42.188489 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0 (models\mart\mart_models.yml)[0m
[0m02:26:42.188914 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__COALESCE_revenue_usd_0_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "COALESCE" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_c19d681713cb96d4ef8541979c524c79.sql
[0m02:26:42.189273 [info ] [MainThread]: 
[0m02:26:42.189682 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_c19d681713cb96d4ef8541979c524c79.sql
[0m02:26:42.190039 [info ] [MainThread]: 
[0m02:26:42.190424 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:26:42.191362 [debug] [MainThread]: Command `dbt test` failed at 02:26:42.191258 after 11.74 seconds
[0m02:26:42.191708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF2074650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97769020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97768C00>]}
[0m02:26:42.192090 [debug] [MainThread]: Flushing usage events
[0m02:26:43.517266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:28:38.323027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2294302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22A467ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22A4679D0>]}


============================== 02:28:38.327803 | 1d2eee1f-f1b4-4a40-8647-19245ad499c0 ==============================
[0m02:28:38.327803 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:28:38.328456 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:28:38.500013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d2eee1f-f1b4-4a40-8647-19245ad499c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2297936F0>]}
[0m02:28:38.601788 [debug] [MainThread]: Command `dbt clean` succeeded at 02:28:38.601660 after 0.45 seconds
[0m02:28:38.602134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22A36DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22A36D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22B6B0650>]}
[0m02:28:38.602481 [debug] [MainThread]: Flushing usage events
[0m02:28:40.120002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:28:47.102180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AE1402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AF183ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AF1839D0>]}


============================== 02:28:47.106396 | d9783e64-5554-41fd-b694-f8193970d89b ==============================
[0m02:28:47.106396 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:28:47.107272 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:28:47.252429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9783e64-5554-41fd-b694-f8193970d89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AE4A36F0>]}
[0m02:28:47.288200 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-71r63xpx'
[0m02:28:47.288583 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:28:49.219084 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:28:49.220478 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:28:49.870394 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:28:49.875164 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:28:50.795177 [info ] [MainThread]: Installed from version 1.3.0
[0m02:28:50.795700 [info ] [MainThread]: Up to date!
[0m02:28:50.796164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9783e64-5554-41fd-b694-f8193970d89b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AF07D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AF07E360>]}
[0m02:28:50.797777 [debug] [MainThread]: Command `dbt deps` succeeded at 02:28:50.797661 after 3.82 seconds
[0m02:28:50.798109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B037D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231AE95B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B03307D0>]}
[0m02:28:50.798440 [debug] [MainThread]: Flushing usage events
[0m02:28:51.871289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:28:55.925536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CAAF502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CABF9BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CABF9B9D0>]}


============================== 02:28:55.929855 | a0c5647e-0ff3-4454-a73c-c0f405125fba ==============================
[0m02:28:55.929855 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:28:55.930534 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:28:59.037731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CAB2AF6F0>]}
[0m02:28:59.101504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CCF9DB350>]}
[0m02:28:59.102132 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:28:59.766155 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:28:59.767153 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:28:59.767672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CCFA68850>]}
[0m02:29:01.712760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD0F9E030>]}
[0m02:29:01.819353 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:29:01.829932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:29:01.862489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD10C74D0>]}
[0m02:29:01.862955 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:29:01.863474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD10CFD40>]}
[0m02:29:01.865499 [info ] [MainThread]: 
[0m02:29:01.865988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:01.866455 [info ] [MainThread]: 
[0m02:29:01.867104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:29:01.871120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:29:01.871444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:01.873315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:29:01.873763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:01.875278 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:29:01.875966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:03.797352 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:29:03.797738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:03.823872 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:29:03.824937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:03.825799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:29:03.826114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:05.608549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD103D010>]}
[0m02:29:05.609120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:29:05.615374 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:29:05.615788 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:29:05.616304 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:29:05.617353 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:29:05.617714 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:29:05.616769 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:29:05.623420 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:29:05.624967 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:29:05.625915 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:29:05.628284 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:29:05.631733 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:29:05.642832 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:29:05.668130 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:29:05.668942 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:29:05.672519 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m02:29:05.673024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:29:05.673503 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m02:29:05.673901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:29:07.599034 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dc263285-df50-4b79-b48e-5f1c05af6d54&page=queryresults
[0m02:29:07.608743 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:87acf894-99dd-4fff-97ec-be57313192b3&page=queryresults
[0m02:29:08.240761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD149F330>]}
[0m02:29:08.241284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CAB288230>]}
[0m02:29:08.242255 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.61s]
[0m02:29:08.244243 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:29:08.244882 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:29:08.243228 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.62s]
[0m02:29:08.246095 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:29:08.245367 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:29:08.246844 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:29:08.247241 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:29:08.251241 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:29:08.261403 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:29:08.265571 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:29:08.267024 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m02:29:08.267510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:29:10.010190 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7963bcc7-1b27-4f47-9c3f-ac52318a1926&page=queryresults
[0m02:29:10.645438 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD19BC050>]}
[0m02:29:10.646028 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m02:29:10.646803 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:29:10.647462 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m02:29:10.647909 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m02:29:10.648580 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m02:29:10.648944 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m02:29:10.651691 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m02:29:10.652748 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m02:29:10.655320 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m02:29:10.656378 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
  OPTIONS()
  as 

with sessions as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),

hits as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m02:29:10.656777 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:29:12.563651 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:639c89f4-07d6-4cd3-999b-0e45e68a6fc2&page=queryresults
[0m02:29:13.118603 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD1475550>]}
[0m02:29:13.119194 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m02:29:13.119989 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m02:29:13.120642 [debug] [Thread-2 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:29:13.121068 [info ] [Thread-2 (]: 5 of 5 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m02:29:13.121653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.fct_sales_item)
[0m02:29:13.121994 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:29:13.124467 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:29:13.126474 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:29:13.137325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:29:14.613136 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:29:14.614598 [debug] [Thread-2 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      

with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m02:29:15.466699 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ce9c3a54-33f3-498c-aab4-07afe53b5370&page=queryresults
[0m02:29:18.362639 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0c5647e-0ff3-4454-a73c-c0f405125fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD1AD1BB0>]}
[0m02:29:18.363296 [info ] [Thread-2 (]: 5 of 5 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.24s]
[0m02:29:18.364123 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:29:18.365635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:29:18.367203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:18.367485 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:29:18.367748 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:29:18.368009 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:29:18.368266 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:29:18.368525 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:29:18.368783 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:29:18.369038 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:29:18.369294 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:29:18.369547 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m02:29:18.369803 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m02:29:18.370141 [info ] [MainThread]: 
[0m02:29:18.370609 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 16.50 seconds (16.50s).
[0m02:29:18.372130 [debug] [MainThread]: Command end result
[0m02:29:18.406937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:29:18.410478 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:29:18.416134 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:29:18.416445 [info ] [MainThread]: 
[0m02:29:18.416957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:29:18.417455 [info ] [MainThread]: 
[0m02:29:18.417946 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:29:18.419046 [debug] [MainThread]: Command `dbt run` succeeded at 02:29:18.418903 after 22.62 seconds
[0m02:29:18.419398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD1362450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD100EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD0EF63F0>]}
[0m02:29:18.419738 [debug] [MainThread]: Flushing usage events
[0m02:29:19.630812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:27.952305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF0AE02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF1B2BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF1B2B9D0>]}


============================== 02:29:27.956692 | be693fcd-640d-4fb9-899f-79b9e31637cb ==============================
[0m02:29:27.956692 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:29:27.957356 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:29:30.964905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be693fcd-640d-4fb9-899f-79b9e31637cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF0E3F6F0>]}
[0m02:29:31.028159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be693fcd-640d-4fb9-899f-79b9e31637cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF9569B350>]}
[0m02:29:31.028794 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:29:31.713715 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:29:31.923733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:29:31.924074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:29:31.976233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be693fcd-640d-4fb9-899f-79b9e31637cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF966F8B50>]}
[0m02:29:32.095039 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:29:32.097411 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:29:32.138822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be693fcd-640d-4fb9-899f-79b9e31637cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF96E72B70>]}
[0m02:29:32.139263 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:29:32.139760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be693fcd-640d-4fb9-899f-79b9e31637cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF96E6E6D0>]}
[0m02:29:32.141475 [info ] [MainThread]: 
[0m02:29:32.141955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:32.142614 [info ] [MainThread]: 
[0m02:29:32.143660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:29:32.148394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:29:32.148957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:32.149440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:29:32.149752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:32.150401 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:29:32.150703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:33.958552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be693fcd-640d-4fb9-899f-79b9e31637cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF96EEAA90>]}
[0m02:29:33.959151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:29:33.966498 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m02:29:33.966960 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:29:33.967369 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m02:29:33.968161 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m02:29:33.967791 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_  [RUN]
[0m02:29:33.968781 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:29:33.970358 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8'
[0m02:29:33.970877 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:29:33.969178 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_  [RUN]
[0m02:29:33.971437 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m02:29:33.971916 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:29:33.972438 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5'
[0m02:29:33.969791 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_  [RUN]
[0m02:29:33.994129 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"
[0m02:29:34.000892 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:29:34.001409 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m02:29:34.001964 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee'
[0m02:29:34.006508 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"
[0m02:29:34.007110 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m02:29:34.013830 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"
[0m02:29:34.023576 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m02:29:34.045754 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"
[0m02:29:34.046509 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:29:34.048877 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:29:34.049711 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m02:29:34.051948 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"
[0m02:29:34.052352 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m02:29:34.054824 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"
[0m02:29:34.055316 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (COALESCE(product_price_usd, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m02:29:34.055768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:29:34.056209 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:34.056605 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:29:34.057297 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (COALESCE(revenue_usd, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m02:29:34.057685 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:29:34.058100 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (COALESCE(revenue_local, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m02:29:34.058483 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:29:36.261025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0a1a3a63-f543-4dd2-83b1-b55cf788c6d1&page=queryresults
[0m02:29:36.261580 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0a1a3a63-f543-4dd2-83b1-b55cf788c6d1&page=queryresults
[0m02:29:36.271451 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m02:29:36.272022 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_  [[31mERROR[0m in 2.30s]
[0m02:29:36.272768 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m02:29:36.273163 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:29:36.274026 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql.
[0m02:29:36.273526 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:29:36.275154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:29:36.275520 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:29:36.283667 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:29:36.284792 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:29:36.286980 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:29:36.287850 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:29:36.288240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:29:36.359497 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:423ba3ed-0083-45fc-bb28-12e86676d681&page=queryresults
[0m02:29:36.360894 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:423ba3ed-0083-45fc-bb28-12e86676d681&page=queryresults
[0m02:29:36.362538 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:af1312fe-c08b-4da1-a4cf-249aa778a746&page=queryresults
[0m02:29:36.363041 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:af1312fe-c08b-4da1-a4cf-249aa778a746&page=queryresults
[0m02:29:36.373332 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m02:29:36.377568 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m02:29:36.376625 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_  [[31mERROR[0m in 2.37s]
[0m02:29:36.378478 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_  [[31mERROR[0m in 2.41s]
[0m02:29:36.379379 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m02:29:36.380015 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m02:29:36.380762 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql.
[0m02:29:36.381338 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql.
[0m02:29:36.498971 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cd992f89-014b-49d2-ae57-2eacd32779d0&page=queryresults
[0m02:29:37.484952 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.51s]
[0m02:29:37.485828 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:29:38.200133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5656118d-6934-4f95-85ab-2703a3c78aaa&page=queryresults
[0m02:29:38.994646 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.72s]
[0m02:29:38.995518 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:29:38.997040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:29:38.998634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:38.998927 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:29:38.999209 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:29:38.999484 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:29:38.999758 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:29:39.000033 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:29:39.000311 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5' was properly closed.
[0m02:29:39.000594 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee' was properly closed.
[0m02:29:39.000912 [info ] [MainThread]: 
[0m02:29:39.001392 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m02:29:39.002847 [debug] [MainThread]: Command end result
[0m02:29:39.034554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:29:39.036703 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:29:39.043110 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:29:39.043641 [info ] [MainThread]: 
[0m02:29:39.044843 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:29:39.045835 [info ] [MainThread]: 
[0m02:29:39.046656 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)[0m
[0m02:29:39.047290 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m02:29:39.047797 [info ] [MainThread]: 
[0m02:29:39.048339 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m02:29:39.048821 [info ] [MainThread]: 
[0m02:29:39.049364 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)[0m
[0m02:29:39.049879 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m02:29:39.050542 [info ] [MainThread]: 
[0m02:29:39.051162 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m02:29:39.051611 [info ] [MainThread]: 
[0m02:29:39.052133 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)[0m
[0m02:29:39.052657 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m02:29:39.053118 [info ] [MainThread]: 
[0m02:29:39.053611 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m02:29:39.054057 [info ] [MainThread]: 
[0m02:29:39.054532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:29:39.055948 [debug] [MainThread]: Command `dbt test` failed at 02:29:39.055830 after 11.23 seconds
[0m02:29:39.056364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF1AF4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF96F23B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF96F23D80>]}
[0m02:29:39.056761 [debug] [MainThread]: Flushing usage events
[0m02:29:40.933769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:32:17.201920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC10202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC206BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC206B9D0>]}


============================== 02:32:17.206233 | 044734c9-3558-4d40-b719-c02f64588ff9 ==============================
[0m02:32:17.206233 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:32:17.206896 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:32:20.430354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '044734c9-3558-4d40-b719-c02f64588ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC137F6F0>]}
[0m02:32:20.505780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '044734c9-3558-4d40-b719-c02f64588ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE5AEB350>]}
[0m02:32:20.506444 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:32:21.217981 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:32:21.418755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:32:21.419482 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m02:32:21.888031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '044734c9-3558-4d40-b719-c02f64588ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE7188350>]}
[0m02:32:21.989189 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:32:21.991462 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:32:22.032282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '044734c9-3558-4d40-b719-c02f64588ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE75BB4D0>]}
[0m02:32:22.032969 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m02:32:22.034000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '044734c9-3558-4d40-b719-c02f64588ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE7266190>]}
[0m02:32:22.036495 [info ] [MainThread]: 
[0m02:32:22.037087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:32:22.037524 [info ] [MainThread]: 
[0m02:32:22.038128 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:32:22.042055 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:32:22.042365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:22.068468 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:32:22.069443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:22.070291 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:32:22.070598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:32:24.095586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '044734c9-3558-4d40-b719-c02f64588ff9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE758FC70>]}
[0m02:32:24.096065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:32:24.102640 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112
[0m02:32:24.103119 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d
[0m02:32:24.103543 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6
[0m02:32:24.104315 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:32:24.103983 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_  [RUN]
[0m02:32:24.106321 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112'
[0m02:32:24.106689 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112
[0m02:32:24.116270 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112"
[0m02:32:24.104814 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_  [RUN]
[0m02:32:24.105207 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_  [RUN]
[0m02:32:24.118096 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d'
[0m02:32:24.119470 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6'
[0m02:32:24.105746 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m02:32:24.120296 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d
[0m02:32:24.120824 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6
[0m02:32:24.121415 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m02:32:24.121875 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112
[0m02:32:24.126677 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d"
[0m02:32:24.130552 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6"
[0m02:32:24.131040 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:32:24.156756 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112"
[0m02:32:24.163290 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:32:24.164085 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d
[0m02:32:24.166939 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d"
[0m02:32:24.167813 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6
[0m02:32:24.170178 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6"
[0m02:32:24.170854 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:32:24.171307 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (CAST(COALESCE(product_price_usd, 0) AS FLOAT64) >= 0))


  
  
      
    ) dbt_internal_test
[0m02:32:24.173644 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m02:32:24.174194 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (CAST(COALESCE(revenue_usd, 0) AS FLOAT64) >= 0))


  
  
      
    ) dbt_internal_test
[0m02:32:24.174689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:32:24.175203 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (CAST(COALESCE(revenue_local, 0) AS FLOAT64) >= 0))


  
  
      
    ) dbt_internal_test
[0m02:32:24.175788 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:32:24.176381 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:32:24.229905 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:24.230374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:32:26.326956 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7fe3e055-b955-49ed-9da0-83c8ef3c4d88&page=queryresults
[0m02:32:26.327453 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7fe3e055-b955-49ed-9da0-83c8ef3c4d88&page=queryresults
[0m02:32:26.335686 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a5b510fd-bcbd-47dd-8584-0e0768f1b63c&page=queryresults
[0m02:32:26.336192 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a5b510fd-bcbd-47dd-8584-0e0768f1b63c&page=queryresults
[0m02:32:26.339762 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql
[0m02:32:26.340910 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_  [[31mERROR[0m in 2.23s]
[0m02:32:26.345876 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112
[0m02:32:26.346323 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:32:26.347369 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql.
[0m02:32:26.346719 [info ] [Thread-3 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m02:32:26.349089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.186a70c112, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m02:32:26.349750 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:32:26.357628 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:32:26.361122 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql
[0m02:32:26.361644 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_  [[31mERROR[0m in 2.24s]
[0m02:32:26.362579 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6
[0m02:32:26.363553 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql.
[0m02:32:26.364469 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:32:26.367241 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m02:32:26.368781 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:32:26.371055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:32:26.425742 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4d82e617-48d2-4bb1-b3c4-e85ff1a82f6a&page=queryresults
[0m02:32:26.435613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8dd9de7-0fd7-4ac4-9938-01d8cac11dfa&page=queryresults
[0m02:32:26.436114 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8dd9de7-0fd7-4ac4-9938-01d8cac11dfa&page=queryresults
[0m02:32:26.442649 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql
[0m02:32:26.443137 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_  [[31mERROR[0m in 2.33s]
[0m02:32:26.443908 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d
[0m02:32:26.444660 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql.
[0m02:32:27.421306 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.30s]
[0m02:32:27.422245 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m02:32:28.094899 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4e617ecd-8370-42be-905d-bf8555d87513&page=queryresults
[0m02:32:28.910291 [info ] [Thread-3 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.56s]
[0m02:32:28.911113 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m02:32:28.912729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:32:28.914336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:32:28.914616 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:32:28.914877 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:32:28.915132 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:32:28.915385 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m02:32:28.915644 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.7d593ae59d' was properly closed.
[0m02:32:28.915903 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.6a7bd837e6' was properly closed.
[0m02:32:28.916161 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m02:32:28.916685 [info ] [MainThread]: 
[0m02:32:28.917415 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m02:32:28.919168 [debug] [MainThread]: Command end result
[0m02:32:28.949649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:32:28.952856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:32:28.961141 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:32:28.961477 [info ] [MainThread]: 
[0m02:32:28.962019 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m02:32:28.962481 [info ] [MainThread]: 
[0m02:32:28.963051 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)[0m
[0m02:32:28.963636 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql
[0m02:32:28.964103 [info ] [MainThread]: 
[0m02:32:28.964606 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql
[0m02:32:28.965053 [info ] [MainThread]: 
[0m02:32:28.965563 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)[0m
[0m02:32:28.966086 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql
[0m02:32:28.966781 [info ] [MainThread]: 
[0m02:32:28.967676 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql
[0m02:32:28.968515 [info ] [MainThread]: 
[0m02:32:28.969232 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)[0m
[0m02:32:28.969779 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql
[0m02:32:28.970303 [info ] [MainThread]: 
[0m02:32:28.970999 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql
[0m02:32:28.972053 [info ] [MainThread]: 
[0m02:32:28.972854 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m02:32:28.974071 [debug] [MainThread]: Command `dbt test` failed at 02:32:28.973935 after 11.94 seconds
[0m02:32:28.974460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDC2040590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE75A4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDE75A4EC0>]}
[0m02:32:28.974810 [debug] [MainThread]: Flushing usage events
[0m02:32:30.400031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:44.502177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BB1002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BC14BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BC14B9D0>]}


============================== 12:38:44.508794 | 222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7 ==============================
[0m12:38:44.508794 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:38:44.509972 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:38:51.468456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BB45F6F0>]}
[0m12:38:51.540668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DFB8B350>]}
[0m12:38:51.541385 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:38:52.411813 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:38:54.079684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:54.080538 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m12:38:54.559305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276E1235C50>]}
[0m12:38:54.666291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:38:54.681685 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:38:54.748714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276E1663A70>]}
[0m12:38:54.749339 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m12:38:54.749986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276E12FDFD0>]}
[0m12:38:54.753348 [info ] [MainThread]: 
[0m12:38:54.753934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:54.754488 [info ] [MainThread]: 
[0m12:38:54.755226 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:38:54.760298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:38:54.760729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:54.761802 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:38:54.762340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:54.763457 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:38:54.763870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:56.955735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '222d99dc-7f2e-4b5a-8322-e0f1a0fbb4d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276E162FC70>]}
[0m12:38:56.957746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:56.973613 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d
[0m12:38:56.974417 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:38:56.975153 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee
[0m12:38:56.976611 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb
[0m12:38:56.975921 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_  [RUN]
[0m12:38:56.977543 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m12:38:56.978155 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_  [RUN]
[0m12:38:56.980037 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d'
[0m12:38:56.980986 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m12:38:56.979049 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_  [RUN]
[0m12:38:56.982249 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee'
[0m12:38:56.982981 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d
[0m12:38:56.983798 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:38:56.984932 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb'
[0m12:38:56.985560 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee
[0m12:38:56.997354 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d"
[0m12:38:57.006306 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:38:57.006915 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb
[0m12:38:57.012147 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee"
[0m12:38:57.017610 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb"
[0m12:38:57.019252 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d
[0m12:38:57.048393 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d"
[0m12:38:57.048989 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:38:57.049917 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb
[0m12:38:57.053583 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:38:57.056341 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb"
[0m12:38:57.057222 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee
[0m12:38:57.058044 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (CAST(COALESCE(`product_price_usd`, 0) AS FLOAT64) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:38:57.060945 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee"
[0m12:38:57.061658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:38:57.062261 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m12:38:57.063223 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:38:57.063887 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (CAST(COALESCE(`revenue_usd`, 0) AS FLOAT64) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:38:57.064445 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:38:57.066226 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (CAST(COALESCE(`revenue_local`, 0) AS FLOAT64) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:38:57.097603 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:38:59.556643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8caa977f-e1eb-4b65-a784-d98abb85326f&page=queryresults
[0m12:38:59.559653 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ad6e0fc8-828b-4e30-b975-24b4f2012245&page=queryresults
[0m12:38:59.558983 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8caa977f-e1eb-4b65-a784-d98abb85326f&page=queryresults
[0m12:38:59.560257 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ad6e0fc8-828b-4e30-b975-24b4f2012245&page=queryresults
[0m12:38:59.592960 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7ff8841b-cd90-44b3-ba33-5e4f97d6c1f2&page=queryresults
[0m12:38:59.682849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e2e44b64-282e-4926-9576-1dbd1d08c458&page=queryresults
[0m12:38:59.683552 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e2e44b64-282e-4926-9576-1dbd1d08c458&page=queryresults
[0m12:38:59.743093 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql
[0m12:38:59.747083 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql
[0m12:38:59.751351 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql
[0m12:38:59.747800 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_  [[31mERROR[0m in 2.77s]
[0m12:38:59.753835 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee
[0m12:38:59.754399 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:38:59.755096 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql.
[0m12:38:59.752147 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_  [[31mERROR[0m in 2.77s]
[0m12:38:59.757532 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d
[0m12:38:59.758307 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql.
[0m12:38:59.752962 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_  [[31mERROR[0m in 2.77s]
[0m12:38:59.759378 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb
[0m12:38:59.760115 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql.
[0m12:38:59.755633 [info ] [Thread-2 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m12:38:59.761095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_.2e91b0c5ee, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m12:38:59.761604 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:38:59.766674 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:38:59.768598 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:38:59.772661 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:38:59.773824 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m12:38:59.774347 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:01.593643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c73aeacc-4f36-4db6-8754-4411fb7dce82&page=queryresults
[0m12:39:02.779748 [info ] [Thread-2 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.02s]
[0m12:39:02.782092 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:39:02.812385 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 5.83s]
[0m12:39:02.814286 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:39:02.817436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:02.821111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:02.821854 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:39:02.822513 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:39:02.823167 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:39:02.823818 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_.9c3f9c588d' was properly closed.
[0m12:39:02.824486 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m12:39:02.825128 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m12:39:02.825763 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_.1d9f4739cb' was properly closed.
[0m12:39:02.826516 [info ] [MainThread]: 
[0m12:39:02.827542 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m12:39:02.831451 [debug] [MainThread]: Command end result
[0m12:39:02.884592 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:39:02.887651 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:39:02.896361 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:39:02.896804 [info ] [MainThread]: 
[0m12:39:02.897494 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:39:02.898106 [info ] [MainThread]: 
[0m12:39:02.898822 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)[0m
[0m12:39:02.899808 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___CAST_COALESCE_revenue_local_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql
[0m12:39:02.900889 [info ] [MainThread]: 
[0m12:39:02.901658 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b1fde5c9af471f35a5609c6d04c29015.sql
[0m12:39:02.902203 [info ] [MainThread]: 
[0m12:39:02.902924 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)[0m
[0m12:39:02.903668 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___CAST_COALESCE_product_price_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql
[0m12:39:02.904322 [info ] [MainThread]: 
[0m12:39:02.905057 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_535d23bec8b1145e6a95ba14f464819b.sql
[0m12:39:02.905742 [info ] [MainThread]: 
[0m12:39:02.906452 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)[0m
[0m12:39:02.907227 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___CAST_COALESCE_revenue_usd_0_AS_FLOAT64_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql
[0m12:39:02.908012 [info ] [MainThread]: 
[0m12:39:02.908704 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_ea93951f0d829489903f5f00796d9603.sql
[0m12:39:02.909327 [info ] [MainThread]: 
[0m12:39:02.909977 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m12:39:02.911386 [debug] [MainThread]: Command `dbt test` failed at 12:39:02.911245 after 18.59 seconds
[0m12:39:02.911955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276BC120590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276E164CC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276E164FB70>]}
[0m12:39:02.912420 [debug] [MainThread]: Flushing usage events
[0m12:39:04.818687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:28.010316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AB9702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC9BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC9BB9D0>]}


============================== 12:46:28.016496 | 45cb7075-164e-40b6-bcf8-181d976e2550 ==============================
[0m12:46:28.016496 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:46:28.017492 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:46:32.485649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45cb7075-164e-40b6-bcf8-181d976e2550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ABCD36F0>]}
[0m12:46:32.583590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45cb7075-164e-40b6-bcf8-181d976e2550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D03FB350>]}
[0m12:46:32.584509 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:46:33.625284 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:46:33.943235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:33.944309 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m12:46:34.626471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45cb7075-164e-40b6-bcf8-181d976e2550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D1A99C50>]}
[0m12:46:34.788336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:46:34.792145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:46:34.847627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45cb7075-164e-40b6-bcf8-181d976e2550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D1CFFA70>]}
[0m12:46:34.848441 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m12:46:34.849164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45cb7075-164e-40b6-bcf8-181d976e2550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D1B71FD0>]}
[0m12:46:34.851818 [info ] [MainThread]: 
[0m12:46:34.852472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:46:34.853085 [info ] [MainThread]: 
[0m12:46:34.853920 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:46:34.860419 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:46:34.861455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:34.862235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:46:34.863182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:34.863825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:46:34.864575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:37.546460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45cb7075-164e-40b6-bcf8-181d976e2550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D1EABE10>]}
[0m12:46:37.547149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:37.555761 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:46:37.556445 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:46:37.557049 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:46:37.558237 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:46:37.557687 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_  [RUN]
[0m12:46:37.558935 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_  [RUN]
[0m12:46:37.561441 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8'
[0m12:46:37.562286 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5'
[0m12:46:37.562951 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:46:37.559730 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_  [RUN]
[0m12:46:37.563800 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:46:37.560382 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m12:46:37.577907 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"
[0m12:46:37.578707 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee'
[0m12:46:37.580460 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m12:46:37.586114 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"
[0m12:46:37.587338 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:46:37.588025 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:46:37.594707 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"
[0m12:46:37.595348 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:46:37.608196 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:46:37.617650 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:46:37.640732 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"
[0m12:46:37.644576 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"
[0m12:46:37.645162 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:46:37.648589 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"
[0m12:46:37.649777 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (COALESCE(revenue_local, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:46:37.650834 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (COALESCE(product_price_usd, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:46:37.651909 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:46:37.653055 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:46:37.653878 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (COALESCE(revenue_usd, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:46:37.654565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:37.658052 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:46:37.658920 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:46:37.777385 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m12:46:37.778065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:46:40.487119 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c46052c2-66dc-4006-af23-f695aab52533&page=queryresults
[0m12:46:40.488769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:44467107-5211-4007-8f1f-39035bf637f8&page=queryresults
[0m12:46:40.488011 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c46052c2-66dc-4006-af23-f695aab52533&page=queryresults
[0m12:46:40.489725 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:44467107-5211-4007-8f1f-39035bf637f8&page=queryresults
[0m12:46:40.515111 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m12:46:40.517427 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m12:46:40.516412 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_  [[31mERROR[0m in 2.95s]
[0m12:46:40.519361 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:46:40.520019 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:46:40.518441 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_  [[31mERROR[0m in 2.96s]
[0m12:46:40.521926 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql.
[0m12:46:40.522930 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:46:40.521042 [info ] [Thread-2 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m12:46:40.525314 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql.
[0m12:46:40.526422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m12:46:40.527279 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:46:40.532714 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:46:40.534031 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:46:40.538233 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:46:40.539625 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m12:46:40.540304 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:46:40.580562 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4a43800f-188c-4979-a317-7ed2db7b60d8&page=queryresults
[0m12:46:40.581967 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4a43800f-188c-4979-a317-7ed2db7b60d8&page=queryresults
[0m12:46:40.590196 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:69d09faf-34ad-42c3-90b8-9681305a2329&page=queryresults
[0m12:46:40.597090 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m12:46:40.597949 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_  [[31mERROR[0m in 3.02s]
[0m12:46:40.599142 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:46:40.600070 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql.
[0m12:46:41.605271 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 4.02s]
[0m12:46:41.606507 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:46:42.751975 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aa1d66f9-f0a0-4c41-a9a6-27127a8ce10b&page=queryresults
[0m12:46:43.663025 [info ] [Thread-2 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.14s]
[0m12:46:43.664297 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:46:43.666559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:43.669142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:43.669632 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:46:43.670115 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:46:43.670569 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:46:43.671009 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8' was properly closed.
[0m12:46:43.671442 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m12:46:43.671873 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee' was properly closed.
[0m12:46:43.672307 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m12:46:43.672783 [info ] [MainThread]: 
[0m12:46:43.673474 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.82 seconds (8.82s).
[0m12:46:43.675983 [debug] [MainThread]: Command end result
[0m12:46:43.721666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:46:43.724901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:46:43.734587 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:46:43.735192 [info ] [MainThread]: 
[0m12:46:43.736222 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:46:43.737078 [info ] [MainThread]: 
[0m12:46:43.737968 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)[0m
[0m12:46:43.738819 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m12:46:43.739548 [info ] [MainThread]: 
[0m12:46:43.740353 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m12:46:43.741148 [info ] [MainThread]: 
[0m12:46:43.742034 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)[0m
[0m12:46:43.742902 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m12:46:43.743656 [info ] [MainThread]: 
[0m12:46:43.744464 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m12:46:43.745173 [info ] [MainThread]: 
[0m12:46:43.745992 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)[0m
[0m12:46:43.746832 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m12:46:43.747855 [info ] [MainThread]: 
[0m12:46:43.749186 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m12:46:43.749994 [info ] [MainThread]: 
[0m12:46:43.750733 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m12:46:43.752450 [debug] [MainThread]: Command `dbt test` failed at 12:46:43.752260 after 16.00 seconds
[0m12:46:43.753030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288AC990590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D1EBABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D1EB92E0>]}
[0m12:46:43.753603 [debug] [MainThread]: Flushing usage events
[0m12:46:46.102934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:44.106071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128F58402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128F688BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128F688B9D0>]}


============================== 12:51:44.112297 | 42c5a928-5412-4446-9782-a44233545060 ==============================
[0m12:51:44.112297 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:51:44.113272 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:51:48.529294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c5a928-5412-4446-9782-a44233545060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128F5B9F6F0>]}
[0m12:51:48.627268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c5a928-5412-4446-9782-a44233545060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289A2EB350>]}
[0m12:51:48.628204 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:51:49.663204 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:51:49.975809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:51:49.976319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:51:50.053791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c5a928-5412-4446-9782-a44233545060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289A378B50>]}
[0m12:51:50.214937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:51:50.218468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:51:50.276179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c5a928-5412-4446-9782-a44233545060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289BB4EB70>]}
[0m12:51:50.276826 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m12:51:50.277589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c5a928-5412-4446-9782-a44233545060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289BB426D0>]}
[0m12:51:50.280326 [info ] [MainThread]: 
[0m12:51:50.281003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:50.281640 [info ] [MainThread]: 
[0m12:51:50.282513 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:51:50.288600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:51:50.289279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:50.289936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:51:50.290771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:50.331427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:51:50.331983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:52.879870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c5a928-5412-4446-9782-a44233545060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289BAE7AD0>]}
[0m12:51:52.881237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:52.894346 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:51:52.895024 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:51:52.895669 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:51:52.896298 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:51:52.896955 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_  [RUN]
[0m12:51:52.897583 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m12:51:52.900158 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8'
[0m12:51:52.898403 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_  [RUN]
[0m12:51:52.901218 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m12:51:52.901973 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:51:52.899086 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_  [RUN]
[0m12:51:52.903151 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5'
[0m12:51:52.904016 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:51:52.933048 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"
[0m12:51:52.933981 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee'
[0m12:51:52.934647 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:51:52.945512 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:51:52.946445 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:51:52.953293 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"
[0m12:51:52.962306 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"
[0m12:51:52.963249 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:51:52.969947 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:51:53.015537 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:51:53.021064 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"
[0m12:51:53.022164 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:51:53.022988 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:51:53.026295 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"
[0m12:51:53.027112 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd (COALESCE(product_price_usd, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:51:53.032645 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"
[0m12:51:53.033524 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m12:51:53.034256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:53.035186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:51:53.036118 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd (COALESCE(revenue_usd, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:51:53.075856 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local (COALESCE(revenue_local, 0) >= 0))


  
  
      
    ) dbt_internal_test
[0m12:51:53.076807 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:51:53.078248 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:51:55.864401 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0f02752d-7aaf-49cb-ad2d-3c0ddf9ae387&page=queryresults
[0m12:51:55.866516 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0f02752d-7aaf-49cb-ad2d-3c0ddf9ae387&page=queryresults
[0m12:51:55.908017 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m12:51:55.910061 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_  [[31mERROR[0m in 3.01s]
[0m12:51:55.912731 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5
[0m12:51:55.914048 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:51:55.916163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5e649a2d-a426-4b43-a8da-5303bedb6865&page=queryresults
[0m12:51:55.914942 [info ] [Thread-2 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m12:51:55.917776 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql.
[0m12:51:55.919775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_.9a07e4dda5, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m12:51:55.918812 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5e649a2d-a426-4b43-a8da-5303bedb6865&page=queryresults
[0m12:51:55.922267 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:51:55.935286 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:51:55.940492 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:51:55.944348 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:51:55.945451 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m12:51:55.946475 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_  [[31mERROR[0m in 3.05s]
[0m12:51:55.947681 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8
[0m12:51:55.948339 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m12:51:55.949289 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql.
[0m12:51:55.949945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:51:55.994148 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f800ad92-c489-48db-a9fe-ea77eed42652&page=queryresults
[0m12:51:56.032326 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9fe5fc94-e67a-44f1-bb14-591a1c1b3379&page=queryresults
[0m12:51:56.033089 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9fe5fc94-e67a-44f1-bb14-591a1c1b3379&page=queryresults
[0m12:51:56.043744 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m12:51:56.044549 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_  [[31mERROR[0m in 3.11s]
[0m12:51:56.045692 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee
[0m12:51:56.046541 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql.
[0m12:51:57.061905 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 4.16s]
[0m12:51:57.063148 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:51:58.206881 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:69b92d4d-133d-4753-a207-34304210bf3f&page=queryresults
[0m12:51:59.106674 [info ] [Thread-2 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.19s]
[0m12:51:59.109958 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:51:59.115043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:59.122884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:59.124239 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:51:59.125639 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:51:59.126829 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:51:59.128197 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_.1e0faf49d8' was properly closed.
[0m12:51:59.129444 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m12:51:59.130651 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m12:51:59.131852 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_.70f72679ee' was properly closed.
[0m12:51:59.133215 [info ] [MainThread]: 
[0m12:51:59.135061 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.85 seconds (8.85s).
[0m12:51:59.141796 [debug] [MainThread]: Command end result
[0m12:51:59.194316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:51:59.197652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:51:59.207889 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:51:59.208396 [info ] [MainThread]: 
[0m12:51:59.209177 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:51:59.209859 [info ] [MainThread]: 
[0m12:51:59.210665 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)[0m
[0m12:51:59.211528 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local___COALESCE_revenue_local_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_local at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m12:51:59.212246 [info ] [MainThread]: 
[0m12:51:59.213016 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_5867bc8f322b06b98c84c827514cf19c.sql
[0m12:51:59.213714 [info ] [MainThread]: 
[0m12:51:59.214504 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)[0m
[0m12:51:59.215502 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd___COALESCE_product_price_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: product_price_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m12:51:59.216379 [info ] [MainThread]: 
[0m12:51:59.217170 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_8439890ce159a610bfa6962d19960fad.sql
[0m12:51:59.217865 [info ] [MainThread]: 
[0m12:51:59.218662 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)[0m
[0m12:51:59.219510 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd___COALESCE_revenue_usd_0_0_ (models\mart\mart_models.yml)
  Function not found: revenue_usd at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m12:51:59.220516 [info ] [MainThread]: 
[0m12:51:59.221457 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_b56bb7bcb0342d743d093d4f913de63e.sql
[0m12:51:59.222306 [info ] [MainThread]: 
[0m12:51:59.223431 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m12:51:59.225056 [debug] [MainThread]: Command `dbt test` failed at 12:51:59.224869 after 15.38 seconds
[0m12:51:59.225634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000128F6860590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289BBCBB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001289BBCBD80>]}
[0m12:51:59.226185 [debug] [MainThread]: Flushing usage events
[0m12:52:02.911114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:45.727148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9A7202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9B76BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9B76B9D0>]}


============================== 12:53:45.731986 | 8c00dac6-2e48-4e5b-812e-540150cdb0dd ==============================
[0m12:53:45.731986 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:53:45.732763 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m12:53:49.006502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c00dac6-2e48-4e5b-812e-540150cdb0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9AA836F0>]}
[0m12:53:49.068905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c00dac6-2e48-4e5b-812e-540150cdb0dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACBF19B350>]}
[0m12:53:49.069537 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:53:49.731141 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:53:49.859773 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ga_retail_project: mart\mart_models.yml - Runtime Error
    Contents of file 'models\mart\mart_models.yml' are not valid. Dictionary expected.
[0m12:53:49.861392 [debug] [MainThread]: Command `dbt test` failed at 12:53:49.861242 after 4.32 seconds
[0m12:53:49.861839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC0839350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC0839050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC08449B0>]}
[0m12:53:49.862287 [debug] [MainThread]: Flushing usage events
[0m12:53:52.080779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:24.916070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260035D02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600461BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600461B9D0>]}


============================== 12:54:24.921221 | e580d935-9a7b-48cf-9939-0eff6e0ab858 ==============================
[0m12:54:24.921221 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:54:24.922073 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select test_non_negative_values', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m12:54:28.441462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e580d935-9a7b-48cf-9939-0eff6e0ab858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600392F6F0>]}
[0m12:54:28.506404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e580d935-9a7b-48cf-9939-0eff6e0ab858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602805B350>]}
[0m12:54:28.507044 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:54:29.272482 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:54:29.399418 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ga_retail_project: mart\mart_models.yml - Runtime Error
    Contents of file 'models\mart\mart_models.yml' are not valid. Dictionary expected.
[0m12:54:29.400760 [debug] [MainThread]: Command `dbt test` failed at 12:54:29.400640 after 4.62 seconds
[0m12:54:29.401118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026029705350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026029705050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260296BC9B0>]}
[0m12:54:29.401468 [debug] [MainThread]: Flushing usage events
[0m12:54:30.549452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:33.984023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BD8A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BE8EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BE8EB9D0>]}


============================== 12:55:33.988876 | 72232981-7b8d-4d96-83c4-a68679c8a5c8 ==============================
[0m12:55:33.988876 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:55:33.989657 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select test_non_negative_values', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:55:37.251461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72232981-7b8d-4d96-83c4-a68679c8a5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BDBFF6F0>]}
[0m12:55:37.315826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72232981-7b8d-4d96-83c4-a68679c8a5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E233B350>]}
[0m12:55:37.316507 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:55:37.982702 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:55:38.196760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:55:38.197330 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\test_non_negative_values.sql
[0m12:55:38.197871 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m12:55:38.698687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72232981-7b8d-4d96-83c4-a68679c8a5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E39CF050>]}
[0m12:55:38.801527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:55:38.803778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:55:38.846860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72232981-7b8d-4d96-83c4-a68679c8a5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E3E917C0>]}
[0m12:55:38.847338 [info ] [MainThread]: Found 5 models, 25 data tests, 2 sources, 612 macros
[0m12:55:38.847894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72232981-7b8d-4d96-83c4-a68679c8a5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E3E4D390>]}
[0m12:55:38.849619 [info ] [MainThread]: 
[0m12:55:38.850163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:38.850700 [info ] [MainThread]: 
[0m12:55:38.851355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:55:38.855780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:55:38.856167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:38.885962 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:55:38.886416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:38.915742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:55:38.916160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:40.833366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72232981-7b8d-4d96-83c4-a68679c8a5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E3E8FE10>]}
[0m12:55:40.834139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:40.842861 [debug] [Thread-1 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m12:55:40.843447 [info ] [Thread-1 (]: 1 of 1 START test test_non_negative_values ..................................... [RUN]
[0m12:55:40.844347 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values'
[0m12:55:40.844811 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m12:55:40.856654 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m12:55:40.858502 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m12:55:40.887831 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m12:55:40.889469 [debug] [Thread-1 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m12:55:40.890074 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:42.903495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:641f081a-56c2-4516-8418-73de0a2d2f1a&page=queryresults
[0m12:55:43.881776 [info ] [Thread-1 (]: 1 of 1 PASS test_non_negative_values ........................................... [[32mPASS[0m in 3.04s]
[0m12:55:43.882930 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m12:55:43.884728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:43.886906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:43.887400 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:55:43.887862 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:55:43.888276 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:55:43.888724 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m12:55:43.889459 [info ] [MainThread]: 
[0m12:55:43.890105 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m12:55:43.891269 [debug] [MainThread]: Command end result
[0m12:55:43.929272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:55:43.931804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:55:43.938887 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:55:43.939267 [info ] [MainThread]: 
[0m12:55:43.939953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:43.940485 [info ] [MainThread]: 
[0m12:55:43.941094 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:55:43.942335 [debug] [MainThread]: Command `dbt test` succeeded at 12:55:43.942204 after 10.10 seconds
[0m12:55:43.942754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BE8B4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E3ECBAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217E3ECBC20>]}
[0m12:55:43.943182 [debug] [MainThread]: Flushing usage events
[0m12:55:45.272691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:19.937933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED53F902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED54FDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED54FDB9D0>]}


============================== 12:58:19.944311 | 31e64882-f95b-4345-a278-a5973cf2da55 ==============================
[0m12:58:19.944311 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:58:19.945277 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m12:58:24.327123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31e64882-f95b-4345-a278-a5973cf2da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED542F36F0>]}
[0m12:58:24.426555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31e64882-f95b-4345-a278-a5973cf2da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED78A3B350>]}
[0m12:58:24.427472 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:58:25.458751 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:58:25.769376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:25.769884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:25.847486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31e64882-f95b-4345-a278-a5973cf2da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED78AC8B50>]}
[0m12:58:26.007242 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:58:26.010555 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:58:26.067754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31e64882-f95b-4345-a278-a5973cf2da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED7A29EB70>]}
[0m12:58:26.068443 [info ] [MainThread]: Found 5 models, 25 data tests, 2 sources, 612 macros
[0m12:58:26.069162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e64882-f95b-4345-a278-a5973cf2da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED7A296510>]}
[0m12:58:26.071665 [info ] [MainThread]: 
[0m12:58:26.072347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:58:26.073006 [info ] [MainThread]: 
[0m12:58:26.073892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:58:26.080442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:58:26.081189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:26.081961 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:58:26.082455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:26.121858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:58:26.123070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:28.591046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31e64882-f95b-4345-a278-a5973cf2da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED7A2ABBA0>]}
[0m12:58:28.591746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:28.600439 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:58:28.601112 [debug] [Thread-3 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m12:58:28.602288 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:58:28.601737 [info ] [Thread-1 (]: 1 of 3 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m12:58:28.602950 [info ] [Thread-3 (]: 3 of 3 START test test_non_negative_values ..................................... [RUN]
[0m12:58:28.604894 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m12:58:28.603946 [info ] [Thread-2 (]: 2 of 3 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m12:58:28.606033 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values'
[0m12:58:28.606687 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:58:28.607463 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m12:58:28.608089 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m12:58:28.635046 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:58:28.635760 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:58:28.640498 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m12:58:28.646462 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:58:28.647715 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:58:28.680189 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m12:58:28.681224 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m12:58:28.681841 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:58:28.685227 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m12:58:28.689013 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m12:58:28.690529 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:28.691732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:28.692576 [debug] [Thread-3 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m12:58:28.693223 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:58:28.737189 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:28.773151 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:58:31.452678 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:742863f2-d24f-4f76-ad10-835a032772fb&page=queryresults
[0m12:58:31.502229 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3fd740f5-474c-44c9-beb1-7cbc2f35eb98&page=queryresults
[0m12:58:31.592502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:10c0c46a-dd2d-4d9c-a386-e27c54565882&page=queryresults
[0m12:58:32.499691 [info ] [Thread-1 (]: 1 of 3 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.89s]
[0m12:58:32.501394 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m12:58:32.507931 [info ] [Thread-2 (]: 2 of 3 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.90s]
[0m12:58:32.509473 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m12:58:32.792979 [info ] [Thread-3 (]: 3 of 3 PASS test_non_negative_values ........................................... [[32mPASS[0m in 4.19s]
[0m12:58:32.796261 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m12:58:32.801391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:32.808954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:32.810279 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:58:32.811483 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:58:32.812411 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:58:32.813234 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m12:58:32.814084 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m12:58:32.814925 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m12:58:32.815875 [info ] [MainThread]: 
[0m12:58:32.817069 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m12:58:32.819624 [debug] [MainThread]: Command end result
[0m12:58:32.867508 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:58:32.870886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:58:32.881486 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:58:32.882003 [info ] [MainThread]: 
[0m12:58:32.882761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:32.883453 [info ] [MainThread]: 
[0m12:58:32.884176 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:58:32.885736 [debug] [MainThread]: Command `dbt test` succeeded at 12:58:32.885568 after 13.20 seconds
[0m12:58:32.886282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED54FB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED7A672C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED7A672DB0>]}
[0m12:58:32.886832 [debug] [MainThread]: Flushing usage events
[0m12:58:35.264875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:37.072131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED9DB502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED9EB9BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED9EB9B9D0>]}


============================== 13:03:37.078248 | b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e ==============================
[0m13:03:37.078248 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:03:37.079251 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:03:41.454227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED9DEAF6F0>]}
[0m13:03:41.552287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC25DB350>]}
[0m13:03:41.553209 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:03:42.579296 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:03:42.886828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:03:42.887877 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m13:03:43.563539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC3C79C50>]}
[0m13:03:43.714718 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:03:43.718259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:03:43.775506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC40A3A70>]}
[0m13:03:43.776161 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m13:03:43.776878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC3FAEEB0>]}
[0m13:03:43.779672 [info ] [MainThread]: 
[0m13:03:43.780394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:43.781105 [info ] [MainThread]: 
[0m13:03:43.782023 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:03:43.789464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:03:43.790234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:43.791057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:03:43.791831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:43.832789 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:03:43.834070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:46.361048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0d6d4ea-bce7-460d-92c7-e3e1a7d7273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC406FD40>]}
[0m13:03:46.361748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:46.370602 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5
[0m13:03:46.371267 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:03:46.371873 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:03:46.373063 [debug] [Thread-4 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m13:03:46.372501 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0  [RUN]
[0m13:03:46.373907 [info ] [Thread-3 (]: 3 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m13:03:46.376093 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5'
[0m13:03:46.376874 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m13:03:46.374497 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m13:03:46.377722 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5
[0m13:03:46.378411 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:03:46.379214 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m13:03:46.375295 [info ] [Thread-4 (]: 4 of 5 START test test_non_negative_values ..................................... [RUN]
[0m13:03:46.393491 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5"
[0m13:03:46.403654 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m13:03:46.404373 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:03:46.405174 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values'
[0m13:03:46.411658 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m13:03:46.412393 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m13:03:46.417127 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m13:03:46.418041 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5
[0m13:03:46.452887 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5"
[0m13:03:46.453706 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:03:46.454276 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:03:46.455027 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m13:03:46.458487 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m13:03:46.462073 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m13:03:46.465175 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m13:03:46.466124 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(transactions transactions >= 0)


  
  
      
    ) dbt_internal_test
[0m13:03:46.467334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:46.468257 [debug] [Thread-4 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m13:03:46.469010 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:03:46.469742 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:03:46.470383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:03:46.471057 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:03:46.471674 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:03:49.231922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:49c807e6-2657-4c67-b719-bc35f369e5cc&page=queryresults
[0m13:03:49.233954 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:49c807e6-2657-4c67-b719-bc35f369e5cc&page=queryresults
[0m13:03:49.267605 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "transactions" at [18:24]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_1acbd6b928debc4ed52c6af3ec04ae67.sql
[0m13:03:49.268834 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0  [[31mERROR[0m in 2.89s]
[0m13:03:49.270512 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5
[0m13:03:49.271423 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694
[0m13:03:49.272207 [info ] [Thread-1 (]: 5 of 5 START test unique_fct_sales_item_visit_id ............................... [RUN]
[0m13:03:49.273211 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "transactions" at [18:24]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_1acbd6b928debc4ed52c6af3ec04ae67.sql.
[0m13:03:49.280513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0.4e1d52b8e5, now test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694)
[0m13:03:49.282204 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694
[0m13:03:49.290764 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694"
[0m13:03:49.292167 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694
[0m13:03:49.296104 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694"
[0m13:03:49.297606 [debug] [Thread-1 (]: On test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:03:49.298248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:49.489341 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b7ede655-359a-4521-a202-f0c6da3f13d1&page=queryresults
[0m13:03:49.499151 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:edaec327-cb47-4d79-80fb-5b8ef01a24b7&page=queryresults
[0m13:03:49.629726 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cbfc7d3d-ac75-4b6e-8d0b-5056b266335c&page=queryresults
[0m13:03:50.478674 [info ] [Thread-3 (]: 3 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 4.10s]
[0m13:03:50.479977 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:03:50.533376 [info ] [Thread-4 (]: 4 of 5 PASS test_non_negative_values ........................................... [[32mPASS[0m in 4.13s]
[0m13:03:50.534651 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m13:03:50.543554 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 4.16s]
[0m13:03:50.544761 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:03:51.714601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:68e2ecaa-d20d-4c5b-aec5-28f6ab316638&page=queryresults
[0m13:03:52.624451 [error] [Thread-1 (]: 5 of 5 FAIL 1621 unique_fct_sales_item_visit_id ................................ [[31mFAIL 1621[0m in 3.34s]
[0m13:03:52.627713 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694
[0m13:03:52.632964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:52.639481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:52.641317 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:03:52.642533 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:03:52.643709 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:03:52.644881 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_fct_sales_item_visit_id.5b4ea3b694' was properly closed.
[0m13:03:52.646087 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m13:03:52.647271 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m13:03:52.648431 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m13:03:52.649775 [info ] [MainThread]: 
[0m13:03:52.651616 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.87 seconds (8.87s).
[0m13:03:52.657900 [debug] [MainThread]: Command end result
[0m13:03:52.720272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:03:52.723645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:03:52.733138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:03:52.733602 [info ] [MainThread]: 
[0m13:03:52.734358 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:03:52.735065 [info ] [MainThread]: 
[0m13:03:52.735866 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0 (models\mart\mart_models.yml)[0m
[0m13:03:52.736689 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_transactions__transactions_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "transactions" at [18:24]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_1acbd6b928debc4ed52c6af3ec04ae67.sql
[0m13:03:52.737416 [info ] [MainThread]: 
[0m13:03:52.738180 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_1acbd6b928debc4ed52c6af3ec04ae67.sql
[0m13:03:52.738885 [info ] [MainThread]: 
[0m13:03:52.739956 [error] [MainThread]: [31mFailure in test unique_fct_sales_item_visit_id (models\mart\mart_models.yml)[0m
[0m13:03:52.740769 [error] [MainThread]:   Got 1621 results, configured to fail if != 0
[0m13:03:52.741443 [info ] [MainThread]: 
[0m13:03:52.742207 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\unique_fct_sales_item_visit_id.sql
[0m13:03:52.742900 [info ] [MainThread]: 
[0m13:03:52.743610 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m13:03:52.745273 [debug] [MainThread]: Command `dbt test` failed at 13:03:52.745097 after 15.94 seconds
[0m13:03:52.745845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED9EB64650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC408FAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC408D020>]}
[0m13:03:52.746395 [debug] [MainThread]: Flushing usage events
[0m13:03:54.926044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:19.264197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E5F402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E6F8BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E6F8B9D0>]}


============================== 13:05:19.272865 | ae107db2-9537-4815-b2f8-471a460b24d9 ==============================
[0m13:05:19.272865 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:05:19.274595 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:05:22.806757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae107db2-9537-4815-b2f8-471a460b24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E62A36F0>]}
[0m13:05:22.869015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae107db2-9537-4815-b2f8-471a460b24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78A9EB350>]}
[0m13:05:22.869616 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:05:23.635082 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:05:23.866002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:23.866732 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m13:05:24.365287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae107db2-9537-4815-b2f8-471a460b24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78C089750>]}
[0m13:05:24.487096 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:05:24.490267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:05:24.549421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae107db2-9537-4815-b2f8-471a460b24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78C4BF5C0>]}
[0m13:05:24.549986 [info ] [MainThread]: Found 5 models, 26 data tests, 2 sources, 612 macros
[0m13:05:24.550589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae107db2-9537-4815-b2f8-471a460b24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78C3BF770>]}
[0m13:05:24.552985 [info ] [MainThread]: 
[0m13:05:24.553598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:05:24.554139 [info ] [MainThread]: 
[0m13:05:24.554817 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:05:24.559303 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:05:24.559873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:24.560359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:05:24.560962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:24.561562 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:05:24.561937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:26.631289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae107db2-9537-4815-b2f8-471a460b24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78C48BD40>]}
[0m13:05:26.631995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:26.639460 [debug] [Thread-4 (]: Began running node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m13:05:26.640026 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:05:26.640642 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:05:26.641108 [debug] [Thread-3 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m13:05:26.641571 [info ] [Thread-4 (]: 4 of 4 START test test_non_negative_values_fct_sales_item_ ..................... [RUN]
[0m13:05:26.642072 [info ] [Thread-2 (]: 2 of 4 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m13:05:26.643905 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122'
[0m13:05:26.644602 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m13:05:26.642680 [info ] [Thread-1 (]: 1 of 4 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m13:05:26.645227 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m13:05:26.645868 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:05:26.643163 [info ] [Thread-3 (]: 3 of 4 START test test_non_negative_values ..................................... [RUN]
[0m13:05:26.646828 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m13:05:26.674842 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m13:05:26.676161 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values'
[0m13:05:26.677175 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:05:26.678142 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m13:05:26.683552 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m13:05:26.686808 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m13:05:26.688354 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:05:26.690383 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m13:05:26.710078 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:05:26.723623 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:05:26.734714 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m13:05:26.737721 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m13:05:26.741841 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m13:05:26.745403 [debug] [Thread-3 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m13:05:26.746178 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:05:26.747538 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:05:26.748506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:26.749383 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:05:26.749976 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:05:26.866403 [debug] [Thread-4 (]: Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:05:26.867049 [error] [Thread-4 (]: 4 of 4 ERROR test_non_negative_values_fct_sales_item_ .......................... [[31mERROR[0m in 0.22s]
[0m13:05:26.867929 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m13:05:26.868480 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122' to be skipped because of status 'error'.  Reason: Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:05:28.960866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b50d93a1-7702-417f-a3ac-d2320f4ce1d8&page=queryresults
[0m13:05:29.033917 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d2dc42b-aa4b-4413-830f-f07271abe58a&page=queryresults
[0m13:05:29.036051 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef4b1996-6a9c-4f7a-8a76-cf4ea9dd2cf0&page=queryresults
[0m13:05:29.977928 [info ] [Thread-3 (]: 3 of 4 PASS test_non_negative_values ........................................... [[32mPASS[0m in 3.30s]
[0m13:05:29.979107 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m13:05:29.983189 [info ] [Thread-2 (]: 2 of 4 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.34s]
[0m13:05:29.984524 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:05:29.994459 [info ] [Thread-1 (]: 1 of 4 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.35s]
[0m13:05:29.995778 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:05:29.997773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:29.999932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:30.000313 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:05:30.000653 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:05:30.000994 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:05:30.001644 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122' was properly closed.
[0m13:05:30.002089 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m13:05:30.002434 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m13:05:30.002769 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m13:05:30.003169 [info ] [MainThread]: 
[0m13:05:30.003789 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m13:05:30.005356 [debug] [MainThread]: Command end result
[0m13:05:30.047752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:05:30.050671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:05:30.059839 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:05:30.060279 [info ] [MainThread]: 
[0m13:05:30.060895 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:05:30.061531 [info ] [MainThread]: 
[0m13:05:30.062249 [error] [MainThread]: [31mFailure in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)[0m
[0m13:05:30.063016 [error] [MainThread]:   Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:05:30.063761 [info ] [MainThread]: 
[0m13:05:30.064433 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m13:05:30.065810 [debug] [MainThread]: Command `dbt test` failed at 13:05:30.065667 after 11.02 seconds
[0m13:05:30.066261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7E6F60590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78C4B49F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B78C4B47E0>]}
[0m13:05:30.066756 [debug] [MainThread]: Flushing usage events
[0m13:05:32.192444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:30.834167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF76402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF868BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF868B9D0>]}


============================== 13:13:30.838920 | 12e8196c-1a51-489d-a54f-5950f81b4f46 ==============================
[0m13:13:30.838920 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:13:30.839677 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:13:34.390083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12e8196c-1a51-489d-a54f-5950f81b4f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF799F6F0>]}
[0m13:13:34.457843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12e8196c-1a51-489d-a54f-5950f81b4f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9C25B350>]}
[0m13:13:34.458817 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:13:35.136713 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:13:35.385248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:35.386067 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m13:13:35.858255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12e8196c-1a51-489d-a54f-5950f81b4f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9D8EDB50>]}
[0m13:13:35.974639 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:13:35.978522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:13:36.023745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12e8196c-1a51-489d-a54f-5950f81b4f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9DCB33E0>]}
[0m13:13:36.024441 [info ] [MainThread]: Found 5 models, 25 data tests, 2 sources, 612 macros
[0m13:13:36.025037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e8196c-1a51-489d-a54f-5950f81b4f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9DC2FBD0>]}
[0m13:13:36.027123 [info ] [MainThread]: 
[0m13:13:36.027792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:36.028353 [info ] [MainThread]: 
[0m13:13:36.029004 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:13:36.034040 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:13:36.034685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:36.035184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:13:36.035968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:36.036628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:13:36.037323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:38.086306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e8196c-1a51-489d-a54f-5950f81b4f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9DCEBEE0>]}
[0m13:13:38.087527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:38.096783 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:13:38.097395 [debug] [Thread-3 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m13:13:38.097921 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:13:38.098558 [info ] [Thread-2 (]: 2 of 3 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m13:13:38.100957 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m13:13:38.099290 [info ] [Thread-3 (]: 3 of 3 START test test_non_negative_values ..................................... [RUN]
[0m13:13:38.101713 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:13:38.102666 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values'
[0m13:13:38.099923 [info ] [Thread-1 (]: 1 of 3 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m13:13:38.128260 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m13:13:38.128741 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m13:13:38.129430 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m13:13:38.133400 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m13:13:38.134159 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:13:38.144004 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m13:13:38.145458 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:13:38.160549 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m13:13:38.189645 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m13:13:38.191615 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m13:13:38.192971 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:13:38.196442 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m13:13:38.197588 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:38.198286 [debug] [Thread-3 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m13:13:38.198803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:38.199420 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:38.202797 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:38.203550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:40.701454 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2f099528-ee20-4723-b2aa-7c6d644e4852&page=queryresults
[0m13:13:40.703943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:346a18c1-6897-4d53-9513-487b38e531bc&page=queryresults
[0m13:13:40.706206 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:68fe6a93-b779-40da-87f2-e90d48e6bddf&page=queryresults
[0m13:13:41.691252 [info ] [Thread-1 (]: 1 of 3 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.56s]
[0m13:13:41.700158 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m13:13:41.704339 [info ] [Thread-3 (]: 3 of 3 PASS test_non_negative_values ........................................... [[32mPASS[0m in 3.60s]
[0m13:13:41.706932 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m13:13:41.859333 [info ] [Thread-2 (]: 2 of 3 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.76s]
[0m13:13:41.861417 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m13:13:41.864983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:41.870454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:41.871430 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:13:41.872358 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:13:41.873257 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:13:41.874170 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m13:13:41.875067 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m13:13:41.876068 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m13:13:41.877557 [info ] [MainThread]: 
[0m13:13:41.879511 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m13:13:41.885915 [debug] [MainThread]: Command end result
[0m13:13:41.953878 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:13:41.956557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:13:41.964838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:13:41.965240 [info ] [MainThread]: 
[0m13:13:41.965858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:41.966498 [info ] [MainThread]: 
[0m13:13:41.967054 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:13:41.968245 [debug] [MainThread]: Command `dbt test` succeeded at 13:13:41.968121 after 11.33 seconds
[0m13:13:41.968646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DF8654650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9DCBE200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D9DCBCAA0>]}
[0m13:13:41.969045 [debug] [MainThread]: Flushing usage events
[0m13:13:43.396408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:23:58.611686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD02102F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD125BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD125B9D0>]}


============================== 22:23:58.617920 | 4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9 ==============================
[0m22:23:58.617920 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:23:58.618988 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m22:24:05.495806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD05736F0>]}
[0m22:24:05.567222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF4C8B350>]}
[0m22:24:05.567904 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:24:06.492989 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m22:24:08.423790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:08.424189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:08.478001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF5CE8B50>]}
[0m22:24:08.588495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:24:08.605836 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:24:08.662212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF64EEB70>]}
[0m22:24:08.662745 [info ] [MainThread]: Found 5 models, 25 data tests, 2 sources, 612 macros
[0m22:24:08.663309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF64E2510>]}
[0m22:24:08.666588 [info ] [MainThread]: 
[0m22:24:08.667131 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:24:08.667631 [info ] [MainThread]: 
[0m22:24:08.668334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:24:08.673480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m22:24:08.674437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:08.675151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m22:24:08.675796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:08.676380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m22:24:08.676736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:10.888714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a4b8e0a-e535-44b3-a2bf-b96d4f1e0fa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF64FB790>]}
[0m22:24:10.889205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:10.900351 [debug] [Thread-4 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:24:10.901049 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m22:24:10.901484 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m22:24:10.902568 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:24:10.902027 [info ] [Thread-4 (]: 4 of 25 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [RUN]
[0m22:24:10.902992 [info ] [Thread-2 (]: 2 of 25 START test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [RUN]
[0m22:24:10.904866 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91'
[0m22:24:10.903547 [info ] [Thread-1 (]: 1 of 25 START test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m22:24:10.905805 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e'
[0m22:24:10.906330 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:24:10.904209 [info ] [Thread-3 (]: 3 of 25 START test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0  [RUN]
[0m22:24:10.907084 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0'
[0m22:24:10.907656 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m22:24:10.934629 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76'
[0m22:24:10.935536 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m22:24:10.936114 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m22:24:10.941278 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"
[0m22:24:10.941803 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:24:10.946945 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"
[0m22:24:10.953669 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76"
[0m22:24:10.954956 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:24:10.978185 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m22:24:10.978919 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m22:24:10.981333 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"
[0m22:24:10.982303 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:24:10.982978 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m22:24:10.987976 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76"
[0m22:24:10.990416 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"
[0m22:24:10.991178 [debug] [Thread-4 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m22:24:10.991933 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m22:24:10.992428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:24:10.992960 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:11.051376 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`

where not(product_price_usd product_price_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m22:24:11.051958 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:24:11.081486 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`

where not(revenue_usd revenue_usd >= 0 or revenue_usd is null)


  
  
      
    ) dbt_internal_test
[0m22:24:11.082125 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:24:13.244507 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:63614a66-e588-46bc-ba4c-bbc6a00f785f&page=queryresults
[0m22:24:13.245099 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:63614a66-e588-46bc-ba4c-bbc6a00f785f&page=queryresults
[0m22:24:13.246174 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d2466b9c-1514-4eb2-b79c-1700f684baf5&page=queryresults
[0m22:24:13.248228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c06460be-3f0f-428a-b832-847393793112&page=queryresults
[0m22:24:13.246666 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d2466b9c-1514-4eb2-b79c-1700f684baf5&page=queryresults
[0m22:24:13.248716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c06460be-3f0f-428a-b832-847393793112&page=queryresults
[0m22:24:13.264097 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f830ed70-933d-4b2b-8817-bbf7bbb86f4b&page=queryresults
[0m22:24:13.265134 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f830ed70-933d-4b2b-8817-bbf7bbb86f4b&page=queryresults
[0m22:24:13.400446 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m22:24:13.404473 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m22:24:13.408214 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m22:24:13.412529 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql
[0m22:24:13.408925 [error] [Thread-2 (]: 2 of 25 ERROR dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [[31mERROR[0m in 2.50s]
[0m22:24:13.413380 [error] [Thread-1 (]: 1 of 25 ERROR dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.51s]
[0m22:24:13.414237 [error] [Thread-4 (]: 4 of 25 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.51s]
[0m22:24:13.415930 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m22:24:13.416760 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m22:24:13.414778 [error] [Thread-3 (]: 3 of 25 ERROR dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0  [[31mERROR[0m in 2.48s]
[0m22:24:13.417790 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:24:13.418411 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:24:13.418957 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e
[0m22:24:13.419577 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql.
[0m22:24:13.420317 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:24:13.420820 [debug] [Thread-4 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:24:13.423125 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql.
[0m22:24:13.421351 [info ] [Thread-2 (]: 5 of 25 START test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m22:24:13.423847 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:24:13.425039 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql.
[0m22:24:13.421839 [info ] [Thread-1 (]: 6 of 25 START test dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date  [RUN]
[0m22:24:13.425753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e, now test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce)
[0m22:24:13.427008 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql.
[0m22:24:13.424439 [info ] [Thread-4 (]: 7 of 25 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m22:24:13.427709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0, now test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e)
[0m22:24:13.428291 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:24:13.428908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91, now test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60)
[0m22:24:13.426343 [info ] [Thread-3 (]: 8 of 25 START test not_null_fct_sales_item_visit_id ............................ [RUN]
[0m22:24:13.429586 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e
[0m22:24:13.434847 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce"
[0m22:24:13.435434 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:24:13.435985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76, now test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d)
[0m22:24:13.447705 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e"
[0m22:24:13.453498 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:24:13.454070 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:24:13.461460 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:24:13.462131 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:24:13.464490 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce"
[0m22:24:13.465495 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e
[0m22:24:13.466809 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:24:13.469704 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:24:13.470278 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:24:13.472522 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:24:13.473209 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m22:24:13.473682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:13.475758 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e"
[0m22:24:13.504647 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:13.505521 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visit_id, product_sku, hit_date
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
    group by visit_id, product_sku, hit_date
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m22:24:13.506580 [debug] [Thread-4 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m22:24:13.507123 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:13.508103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:13.508600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:15.465044 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:99173e3d-a3ef-45c6-8117-46cde12adfec&page=queryresults
[0m22:24:15.465613 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:99173e3d-a3ef-45c6-8117-46cde12adfec&page=queryresults
[0m22:24:15.472464 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql
[0m22:24:15.473079 [error] [Thread-2 (]: 5 of 25 ERROR dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.05s]
[0m22:24:15.473955 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:24:15.474431 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:24:15.475562 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql.
[0m22:24:15.474865 [info ] [Thread-2 (]: 9 of 25 START test not_null_fct_sales_item_visitor_id .......................... [RUN]
[0m22:24:15.476713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m22:24:15.477408 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:24:15.482042 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:24:15.483337 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:24:15.486316 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:24:15.487672 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:15.488332 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:15.776180 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c44b211a-5796-4eac-89de-cab958039120&page=queryresults
[0m22:24:15.805920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a69a2401-acb4-4ab4-951c-b89d16771512&page=queryresults
[0m22:24:15.886450 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6b6a5fa2-4399-4754-8081-922d6aafafc7&page=queryresults
[0m22:24:17.487925 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c025e5b3-89af-4fbb-9a18-438f774ee20a&page=queryresults
[0m22:24:19.557731 [info ] [Thread-4 (]: 7 of 25 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 6.13s]
[0m22:24:19.561967 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:24:19.562399 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:24:19.560797 [info ] [Thread-3 (]: 8 of 25 PASS not_null_fct_sales_item_visit_id .................................. [[32mPASS[0m in 6.12s]
[0m22:24:19.564605 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:24:19.565395 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:24:19.562797 [info ] [Thread-4 (]: 10 of 25 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m22:24:19.569924 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m22:24:19.566149 [info ] [Thread-3 (]: 11 of 25 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m22:24:19.570862 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:24:19.569219 [info ] [Thread-2 (]: 9 of 25 PASS not_null_fct_sales_item_visitor_id ................................ [[32mPASS[0m in 4.09s]
[0m22:24:19.571908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m22:24:19.576926 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m22:24:19.577740 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:24:19.578211 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:24:19.578940 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:24:19.585026 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m22:24:19.585715 [info ] [Thread-2 (]: 12 of 25 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m22:24:19.586778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m22:24:19.587246 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:24:19.587806 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:24:19.593487 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m22:24:19.595882 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m22:24:19.596973 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:24:19.601892 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m22:24:19.604014 [error] [Thread-1 (]: 6 of 25 FAIL 7314 dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date  [[31mFAIL 7314[0m in 6.18s]
[0m22:24:19.604919 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e
[0m22:24:19.605474 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:24:19.605888 [info ] [Thread-1 (]: 13 of 25 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m22:24:19.606634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date.56f8efb90e, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m22:24:19.607056 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:24:19.611037 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:24:19.611701 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:24:19.614277 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m22:24:19.615052 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:24:19.615697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:19.616477 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:19.617291 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:24:19.618157 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:19.618928 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:19.621509 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:24:19.653494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:19.692871 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m22:24:19.693453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:22.082625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc8dc6e2-8e58-4ec2-ab90-1d4d5a0fcc14&page=queryresults
[0m22:24:22.092373 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:de4aca22-de44-4479-8252-63885c75f6cd&page=queryresults
[0m22:24:22.253117 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:304a357a-c6f3-40e0-b6ca-4403c6f2b379&page=queryresults
[0m22:24:22.272587 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dcd8b5b7-67cb-4242-a272-85d41ccc35d3&page=queryresults
[0m22:24:23.695746 [info ] [Thread-1 (]: 13 of 25 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 4.09s]
[0m22:24:23.696642 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:24:23.697042 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:24:23.697431 [info ] [Thread-1 (]: 14 of 25 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m22:24:23.698104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m22:24:23.698489 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:24:23.702556 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:24:23.703717 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:24:23.706457 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:24:23.707413 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:24:23.707826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:23.806474 [info ] [Thread-4 (]: 10 of 25 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 4.24s]
[0m22:24:23.807537 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:24:23.807989 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:24:23.808399 [info ] [Thread-4 (]: 15 of 25 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m22:24:23.809118 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m22:24:23.809531 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:24:23.813543 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:24:23.815073 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:24:23.819498 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:24:23.820967 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:23.821457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:23.899373 [info ] [Thread-3 (]: 11 of 25 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 4.33s]
[0m22:24:23.901732 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:24:23.902211 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:24:23.901004 [info ] [Thread-2 (]: 12 of 25 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 4.31s]
[0m22:24:23.903758 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:24:23.904299 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:24:23.902737 [info ] [Thread-3 (]: 16 of 25 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m22:24:23.905427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m22:24:23.905858 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:24:23.909947 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:24:23.904858 [info ] [Thread-2 (]: 17 of 25 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m22:24:23.910819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m22:24:23.911238 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:24:23.915805 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:24:23.916977 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:24:23.920752 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:24:23.921558 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:24:23.924512 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:24:23.925535 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:24:23.926420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:23.957739 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m22:24:23.958235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:25.956717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6d97cf0e-91be-440a-a7f1-93021b4ed7b2&page=queryresults
[0m22:24:26.106952 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e64c005e-cb1a-4ba0-a573-0f1afae0c591&page=queryresults
[0m22:24:26.246573 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2bf31660-600a-46d2-a873-6de200dabbb7&page=queryresults
[0m22:24:26.337620 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:88f11a04-24e6-4c83-9fe2-aca96cbd917f&page=queryresults
[0m22:24:27.189685 [info ] [Thread-2 (]: 17 of 25 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 3.28s]
[0m22:24:27.190599 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:24:27.191041 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:24:27.191461 [info ] [Thread-2 (]: 18 of 25 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m22:24:27.192087 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m22:24:27.192502 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:24:27.196420 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:24:27.197384 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:24:27.200733 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:24:27.202084 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:24:27.202539 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:27.450380 [info ] [Thread-1 (]: 14 of 25 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.75s]
[0m22:24:27.451288 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:24:27.451684 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:24:27.452045 [info ] [Thread-1 (]: 19 of 25 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m22:24:27.452594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m22:24:27.452974 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:24:27.456753 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:24:27.457838 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:24:27.460462 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:24:27.461526 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:24:27.461965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:27.580190 [info ] [Thread-4 (]: 15 of 25 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 3.77s]
[0m22:24:27.581300 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:24:27.581874 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:24:27.582344 [info ] [Thread-4 (]: 20 of 25 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m22:24:27.582950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m22:24:27.583467 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:24:27.587491 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:24:27.588481 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:24:27.591047 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:24:27.591958 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m22:24:27.592387 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:27.673390 [info ] [Thread-3 (]: 16 of 25 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 3.77s]
[0m22:24:27.674899 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:24:27.675782 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:24:27.676630 [info ] [Thread-3 (]: 21 of 25 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m22:24:27.677439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m22:24:27.677832 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:24:27.682871 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:24:27.684452 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:24:27.687349 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:24:27.688526 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m22:24:27.689421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:29.290171 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:310d3596-b69f-4c10-8a60-8b213a160e55&page=queryresults
[0m22:24:29.850319 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:01dd738c-9241-416d-a998-b9366d67638f&page=queryresults
[0m22:24:29.930160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6ab7aac6-426a-4044-8b87-bcf8560c6790&page=queryresults
[0m22:24:29.980274 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4ea4646d-b965-4e4f-ab7c-dec3f5fd1bbe&page=queryresults
[0m22:24:30.193061 [info ] [Thread-2 (]: 18 of 25 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 3.00s]
[0m22:24:30.194062 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:24:30.194540 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m22:24:30.194978 [info ] [Thread-2 (]: 22 of 25 START test stg_hits_products_quality .................................. [RUN]
[0m22:24:30.195662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m22:24:30.196097 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m22:24:30.199582 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:24:30.200874 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m22:24:30.203868 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:24:30.204947 [debug] [Thread-2 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:24:30.205452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:24:30.796175 [info ] [Thread-1 (]: 19 of 25 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.34s]
[0m22:24:30.797824 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:24:30.798761 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:24:30.799680 [info ] [Thread-1 (]: 23 of 25 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m22:24:30.800586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m22:24:30.801153 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:24:30.804134 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:24:30.805937 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:24:30.810248 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:24:30.812057 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:24:30.813008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:30.854264 [info ] [Thread-4 (]: 20 of 25 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.27s]
[0m22:24:30.855905 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:24:30.856741 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:24:30.857477 [info ] [Thread-4 (]: 24 of 25 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m22:24:30.858492 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m22:24:30.859063 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:24:30.862061 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:24:30.863386 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:24:30.868772 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:24:30.869966 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:24:30.870637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:24:30.934453 [info ] [Thread-3 (]: 21 of 25 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.26s]
[0m22:24:30.935507 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:24:30.935977 [debug] [Thread-3 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m22:24:30.936478 [info ] [Thread-3 (]: 25 of 25 START test test_non_negative_values ................................... [RUN]
[0m22:24:30.937152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m22:24:30.937689 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m22:24:30.940442 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m22:24:30.941395 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m22:24:30.944443 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m22:24:30.946095 [debug] [Thread-3 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:24:30.947017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:24:32.262862 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef42c271-dd4a-46c2-b667-0868c46cf558&page=queryresults
[0m22:24:32.972975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:180c1718-4a35-42a7-af17-9ec4c91bd7b2&page=queryresults
[0m22:24:33.183606 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b45cc46e-ba19-4922-9bf5-843cd76b3f39&page=queryresults
[0m22:24:33.192933 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:98a1f64a-7f04-4f37-ae1c-1f4a9dfb0c63&page=queryresults
[0m22:24:33.695864 [info ] [Thread-2 (]: 22 of 25 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.50s]
[0m22:24:33.697070 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m22:24:34.016517 [info ] [Thread-3 (]: 25 of 25 PASS test_non_negative_values ......................................... [[32mPASS[0m in 3.08s]
[0m22:24:34.017373 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m22:24:34.336695 [info ] [Thread-1 (]: 23 of 25 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.54s]
[0m22:24:34.337556 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:24:34.527069 [info ] [Thread-4 (]: 24 of 25 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.67s]
[0m22:24:34.528054 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:24:34.529440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:24:34.530973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:34.531268 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m22:24:34.531539 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m22:24:34.531804 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m22:24:34.532070 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m22:24:34.532331 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_hits_products_quality' was properly closed.
[0m22:24:34.532595 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m22:24:34.532862 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m22:24:34.533185 [info ] [MainThread]: 
[0m22:24:34.533598 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 25.86 seconds (25.86s).
[0m22:24:34.538727 [debug] [MainThread]: Command end result
[0m22:24:34.719724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:24:34.722348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:24:34.731278 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m22:24:34.731658 [info ] [MainThread]: 
[0m22:24:34.732218 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m22:24:34.732717 [info ] [MainThread]: 
[0m22:24:34.733284 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)[0m
[0m22:24:34.733909 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m22:24:34.734438 [info ] [MainThread]: 
[0m22:24:34.735026 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m22:24:34.735475 [info ] [MainThread]: 
[0m22:24:34.735992 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)[0m
[0m22:24:34.736525 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m22:24:34.737032 [info ] [MainThread]: 
[0m22:24:34.737643 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m22:24:34.738139 [info ] [MainThread]: 
[0m22:24:34.738662 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)[0m
[0m22:24:34.739328 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m22:24:34.739823 [info ] [MainThread]: 
[0m22:24:34.740380 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m22:24:34.740858 [info ] [MainThread]: 
[0m22:24:34.741602 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)[0m
[0m22:24:34.742753 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql
[0m22:24:34.743490 [info ] [MainThread]: 
[0m22:24:34.744112 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql
[0m22:24:34.744606 [info ] [MainThread]: 
[0m22:24:34.745224 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)[0m
[0m22:24:34.745857 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql
[0m22:24:34.746363 [info ] [MainThread]: 
[0m22:24:34.746917 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql
[0m22:24:34.747449 [info ] [MainThread]: 
[0m22:24:34.748043 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg_hits_products_visit_id__product_sku__hit_date (models\staging\staging_models.yml)[0m
[0m22:24:34.748629 [error] [MainThread]:   Got 7314 results, configured to fail if != 0
[0m22:24:34.749104 [info ] [MainThread]: 
[0m22:24:34.749715 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_unique_combination_o_7de980140511f1c407914f6b810cdff2.sql
[0m22:24:34.750183 [info ] [MainThread]: 
[0m22:24:34.750670 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=25
[0m22:24:34.752306 [debug] [MainThread]: Command `dbt test` failed at 22:24:34.752133 after 36.31 seconds
[0m22:24:34.752751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFD1230590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF656BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFF656A410>]}
[0m22:24:34.753144 [debug] [MainThread]: Flushing usage events
[0m22:24:36.906990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:29.489412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024312BD02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313C1BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313C1B9D0>]}


============================== 22:30:29.495395 | 346f883f-f683-4178-b448-2d9ce4f63894 ==============================
[0m22:30:29.495395 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:30:29.496379 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:30:33.821597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '346f883f-f683-4178-b448-2d9ce4f63894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024312F336F0>]}
[0m22:30:33.918021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '346f883f-f683-4178-b448-2d9ce4f63894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002433765B350>]}
[0m22:30:33.918950 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:30:34.951740 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m22:30:35.267266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:30:35.268286 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\intermediate\intermediate_models.yml
[0m22:30:35.269089 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\staging_models.yml
[0m22:30:35.939918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '346f883f-f683-4178-b448-2d9ce4f63894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338CF9550>]}
[0m22:30:36.100300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:30:36.103803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:30:36.160752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '346f883f-f683-4178-b448-2d9ce4f63894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243391232F0>]}
[0m22:30:36.161393 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m22:30:36.162102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '346f883f-f683-4178-b448-2d9ce4f63894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024339024D70>]}
[0m22:30:36.165849 [info ] [MainThread]: 
[0m22:30:36.166540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:36.167581 [info ] [MainThread]: 
[0m22:30:36.168658 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:30:36.175005 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m22:30:36.175756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:36.176415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m22:30:36.177254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:36.177986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m22:30:36.178607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:38.895009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '346f883f-f683-4178-b448-2d9ce4f63894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243390FFAD0>]}
[0m22:30:38.895728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:38.904279 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:30:38.905517 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:30:38.906148 [debug] [Thread-4 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:30:38.904960 [info ] [Thread-1 (]: 1 of 22 START test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0  [RUN]
[0m22:30:38.906877 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:30:38.907495 [info ] [Thread-2 (]: 2 of 22 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [RUN]
[0m22:30:38.908953 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76'
[0m22:30:38.908085 [info ] [Thread-4 (]: 4 of 22 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m22:30:38.910553 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91'
[0m22:30:38.909662 [info ] [Thread-3 (]: 3 of 22 START test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m22:30:38.912140 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m22:30:38.911177 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:30:38.912830 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:30:38.913667 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce'
[0m22:30:38.914562 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:30:38.928292 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76"
[0m22:30:38.935735 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m22:30:38.936483 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:30:38.952418 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:30:38.960371 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce"
[0m22:30:38.961450 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:30:38.992727 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m22:30:38.993536 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:30:38.996698 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:30:38.997269 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:30:39.000869 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76"
[0m22:30:39.001973 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:30:39.002843 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m22:30:39.005926 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce"
[0m22:30:39.006724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:30:39.007650 [debug] [Thread-4 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m22:30:39.008330 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`

where not(product_price_usd product_price_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m22:30:39.009256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:30:39.049060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:30:39.126317 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m22:30:39.127235 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:30:41.745833 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c6c13b08-e052-4300-93d1-cdb8e1dd1739&page=queryresults
[0m22:30:41.747003 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c6c13b08-e052-4300-93d1-cdb8e1dd1739&page=queryresults
[0m22:30:41.755625 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b53a617b-6578-4f65-a40b-21d717222c7b&page=queryresults
[0m22:30:41.756367 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b53a617b-6578-4f65-a40b-21d717222c7b&page=queryresults
[0m22:30:41.775328 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql
[0m22:30:41.780381 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m22:30:41.778928 [error] [Thread-3 (]: 3 of 22 ERROR dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.87s]
[0m22:30:41.782316 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce
[0m22:30:41.782946 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:30:41.781394 [error] [Thread-2 (]: 2 of 22 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.87s]
[0m22:30:41.784728 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql.
[0m22:30:41.786487 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m22:30:41.783534 [info ] [Thread-3 (]: 5 of 22 START test not_null_fct_sales_item_visit_id ............................ [RUN]
[0m22:30:41.788842 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:30:41.789814 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql.
[0m22:30:41.790466 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null.fc97f88dce, now test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d)
[0m22:30:41.791140 [info ] [Thread-2 (]: 6 of 22 START test not_null_fct_sales_item_visitor_id .......................... [RUN]
[0m22:30:41.792089 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:30:41.792817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m22:30:41.802907 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:30:41.803624 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:30:41.810671 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:30:41.812169 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:30:41.815384 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:30:41.816010 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:30:41.820307 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:30:41.821649 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:41.822277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:41.823147 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:41.823755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:41.906554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8e416be3-7ff7-4ad0-93b9-202e1b0734f3&page=queryresults
[0m22:30:41.907311 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8e416be3-7ff7-4ad0-93b9-202e1b0734f3&page=queryresults
[0m22:30:41.918520 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql
[0m22:30:41.919333 [error] [Thread-1 (]: 1 of 22 ERROR dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0  [[31mERROR[0m in 3.01s]
[0m22:30:41.920806 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76
[0m22:30:41.921540 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:30:41.922801 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql.
[0m22:30:41.922078 [info ] [Thread-1 (]: 7 of 22 START test not_null_int_sessions_enriched_session_date ................. [RUN]
[0m22:30:41.923846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0.66d41c0b76, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m22:30:41.924409 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:30:41.929857 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m22:30:41.931151 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:30:41.934985 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m22:30:41.936842 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:30:41.937775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:42.015726 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a3b46e2f-3564-4bf2-85cb-2208197ea10f&page=queryresults
[0m22:30:43.595477 [info ] [Thread-4 (]: 4 of 22 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.68s]
[0m22:30:43.596812 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:30:43.597397 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:30:43.597947 [info ] [Thread-4 (]: 8 of 22 START test not_null_int_sessions_enriched_visit_id ..................... [RUN]
[0m22:30:43.598738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m22:30:43.599311 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:30:43.604522 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m22:30:43.605760 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:30:43.609381 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m22:30:43.610585 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:43.611172 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:44.579246 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:56e1fd1d-6c0c-4adb-be9a-b84390a9c88f&page=queryresults
[0m22:30:44.599355 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d44615eb-a6b3-47a5-9446-f581a1750ca5&page=queryresults
[0m22:30:44.867349 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:534fa28d-0814-46ab-999b-665f6de7a4ea&page=queryresults
[0m22:30:45.450935 [info ] [Thread-2 (]: 6 of 22 PASS not_null_fct_sales_item_visitor_id ................................ [[32mPASS[0m in 3.66s]
[0m22:30:45.452188 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:30:45.452917 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:30:45.453469 [info ] [Thread-2 (]: 9 of 22 START test not_null_int_sessions_enriched_visitor_id ................... [RUN]
[0m22:30:45.454292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m22:30:45.454866 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:30:45.460152 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m22:30:45.462895 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:30:45.466725 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m22:30:45.471866 [info ] [Thread-3 (]: 5 of 22 PASS not_null_fct_sales_item_visit_id .................................. [[32mPASS[0m in 3.68s]
[0m22:30:45.472860 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:45.473846 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:30:45.474516 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:45.475217 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:30:45.476269 [info ] [Thread-3 (]: 10 of 22 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m22:30:45.516503 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m22:30:45.517623 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:30:45.523448 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:30:45.525165 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:30:45.529007 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:30:45.530344 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m22:30:45.530944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:46.269586 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:53de19d8-0b02-45f1-8a37-5f98dc385667&page=queryresults
[0m22:30:46.315129 [info ] [Thread-1 (]: 7 of 22 PASS not_null_int_sessions_enriched_session_date ....................... [[32mPASS[0m in 4.39s]
[0m22:30:46.326059 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:30:46.327200 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:30:46.328253 [info ] [Thread-1 (]: 11 of 22 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m22:30:46.330623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m22:30:46.331383 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:30:46.339823 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:30:46.342106 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:30:46.356104 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:30:46.357608 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:30:46.358384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:47.754973 [info ] [Thread-4 (]: 8 of 22 PASS not_null_int_sessions_enriched_visit_id ........................... [[32mPASS[0m in 4.16s]
[0m22:30:47.756614 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:30:47.757913 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:30:47.759185 [info ] [Thread-4 (]: 12 of 22 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m22:30:47.760576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m22:30:47.761535 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:30:47.768622 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:30:47.770242 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:30:47.945385 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:30:47.946738 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:47.947344 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:48.170613 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:90cb1a10-7d97-4a47-a8fd-346b30c5bc27&page=queryresults
[0m22:30:48.390770 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:af657f4e-8cc6-4e6a-8318-1833288e7229&page=queryresults
[0m22:30:49.041295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:abeb74ae-68a8-4672-9f00-802c1e7232b9&page=queryresults
[0m22:30:49.590710 [info ] [Thread-3 (]: 10 of 22 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 4.07s]
[0m22:30:49.593529 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:30:49.596349 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:30:49.597939 [info ] [Thread-3 (]: 13 of 22 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m22:30:49.598951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m22:30:49.599423 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:30:49.604083 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:30:49.606282 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:30:49.609689 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:30:49.610845 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:30:49.611386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:49.754045 [info ] [Thread-2 (]: 9 of 22 PASS not_null_int_sessions_enriched_visitor_id ......................... [[32mPASS[0m in 4.30s]
[0m22:30:49.755020 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:30:49.755472 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:30:49.755882 [info ] [Thread-2 (]: 14 of 22 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m22:30:49.756512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m22:30:49.756937 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:30:49.761156 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:30:49.762106 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:30:49.764727 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:30:49.765637 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m22:30:49.766214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:49.982138 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7511f572-d783-4ab7-8423-7046c33e0c95&page=queryresults
[0m22:30:50.395640 [info ] [Thread-1 (]: 11 of 22 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 4.07s]
[0m22:30:50.396584 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:30:50.397041 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:30:50.397465 [info ] [Thread-1 (]: 15 of 22 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m22:30:50.398093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m22:30:50.398519 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:30:50.403408 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:30:50.404421 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:30:50.407231 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:30:50.408300 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:30:50.408777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:51.395607 [info ] [Thread-4 (]: 12 of 22 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 3.64s]
[0m22:30:51.396502 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:30:51.396911 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:30:51.397294 [info ] [Thread-4 (]: 16 of 22 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m22:30:51.397881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m22:30:51.398241 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:30:51.402370 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:30:51.403403 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:30:51.406042 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:30:51.406888 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:30:51.407307 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:51.694100 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c377c676-4210-4324-aa15-f02757fb5934&page=queryresults
[0m22:30:51.793762 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1fdacc3d-47d3-432f-80ad-585385ddb55b&page=queryresults
[0m22:30:52.394437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2018f5ea-1d36-4adf-9a29-e72206c0e370&page=queryresults
[0m22:30:52.647341 [info ] [Thread-2 (]: 14 of 22 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.89s]
[0m22:30:52.648356 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:30:52.648819 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:30:52.649256 [info ] [Thread-2 (]: 17 of 22 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m22:30:52.649962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m22:30:52.650404 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:30:52.654765 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:30:52.655836 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:30:52.658680 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:30:52.659573 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m22:30:52.660019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:53.195346 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:311cbbb6-bd09-4b0b-b171-f4594cf0e42e&page=queryresults
[0m22:30:53.248249 [info ] [Thread-3 (]: 13 of 22 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 3.65s]
[0m22:30:53.249381 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:30:53.249967 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:30:53.250625 [info ] [Thread-3 (]: 18 of 22 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m22:30:53.251697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m22:30:53.252265 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:30:53.257698 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:30:53.263461 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:30:53.262874 [info ] [Thread-1 (]: 15 of 22 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.86s]
[0m22:30:53.268051 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:30:53.269027 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:30:53.269923 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m22:30:53.270509 [info ] [Thread-1 (]: 19 of 22 START test stg_hits_products_quality .................................. [RUN]
[0m22:30:53.271394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m22:30:53.271970 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m22:30:53.276041 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:30:53.276925 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m22:30:53.277590 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:53.313326 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m22:30:53.316178 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:30:53.317948 [debug] [Thread-1 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:30:53.318592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:54.569156 [info ] [Thread-4 (]: 16 of 22 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.17s]
[0m22:30:54.570029 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:30:54.570415 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:30:54.570788 [info ] [Thread-4 (]: 20 of 22 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m22:30:54.571375 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m22:30:54.571761 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:30:54.574253 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:30:54.575114 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:30:54.577545 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:30:54.578610 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dddd9c28-c9d2-4f73-ab79-efec41ad87e1&page=queryresults
[0m22:30:54.579688 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:30:54.580104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:30:55.219896 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:119fd185-deb3-4e41-9701-cefcd3ba16fc&page=queryresults
[0m22:30:55.326742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dd8002cf-2a25-463e-a047-c705e244ddae&page=queryresults
[0m22:30:55.379293 [info ] [Thread-2 (]: 17 of 22 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 2.73s]
[0m22:30:55.380201 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:30:55.380617 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:30:55.381003 [info ] [Thread-2 (]: 21 of 22 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m22:30:55.381593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m22:30:55.381977 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:30:55.384490 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:30:55.385512 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:30:55.388564 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:30:55.389572 [debug] [Thread-2 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:30:55.390008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:30:56.111107 [info ] [Thread-3 (]: 18 of 22 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 2.86s]
[0m22:30:56.115772 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:30:56.119109 [debug] [Thread-3 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m22:30:56.121843 [info ] [Thread-3 (]: 22 of 22 START test test_non_negative_values ................................... [RUN]
[0m22:30:56.125510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m22:30:56.129185 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m22:30:56.141452 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m22:30:56.145906 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m22:30:56.157590 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m22:30:56.160360 [debug] [Thread-3 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:30:56.161347 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:56.388513 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:339df4ec-45ce-4173-bad3-0143a627e6e5&page=queryresults
[0m22:30:56.690932 [info ] [Thread-1 (]: 19 of 22 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.42s]
[0m22:30:56.692042 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m22:30:57.570548 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bdfbcdb5-44d0-45ff-8b7a-4d5ef11cbec8&page=queryresults
[0m22:30:57.766038 [info ] [Thread-4 (]: 20 of 22 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.19s]
[0m22:30:57.768047 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:30:58.022921 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6cbc1710-97f0-4148-89a8-da4609adb19a&page=queryresults
[0m22:30:58.882096 [info ] [Thread-3 (]: 22 of 22 PASS test_non_negative_values ......................................... [[32mPASS[0m in 2.76s]
[0m22:30:58.885494 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m22:30:59.287699 [info ] [Thread-2 (]: 21 of 22 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.91s]
[0m22:30:59.288716 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:30:59.290358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:59.292305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:59.292674 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m22:30:59.293022 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m22:30:59.293361 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m22:30:59.293699 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_hits_products_quality' was properly closed.
[0m22:30:59.294042 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m22:30:59.294377 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m22:30:59.294712 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m22:30:59.295111 [info ] [MainThread]: 
[0m22:30:59.295722 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 23.13 seconds (23.13s).
[0m22:30:59.302021 [debug] [MainThread]: Command end result
[0m22:30:59.343460 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:30:59.345988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:30:59.354035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m22:30:59.354400 [info ] [MainThread]: 
[0m22:30:59.354989 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m22:30:59.355545 [info ] [MainThread]: 
[0m22:30:59.356199 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)[0m
[0m22:30:59.356867 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_with_fx_revenue_local__revenue_local_0_or_revenue_local_is_null (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql
[0m22:30:59.357508 [info ] [MainThread]: 
[0m22:30:59.358123 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_076c9d085ab77c91fda9438c25f47b37.sql
[0m22:30:59.358681 [info ] [MainThread]: 
[0m22:30:59.359326 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)[0m
[0m22:30:59.359963 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m22:30:59.360561 [info ] [MainThread]: 
[0m22:30:59.361219 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m22:30:59.361801 [info ] [MainThread]: 
[0m22:30:59.362738 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)[0m
[0m22:30:59.363397 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd__product_price_usd_0 (models\staging\staging_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql
[0m22:30:59.363971 [info ] [MainThread]: 
[0m22:30:59.364595 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_expression_is_true_s_039e1ea1391cdc5bff1e2072bad699e5.sql
[0m22:30:59.365214 [info ] [MainThread]: 
[0m22:30:59.365786 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=22
[0m22:30:59.367059 [debug] [MainThread]: Command `dbt test` failed at 22:30:59.366932 after 30.13 seconds
[0m22:30:59.367546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024313BE4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338BE92E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024338A60F70>]}
[0m22:30:59.367957 [debug] [MainThread]: Flushing usage events
[0m22:31:01.354874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:36.181388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CF1402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D018BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D018B9D0>]}


============================== 22:38:36.187780 | 3a717fde-be98-47e0-a468-c6825fb8b440 ==============================
[0m22:38:36.187780 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:38:36.188789 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m22:38:40.660494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219CF49F6F0>]}
[0m22:38:40.761782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F3BCB350>]}
[0m22:38:40.762715 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:38:41.799996 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m22:38:42.144214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:38:42.145488 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\staging_models.yml
[0m22:38:42.146268 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m22:38:42.716464 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m22:38:42.717374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F525DD50>]}
[0m22:38:42.878789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F54D34D0>]}
[0m22:38:43.035766 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:38:43.039307 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:38:43.097836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F558BCB0>]}
[0m22:38:43.098476 [info ] [MainThread]: Found 22 data tests, 5 models, 2 sources, 612 macros
[0m22:38:43.099218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5667E10>]}
[0m22:38:43.102987 [info ] [MainThread]: 
[0m22:38:43.103685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:38:43.104383 [info ] [MainThread]: 
[0m22:38:43.105530 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:38:43.112051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m22:38:43.112813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:43.113571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m22:38:43.114047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:43.154421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m22:38:43.155018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:46.123295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a717fde-be98-47e0-a468-c6825fb8b440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F56C0950>]}
[0m22:38:46.125156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:46.148133 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a
[0m22:38:46.149923 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:38:46.151601 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:38:46.153628 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:38:46.155490 [info ] [Thread-1 (]: 1 of 22 START test dbt_utils_expression_is_true_fct_sales_item_transactions_0 .. [RUN]
[0m22:38:46.157137 [info ] [Thread-2 (]: 2 of 22 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m22:38:46.158646 [info ] [Thread-3 (]: 3 of 22 START test not_null_fct_sales_item_visit_id ............................ [RUN]
[0m22:38:46.162154 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a'
[0m22:38:46.163433 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m22:38:46.160404 [info ] [Thread-4 (]: 4 of 22 START test not_null_fct_sales_item_visitor_id .......................... [RUN]
[0m22:38:46.164878 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m22:38:46.165872 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a
[0m22:38:46.166905 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:38:46.167874 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m22:38:46.168640 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:38:46.183797 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a"
[0m22:38:46.192559 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:38:46.193275 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:38:46.202321 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:38:46.209124 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:38:46.210633 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a
[0m22:38:46.220353 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:38:46.258334 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a"
[0m22:38:46.259709 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:38:46.260305 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:38:46.261270 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:38:46.264420 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:38:46.267823 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:38:46.269129 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(transactions >= 0)


  
  
      
    ) dbt_internal_test
[0m22:38:46.269892 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:46.270568 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m22:38:46.271504 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:38:46.272214 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:38:46.312002 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:38:46.312711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:38:46.314324 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:38:49.036232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc613fc1-7d41-48af-9dcd-9dc87667dfba&page=queryresults
[0m22:38:49.038412 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc613fc1-7d41-48af-9dcd-9dc87667dfba&page=queryresults
[0m22:38:49.054437 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_transactions_0 (models\mart\mart_models.yml)
  Unrecognized name: transactions; Did you mean transaction_id? at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transactions_0.sql
[0m22:38:49.055388 [error] [Thread-1 (]: 1 of 22 ERROR dbt_utils_expression_is_true_fct_sales_item_transactions_0 ....... [[31mERROR[0m in 2.89s]
[0m22:38:49.056842 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a
[0m22:38:49.057523 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:38:49.058414 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_transactions_0 (models\mart\mart_models.yml)
  Unrecognized name: transactions; Did you mean transaction_id? at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transactions_0.sql.
[0m22:38:49.059098 [info ] [Thread-1 (]: 5 of 22 START test not_null_int_sessions_enriched_session_date ................. [RUN]
[0m22:38:49.061107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transactions_0.8bd5d2f43a, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m22:38:49.061875 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:38:49.068718 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m22:38:49.070260 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:38:49.074975 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m22:38:49.076530 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:38:49.077216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:49.119105 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c803d8eb-f2fc-4dfb-a22d-4cdd4052b8c8&page=queryresults
[0m22:38:49.134314 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2b84c2e8-108d-4abd-a2a6-78d9507e4f3a&page=queryresults
[0m22:38:49.173648 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9d7d1485-9860-49d3-98f4-4325d88b5c97&page=queryresults
[0m22:38:50.151999 [info ] [Thread-3 (]: 3 of 22 PASS not_null_fct_sales_item_visit_id .................................. [[32mPASS[0m in 3.99s]
[0m22:38:50.153313 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:38:50.153966 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:38:50.154702 [info ] [Thread-3 (]: 6 of 22 START test not_null_int_sessions_enriched_visit_id ..................... [RUN]
[0m22:38:50.155694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m22:38:50.156249 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:38:50.161495 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m22:38:50.162729 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:38:50.167600 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m22:38:50.169946 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:38:50.171348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:38:50.238588 [info ] [Thread-4 (]: 4 of 22 PASS not_null_fct_sales_item_visitor_id ................................ [[32mPASS[0m in 4.07s]
[0m22:38:50.240459 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:38:50.241274 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:38:50.241826 [info ] [Thread-4 (]: 7 of 22 START test not_null_int_sessions_enriched_visitor_id ................... [RUN]
[0m22:38:50.242663 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m22:38:50.243236 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:38:50.249193 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m22:38:50.250474 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:38:50.254089 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m22:38:50.255456 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:38:50.256070 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:38:50.728142 [info ] [Thread-2 (]: 2 of 22 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.56s]
[0m22:38:50.729419 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:38:50.729995 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:38:50.730536 [info ] [Thread-2 (]: 8 of 22 START test not_null_stg_hits_products_product_sku ...................... [RUN]
[0m22:38:50.731324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m22:38:50.731956 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:38:50.737180 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:38:50.738452 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:38:50.743005 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:38:50.744343 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m22:38:50.744945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:38:51.666760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9f94f328-0bd8-42ca-b6de-2a766b8e15e7&page=queryresults
[0m22:38:53.036991 [info ] [Thread-1 (]: 5 of 22 PASS not_null_int_sessions_enriched_session_date ....................... [[32mPASS[0m in 3.98s]
[0m22:38:53.040092 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m22:38:53.041610 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:38:53.043439 [info ] [Thread-1 (]: 9 of 22 START test not_null_stg_sessions_session_date .......................... [RUN]
[0m22:38:53.045729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m22:38:53.047366 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:38:53.063849 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:38:53.066519 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7d0e96d1-773a-48d4-964b-ddc5837fea06&page=queryresults
[0m22:38:53.073454 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:38:53.086948 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:38:53.088644 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:38:53.089268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:53.297106 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8064f228-ab8c-430b-b06a-bf1ba4fd7a77&page=queryresults
[0m22:38:53.356947 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8e238c3-3d81-434e-9a54-a955f8e87fa4&page=queryresults
[0m22:38:54.482187 [info ] [Thread-3 (]: 6 of 22 PASS not_null_int_sessions_enriched_visit_id ........................... [[32mPASS[0m in 4.33s]
[0m22:38:54.483411 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m22:38:54.484021 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:38:54.484594 [info ] [Thread-3 (]: 10 of 22 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m22:38:54.485441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m22:38:54.485996 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:38:54.491734 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:38:54.493061 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:38:54.648969 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:38:54.650345 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:38:54.650931 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:38:54.702435 [info ] [Thread-4 (]: 7 of 22 PASS not_null_int_sessions_enriched_visitor_id ......................... [[32mPASS[0m in 4.46s]
[0m22:38:54.703660 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m22:38:54.704277 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:38:54.704858 [info ] [Thread-4 (]: 11 of 22 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m22:38:54.705746 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m22:38:54.706296 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:38:54.711639 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:38:54.712897 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:38:54.717936 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:38:54.719828 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:38:54.720681 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:38:54.766481 [info ] [Thread-2 (]: 8 of 22 PASS not_null_stg_hits_products_product_sku ............................ [[32mPASS[0m in 4.04s]
[0m22:38:54.767877 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:38:54.769410 [debug] [Thread-2 (]: Began running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:38:54.770698 [info ] [Thread-2 (]: 12 of 22 START test relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [RUN]
[0m22:38:54.772198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3)
[0m22:38:54.772836 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:38:54.782717 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:38:54.784660 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:38:54.791725 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:38:54.794205 [debug] [Thread-2 (]: On test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sku as from_field
    from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
    where product_sku is not null
),

parent as (
    select product_sku as to_field
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:38:54.795546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:38:55.680236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:06a06a68-2c50-4e0d-a7d2-0de4c7657806&page=queryresults
[0m22:38:57.077808 [info ] [Thread-1 (]: 9 of 22 PASS not_null_stg_sessions_session_date ................................ [[32mPASS[0m in 4.03s]
[0m22:38:57.079059 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:38:57.079669 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:38:57.080348 [info ] [Thread-1 (]: 13 of 22 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m22:38:57.081152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m22:38:57.081689 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:38:57.087627 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:38:57.088983 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:38:57.092733 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:38:57.094069 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m22:38:57.094680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:57.301860 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b2be6406-be0e-4e01-93c4-7df7859ad3e7&page=queryresults
[0m22:38:57.360901 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:646ddc70-f72f-4f03-a757-e2d32c0ea410&page=queryresults
[0m22:38:57.492106 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d101160a-5c5c-4ca9-ae9e-ec3fb50cb124&page=queryresults
[0m22:38:58.773577 [info ] [Thread-3 (]: 10 of 22 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 4.29s]
[0m22:38:58.787134 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:38:58.789133 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:38:58.785005 [info ] [Thread-4 (]: 11 of 22 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 4.08s]
[0m22:38:58.795352 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:38:58.791484 [info ] [Thread-3 (]: 14 of 22 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m22:38:58.798573 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:38:58.801072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m22:38:58.804535 [info ] [Thread-4 (]: 15 of 22 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m22:38:58.806831 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:38:58.808755 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m22:38:58.824548 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:38:58.826373 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:38:58.841330 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:38:58.843645 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:38:58.848294 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:38:58.848988 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:38:58.853987 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:38:58.855280 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:38:58.856054 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:38:58.896477 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:38:58.897405 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:38:59.346565 [info ] [Thread-2 (]: 12 of 22 PASS relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [[32mPASS[0m in 4.57s]
[0m22:38:59.347815 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:38:59.348420 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:38:59.349100 [info ] [Thread-2 (]: 16 of 22 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m22:38:59.349930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m22:38:59.350510 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:38:59.355938 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:38:59.357182 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:38:59.360633 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:38:59.361840 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m22:38:59.362439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:38:59.403989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:af68cce7-051a-41c9-8346-d21008034577&page=queryresults
[0m22:39:00.248149 [info ] [Thread-1 (]: 13 of 22 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 3.17s]
[0m22:39:00.249408 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:39:00.249990 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:39:00.250647 [info ] [Thread-1 (]: 17 of 22 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m22:39:00.251451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m22:39:00.252022 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:39:00.262620 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:39:00.264765 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:39:00.269244 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:39:00.271022 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m22:39:00.271668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:01.457588 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eddce25e-0a33-41e2-9f5f-040200a924c7&page=queryresults
[0m22:39:01.676298 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:238e25ca-2144-4b10-83d3-909abed37ffc&page=queryresults
[0m22:39:02.036464 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b9bf8be2-1cbe-4475-ac54-f2b534efdc25&page=queryresults
[0m22:39:02.349830 [info ] [Thread-3 (]: 14 of 22 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 3.55s]
[0m22:39:02.351083 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:39:02.351747 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m22:39:02.352745 [info ] [Thread-3 (]: 18 of 22 START test stg_hits_products_quality .................................. [RUN]
[0m22:39:02.354057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m22:39:02.355193 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m22:39:02.360673 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:39:02.362204 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m22:39:02.366113 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:39:02.367423 [debug] [Thread-3 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:39:02.368048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:02.550592 [info ] [Thread-4 (]: 15 of 22 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.74s]
[0m22:39:02.551824 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:39:02.552509 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:39:02.553295 [info ] [Thread-4 (]: 19 of 22 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m22:39:02.554548 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m22:39:02.555127 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:39:02.558625 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:39:02.559870 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:39:02.563305 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:39:02.564558 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:39:02.565161 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:02.817483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6a8cbec3-7186-49ef-a682-6d0d7fbec439&page=queryresults
[0m22:39:02.880045 [info ] [Thread-2 (]: 16 of 22 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.53s]
[0m22:39:02.881294 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:39:02.881915 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:39:02.882601 [info ] [Thread-2 (]: 20 of 22 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m22:39:02.883424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m22:39:02.884095 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:39:02.889626 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:39:02.890928 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:39:02.894565 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:39:02.895830 [debug] [Thread-2 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:39:02.896436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:03.720609 [info ] [Thread-1 (]: 17 of 22 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.47s]
[0m22:39:03.721549 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:39:03.721987 [debug] [Thread-1 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m22:39:03.722366 [info ] [Thread-1 (]: 21 of 22 START test test_non_negative_values ................................... [RUN]
[0m22:39:03.723050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m22:39:03.723430 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m22:39:03.725883 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m22:39:03.726847 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m22:39:03.729471 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m22:39:03.731601 [debug] [Thread-1 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:39:03.732323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:04.679121 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e75ef5a2-93ca-48d6-85b2-3d71d5a59407&page=queryresults
[0m22:39:05.079476 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:13b3aa22-ea1d-4570-98bb-a20ff270dda9&page=queryresults
[0m22:39:05.239308 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:502638ed-fd6d-4507-8c84-93b89bba18dc&page=queryresults
[0m22:39:05.731803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:28eda0f0-da66-46ed-b309-92f3088ea5a6&page=queryresults
[0m22:39:05.988692 [info ] [Thread-3 (]: 18 of 22 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.63s]
[0m22:39:05.991663 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m22:39:05.993270 [debug] [Thread-3 (]: Began running node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m22:39:05.995027 [info ] [Thread-3 (]: 22 of 22 START test test_non_negative_values_fct_sales_item_ ................... [RUN]
[0m22:39:05.997037 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122)
[0m22:39:05.998863 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m22:39:06.023749 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:06.073618 [debug] [Thread-3 (]: Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:39:06.074306 [error] [Thread-3 (]: 22 of 22 ERROR test_non_negative_values_fct_sales_item_ ........................ [[31mERROR[0m in 0.08s]
[0m22:39:06.075190 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m22:39:06.075855 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122' to be skipped because of status 'error'.  Reason: Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:39:06.490303 [info ] [Thread-4 (]: 19 of 22 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.94s]
[0m22:39:06.493281 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:39:06.596036 [info ] [Thread-1 (]: 21 of 22 PASS test_non_negative_values ......................................... [[32mPASS[0m in 2.87s]
[0m22:39:06.597136 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m22:39:06.667366 [info ] [Thread-2 (]: 20 of 22 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.78s]
[0m22:39:06.669621 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:39:06.673357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:39:06.677597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:06.678426 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m22:39:06.679164 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m22:39:06.679878 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m22:39:06.680599 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m22:39:06.681308 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m22:39:06.682015 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122' was properly closed.
[0m22:39:06.682735 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m22:39:06.683582 [info ] [MainThread]: 
[0m22:39:06.684688 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 23.58 seconds (23.58s).
[0m22:39:06.694244 [debug] [MainThread]: Command end result
[0m22:39:06.736577 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:39:06.739445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:39:06.748650 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m22:39:06.749095 [info ] [MainThread]: 
[0m22:39:06.749738 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:39:06.750342 [info ] [MainThread]: 
[0m22:39:06.751055 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_transactions_0 (models\mart\mart_models.yml)[0m
[0m22:39:06.751719 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_transactions_0 (models\mart\mart_models.yml)
  Unrecognized name: transactions; Did you mean transaction_id? at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transactions_0.sql
[0m22:39:06.752314 [info ] [MainThread]: 
[0m22:39:06.752957 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transactions_0.sql
[0m22:39:06.753535 [info ] [MainThread]: 
[0m22:39:06.754182 [error] [MainThread]: [31mFailure in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)[0m
[0m22:39:06.754798 [error] [MainThread]:   Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:39:06.755416 [info ] [MainThread]: 
[0m22:39:06.756022 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=22
[0m22:39:06.756841 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:39:06.758415 [debug] [MainThread]: Command `dbt test` failed at 22:39:06.758192 after 30.83 seconds
[0m22:39:06.758991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F5230940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4DFFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219F4DFF430>]}
[0m22:39:06.759418 [debug] [MainThread]: Flushing usage events
[0m22:39:07.832840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:18.266495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EC8E002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EC9E4BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EC9E4B9D0>]}


============================== 22:40:18.271659 | 2bd8c381-dc5f-46a4-af0e-d2d5e331cc53 ==============================
[0m22:40:18.271659 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:40:18.272449 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select path:models/staging', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:40:21.469505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bd8c381-dc5f-46a4-af0e-d2d5e331cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EC915F6F0>]}
[0m22:40:21.530546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bd8c381-dc5f-46a4-af0e-d2d5e331cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EED87B350>]}
[0m22:40:21.531151 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:40:22.191009 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m22:40:22.403809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:40:22.404159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:40:22.453335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bd8c381-dc5f-46a4-af0e-d2d5e331cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EEE8D9650>]}
[0m22:40:22.554035 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:40:22.556232 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:40:22.597807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bd8c381-dc5f-46a4-af0e-d2d5e331cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EEF06AB70>]}
[0m22:40:22.598286 [info ] [MainThread]: Found 22 data tests, 5 models, 2 sources, 612 macros
[0m22:40:22.598838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bd8c381-dc5f-46a4-af0e-d2d5e331cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EEF075FD0>]}
[0m22:40:22.601993 [info ] [MainThread]: 
[0m22:40:22.602478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:22.602968 [info ] [MainThread]: 
[0m22:40:22.603634 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:40:22.608101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m22:40:22.608445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:22.637330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m22:40:22.637957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:22.638551 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m22:40:22.639479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:24.602203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bd8c381-dc5f-46a4-af0e-d2d5e331cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EEF0FB520>]}
[0m22:40:24.602810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:24.610730 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:40:24.611295 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:40:24.611823 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:40:24.612828 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:40:24.612357 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m22:40:24.613983 [info ] [Thread-3 (]: 3 of 14 START test not_null_stg_sessions_session_date .......................... [RUN]
[0m22:40:24.615976 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m22:40:24.616712 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m22:40:24.614616 [info ] [Thread-2 (]: 2 of 14 START test not_null_stg_hits_products_product_sku ...................... [RUN]
[0m22:40:24.617511 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:40:24.618071 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:40:24.615131 [info ] [Thread-4 (]: 4 of 14 START test not_null_stg_sessions_visit_id .............................. [RUN]
[0m22:40:24.618916 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90'
[0m22:40:24.663829 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:40:24.666575 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:40:24.667179 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m22:40:24.667729 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:40:24.668659 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:40:24.674236 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:40:24.679283 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:40:24.679874 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:40:24.680495 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:40:24.711712 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m22:40:24.714771 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m22:40:24.715750 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:40:24.718320 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m22:40:24.718872 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:40:24.723849 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m22:40:24.724554 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m22:40:24.725064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:24.725883 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m22:40:24.726669 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:40:24.727140 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:40:24.757779 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:40:24.815506 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m22:40:24.816026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:40:27.051987 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f41428ff-ecbe-4678-85ea-ff881e643853&page=queryresults
[0m22:40:27.061871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:11e744b7-94ee-4022-8772-36074f532fac&page=queryresults
[0m22:40:27.111820 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dad99e84-5175-46dd-8eab-d1cc22cd948a&page=queryresults
[0m22:40:27.122097 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:20725e1d-6c69-4c9c-9b71-cb0dad065cd4&page=queryresults
[0m22:40:28.624970 [info ] [Thread-2 (]: 2 of 14 PASS not_null_stg_hits_products_product_sku ............................ [[32mPASS[0m in 4.01s]
[0m22:40:28.626038 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m22:40:28.626568 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:40:28.627063 [info ] [Thread-2 (]: 5 of 14 START test not_null_stg_sessions_visitor_id ............................ [RUN]
[0m22:40:28.627793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m22:40:28.628276 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:40:28.632593 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:40:28.636893 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.02s]
[0m22:40:28.637945 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m22:40:28.638447 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:40:28.639032 [debug] [Thread-1 (]: Began running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:40:28.642657 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m22:40:28.643356 [info ] [Thread-1 (]: 6 of 14 START test relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [RUN]
[0m22:40:28.644155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3)
[0m22:40:28.644606 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:40:28.653105 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:40:28.654098 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:40:28.654678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:40:28.688883 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:40:28.693474 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:40:28.695774 [info ] [Thread-3 (]: 3 of 14 PASS not_null_stg_sessions_session_date ................................ [[32mPASS[0m in 4.08s]
[0m22:40:28.696675 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m22:40:28.697155 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:40:28.697600 [info ] [Thread-3 (]: 7 of 14 START test source_not_null_ext_country_currency_country ................ [RUN]
[0m22:40:28.698231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m22:40:28.698668 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:40:28.703241 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:40:28.704998 [debug] [Thread-1 (]: On test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sku as from_field
    from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
    where product_sku is not null
),

parent as (
    select product_sku as to_field
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:40:28.706671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:28.740860 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:40:28.744032 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m22:40:28.745509 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m22:40:28.746093 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:40:28.785768 [info ] [Thread-4 (]: 4 of 14 PASS not_null_stg_sessions_visit_id .................................... [[32mPASS[0m in 4.12s]
[0m22:40:28.786998 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m22:40:28.787563 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:40:28.787985 [info ] [Thread-4 (]: 8 of 14 START test source_not_null_ext_country_currency_currency ............... [RUN]
[0m22:40:28.788668 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m22:40:28.789108 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:40:28.793320 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:40:28.794273 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:40:28.796979 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m22:40:28.797893 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:40:28.798358 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:40:30.868547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8c18a9dd-b3b2-46ee-978f-d0b308d911c3&page=queryresults
[0m22:40:30.885999 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7fe4a85d-b678-4ae5-bf1d-86734c4fc179&page=queryresults
[0m22:40:30.906495 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0fc516a0-16f7-4a4e-9e76-8fc191bbaf17&page=queryresults
[0m22:40:30.909724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e76c6d31-9f72-4ab8-b1c3-8ac07a4e16d3&page=queryresults
[0m22:40:31.809565 [info ] [Thread-4 (]: 8 of 14 PASS source_not_null_ext_country_currency_currency ..................... [[32mPASS[0m in 3.02s]
[0m22:40:31.810820 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m22:40:31.811419 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:40:31.811989 [info ] [Thread-4 (]: 9 of 14 START test source_not_null_ext_fx_rates_currency ....................... [RUN]
[0m22:40:31.812832 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m22:40:31.813396 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:40:31.818945 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:40:31.820320 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:40:31.824256 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m22:40:31.825585 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m22:40:31.826205 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:40:32.078397 [info ] [Thread-3 (]: 7 of 14 PASS source_not_null_ext_country_currency_country ...................... [[32mPASS[0m in 3.38s]
[0m22:40:32.079253 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m22:40:32.079644 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:40:32.080012 [info ] [Thread-3 (]: 10 of 14 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m22:40:32.080587 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m22:40:32.080951 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:40:32.084537 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:40:32.085338 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:40:32.087732 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m22:40:32.088552 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m22:40:32.088949 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:40:32.328744 [info ] [Thread-2 (]: 5 of 14 PASS not_null_stg_sessions_visitor_id .................................. [[32mPASS[0m in 3.70s]
[0m22:40:32.329600 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m22:40:32.330002 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:40:32.330374 [info ] [Thread-2 (]: 11 of 14 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m22:40:32.330959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m22:40:32.331327 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:40:32.335338 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:40:32.336667 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:40:32.342175 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m22:40:32.343605 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m22:40:32.344438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:40:32.588927 [info ] [Thread-1 (]: 6 of 14 PASS relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [[32mPASS[0m in 3.94s]
[0m22:40:32.589813 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:40:32.590225 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m22:40:32.590599 [info ] [Thread-1 (]: 12 of 14 START test stg_hits_products_quality .................................. [RUN]
[0m22:40:32.591176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3, now test.ga_retail_project.stg_hits_products_quality)
[0m22:40:32.591549 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m22:40:32.594182 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:40:32.595031 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m22:40:32.596953 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m22:40:32.597749 [debug] [Thread-1 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:40:32.598155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:33.868253 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dbcf8501-fce2-48a0-b54d-25a33e45747d&page=queryresults
[0m22:40:34.113080 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:acebe59e-eeaf-4f41-a9de-b7bf1c322199&page=queryresults
[0m22:40:34.390958 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:641a5cac-ecc0-46e9-8214-5b7fb832c6ee&page=queryresults
[0m22:40:34.639359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7b5d0e4b-9d85-4fc4-a66e-1d27a876fc6b&page=queryresults
[0m22:40:34.813695 [info ] [Thread-4 (]: 9 of 14 PASS source_not_null_ext_fx_rates_currency ............................. [[32mPASS[0m in 3.00s]
[0m22:40:34.815236 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m22:40:34.816033 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:40:34.816893 [info ] [Thread-4 (]: 13 of 14 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m22:40:34.818005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m22:40:34.818794 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:40:34.823105 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:40:34.824679 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:40:34.828445 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m22:40:34.829959 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m22:40:34.830716 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:40:35.042146 [info ] [Thread-3 (]: 10 of 14 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 2.96s]
[0m22:40:35.043161 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m22:40:35.043625 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:40:35.044042 [info ] [Thread-3 (]: 14 of 14 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m22:40:35.044715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m22:40:35.045219 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:40:35.047985 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:40:35.048962 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:40:35.051260 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m22:40:35.052368 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:40:35.053223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:40:35.325578 [info ] [Thread-2 (]: 11 of 14 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 2.99s]
[0m22:40:35.326436 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m22:40:36.032372 [info ] [Thread-1 (]: 12 of 14 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.44s]
[0m22:40:36.033425 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m22:40:36.832376 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:72dfbfa9-bba5-4a4c-928e-c4d1dabb84f8&page=queryresults
[0m22:40:37.134402 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bc5d3ed6-c2bb-4b82-a01a-2eeeef7c32d1&page=queryresults
[0m22:40:38.274987 [info ] [Thread-4 (]: 13 of 14 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.46s]
[0m22:40:38.278441 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m22:40:38.553814 [info ] [Thread-3 (]: 14 of 14 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.51s]
[0m22:40:38.557049 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m22:40:38.562332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:38.569568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:38.570918 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m22:40:38.572135 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m22:40:38.573314 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m22:40:38.574491 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_hits_products_quality' was properly closed.
[0m22:40:38.575749 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m22:40:38.576983 [debug] [MainThread]: Connection 'test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01' was properly closed.
[0m22:40:38.578161 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m22:40:38.579529 [info ] [MainThread]: 
[0m22:40:38.581327 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 15.98 seconds (15.98s).
[0m22:40:38.595480 [debug] [MainThread]: Command end result
[0m22:40:38.645502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:40:38.648281 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:40:38.657250 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m22:40:38.657681 [info ] [MainThread]: 
[0m22:40:38.658267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:38.658813 [info ] [MainThread]: 
[0m22:40:38.659375 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m22:40:38.660638 [debug] [MainThread]: Command `dbt test` succeeded at 22:40:38.660504 after 20.60 seconds
[0m22:40:38.661069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EC9E20590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EEF168890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EEF169910>]}
[0m22:40:38.661505 [debug] [MainThread]: Flushing usage events
[0m22:40:40.035921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:44:57.431530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11ADD02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11BE13ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11BE139D0>]}


============================== 22:44:57.438915 | 797fb8ad-38d9-468d-bb93-152cf58429bb ==============================
[0m22:44:57.438915 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:44:57.439889 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m22:44:57.691511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '797fb8ad-38d9-468d-bb93-152cf58429bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11B1336F0>]}
[0m22:44:57.821550 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-k2x8fy9m'
[0m22:44:57.822160 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:45:00.506288 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:45:00.508278 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:45:01.257020 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:45:01.263567 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:45:02.454933 [info ] [MainThread]: Installed from version 1.3.0
[0m22:45:02.455933 [info ] [MainThread]: Up to date!
[0m22:45:02.456676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '797fb8ad-38d9-468d-bb93-152cf58429bb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11BD0D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11BD0E360>]}
[0m22:45:02.459234 [debug] [MainThread]: Command `dbt deps` succeeded at 22:45:02.459050 after 5.25 seconds
[0m22:45:02.459752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11D02D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11B5EB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F11CFD07D0>]}
[0m22:45:02.460281 [debug] [MainThread]: Flushing usage events
[0m22:45:03.729799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:45:20.318701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024121C502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024122C9BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024122C9B9D0>]}


============================== 22:45:20.323471 | a088c516-c7a2-45f0-9c4a-ca7bf3643ba6 ==============================
[0m22:45:20.323471 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:45:20.324247 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m22:45:23.599515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a088c516-c7a2-45f0-9c4a-ca7bf3643ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024121FB36F0>]}
[0m22:45:23.660145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a088c516-c7a2-45f0-9c4a-ca7bf3643ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241466DB350>]}
[0m22:45:23.660757 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:45:24.362434 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m22:45:24.674482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:45:24.675360 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m22:45:25.179560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a088c516-c7a2-45f0-9c4a-ca7bf3643ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024147D58850>]}
[0m22:45:25.289962 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:45:25.292570 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:45:25.338007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a088c516-c7a2-45f0-9c4a-ca7bf3643ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241481AFA70>]}
[0m22:45:25.338784 [info ] [MainThread]: Found 22 data tests, 5 models, 2 sources, 612 macros
[0m22:45:25.339386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a088c516-c7a2-45f0-9c4a-ca7bf3643ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241480EEF90>]}
[0m22:45:25.341725 [info ] [MainThread]: 
[0m22:45:25.342290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:45:25.342811 [info ] [MainThread]: 
[0m22:45:25.343525 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:45:25.348143 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m22:45:25.348527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:25.377343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m22:45:25.377773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:25.407236 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m22:45:25.407880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:27.431663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a088c516-c7a2-45f0-9c4a-ca7bf3643ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002414817BD40>]}
[0m22:45:27.432414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:27.441638 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9
[0m22:45:27.442390 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:45:27.443085 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:45:27.444343 [debug] [Thread-4 (]: Began running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:45:27.443745 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_expression_is_true_fct_sales_item_transaction_id_0 . [RUN]
[0m22:45:27.445240 [info ] [Thread-3 (]: 3 of 6 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m22:45:27.447553 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9'
[0m22:45:27.445863 [info ] [Thread-2 (]: 2 of 6 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m22:45:27.448589 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m22:45:27.449418 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9
[0m22:45:27.446691 [info ] [Thread-4 (]: 4 of 6 START test relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [RUN]
[0m22:45:27.450446 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m22:45:27.451146 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:45:27.458258 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3'
[0m22:45:27.465547 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9"
[0m22:45:27.466168 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:45:27.474861 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:45:27.475499 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:45:27.480579 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:45:27.486701 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:45:27.488514 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9
[0m22:45:27.519079 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9"
[0m22:45:27.519666 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:45:27.520599 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:45:27.524939 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:45:27.527742 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:45:27.528284 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:45:27.531494 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:45:27.532298 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(transaction_id >= 0)


  
  
      
    ) dbt_internal_test
[0m22:45:27.532865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:27.533405 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:45:27.534041 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:45:27.596061 [debug] [Thread-4 (]: On test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sku as from_field
    from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
    where product_sku is not null
),

parent as (
    select product_sku as to_field
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:45:27.596592 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:45:27.597092 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:45:27.598642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:45:29.738421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f731c4d-e99f-4227-9f00-7a873cbfd06e&page=queryresults
[0m22:45:29.740478 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f731c4d-e99f-4227-9f00-7a873cbfd06e&page=queryresults
[0m22:45:29.755921 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d8e62244-53e8-4793-8509-58c7151347ca&page=queryresults
[0m22:45:29.783937 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_transaction_id_0 (models\mart\mart_models.yml)
  No matching signature for operator >= for argument types: STRING, INT64
    Signature: T1 >= T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.sql
[0m22:45:29.785214 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_expression_is_true_fct_sales_item_transaction_id_0 ...... [[31mERROR[0m in 2.34s]
[0m22:45:29.786895 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9
[0m22:45:29.787649 [debug] [Thread-1 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m22:45:29.788834 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_transaction_id_0 (models\mart\mart_models.yml)
  No matching signature for operator >= for argument types: STRING, INT64
    Signature: T1 >= T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.sql.
[0m22:45:29.789859 [info ] [Thread-1 (]: 5 of 6 START test test_non_negative_values ..................................... [RUN]
[0m22:45:29.792239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.f0e70190f9, now test.ga_retail_project.test_non_negative_values)
[0m22:45:29.793237 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m22:45:29.796859 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m22:45:29.798006 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m22:45:29.801215 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m22:45:29.802308 [debug] [Thread-1 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:45:29.802819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:29.838614 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:074f8cdb-6367-4f2a-8a2b-8732161fc509&page=queryresults
[0m22:45:29.855708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:32c10b72-fe89-4a26-8929-136d9e1bb6bb&page=queryresults
[0m22:45:30.743832 [info ] [Thread-2 (]: 2 of 6 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.29s]
[0m22:45:30.744775 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:45:30.745195 [debug] [Thread-2 (]: Began running node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m22:45:30.745578 [info ] [Thread-2 (]: 6 of 6 START test test_non_negative_values_fct_sales_item_ ..................... [RUN]
[0m22:45:30.746207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d, now test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122)
[0m22:45:30.746622 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m22:45:30.751276 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:45:30.756155 [debug] [Thread-2 (]: Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:45:30.756736 [error] [Thread-2 (]: 6 of 6 ERROR test_non_negative_values_fct_sales_item_ .......................... [[31mERROR[0m in 0.01s]
[0m22:45:30.757535 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122
[0m22:45:30.758053 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122' to be skipped because of status 'error'.  Reason: Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m22:45:30.918583 [info ] [Thread-3 (]: 3 of 6 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.47s]
[0m22:45:30.919435 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:45:31.558994 [info ] [Thread-4 (]: 4 of 6 PASS relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [[32mPASS[0m in 4.10s]
[0m22:45:31.562303 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:45:31.659041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:42846734-1b00-4f6b-8191-7b0882bd47c8&page=queryresults
[0m22:45:32.529943 [info ] [Thread-1 (]: 5 of 6 PASS test_non_negative_values ........................................... [[32mPASS[0m in 2.74s]
[0m22:45:32.533222 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m22:45:32.538668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:45:32.546041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:32.547416 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m22:45:32.548611 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m22:45:32.549801 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m22:45:32.550963 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m22:45:32.552149 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m22:45:32.553332 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values_fct_sales_item_.c803eed122' was properly closed.
[0m22:45:32.554498 [debug] [MainThread]: Connection 'test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3' was properly closed.
[0m22:45:32.556054 [info ] [MainThread]: 
[0m22:45:32.558091 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m22:45:32.564087 [debug] [MainThread]: Command end result
[0m22:45:32.616436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:45:32.619145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:45:32.627145 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m22:45:32.627536 [info ] [MainThread]: 
[0m22:45:32.628158 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:45:32.628786 [info ] [MainThread]: 
[0m22:45:32.629469 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_transaction_id_0 (models\mart\mart_models.yml)[0m
[0m22:45:32.630159 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_transaction_id_0 (models\mart\mart_models.yml)
  No matching signature for operator >= for argument types: STRING, INT64
    Signature: T1 >= T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [18:11]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.sql
[0m22:45:32.630794 [info ] [MainThread]: 
[0m22:45:32.631447 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_fct_sales_item_transaction_id_0.sql
[0m22:45:32.632011 [info ] [MainThread]: 
[0m22:45:32.632661 [error] [MainThread]: [31mFailure in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)[0m
[0m22:45:32.633309 [error] [MainThread]:   Compilation Error in test test_non_negative_values_fct_sales_item_ (models\mart\mart_models.yml)
  'test_test_non_negative_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:45:32.633909 [info ] [MainThread]: 
[0m22:45:32.634504 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m22:45:32.635797 [debug] [MainThread]: Command `dbt test` failed at 22:45:32.635665 after 12.45 seconds
[0m22:45:32.636244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024122C70590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024148134260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024148134100>]}
[0m22:45:32.636684 [debug] [MainThread]: Flushing usage events
[0m22:45:33.780868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:43.982674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BECADF02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BECBE3BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BECBE3B9D0>]}


============================== 22:46:43.987608 | b3ef76fd-f0e5-4790-a7eb-7d573631d5f2 ==============================
[0m22:46:43.987608 [info ] [MainThread]: Running with dbt=1.10.9
[0m22:46:43.988394 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m22:46:47.249187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3ef76fd-f0e5-4790-a7eb-7d573631d5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BECB14F6F0>]}
[0m22:46:47.312393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3ef76fd-f0e5-4790-a7eb-7d573631d5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEEF87B350>]}
[0m22:46:47.313022 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:46:48.002165 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m22:46:48.233600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:48.234380 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m22:46:48.720479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3ef76fd-f0e5-4790-a7eb-7d573631d5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF0F09750>]}
[0m22:46:48.830457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:46:48.833503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:46:48.878012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ef76fd-f0e5-4790-a7eb-7d573631d5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF133B980>]}
[0m22:46:48.878520 [info ] [MainThread]: Found 20 data tests, 5 models, 2 sources, 612 macros
[0m22:46:48.879106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ef76fd-f0e5-4790-a7eb-7d573631d5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF124BBD0>]}
[0m22:46:48.881042 [info ] [MainThread]: 
[0m22:46:48.881605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:46:48.882092 [info ] [MainThread]: 
[0m22:46:48.882779 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:46:48.887550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m22:46:48.887947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:48.888868 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m22:46:48.889492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:48.890046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m22:46:48.890408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.940124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ef76fd-f0e5-4790-a7eb-7d573631d5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF12E7EE0>]}
[0m22:46:50.941079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:50.955756 [debug] [Thread-3 (]: Began running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:46:50.956698 [debug] [Thread-4 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m22:46:50.957447 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:46:50.958262 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:46:50.959126 [info ] [Thread-3 (]: 3 of 4 START test relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [RUN]
[0m22:46:50.962732 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3'
[0m22:46:50.963648 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:46:50.987732 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:46:50.989922 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:46:50.959871 [info ] [Thread-4 (]: 4 of 4 START test test_non_negative_values ..................................... [RUN]
[0m22:46:51.013279 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.test_non_negative_values'
[0m22:46:51.038592 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m22:46:51.053196 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"
[0m22:46:50.960848 [info ] [Thread-1 (]: 1 of 4 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m22:46:51.059136 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m22:46:50.961716 [info ] [Thread-2 (]: 2 of 4 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m22:46:51.060582 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m22:46:51.061400 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m22:46:51.061978 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:46:51.062861 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:46:51.082794 [debug] [Thread-3 (]: On test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sku as from_field
    from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
    where product_sku is not null
),

parent as (
    select product_sku as to_field
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m22:46:51.085552 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:46:51.088441 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m22:46:51.096617 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:46:51.097439 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:46:51.101787 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m22:46:51.104413 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:46:51.107987 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m22:46:51.137508 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:46:51.138322 [debug] [Thread-4 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m22:46:51.141883 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m22:46:51.142806 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m22:46:51.143303 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:46:51.144061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:51.199523 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m22:46:51.200548 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:46:53.291966 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:61f4455e-a38d-4b5e-ba8a-c0ca3cfc9238&page=queryresults
[0m22:46:53.299548 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a016fedf-2591-49dd-81dd-44f83ff7799a&page=queryresults
[0m22:46:53.370187 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3f8c9d07-056a-462e-97cb-98fc390c5643&page=queryresults
[0m22:46:53.501244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2dbedb69-e064-49c1-9fbb-af54f775f256&page=queryresults
[0m22:46:54.233218 [info ] [Thread-2 (]: 2 of 4 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.17s]
[0m22:46:54.236603 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m22:46:54.267883 [info ] [Thread-4 (]: 4 of 4 PASS test_non_negative_values ........................................... [[32mPASS[0m in 3.25s]
[0m22:46:54.270316 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m22:46:54.411640 [info ] [Thread-1 (]: 1 of 4 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.35s]
[0m22:46:54.414771 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m22:46:55.535178 [info ] [Thread-3 (]: 3 of 4 PASS relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_  [[32mPASS[0m in 4.57s]
[0m22:46:55.539824 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3
[0m22:46:55.547946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:55.554436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:55.555264 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m22:46:55.556556 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m22:46:55.557796 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m22:46:55.559059 [debug] [MainThread]: Connection 'test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_stg_hits_products_.bcd5a509b3' was properly closed.
[0m22:46:55.560111 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m22:46:55.560934 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m22:46:55.561614 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m22:46:55.562392 [info ] [MainThread]: 
[0m22:46:55.563328 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m22:46:55.566240 [debug] [MainThread]: Command end result
[0m22:46:55.622654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m22:46:55.626294 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m22:46:55.634780 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m22:46:55.635203 [info ] [MainThread]: 
[0m22:46:55.635869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:55.636483 [info ] [MainThread]: 
[0m22:46:55.637216 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:46:55.638667 [debug] [MainThread]: Command `dbt test` succeeded at 22:46:55.638491 after 11.79 seconds
[0m22:46:55.639446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BECBE04650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF12FB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF12FA4C0>]}
[0m22:46:55.640342 [debug] [MainThread]: Flushing usage events
[0m22:46:57.614918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:18.642869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C08102F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C185BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C185B9D0>]}


============================== 00:18:18.651042 | c424ffdd-2e97-47f1-947d-7d87ed23e7a6 ==============================
[0m00:18:18.651042 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:18:18.652423 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_products', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:18:27.139783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C0B736F0>]}
[0m00:18:27.238547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E528B350>]}
[0m00:18:27.239456 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:18:28.479748 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:18:29.413507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:18:29.414295 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\dim_products.sql
[0m00:18:29.415102 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m00:18:30.119315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E68FD250>]}
[0m00:18:30.276830 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:18:30.282124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:18:30.341025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E534DD60>]}
[0m00:18:30.341682 [info ] [MainThread]: Found 22 data tests, 6 models, 2 sources, 612 macros
[0m00:18:30.342410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E6AC2DD0>]}
[0m00:18:30.345597 [info ] [MainThread]: 
[0m00:18:30.346947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:18:30.348068 [info ] [MainThread]: 
[0m00:18:30.349035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:18:30.350613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:18:30.351309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:32.658268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m00:18:32.659002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:32.659645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m00:18:32.660395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:32.661014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m00:18:32.661635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:35.139194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E6B587A0>]}
[0m00:18:35.139875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:35.157075 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_products
[0m00:18:35.157864 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m00:18:35.158863 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m00:18:35.159428 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_products
[0m00:18:35.171088 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m00:18:35.172649 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_products
[0m00:18:35.233645 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m00:18:35.235580 [debug] [Thread-1 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`dim_products`
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_products.sql
WITH products AS (
    SELECT
        product_sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(product_category) AS product_category
    FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
    WHERE product_sku IS NOT NULL
    GROUP BY product_sku
)

SELECT * FROM products
    );
  
[0m00:18:35.236264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:18:37.430571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:de8c4269-e4f6-4a32-a76d-0370b126e7ec&page=queryresults
[0m00:18:40.992287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c424ffdd-2e97-47f1-947d-7d87ed23e7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E6B671D0>]}
[0m00:18:40.993083 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (435.0 rows, 3.3 MiB processed)[0m in 5.83s]
[0m00:18:40.993999 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_products
[0m00:18:40.995506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:40.997343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:40.997692 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:18:40.998014 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m00:18:40.998327 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m00:18:40.998639 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:18:40.999027 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m00:18:40.999458 [info ] [MainThread]: 
[0m00:18:41.000054 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.65 seconds (10.65s).
[0m00:18:41.001072 [debug] [MainThread]: Command end result
[0m00:18:41.038518 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:18:41.041196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:18:41.047972 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:18:41.048355 [info ] [MainThread]: 
[0m00:18:41.049115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:41.049887 [info ] [MainThread]: 
[0m00:18:41.050462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:18:41.051862 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:41.051695 after 22.69 seconds
[0m00:18:41.052308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E67EFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4BF0A2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4E6C77A70>]}
[0m00:18:41.052745 [debug] [MainThread]: Flushing usage events
[0m00:18:43.334799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:07.598523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E35502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E459BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E459B9D0>]}


============================== 00:20:07.603658 | 56f10b53-66cb-43d5-b6b5-b08d98a8bab2 ==============================
[0m00:20:07.603658 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:20:07.604409 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select path:models/mart', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:20:11.013335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56f10b53-66cb-43d5-b6b5-b08d98a8bab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E38B36F0>]}
[0m00:20:11.076182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56f10b53-66cb-43d5-b6b5-b08d98a8bab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18801B350>]}
[0m00:20:11.076833 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:20:11.811903 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:20:12.040817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:20:12.041185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:20:12.094463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56f10b53-66cb-43d5-b6b5-b08d98a8bab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1880A9650>]}
[0m00:20:12.206205 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:20:12.208603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:20:12.260650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56f10b53-66cb-43d5-b6b5-b08d98a8bab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E189802B70>]}
[0m00:20:12.261171 [info ] [MainThread]: Found 22 data tests, 6 models, 2 sources, 612 macros
[0m00:20:12.261740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56f10b53-66cb-43d5-b6b5-b08d98a8bab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E189815FD0>]}
[0m00:20:12.265018 [info ] [MainThread]: 
[0m00:20:12.265689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:20:12.266267 [info ] [MainThread]: 
[0m00:20:12.267040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:20:12.271887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m00:20:12.272280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:12.303344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m00:20:12.304412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:12.304964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m00:20:12.305316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:14.455336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56f10b53-66cb-43d5-b6b5-b08d98a8bab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18989B6C0>]}
[0m00:20:14.456583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:20:14.466824 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m00:20:14.467528 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m00:20:14.468236 [debug] [Thread-4 (]: Began running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66
[0m00:20:14.468698 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m00:20:14.469190 [info ] [Thread-1 (]: 1 of 6 START test not_null_dim_products_product_sku ............................ [RUN]
[0m00:20:14.469684 [info ] [Thread-3 (]: 3 of 6 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m00:20:14.472146 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343'
[0m00:20:14.472998 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7'
[0m00:20:14.473831 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m00:20:14.470305 [info ] [Thread-4 (]: 4 of 6 START test relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_  [RUN]
[0m00:20:14.474884 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m00:20:14.471144 [info ] [Thread-2 (]: 2 of 6 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m00:20:14.506548 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m00:20:14.507499 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66'
[0m00:20:14.513143 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m00:20:14.514013 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m00:20:14.515204 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66
[0m00:20:14.516289 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m00:20:14.527448 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66"
[0m00:20:14.533087 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m00:20:14.534368 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m00:20:14.535144 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m00:20:14.563263 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m00:20:14.566618 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m00:20:14.567594 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66
[0m00:20:14.568168 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m00:20:14.570978 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66"
[0m00:20:14.575091 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m00:20:14.575934 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m00:20:14.576934 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from `e2e-dbt-project`.`analytics_mart`.`dim_products`
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m00:20:14.577629 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:20:14.578278 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:20:14.578769 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m00:20:14.579465 [debug] [Thread-4 (]: On test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_sku as from_field
    from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
    where product_sku is not null
),

parent as (
    select product_sku as to_field
    from `e2e-dbt-project`.`analytics_mart`.`dim_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:20:14.580061 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:20:14.580653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:20:16.967998 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:32302d80-57f9-4514-8efe-1a21c825e396&page=queryresults
[0m00:20:16.977580 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:64361367-7e0a-492e-bc03-0f4fa43b1936&page=queryresults
[0m00:20:17.148990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:43a294f6-c755-4a00-a1eb-20457478a762&page=queryresults
[0m00:20:17.218185 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0ce4cedd-77f6-4e80-b28e-89f079bbf0c0&page=queryresults
[0m00:20:17.886327 [info ] [Thread-2 (]: 2 of 6 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.37s]
[0m00:20:17.887407 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m00:20:17.888110 [debug] [Thread-2 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m00:20:17.888707 [info ] [Thread-2 (]: 5 of 6 START test test_non_negative_values ..................................... [RUN]
[0m00:20:17.889312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d, now test.ga_retail_project.test_non_negative_values)
[0m00:20:17.889725 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m00:20:17.892487 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m00:20:17.902341 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m00:20:17.906096 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m00:20:17.907732 [debug] [Thread-2 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m00:20:17.908678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:20:17.943607 [info ] [Thread-3 (]: 3 of 6 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 3.47s]
[0m00:20:17.944702 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m00:20:17.945181 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m00:20:17.945696 [info ] [Thread-3 (]: 6 of 6 START test unique_dim_products_product_sku .............................. [RUN]
[0m00:20:17.946627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m00:20:17.947103 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m00:20:17.955985 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m00:20:17.957674 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m00:20:17.963510 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m00:20:17.965282 [debug] [Thread-3 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from `e2e-dbt-project`.`analytics_mart`.`dim_products`
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:20:17.966175 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:20:18.054734 [info ] [Thread-1 (]: 1 of 6 PASS not_null_dim_products_product_sku .................................. [[32mPASS[0m in 3.58s]
[0m00:20:18.056059 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m00:20:18.096173 [info ] [Thread-4 (]: 4 of 6 PASS relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_  [[32mPASS[0m in 3.59s]
[0m00:20:18.098105 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66
[0m00:20:20.263605 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b37f1c8b-b804-48f9-accc-8d89f03884dd&page=queryresults
[0m00:20:20.455851 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2f4e0ce8-2bb6-425f-8bed-67f40e010d6d&page=queryresults
[0m00:20:21.168758 [info ] [Thread-2 (]: 5 of 6 PASS test_non_negative_values ........................................... [[32mPASS[0m in 3.28s]
[0m00:20:21.169915 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m00:20:21.333040 [info ] [Thread-3 (]: 6 of 6 PASS unique_dim_products_product_sku .................................... [[32mPASS[0m in 3.39s]
[0m00:20:21.336542 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m00:20:21.342177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:20:21.349532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:21.351430 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m00:20:21.353016 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:20:21.354715 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m00:20:21.356128 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343' was properly closed.
[0m00:20:21.357406 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m00:20:21.358702 [debug] [MainThread]: Connection 'test.ga_retail_project.relationships_fct_sales_item_product_sku__product_sku__ref_dim_products_.d2e8855c66' was properly closed.
[0m00:20:21.359946 [debug] [MainThread]: Connection 'test.ga_retail_project.test_non_negative_values' was properly closed.
[0m00:20:21.361451 [info ] [MainThread]: 
[0m00:20:21.363439 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 9.09 seconds (9.09s).
[0m00:20:21.374629 [debug] [MainThread]: Command end result
[0m00:20:21.428544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:20:21.431434 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:20:21.440777 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:20:21.441195 [info ] [MainThread]: 
[0m00:20:21.441839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:20:21.442397 [info ] [MainThread]: 
[0m00:20:21.442967 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m00:20:21.444166 [debug] [MainThread]: Command `dbt test` succeeded at 00:20:21.444039 after 14.04 seconds
[0m00:20:21.444569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E4570590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E189C53CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E189C53E30>]}
[0m00:20:21.444969 [debug] [MainThread]: Flushing usage events
[0m00:20:23.786613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:14.760771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F6AE42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F4749D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F7B2BD90>]}


============================== 01:26:14.767200 | e299b78b-f92a-4f17-bde6-21ce8db4824c ==============================
[0m01:26:14.767200 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:26:14.768242 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt source freshness --select source:ext.*', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:26:19.329454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e299b78b-f92a-4f17-bde6-21ce8db4824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F6E43950>]}
[0m01:26:19.427305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e299b78b-f92a-4f17-bde6-21ce8db4824c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B09C6A2F10>]}
[0m01:26:19.428311 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:26:20.479409 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:26:20.698540 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading ga_retail_project: staging\sources.yml - Runtime Error
    Syntax error near line 11
    ------------------------------
    8  | 
    9  |     tables:
    10 |             - name: country_currency
    11 |         description: "Mapping of countries to local currencies."
    12 |         loaded_at_field: rate_date   # if you don’t have one, add a static ‘_loaded_at’ during load; else remove freshness
    13 |         freshness:
    14 |           warn_after: { count: 14, period: day }
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 11, column 9
[0m01:26:20.700907 [debug] [MainThread]: Command `dbt source freshness` failed at 01:26:20.700710 after 6.21 seconds
[0m01:26:20.701920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B09CD29150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B09CD28E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B09CD2CC80>]}
[0m01:26:20.702673 [debug] [MainThread]: Flushing usage events
[0m01:26:23.874166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:23.446123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A24F9242F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A24D599D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A25096BD90>]}


============================== 01:27:23.453106 | 736b786a-c348-4faa-85d8-2603ad236365 ==============================
[0m01:27:23.453106 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:27:23.454242 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt source freshness --select source:ext.*', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:27:25.819114 [error] [MainThread]: Encountered an error:

[0m01:27:25.845317 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 268, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\config\runtime.py", line 78, in load_profile
    profile = Profile.render(
        profile_renderer, profile_name, profile_name_override, target_override, threads_override
    )
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
           ~~~~~~~~~~~~~~~~~~~~~^
        raw_profiles=raw_profiles,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        threads_override=threads_override,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        raw_profile=raw_profile,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        threads_override=threads_override,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        profile_data, profile_name, target_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
           ~~~~~~~~~~~~~~~~~~~^^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\adapters\bigquery\__init__.py", line 2, in <module>
    from dbt.adapters.bigquery.connections import BigQueryConnectionManager
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\adapters\bigquery\connections.py", line 39, in <module>
    from dbt.adapters.bigquery.clients import create_bigquery_client
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\adapters\bigquery\clients.py", line 9, in <module>
    from google.cloud.storage import Client as StorageClient
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\google\cloud\storage\__init__.py", line 36, in <module>
    from google.cloud.storage.blob import Blob
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\google\cloud\storage\blob.py", line 61, in <module>
    from google.cloud.storage._signing import generate_signed_url_v2
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1022, in exec_module
  File "<frozen importlib._bootstrap_external>", line 1118, in get_code
  File "<frozen importlib._bootstrap_external>", line 1217, in get_data
KeyboardInterrupt

[0m01:27:25.848224 [debug] [MainThread]: Command `dbt source freshness` failed at 01:27:25.848034 after 2.59 seconds
[0m01:27:25.848766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26E874510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26E7BF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26E841590>]}
[0m01:27:25.849415 [debug] [MainThread]: Flushing usage events
[0m01:27:27.328976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:36.923535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34C2942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349EF9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34D2DBD90>]}


============================== 01:27:36.930001 | e7412ebd-013a-4bd5-b0f6-8aa0614ae01e ==============================
[0m01:27:36.930001 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:27:36.930969 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt source freshness --select source:ext.*', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:27:41.386718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34C5EF950>]}
[0m01:27:41.483656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C371D12F10>]}
[0m01:27:41.484572 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:27:42.560814 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:27:42.881659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 3 files changed.
[0m01:27:42.882449 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\dim_visitors.sql
[0m01:27:42.882969 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\dim_country.sql
[0m01:27:42.883469 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\dim_date.sql
[0m01:27:42.884649 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\sources.yml
[0m01:27:42.885453 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m01:27:42.885969 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\fct_sales_item.sql
[0m01:27:43.576712 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m01:27:43.577574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C371D6DB50>]}
[0m01:27:43.907007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3723A33E0>]}
[0m01:27:44.059250 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:44.062613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:44.108121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37278A510>]}
[0m01:27:44.108777 [info ] [MainThread]: Found 31 data tests, 9 models, 2 sources, 612 macros
[0m01:27:44.109474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3728D58B0>]}
[0m01:27:44.112029 [info ] [MainThread]: 
[0m01:27:44.112713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:27:44.113372 [info ] [MainThread]: 
[0m01:27:44.114226 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:44.120657 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:27:44.121338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:44.121992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:27:44.122758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:44.123454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:27:44.123930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:46.687800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7412ebd-013a-4bd5-b0f6-8aa0614ae01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3728C1FD0>]}
[0m01:27:46.689507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:46.709496 [debug] [Thread-1 (]: Began running node source.ga_retail_project.ext.country_currency
[0m01:27:46.711117 [debug] [Thread-2 (]: Began running node source.ga_retail_project.ext.fx_rates
[0m01:27:46.712677 [info ] [Thread-1 (]: 1 of 2 START freshness of ext.country_currency ................................. [RUN]
[0m01:27:46.716472 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.ga_retail_project.ext.country_currency'
[0m01:27:46.714164 [info ] [Thread-2 (]: 2 of 2 START freshness of ext.fx_rates ......................................... [RUN]
[0m01:27:46.718393 [debug] [Thread-1 (]: Began compiling node source.ga_retail_project.ext.country_currency
[0m01:27:46.720173 [debug] [Thread-2 (]: Acquiring new bigquery connection 'source.ga_retail_project.ext.fx_rates'
[0m01:27:46.721337 [debug] [Thread-1 (]: Began executing node source.ga_retail_project.ext.country_currency
[0m01:27:46.722455 [debug] [Thread-2 (]: Began compiling node source.ga_retail_project.ext.fx_rates
[0m01:27:46.749391 [debug] [Thread-1 (]: On source.ga_retail_project.ext.country_currency: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "source.ga_retail_project.ext.country_currency"} */
select
      max(rate_date) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `e2e-dbt-project`.`ext`.`country_currency`
    
  
[0m01:27:46.750131 [debug] [Thread-2 (]: Began executing node source.ga_retail_project.ext.fx_rates
[0m01:27:46.750805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:27:46.754617 [debug] [Thread-2 (]: On source.ga_retail_project.ext.fx_rates: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "source.ga_retail_project.ext.fx_rates"} */
select
      max(rate_date) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `e2e-dbt-project`.`ext`.`fx_rates`
    
  
[0m01:27:46.755545 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:27:49.341130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:256b34c6-7f0c-42eb-a30e-e76728c24365&page=queryresults
[0m01:27:49.343149 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:256b34c6-7f0c-42eb-a30e-e76728c24365&page=queryresults
[0m01:27:49.345616 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
macro collect_freshness
[0m01:27:49.347285 [debug] [Thread-1 (]: BigQuery adapter: Database Error
  Unrecognized name: rate_date at [3:11]
[0m01:27:49.414723 [debug] [Thread-1 (]: Database Error in source country_currency (models\staging\sources.yml)
  Unrecognized name: rate_date at [3:11]
[0m01:27:49.415585 [error] [Thread-1 (]: 1 of 2 ERROR freshness of ext.country_currency ................................. [[31mERROR[0m in 2.70s]
[0m01:27:49.416698 [debug] [Thread-1 (]: Finished running node source.ga_retail_project.ext.country_currency
[0m01:27:49.480530 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:afab9c3c-942b-44aa-9ad8-745e74b68160&page=queryresults
[0m01:27:50.516684 [error] [Thread-2 (]: 2 of 2 ERROR STALE freshness of ext.fx_rates ................................... [[31mERROR STALE[0m in 3.80s]
[0m01:27:50.519982 [debug] [Thread-2 (]: Finished running node source.ga_retail_project.ext.fx_rates
[0m01:27:50.522841 [debug] [Thread-7 (]: Marking all children of 'source.ga_retail_project.ext.fx_rates' to be skipped because of status 'error'. 
[0m01:27:50.530382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:50.537490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:50.539263 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:27:50.541698 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:27:50.544125 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:27:50.546562 [debug] [MainThread]: Connection 'source.ga_retail_project.ext.country_currency' was properly closed.
[0m01:27:50.549078 [debug] [MainThread]: Connection 'source.ga_retail_project.ext.fx_rates' was properly closed.
[0m01:27:50.551611 [info ] [MainThread]: 
[0m01:27:50.554099 [info ] [MainThread]: Finished running 2 sources in 0 hours 0 minutes and 6.44 seconds (6.44s).
[0m01:27:50.781398 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:50.784706 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:50.791974 [debug] [MainThread]: Wrote artifact FreshnessResult to C:\Projects\ga_retail_project\target\sources.json
[0m01:27:50.792450 [info ] [MainThread]: 
[0m01:27:50.793252 [error] [MainThread]:   Database Error in source country_currency (models\staging\sources.yml)
  Unrecognized name: rate_date at [3:11]
[0m01:27:50.793944 [info ] [MainThread]: 
[0m01:27:50.794783 [error] [MainThread]: [31mFailure in source fx_rates (models\staging\sources.yml)[0m
[0m01:27:50.795552 [error] [MainThread]:   Status: error
[0m01:27:50.796201 [info ] [MainThread]: Done.
[0m01:27:50.797186 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:27:50.798943 [debug] [MainThread]: Command `dbt source freshness` failed at 01:27:50.798774 after 14.06 seconds
[0m01:27:50.799495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C370CFD9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37273C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C372700CD0>]}
[0m01:27:50.800028 [debug] [MainThread]: Flushing usage events
[0m01:27:52.081374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:29.429877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1A64042F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1A4069D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1A744BD90>]}


============================== 01:28:29.434907 | 15b9f82a-f90c-4ec3-8bbb-5a2527d422a7 ==============================
[0m01:28:29.434907 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:28:29.435775 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt source freshness --select source:ext.*', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:28:32.882236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1A675F950>]}
[0m01:28:32.947523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CBE92F10>]}
[0m01:28:32.948182 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:28:33.643634 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:28:33.877757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:28:33.878963 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\sources.yml
[0m01:28:34.376802 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m01:28:34.377485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CBEED950>]}
[0m01:28:34.601874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CC53B020>]}
[0m01:28:34.721458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:28:34.724076 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:28:34.758249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CC7D8D70>]}
[0m01:28:34.758744 [info ] [MainThread]: Found 31 data tests, 9 models, 2 sources, 612 macros
[0m01:28:34.759304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CCA2D230>]}
[0m01:28:34.761126 [info ] [MainThread]: 
[0m01:28:34.761673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:28:34.762191 [info ] [MainThread]: 
[0m01:28:34.762895 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:34.768035 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:28:34.768459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:34.797835 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:28:34.798266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:34.801899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:28:34.802274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:36.702034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b9f82a-f90c-4ec3-8bbb-5a2527d422a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CCA46750>]}
[0m01:28:36.703964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:36.724151 [debug] [Thread-1 (]: Began running node source.ga_retail_project.ext.fx_rates
[0m01:28:36.725556 [info ] [Thread-1 (]: 1 of 1 START freshness of ext.fx_rates ......................................... [RUN]
[0m01:28:36.727265 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.ga_retail_project.ext.fx_rates'
[0m01:28:36.728084 [debug] [Thread-1 (]: Began compiling node source.ga_retail_project.ext.fx_rates
[0m01:28:36.728911 [debug] [Thread-1 (]: Began executing node source.ga_retail_project.ext.fx_rates
[0m01:28:36.749548 [debug] [Thread-1 (]: On source.ga_retail_project.ext.fx_rates: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "source.ga_retail_project.ext.fx_rates"} */
select
      max(rate_date) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `e2e-dbt-project`.`ext`.`fx_rates`
    
  
[0m01:28:36.750150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:28:38.611119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e18bf249-66d9-4bf1-a4d3-4c7597fbedbd&page=queryresults
[0m01:28:39.656500 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of ext.fx_rates ................................... [[31mERROR STALE[0m in 2.93s]
[0m01:28:39.659871 [debug] [Thread-1 (]: Finished running node source.ga_retail_project.ext.fx_rates
[0m01:28:39.662355 [debug] [Thread-7 (]: Marking all children of 'source.ga_retail_project.ext.fx_rates' to be skipped because of status 'error'. 
[0m01:28:39.669655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:39.676069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:39.677371 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:28:39.678605 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:28:39.680038 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:28:39.681548 [debug] [MainThread]: Connection 'source.ga_retail_project.ext.fx_rates' was properly closed.
[0m01:28:39.682895 [info ] [MainThread]: 
[0m01:28:39.684929 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m01:28:39.761218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:28:39.763948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:28:39.770579 [debug] [MainThread]: Wrote artifact FreshnessResult to C:\Projects\ga_retail_project\target\sources.json
[0m01:28:39.771032 [info ] [MainThread]: 
[0m01:28:39.771767 [error] [MainThread]: [31mFailure in source fx_rates (models\staging\sources.yml)[0m
[0m01:28:39.772410 [error] [MainThread]:   Status: error
[0m01:28:39.772970 [info ] [MainThread]: Done.
[0m01:28:39.773815 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:28:39.775174 [debug] [MainThread]: Command `dbt source freshness` failed at 01:28:39.775039 after 10.49 seconds
[0m01:28:39.775625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CC3E3120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CCA07ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1CCA079D0>]}
[0m01:28:39.776062 [debug] [MainThread]: Flushing usage events
[0m01:28:41.140343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:58:27.778201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D8C742F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D68D9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D9CB3D90>]}


============================== 01:58:27.784467 | 18035749-4ff9-423c-ad0d-636be61a00e2 ==============================
[0m01:58:27.784467 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:58:27.785409 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:58:28.013537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18035749-4ff9-423c-ad0d-636be61a00e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D8FD3950>]}
[0m01:58:28.133449 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-b049qhae'
[0m01:58:28.134048 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:58:30.050814 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:58:30.061230 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:58:30.861734 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:58:30.875833 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:58:32.046907 [info ] [MainThread]: Installed from version 1.3.0
[0m01:58:32.047613 [info ] [MainThread]: Up to date!
[0m01:58:32.048296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '18035749-4ff9-423c-ad0d-636be61a00e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D9D25590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D9D25F20>]}
[0m01:58:32.050722 [debug] [MainThread]: Command `dbt deps` succeeded at 01:58:32.050543 after 4.54 seconds
[0m01:58:32.051230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3DAF01750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D9B328A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3D9E947D0>]}
[0m01:58:32.051757 [debug] [MainThread]: Flushing usage events
[0m01:58:33.622826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:58:46.446858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E19AC42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E17739D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E1AB0FD90>]}


============================== 01:58:46.453097 | baa03c9c-028e-4499-9c74-04852aee7ec0 ==============================
[0m01:58:46.453097 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:58:46.454054 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt source freshness --select source:ext.fx_rates', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:58:50.982700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E19E1F950>]}
[0m01:58:51.090368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3F5B6F10>]}
[0m01:58:51.091312 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:58:52.202422 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:58:52.388521 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:58:52.389328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3FC25450>]}
[0m01:58:55.988875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3FC433E0>]}
[0m01:58:56.165874 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:58:56.169263 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:58:56.215917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E3FC4ADD0>]}
[0m01:58:56.216574 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:58:56.217277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E40194600>]}
[0m01:58:56.219827 [info ] [MainThread]: 
[0m01:58:56.220477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:58:56.221124 [info ] [MainThread]: 
[0m01:58:56.222049 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:58:56.228913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:58:56.229403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:56.230362 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:58:56.230844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:56.270932 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:58:56.272052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:58.818629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa03c9c-028e-4499-9c74-04852aee7ec0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E4003A510>]}
[0m01:58:58.820512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:58:58.834943 [debug] [Thread-1 (]: Began running node source.ga_retail_project.ext.fx_rates
[0m01:58:58.835728 [info ] [Thread-1 (]: 1 of 1 START freshness of ext.fx_rates ......................................... [RUN]
[0m01:58:58.836860 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.ga_retail_project.ext.fx_rates'
[0m01:58:58.837545 [debug] [Thread-1 (]: Began compiling node source.ga_retail_project.ext.fx_rates
[0m01:58:58.838206 [debug] [Thread-1 (]: Began executing node source.ga_retail_project.ext.fx_rates
[0m01:58:58.858753 [debug] [Thread-1 (]: On source.ga_retail_project.ext.fx_rates: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "source.ga_retail_project.ext.fx_rates"} */
select
      max(rate_date) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from e2e-dbt-project.ext.fx_rates
    
  
[0m01:58:58.859408 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:59:01.311607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8aa4f150-4427-4472-aa93-e5ecbe0c0595&page=queryresults
[0m01:59:02.330862 [debug] [Thread-1 (]: Database Error in source fx_rates (models\staging\sources.yml)
  Expected a timestamp value when querying field 'last_modified' of table None but received value of type 'date' instead
[0m01:59:02.331814 [error] [Thread-1 (]: 1 of 1 ERROR freshness of ext.fx_rates ......................................... [[31mERROR[0m in 3.50s]
[0m01:59:02.333165 [debug] [Thread-1 (]: Finished running node source.ga_retail_project.ext.fx_rates
[0m01:59:02.335395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:59:02.337846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:59:02.338301 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:59:02.338721 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:59:02.339139 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:59:02.339546 [debug] [MainThread]: Connection 'source.ga_retail_project.ext.fx_rates' was properly closed.
[0m01:59:02.340005 [info ] [MainThread]: 
[0m01:59:02.340649 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m01:59:02.394938 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:59:02.398365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:59:02.402661 [debug] [MainThread]: Wrote artifact FreshnessResult to C:\Projects\ga_retail_project\target\sources.json
[0m01:59:02.403136 [info ] [MainThread]: 
[0m01:59:02.403913 [error] [MainThread]:   Database Error in source fx_rates (models\staging\sources.yml)
  Expected a timestamp value when querying field 'last_modified' of table None but received value of type 'date' instead
[0m01:59:02.404614 [info ] [MainThread]: Done.
[0m01:59:02.406226 [debug] [MainThread]: Command `dbt source freshness` failed at 01:59:02.406059 after 16.14 seconds
[0m01:59:02.406785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E40187960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E40180190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E401800F0>]}
[0m01:59:02.407363 [debug] [MainThread]: Flushing usage events
[0m01:59:03.651406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:59.806080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFD7342F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFB399D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFE773D90>]}


============================== 02:00:59.811296 | b025887d-89d5-4550-8583-4a0d0826c9ae ==============================
[0m02:00:59.811296 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:00:59.812162 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:01:00.001446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b025887d-89d5-4550-8583-4a0d0826c9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFDA93950>]}
[0m02:01:00.113654 [debug] [MainThread]: Command `dbt clean` succeeded at 02:01:00.113513 after 0.50 seconds
[0m02:01:00.114071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFE7E58C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFE7E5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FFF9CC650>]}
[0m02:01:00.114554 [debug] [MainThread]: Flushing usage events
[0m02:01:02.392901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:06.395202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204251842F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020422E09D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204261C3D90>]}


============================== 02:01:06.400240 | 5933766e-e113-4cbb-8dd8-495106a85f93 ==============================
[0m02:01:06.400240 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:01:06.401036 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:01:06.568464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5933766e-e113-4cbb-8dd8-495106a85f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204254E3950>]}
[0m02:01:06.605903 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-tzsrba9a'
[0m02:01:06.606339 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:01:08.528735 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:01:08.533984 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:01:09.080470 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:01:09.099049 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:01:09.956369 [info ] [MainThread]: Installed from version 1.3.0
[0m02:01:09.956900 [info ] [MainThread]: Up to date!
[0m02:01:09.957399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5933766e-e113-4cbb-8dd8-495106a85f93', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426235590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426235F20>]}
[0m02:01:09.959123 [debug] [MainThread]: Command `dbt deps` succeeded at 02:01:09.958995 after 3.70 seconds
[0m02:01:09.959480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020427451750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204260428A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204274047D0>]}
[0m02:01:09.959843 [debug] [MainThread]: Flushing usage events
[0m02:01:11.070465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:01:14.827189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8FF442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8DC19D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C90F8FD90>]}


============================== 02:01:14.833352 | 477092d7-af56-45a8-9625-a5333efd3d60 ==============================
[0m02:01:14.833352 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:01:14.835358 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt source freshness --select source:ext.fx_rates', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:01:18.315748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C902A3950>]}
[0m02:01:18.381125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB49F6F10>]}
[0m02:01:18.381793 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:01:19.083924 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:01:19.085148 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:01:19.085739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB4A4CA50>]}
[0m02:01:21.389367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB5F22300>]}
[0m02:01:21.523326 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:01:21.526159 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:01:21.563037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB4ADE7B0>]}
[0m02:01:21.563547 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:01:21.564130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB636D570>]}
[0m02:01:21.566093 [info ] [MainThread]: 
[0m02:01:21.566650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:01:21.567154 [info ] [MainThread]: 
[0m02:01:21.567848 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:01:21.572929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:01:21.573297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:21.603568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:01:21.604015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:21.633907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:01:21.634400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:01:23.558630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '477092d7-af56-45a8-9625-a5333efd3d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB6021790>]}
[0m02:01:23.560714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:01:23.581911 [debug] [Thread-1 (]: Began running node source.ga_retail_project.ext.fx_rates
[0m02:01:23.583690 [info ] [Thread-1 (]: 1 of 1 START freshness of ext.fx_rates ......................................... [RUN]
[0m02:01:23.586301 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.ga_retail_project.ext.fx_rates'
[0m02:01:23.587914 [debug] [Thread-1 (]: Began compiling node source.ga_retail_project.ext.fx_rates
[0m02:01:23.589450 [debug] [Thread-1 (]: Began executing node source.ga_retail_project.ext.fx_rates
[0m02:01:23.614717 [debug] [Thread-1 (]: On source.ga_retail_project.ext.fx_rates: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "source.ga_retail_project.ext.fx_rates"} */
select
      max(TIMESTAMP(rate_date)) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from e2e-dbt-project.ext.fx_rates
    
  
[0m02:01:23.615352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:01:25.605127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:17c9e702-1642-4d38-ac79-ad614cdd2165&page=queryresults
[0m02:01:26.603716 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of ext.fx_rates .......................................... [[33mWARN[0m in 3.02s]
[0m02:01:26.604842 [debug] [Thread-1 (]: Finished running node source.ga_retail_project.ext.fx_rates
[0m02:01:26.606758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:01:26.608938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:01:26.609402 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:01:26.609852 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:01:26.610299 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:01:26.610733 [debug] [MainThread]: Connection 'source.ga_retail_project.ext.fx_rates' was properly closed.
[0m02:01:26.611211 [info ] [MainThread]: 
[0m02:01:26.611932 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m02:01:26.657582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:01:26.660539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:01:26.666997 [debug] [MainThread]: Wrote artifact FreshnessResult to C:\Projects\ga_retail_project\target\sources.json
[0m02:01:26.667426 [info ] [MainThread]: Done.
[0m02:01:26.668853 [debug] [MainThread]: Command `dbt source freshness` succeeded at 02:01:26.668702 after 11.98 seconds
[0m02:01:26.669333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB6323B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB4B8CD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB4B8F4D0>]}
[0m02:01:26.669823 [debug] [MainThread]: Flushing usage events
[0m02:01:27.778017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:04.621607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D51042F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D2D79D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D614BD90>]}


============================== 02:03:04.626608 | 66bb9081-7eab-4406-a0f1-95ef03c89ce9 ==============================
[0m02:03:04.626608 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:03:04.627402 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:03:07.959301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3D5463950>]}
[0m02:03:08.030527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3F9BE2F10>]}
[0m02:03:08.031181 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:03:08.674346 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:03:08.925623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:03:08.925990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:03:08.996053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3F9C3D450>]}
[0m02:03:09.130750 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:03:09.133230 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:03:09.168092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FB260D70>]}
[0m02:03:09.168591 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:03:09.169149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FB17ADD0>]}
[0m02:03:09.171483 [info ] [MainThread]: 
[0m02:03:09.172022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:03:09.172536 [info ] [MainThread]: 
[0m02:03:09.173229 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:03:09.174366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:03:09.174735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:10.842456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:03:10.843168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:10.843793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:03:10.844601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:10.845257 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:03:10.845930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:12.744770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FB407930>]}
[0m02:03:12.745389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:12.753123 [debug] [Thread-1 (]: Began running node seed.ga_retail_project.product_categories
[0m02:03:12.753848 [info ] [Thread-1 (]: 1 of 1 START seed file analytics_stg.product_categories ........................ [RUN]
[0m02:03:12.754790 [debug] [Thread-1 (]: Acquiring new bigquery connection 'seed.ga_retail_project.product_categories'
[0m02:03:12.755259 [debug] [Thread-1 (]: Began compiling node seed.ga_retail_project.product_categories
[0m02:03:12.755722 [debug] [Thread-1 (]: Began executing node seed.ga_retail_project.product_categories
[0m02:03:12.889312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:18.271746 [debug] [Thread-1 (]: On seed.ga_retail_project.product_categories: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "seed.ga_retail_project.product_categories"} */

    alter table e2e-dbt-project.analytics_stg.product_categories set OPTIONS()
  
[0m02:03:18.709943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:416bbeb7-bcd7-4654-9838-f2d055066408&page=queryresults
[0m02:03:19.242884 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ga_retail_project.product_categories"
[0m02:03:19.278551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66bb9081-7eab-4406-a0f1-95ef03c89ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FBA98A10>]}
[0m02:03:19.279192 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics_stg.product_categories .................... [[32mINSERT 3[0m in 6.52s]
[0m02:03:19.280148 [debug] [Thread-1 (]: Finished running node seed.ga_retail_project.product_categories
[0m02:03:19.281684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:03:19.283571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:19.283935 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:03:19.284281 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:03:19.284626 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:03:19.284968 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:03:19.285311 [debug] [MainThread]: Connection 'seed.ga_retail_project.product_categories' was properly closed.
[0m02:03:19.285684 [info ] [MainThread]: 
[0m02:03:19.286249 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m02:03:19.287740 [debug] [MainThread]: Command end result
[0m02:03:19.336771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:03:19.339376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:03:19.346240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:03:19.346655 [info ] [MainThread]: 
[0m02:03:19.347308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:19.347877 [info ] [MainThread]: 
[0m02:03:19.348500 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:03:19.349773 [debug] [MainThread]: Command `dbt seed` succeeded at 02:03:19.349640 after 14.96 seconds
[0m02:03:19.350203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FB34BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FB3BD4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3FB3BD590>]}
[0m02:03:19.350659 [debug] [MainThread]: Flushing usage events
[0m02:03:20.751127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:56.787375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624D2142F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624AE89D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624E25BD90>]}


============================== 02:03:56.792287 | 1c41a562-55c5-4602-80c0-8b129228f950 ==============================
[0m02:03:56.792287 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:03:56.793082 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select +fct_sales_item', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:04:00.138604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624D56F950>]}
[0m02:04:00.206489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016272CA6F10>]}
[0m02:04:00.207180 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:04:00.905722 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:04:01.156930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:01.157333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:01.231367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016272CFD350>]}
[0m02:04:01.364505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:01.366955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:01.407458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016272D257C0>]}
[0m02:04:01.407950 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:04:01.408522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273268050>]}
[0m02:04:01.410756 [info ] [MainThread]: 
[0m02:04:01.411365 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:04:01.411904 [info ] [MainThread]: 
[0m02:04:01.412610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:01.417176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:01.417550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:01.446228 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:01.447133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:01.476523 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:01.477318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:04.500251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:04:04.502182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:04.504075 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:04:04.506228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:04.508216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:04:04.510238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:06.440829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162734FB520>]}
[0m02:04:06.441570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:06.449653 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:04:06.450248 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:04:06.450922 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:04:06.452348 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:04:06.452835 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:04:06.462735 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:04:06.451565 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:04:06.463783 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:04:06.464294 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:04:06.466924 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:04:06.470499 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:04:06.471173 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:04:06.537020 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:04:06.539610 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:04:06.542854 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m02:04:06.543584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:06.544293 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m02:04:06.544817 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:04:08.672151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3a6da024-4c19-4eaf-be9c-2936319555ab&page=queryresults
[0m02:04:08.678419 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6ad8e983-da97-4bb4-b559-179c25e7a915&page=queryresults
[0m02:04:09.408482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001627345BAD0>]}
[0m02:04:09.408927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162734AA0A0>]}
[0m02:04:09.409646 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.94s]
[0m02:04:09.411101 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:04:09.411832 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:09.410291 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.96s]
[0m02:04:09.413085 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:04:09.412335 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:04:09.413942 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:04:09.414346 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:09.417784 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:04:09.419651 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:09.422995 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:04:09.425167 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as with base as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m02:04:09.425756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:04:11.363005 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:81e65867-4d4e-411d-a28c-019bdc877f57&page=queryresults
[0m02:04:11.939526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273B3C9B0>]}
[0m02:04:11.940308 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.53s]
[0m02:04:11.941359 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:11.942220 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m02:04:11.942836 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m02:04:11.943766 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m02:04:11.944254 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m02:04:11.948780 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m02:04:11.950361 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m02:04:11.956582 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m02:04:11.958112 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

with sessions as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),

hits as (
    select *
    from e2e-dbt-project.analytics_stg.stg_hits_products
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m02:04:11.958678 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:04:13.885646 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a2b7a0c5-a646-49dc-b49f-d7222b3d98d6&page=queryresults
[0m02:04:14.479544 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162731CAA50>]}
[0m02:04:14.482051 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.54s]
[0m02:04:14.485263 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m02:04:14.487878 [debug] [Thread-2 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:04:14.489983 [info ] [Thread-2 (]: 5 of 5 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m02:04:14.492792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.fct_sales_item)
[0m02:04:14.494724 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:04:14.525878 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:04:14.528085 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:04:14.576605 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:04:16.478074 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:04:16.479948 [debug] [Thread-2 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into e2e-dbt-project.analytics_mart.fct_sales_item as DBT_INTERNAL_DEST
        using (

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base

where session_date >
  (select coalesce(max(session_date), date('1970-01-01')) from e2e-dbt-project.analytics_mart.fct_sales_item)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_id = DBT_INTERNAL_DEST.transaction_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_sku = DBT_INTERNAL_DEST.product_sku
                ) and (
                    DBT_INTERNAL_SOURCE.visit_id = DBT_INTERNAL_DEST.visit_id
                )

    
    when matched then update set
        `session_date` = DBT_INTERNAL_SOURCE.`session_date`,`visitor_id` = DBT_INTERNAL_SOURCE.`visitor_id`,`visit_id` = DBT_INTERNAL_SOURCE.`visit_id`,`country` = DBT_INTERNAL_SOURCE.`country`,`traffic_source` = DBT_INTERNAL_SOURCE.`traffic_source`,`traffic_medium` = DBT_INTERNAL_SOURCE.`traffic_medium`,`traffic_campaign` = DBT_INTERNAL_SOURCE.`traffic_campaign`,`transaction_id` = DBT_INTERNAL_SOURCE.`transaction_id`,`product_sku` = DBT_INTERNAL_SOURCE.`product_sku`,`product_name` = DBT_INTERNAL_SOURCE.`product_name`,`product_category` = DBT_INTERNAL_SOURCE.`product_category`,`product_quantity` = DBT_INTERNAL_SOURCE.`product_quantity`,`product_price_usd` = DBT_INTERNAL_SOURCE.`product_price_usd`,`revenue_usd` = DBT_INTERNAL_SOURCE.`revenue_usd`,`revenue_local` = DBT_INTERNAL_SOURCE.`revenue_local`
    

    when not matched then insert
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)
    values
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)


    
[0m02:04:17.459560 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fbf7e908-4684-4887-ae73-2e7945760ade&page=queryresults
[0m02:04:20.512302 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c41a562-55c5-4602-80c0-8b129228f950', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273C15940>]}
[0m02:04:20.514400 [info ] [Thread-2 (]: 5 of 5 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mMERGE (0.0 rows, 11.4 MiB processed)[0m in 6.02s]
[0m02:04:20.517106 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:04:20.521654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:20.527651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:20.528826 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:04:20.529831 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:04:20.530842 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:04:20.531836 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:04:20.532824 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:04:20.533802 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:04:20.534781 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:04:20.535736 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:04:20.536729 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m02:04:20.537712 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m02:04:20.538818 [info ] [MainThread]: 
[0m02:04:20.540002 [info ] [MainThread]: Finished running 1 incremental model, 4 view models in 0 hours 0 minutes and 19.13 seconds (19.13s).
[0m02:04:20.543924 [debug] [MainThread]: Command end result
[0m02:04:20.597271 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:20.600711 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:20.609666 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:04:20.610126 [info ] [MainThread]: 
[0m02:04:20.610930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:20.611784 [info ] [MainThread]: 
[0m02:04:20.612571 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:04:20.614236 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:20.614060 after 23.97 seconds
[0m02:04:20.615026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273423B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273C320F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016273C321B0>]}
[0m02:04:20.615600 [debug] [MainThread]: Flushing usage events
[0m02:04:22.242737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:33.508302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713B2842F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027138EF9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713C2CFD90>]}


============================== 02:04:33.514545 | 11ac8872-ac93-41c2-a15b-53ab7b46356e ==============================
[0m02:04:33.514545 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:04:33.515540 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:04:37.927954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11ac8872-ac93-41c2-a15b-53ab7b46356e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713B5E3950>]}
[0m02:04:38.026957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11ac8872-ac93-41c2-a15b-53ab7b46356e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715FD72F10>]}
[0m02:04:38.027882 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:04:39.061336 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:04:39.419193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:39.419726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:39.520933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11ac8872-ac93-41c2-a15b-53ab7b46356e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715FDCD450>]}
[0m02:04:39.712630 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:39.716524 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:39.778718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11ac8872-ac93-41c2-a15b-53ab7b46356e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027161572E40>]}
[0m02:04:39.779420 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:04:39.780150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ac8872-ac93-41c2-a15b-53ab7b46356e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027161562970>]}
[0m02:04:39.785188 [info ] [MainThread]: 
[0m02:04:39.786013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:04:39.787058 [info ] [MainThread]: 
[0m02:04:39.788296 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:39.799346 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:04:39.800363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:39.801231 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:04:39.802648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:04:39.803452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:39.804132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:42.743045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ac8872-ac93-41c2-a15b-53ab7b46356e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271615DFBA0>]}
[0m02:04:42.744928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:42.763082 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:04:42.763770 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:04:42.764379 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:04:42.765574 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:04:42.765030 [info ] [Thread-1 (]: 1 of 34 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0  [RUN]
[0m02:04:42.766453 [info ] [Thread-3 (]: 3 of 34 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m02:04:42.768626 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619'
[0m02:04:42.767065 [info ] [Thread-4 (]: 4 of 34 START test not_null_dim_country_country ................................ [RUN]
[0m02:04:42.769719 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m02:04:42.770437 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:04:42.767643 [info ] [Thread-2 (]: 2 of 34 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0  [RUN]
[0m02:04:42.771446 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m02:04:42.772314 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:04:42.795872 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba'
[0m02:04:42.802371 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619"
[0m02:04:42.803118 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:04:42.810789 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:04:42.818533 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:04:42.828225 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:04:42.834918 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba"
[0m02:04:42.836822 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:04:42.861073 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:04:42.869131 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:04:42.872465 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619"
[0m02:04:42.873371 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:04:42.874161 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:04:42.877931 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:04:42.881309 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba"
[0m02:04:42.882633 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:04:42.883347 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:04:42.884057 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m02:04:42.884697 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:04:42.925137 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from e2e-dbt-project.analytics_mart.fct_sales_item

where not(revenue_local revenue_local >= 0)


  
  
      
    ) dbt_internal_test
[0m02:04:42.925844 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:42.965212 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from e2e-dbt-project.analytics_mart.fct_sales_item

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m02:04:42.965879 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:04:45.647945 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6096524e-6583-46f7-8c4b-501fd021f649&page=queryresults
[0m02:04:45.650009 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6096524e-6583-46f7-8c4b-501fd021f649&page=queryresults
[0m02:04:45.690926 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql
[0m02:04:45.692448 [error] [Thread-2 (]: 2 of 34 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.90s]
[0m02:04:45.694039 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:04:45.694877 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:04:45.696050 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql.
[0m02:04:45.697029 [info ] [Thread-2 (]: 5 of 34 START test not_null_dim_date_date ...................................... [RUN]
[0m02:04:45.699171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba, now test.ga_retail_project.not_null_dim_date_date.78f11e7735)
[0m02:04:45.700221 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:04:45.708641 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_date.78f11e7735"
[0m02:04:45.710028 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:04:45.717453 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_date.78f11e7735"
[0m02:04:45.720113 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from e2e-dbt-project.analytics_mart.dim_date
where date is null



  
  
      
    ) dbt_internal_test
[0m02:04:45.720951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:04:45.774999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:519ae065-95e2-4150-86c0-f6fd8f59bb27&page=queryresults
[0m02:04:45.775941 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:519ae065-95e2-4150-86c0-f6fd8f59bb27&page=queryresults
[0m02:04:45.788215 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql
[0m02:04:45.789717 [error] [Thread-1 (]: 1 of 34 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0  [[31mERROR[0m in 3.02s]
[0m02:04:45.791482 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:04:45.792588 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:04:45.793928 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql.
[0m02:04:45.794553 [info ] [Thread-1 (]: 6 of 34 START test not_null_dim_products_product_sku ........................... [RUN]
[0m02:04:45.795916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619, now test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343)
[0m02:04:45.796505 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:04:45.802204 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:04:45.804163 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:04:45.808183 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:04:45.810277 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:04:45.811455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:45.854856 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e8dcc6e2-4742-4143-af43-cbaaa957de25&page=queryresults
[0m02:04:45.856513 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e8dcc6e2-4742-4143-af43-cbaaa957de25&page=queryresults
[0m02:04:45.869636 [debug] [Thread-4 (]: Database Error in test not_null_dim_country_country (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_country was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_country_country.sql
[0m02:04:45.871037 [error] [Thread-4 (]: 4 of 34 ERROR not_null_dim_country_country ..................................... [[31mERROR[0m in 3.10s]
[0m02:04:45.872929 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:04:45.874057 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:04:45.875538 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.not_null_dim_country_country.efd0998505' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_country_country (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_country was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_country_country.sql.
[0m02:04:45.876679 [info ] [Thread-4 (]: 7 of 34 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m02:04:45.877929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m02:04:45.878977 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:04:45.889114 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:04:45.891361 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:04:45.899870 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:04:45.902478 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:45.903772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:04:46.006543 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bf584f5a-cb1f-472e-ab4e-dc65eaffb3af&page=queryresults
[0m02:04:47.576144 [info ] [Thread-3 (]: 3 of 34 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.81s]
[0m02:04:47.578056 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:04:47.579319 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:04:47.580425 [info ] [Thread-3 (]: 8 of 34 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m02:04:47.581327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m02:04:47.581940 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:04:47.588035 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:04:47.589782 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:04:47.595499 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:04:47.598079 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:04:47.599431 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:04:48.401466 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aa7a23f8-eb36-480d-8885-4f59cac1a215&page=queryresults
[0m02:04:48.402204 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aa7a23f8-eb36-480d-8885-4f59cac1a215&page=queryresults
[0m02:04:48.418730 [debug] [Thread-2 (]: Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_date was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:04:48.419509 [error] [Thread-2 (]: 5 of 34 ERROR not_null_dim_date_date ........................................... [[31mERROR[0m in 2.72s]
[0m02:04:48.420994 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:04:48.422022 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:04:48.423083 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.not_null_dim_date_date.78f11e7735' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_date was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql.
[0m02:04:48.423812 [info ] [Thread-2 (]: 9 of 34 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m02:04:48.425033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_date.78f11e7735, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m02:04:48.426088 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:04:48.432587 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:04:48.434037 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:04:48.437787 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:04:48.439524 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m02:04:48.440226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:04:48.569359 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:96da2ff1-ed15-4b5b-8786-d1e619e8ff22&page=queryresults
[0m02:04:48.571068 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:96da2ff1-ed15-4b5b-8786-d1e619e8ff22&page=queryresults
[0m02:04:48.595660 [debug] [Thread-4 (]: Database Error in test not_null_dim_visitors_visitor_id (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_visitors was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_visitors_visitor_id.sql
[0m02:04:48.597528 [error] [Thread-4 (]: 7 of 34 ERROR not_null_dim_visitors_visitor_id ................................. [[31mERROR[0m in 2.72s]
[0m02:04:48.600539 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:04:48.602061 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:04:48.603741 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_visitors_visitor_id (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_visitors was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_visitors_visitor_id.sql.
[0m02:04:48.604712 [info ] [Thread-4 (]: 10 of 34 START test not_null_fct_sales_item_session_date ....................... [RUN]
[0m02:04:48.606633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m02:04:48.608669 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:04:48.618452 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:04:48.620379 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:04:48.625238 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:04:48.627143 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:04:48.627899 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:04:48.879537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0cbfbef4-3220-46d9-af1f-fee8fe358e6e&page=queryresults
[0m02:04:49.742225 [info ] [Thread-1 (]: 6 of 34 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.95s]
[0m02:04:49.744014 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:04:49.744731 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:04:49.745951 [info ] [Thread-1 (]: 11 of 34 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m02:04:49.747244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m02:04:49.747884 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:04:49.753280 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:04:49.754810 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:04:49.759026 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:04:49.760986 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:49.761946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:50.430994 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b31a29cf-a1f7-461d-82e2-e547575dc934&page=queryresults
[0m02:04:51.266577 [error] [Thread-3 (]: 8 of 34 FAIL 882 not_null_fct_sales_item_product_sku ........................... [[31mFAIL 882[0m in 3.68s]
[0m02:04:51.268178 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:04:51.268768 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:04:51.269458 [info ] [Thread-3 (]: 12 of 34 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m02:04:51.270325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m02:04:51.270881 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:04:51.277552 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:04:51.280025 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:04:51.287999 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:04:51.290655 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:04:51.291454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:04:51.417726 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:79d7a662-1a40-4fab-9568-88c18b0d1600&page=queryresults
[0m02:04:51.582724 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:464ad048-2167-4c90-ae68-615b45f5db61&page=queryresults
[0m02:04:52.372440 [error] [Thread-2 (]: 9 of 34 FAIL 43746 not_null_fct_sales_item_revenue_usd ......................... [[31mFAIL 43746[0m in 3.95s]
[0m02:04:52.375939 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:04:52.378951 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:04:52.382510 [info ] [Thread-2 (]: 13 of 34 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m02:04:52.385557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m02:04:52.387235 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:04:52.408750 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:04:52.423718 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:04:52.432873 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:04:52.435435 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:52.436671 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:04:52.486714 [info ] [Thread-4 (]: 10 of 34 PASS not_null_fct_sales_item_session_date ............................. [[32mPASS[0m in 3.88s]
[0m02:04:52.488918 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:04:52.490249 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:04:52.491565 [info ] [Thread-4 (]: 14 of 34 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m02:04:52.492925 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m02:04:52.494054 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:04:52.504594 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:04:52.506055 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:04:52.515135 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:04:52.516837 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:52.517463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:04:52.560536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3b154d53-706a-4689-806f-127ec3d4a923&page=queryresults
[0m02:04:53.433070 [error] [Thread-1 (]: 11 of 34 FAIL 48209 not_null_fct_sales_item_transaction_id ..................... [[31mFAIL 48209[0m in 3.69s]
[0m02:04:53.434685 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:04:53.435278 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:04:53.435905 [info ] [Thread-1 (]: 15 of 34 START test not_null_product_categories_product_category ............... [RUN]
[0m02:04:53.436673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m02:04:53.437211 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:04:53.442831 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:04:53.444775 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:04:53.449459 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:04:53.451293 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m02:04:53.451952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:54.234106 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:59a2e3ed-6cd1-4370-b1de-0543575cca31&page=queryresults
[0m02:04:55.344994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8cf23ebc-813b-49dd-959d-5919383beebf&page=queryresults
[0m02:04:55.365008 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:187be578-0107-4493-bb75-0c4374c06cc1&page=queryresults
[0m02:04:56.173118 [info ] [Thread-3 (]: 12 of 34 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 4.90s]
[0m02:04:56.175633 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:04:56.177055 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:04:56.178244 [info ] [Thread-3 (]: 16 of 34 START test not_null_product_categories_product_sku .................... [RUN]
[0m02:04:56.180367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m02:04:56.182112 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:04:56.191593 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:04:56.194439 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:04:56.202313 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:04:56.204455 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:04:56.205429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:04:56.338299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f92ed227-e6a1-4cc8-8769-32b30766eda2&page=queryresults
[0m02:04:56.763312 [info ] [Thread-2 (]: 13 of 34 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 4.38s]
[0m02:04:56.764942 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:04:56.765557 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:04:56.766308 [info ] [Thread-2 (]: 17 of 34 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m02:04:56.767394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m02:04:56.768362 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:04:56.776877 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:04:56.787459 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:04:56.795659 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:04:56.798113 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:04:56.799234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:04:56.861539 [info ] [Thread-4 (]: 14 of 34 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 4.37s]
[0m02:04:56.863801 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:04:56.865131 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:04:56.866717 [info ] [Thread-4 (]: 18 of 34 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m02:04:56.868145 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m02:04:56.869377 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:04:56.880969 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:04:56.883359 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:04:56.891777 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:04:56.894289 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:04:56.895202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:04:57.210783 [info ] [Thread-1 (]: 15 of 34 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 3.77s]
[0m02:04:57.212091 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:04:57.212746 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:04:57.213453 [info ] [Thread-1 (]: 19 of 34 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m02:04:57.214340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m02:04:57.214900 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:04:57.220174 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:04:57.221703 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:04:57.226197 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:04:57.227857 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:04:57.228809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:59.128736 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78cd2a1d-51f2-400f-9965-ba417a16dbcc&page=queryresults
[0m02:04:59.641756 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:648ffe26-5959-4e89-b3be-38b0658e3e92&page=queryresults
[0m02:04:59.671081 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0ca082d6-ac8b-4f19-a106-f9c3665c7bb6&page=queryresults
[0m02:04:59.921287 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0045afbc-4be0-41b5-b03d-7b41f66681fd&page=queryresults
[0m02:05:00.023732 [info ] [Thread-3 (]: 16 of 34 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 3.84s]
[0m02:05:00.025011 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:05:00.025625 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:05:00.026314 [info ] [Thread-3 (]: 20 of 34 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m02:05:00.027240 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m02:05:00.027794 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:05:00.033243 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:05:00.034779 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:05:00.039129 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:05:00.040653 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:05:00.041613 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:01.041592 [info ] [Thread-4 (]: 18 of 34 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 4.17s]
[0m02:05:01.047821 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:05:01.049743 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:05:01.051894 [info ] [Thread-4 (]: 21 of 34 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m02:05:01.055023 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m02:05:01.059252 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:05:01.083738 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:05:01.090135 [info ] [Thread-2 (]: 17 of 34 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 4.32s]
[0m02:05:01.091899 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:05:01.093240 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:05:01.094225 [info ] [Thread-2 (]: 22 of 34 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m02:05:01.095995 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:05:01.097202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m02:05:01.102234 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:05:01.104017 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:05:01.118723 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:05:01.121480 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m02:05:01.122947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:01.174298 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:05:01.179725 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:05:01.182334 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:05:01.183416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:05:01.416222 [info ] [Thread-1 (]: 19 of 34 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 4.20s]
[0m02:05:01.417467 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:05:01.418074 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:05:01.418777 [info ] [Thread-1 (]: 23 of 34 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m02:05:01.419818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m02:05:01.420468 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:05:01.425728 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:05:01.436031 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:05:01.440359 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:05:01.442330 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:05:01.443627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:02.732275 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:46e46674-6ba2-4ce9-a1b2-c775b4a5b77f&page=queryresults
[0m02:05:03.955508 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c54cab9f-c1e6-471b-b605-5630a4fc631e&page=queryresults
[0m02:05:04.056781 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:240d81b8-76df-4073-8bfa-2ec0db612d4c&page=queryresults
[0m02:05:04.286784 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5a1eab78-2e8b-42ab-9ee1-37dc1e816339&page=queryresults
[0m02:05:04.311490 [info ] [Thread-3 (]: 20 of 34 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 4.28s]
[0m02:05:04.312824 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:05:04.314184 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:05:04.314858 [info ] [Thread-3 (]: 24 of 34 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m02:05:04.316171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m02:05:04.317142 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:05:04.323987 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:05:04.326549 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:05:04.332467 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:05:04.334508 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m02:05:04.335568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:04.807423 [info ] [Thread-4 (]: 21 of 34 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 3.75s]
[0m02:05:04.808654 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:05:04.809246 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:05:04.809939 [info ] [Thread-4 (]: 25 of 34 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m02:05:04.810791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m02:05:04.811339 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:05:04.816697 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:05:04.818313 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:05:04.822914 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:05:04.824662 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m02:05:04.825660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:04.879807 [info ] [Thread-2 (]: 22 of 34 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 3.78s]
[0m02:05:04.881576 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:05:04.882237 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m02:05:04.883147 [info ] [Thread-2 (]: 26 of 34 START test stg_hits_products_quality .................................. [RUN]
[0m02:05:04.884123 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m02:05:04.884779 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m02:05:04.889285 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:05:04.891757 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m02:05:04.895488 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:05:04.897871 [debug] [Thread-2 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:05:04.898800 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:05:05.228241 [info ] [Thread-1 (]: 23 of 34 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.81s]
[0m02:05:05.229503 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:05:05.230115 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:05:05.230821 [info ] [Thread-1 (]: 27 of 34 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m02:05:05.231867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m02:05:05.233049 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:05:05.240447 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:05:05.242144 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:05:05.246463 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:05:05.248794 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:05:05.250104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:07.136063 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:89e8c1de-a972-42dd-b663-9ea1473f8b15&page=queryresults
[0m02:05:07.850996 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:246426b0-6fc4-4e1d-b31c-825a194c0813&page=queryresults
[0m02:05:08.009884 [info ] [Thread-3 (]: 24 of 34 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.69s]
[0m02:05:08.013701 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:05:08.015543 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:05:08.018580 [info ] [Thread-3 (]: 28 of 34 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m02:05:08.024139 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m02:05:08.025954 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:05:08.029720 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1e6f7d8a-685e-4028-871d-3dd7deb27d23&page=queryresults
[0m02:05:08.044747 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:05:08.048622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c07adb4-7c79-4438-9926-75c9ef0c134e&page=queryresults
[0m02:05:08.056692 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:05:08.066165 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:05:08.069431 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:05:08.070292 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:08.875918 [info ] [Thread-4 (]: 25 of 34 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 4.06s]
[0m02:05:08.877862 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:05:08.879046 [debug] [Thread-4 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m02:05:08.879923 [info ] [Thread-4 (]: 29 of 34 START test test_non_negative_values ................................... [RUN]
[0m02:05:08.880870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m02:05:08.881440 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m02:05:08.884833 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m02:05:08.886451 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m02:05:08.890001 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m02:05:08.893547 [debug] [Thread-4 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:05:08.894356 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:09.266334 [info ] [Thread-2 (]: 26 of 34 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 4.38s]
[0m02:05:09.268027 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m02:05:09.268630 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:05:09.269398 [info ] [Thread-2 (]: 30 of 34 START test unique_dim_country_country ................................. [RUN]
[0m02:05:09.270379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m02:05:09.270921 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:05:09.279983 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:05:09.281707 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:05:09.285687 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:05:09.287328 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:05:09.288390 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:05:09.648213 [info ] [Thread-1 (]: 27 of 34 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 4.42s]
[0m02:05:09.649390 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:05:09.649979 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:05:09.650834 [info ] [Thread-1 (]: 31 of 34 START test unique_dim_date_date ....................................... [RUN]
[0m02:05:09.652164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_dim_date_date.dd069a8d31)
[0m02:05:09.653334 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:05:09.663352 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_date.dd069a8d31"
[0m02:05:09.665630 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:05:09.671836 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_date.dd069a8d31"
[0m02:05:09.673417 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:05:09.674069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:11.151051 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bbc80a59-0bab-4824-993b-2c5eb68a7c6e&page=queryresults
[0m02:05:11.891734 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a5752e82-f93b-47f0-a0bd-493d257ec0c6&page=queryresults
[0m02:05:11.893558 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a5752e82-f93b-47f0-a0bd-493d257ec0c6&page=queryresults
[0m02:05:11.920687 [debug] [Thread-2 (]: Database Error in test unique_dim_country_country (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_country was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_country_country.sql
[0m02:05:11.922773 [error] [Thread-2 (]: 30 of 34 ERROR unique_dim_country_country ...................................... [[31mERROR[0m in 2.65s]
[0m02:05:11.925706 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:05:11.927434 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:05:11.930475 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.unique_dim_country_country.11db8eecec' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_country_country (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_country was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_country_country.sql.
[0m02:05:11.932017 [info ] [Thread-2 (]: 32 of 34 START test unique_dim_products_product_sku ............................ [RUN]
[0m02:05:11.935376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_country_country.11db8eecec, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m02:05:11.937845 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:05:11.948758 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:05:11.950966 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:05:11.956795 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:05:11.958630 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:05:11.959710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:05:12.092374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:68459519-93cc-4083-9e25-672a98742a08&page=queryresults
[0m02:05:12.093104 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:68459519-93cc-4083-9e25-672a98742a08&page=queryresults
[0m02:05:12.106547 [debug] [Thread-1 (]: Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_date was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:05:12.108253 [error] [Thread-1 (]: 31 of 34 ERROR unique_dim_date_date ............................................ [[31mERROR[0m in 2.46s]
[0m02:05:12.109992 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:05:12.110749 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:05:12.112027 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.unique_dim_date_date.dd069a8d31' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_date was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql.
[0m02:05:12.113097 [info ] [Thread-1 (]: 33 of 34 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m02:05:12.114411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_date_date.dd069a8d31, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m02:05:12.115572 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:05:12.124749 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:05:12.127561 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:05:12.133170 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:05:12.135821 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:05:12.136893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:12.184831 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:49f87799-c654-4d87-a188-f2942847a1fe&page=queryresults
[0m02:05:12.990017 [info ] [Thread-4 (]: 29 of 34 PASS test_non_negative_values ......................................... [[32mPASS[0m in 4.11s]
[0m02:05:12.991653 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m02:05:12.992302 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:05:12.993010 [info ] [Thread-4 (]: 34 of 34 START test unique_product_categories_product_sku ...................... [RUN]
[0m02:05:12.994136 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m02:05:12.995073 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:05:13.002632 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:05:13.013188 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:05:13.017605 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:05:13.020210 [debug] [Thread-4 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:05:13.021419 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:13.140248 [info ] [Thread-3 (]: 28 of 34 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 5.12s]
[0m02:05:13.141774 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:05:14.724755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ff28de7d-f2fb-4759-b994-2448ee018d29&page=queryresults
[0m02:05:14.725473 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ff28de7d-f2fb-4759-b994-2448ee018d29&page=queryresults
[0m02:05:14.735311 [debug] [Thread-1 (]: Database Error in test unique_dim_visitors_visitor_id (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_visitors was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_visitors_visitor_id.sql
[0m02:05:14.736122 [error] [Thread-1 (]: 33 of 34 ERROR unique_dim_visitors_visitor_id .................................. [[31mERROR[0m in 2.62s]
[0m02:05:14.737527 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:05:14.739021 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_visitors_visitor_id (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_visitors was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_visitors_visitor_id.sql.
[0m02:05:14.904880 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:904342db-d6c2-4721-b1f0-eba655fd4ca8&page=queryresults
[0m02:05:15.783065 [info ] [Thread-2 (]: 32 of 34 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 3.85s]
[0m02:05:15.784504 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:05:15.837497 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e84cea88-bff1-4792-ae09-ebe90ed41222&page=queryresults
[0m02:05:16.777997 [info ] [Thread-4 (]: 34 of 34 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 3.78s]
[0m02:05:16.783526 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:05:16.789849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:16.797526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:16.799339 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:05:16.800640 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:05:16.801863 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:05:16.803090 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m02:05:16.804513 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m02:05:16.806031 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m02:05:16.807345 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m02:05:16.808795 [info ] [MainThread]: 
[0m02:05:16.810446 [info ] [MainThread]: Finished running 34 data tests in 0 hours 0 minutes and 37.02 seconds (37.02s).
[0m02:05:16.826304 [debug] [MainThread]: Command end result
[0m02:05:16.891513 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:05:16.895332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:05:16.908239 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:05:16.908775 [info ] [MainThread]: 
[0m02:05:16.909570 [info ] [MainThread]: [31mCompleted with 11 errors, 0 partial successes, and 0 warnings:[0m
[0m02:05:16.910446 [info ] [MainThread]: 
[0m02:05:16.911304 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)[0m
[0m02:05:16.912391 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql
[0m02:05:16.913168 [info ] [MainThread]: 
[0m02:05:16.914033 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql
[0m02:05:16.914769 [info ] [MainThread]: 
[0m02:05:16.916143 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)[0m
[0m02:05:16.917355 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql
[0m02:05:16.918446 [info ] [MainThread]: 
[0m02:05:16.919717 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql
[0m02:05:16.920763 [info ] [MainThread]: 
[0m02:05:16.921996 [error] [MainThread]: [31mFailure in test not_null_dim_country_country (models\mart\mart_models.yml)[0m
[0m02:05:16.923254 [error] [MainThread]:   Database Error in test not_null_dim_country_country (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_country was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_country_country.sql
[0m02:05:16.924290 [info ] [MainThread]: 
[0m02:05:16.925495 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_dim_country_country.sql
[0m02:05:16.926511 [info ] [MainThread]: 
[0m02:05:16.927695 [error] [MainThread]: [31mFailure in test not_null_dim_date_date (models\mart\mart_models.yml)[0m
[0m02:05:16.928752 [error] [MainThread]:   Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_date was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:05:16.929636 [info ] [MainThread]: 
[0m02:05:16.930520 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:05:16.931226 [info ] [MainThread]: 
[0m02:05:16.932306 [error] [MainThread]: [31mFailure in test not_null_dim_visitors_visitor_id (models\mart\mart_models.yml)[0m
[0m02:05:16.933208 [error] [MainThread]:   Database Error in test not_null_dim_visitors_visitor_id (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_visitors was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_visitors_visitor_id.sql
[0m02:05:16.933961 [info ] [MainThread]: 
[0m02:05:16.934784 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_dim_visitors_visitor_id.sql
[0m02:05:16.935511 [info ] [MainThread]: 
[0m02:05:16.936492 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_product_sku (models\mart\mart_models.yml)[0m
[0m02:05:16.937727 [error] [MainThread]:   Got 882 results, configured to fail if != 0
[0m02:05:16.938685 [info ] [MainThread]: 
[0m02:05:16.939530 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_product_sku.sql
[0m02:05:16.940241 [info ] [MainThread]: 
[0m02:05:16.941131 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_revenue_usd (models\mart\mart_models.yml)[0m
[0m02:05:16.941926 [error] [MainThread]:   Got 43746 results, configured to fail if != 0
[0m02:05:16.942600 [info ] [MainThread]: 
[0m02:05:16.943534 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_revenue_usd.sql
[0m02:05:16.944412 [info ] [MainThread]: 
[0m02:05:16.945309 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_transaction_id (models\mart\mart_models.yml)[0m
[0m02:05:16.946283 [error] [MainThread]:   Got 48209 results, configured to fail if != 0
[0m02:05:16.947259 [info ] [MainThread]: 
[0m02:05:16.948515 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_transaction_id.sql
[0m02:05:16.949553 [info ] [MainThread]: 
[0m02:05:16.950780 [error] [MainThread]: [31mFailure in test unique_dim_country_country (models\mart\mart_models.yml)[0m
[0m02:05:16.952024 [error] [MainThread]:   Database Error in test unique_dim_country_country (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_country was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_country_country.sql
[0m02:05:16.953075 [info ] [MainThread]: 
[0m02:05:16.954274 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\unique_dim_country_country.sql
[0m02:05:16.955292 [info ] [MainThread]: 
[0m02:05:16.956572 [error] [MainThread]: [31mFailure in test unique_dim_date_date (models\mart\mart_models.yml)[0m
[0m02:05:16.957891 [error] [MainThread]:   Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_date was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:05:16.958942 [info ] [MainThread]: 
[0m02:05:16.959820 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:05:16.960516 [info ] [MainThread]: 
[0m02:05:16.961344 [error] [MainThread]: [31mFailure in test unique_dim_visitors_visitor_id (models\mart\mart_models.yml)[0m
[0m02:05:16.962549 [error] [MainThread]:   Database Error in test unique_dim_visitors_visitor_id (models\mart\mart_models.yml)
  Not found: Table e2e-dbt-project:analytics_mart.dim_visitors was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_visitors_visitor_id.sql
[0m02:05:16.963593 [info ] [MainThread]: 
[0m02:05:16.964807 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\unique_dim_visitors_visitor_id.sql
[0m02:05:16.965925 [info ] [MainThread]: 
[0m02:05:16.967020 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=11 SKIP=0 NO-OP=0 TOTAL=34
[0m02:05:16.969531 [debug] [MainThread]: Command `dbt test` failed at 02:05:16.969288 after 43.64 seconds
[0m02:05:16.970512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002713C2807D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027161A9C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027161A9E360>]}
[0m02:05:16.971506 [debug] [MainThread]: Flushing usage events
[0m02:05:18.549181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:15:39.034617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CC0B42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C9D19D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CD0F3D90>]}


============================== 02:15:39.040776 | 1ff8d6a1-6328-4e27-8f5f-31936d7b4f65 ==============================
[0m02:15:39.040776 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:15:39.041743 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:15:39.274015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ff8d6a1-6328-4e27-8f5f-31936d7b4f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CC413950>]}
[0m02:15:39.416160 [debug] [MainThread]: Command `dbt clean` succeeded at 02:15:39.415950 after 0.64 seconds
[0m02:15:39.416735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CD1718C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CD171040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CE2FC650>]}
[0m02:15:39.417278 [debug] [MainThread]: Flushing usage events
[0m02:15:42.846157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:15:47.448727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7B142F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB5789D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB8B53D90>]}


============================== 02:15:47.458066 | 16cf7607-769b-47c1-9cfb-54f37bad6435 ==============================
[0m02:15:47.458066 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:15:47.459516 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:15:47.692661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16cf7607-769b-47c1-9cfb-54f37bad6435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7E73950>]}
[0m02:15:47.741731 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-rwknhlyi'
[0m02:15:47.742313 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:15:51.334748 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:15:51.337940 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:15:52.076883 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:15:52.085550 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:15:53.258326 [info ] [MainThread]: Installed from version 1.3.0
[0m02:15:53.259086 [info ] [MainThread]: Up to date!
[0m02:15:53.259809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16cf7607-769b-47c1-9cfb-54f37bad6435', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB8BC5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB8BC5F20>]}
[0m02:15:53.262272 [debug] [MainThread]: Command `dbt deps` succeeded at 02:15:53.262097 after 6.00 seconds
[0m02:15:53.262789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB9DB1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB89D28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB9D647D0>]}
[0m02:15:53.263324 [debug] [MainThread]: Flushing usage events
[0m02:15:54.598660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:15:58.805515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF1CC42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEF939D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2D0BD90>]}


============================== 02:15:58.810508 | 02c92405-f3f2-4c94-b715-0b9948245adf ==============================
[0m02:15:58.810508 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:15:58.811302 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_country dim_date dim_visitors +fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:16:02.156863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2023950>]}
[0m02:16:02.219742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF96826F10>]}
[0m02:16:02.220359 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:16:02.871388 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:16:02.872596 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:16:02.873176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9687C950>]}
[0m02:16:04.770643 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m02:16:04.771402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9818DB80>]}
[0m02:16:05.066185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF969E0F30>]}
[0m02:16:05.190695 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:16:05.201167 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:16:05.236343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9819E4E0>]}
[0m02:16:05.236836 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:16:05.237453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF981B4290>]}
[0m02:16:05.240410 [info ] [MainThread]: 
[0m02:16:05.240963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:05.241487 [info ] [MainThread]: 
[0m02:16:05.242173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:16:05.246907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:16:05.247280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:05.276684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:16:05.277533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:05.281751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:16:05.282154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:07.535607 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:16:07.536326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:07.536927 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:16:07.537628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:07.538454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:16:07.538888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:09.465592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9818A990>]}
[0m02:16:09.466316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:16:09.473979 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:16:09.474572 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_date
[0m02:16:09.475761 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:16:09.475302 [info ] [Thread-2 (]: 2 of 8 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:16:09.476622 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m02:16:09.478063 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:16:09.477218 [info ] [Thread-3 (]: 3 of 8 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:16:09.478921 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m02:16:09.479477 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:16:09.480157 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:16:09.480706 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_date
[0m02:16:09.488858 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:16:09.489484 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:16:09.493537 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m02:16:09.495745 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:16:09.499494 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:16:09.541870 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:16:09.542592 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_date
[0m02:16:09.579192 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m02:16:09.579806 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:16:09.582811 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:16:09.585483 [debug] [Thread-2 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m02:16:09.586134 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:16:09.615083 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m02:16:09.615571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:16:09.616599 [debug] [Thread-1 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_date.sql
WITH dates AS (
    SELECT
        day AS date_day,
        EXTRACT(YEAR FROM day) AS year,
        EXTRACT(QUARTER FROM day) AS quarter,
        EXTRACT(MONTH FROM day) AS month,
        FORMAT_DATE('%B', day) AS month_name,
        EXTRACT(DAY FROM day) AS day_of_month,
        EXTRACT(DAYOFWEEK FROM day) AS day_of_week,
        FORMAT_DATE('%A', day) AS day_name
    FROM UNNEST(
        GENERATE_DATE_ARRAY('2016-01-01', '2018-12-31', INTERVAL 1 DAY)
    ) AS day
)

SELECT * FROM dates
    );
  
[0m02:16:09.617062 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:16:11.685814 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:76909521-316c-4c93-b619-00700b855785&page=queryresults
[0m02:16:11.695918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8282f225-401f-4606-bcac-419441e283b2&page=queryresults
[0m02:16:11.777063 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4d4eaff6-4a84-44d2-b687-31150eb19923&page=queryresults
[0m02:16:12.368674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF2000230>]}
[0m02:16:12.369390 [info ] [Thread-3 (]: 3 of 8 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.89s]
[0m02:16:12.370277 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:16:12.371008 [debug] [Thread-4 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:16:12.371522 [info ] [Thread-4 (]: 4 of 8 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:16:12.372222 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:16:12.372609 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:16:12.375861 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:16:12.385507 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:16:12.388712 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:16:12.389937 [debug] [Thread-4 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as with base as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m02:16:12.390448 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:16:12.424417 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF968CF650>]}
[0m02:16:12.425124 [info ] [Thread-2 (]: 2 of 8 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.95s]
[0m02:16:12.426165 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:16:13.829197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF98395B00>]}
[0m02:16:13.831592 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (1.1k rows, 0 processed)[0m in 4.35s]
[0m02:16:13.834741 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_date
[0m02:16:14.299836 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:def51de0-776a-4b90-8b41-a074eacf7ac4&page=queryresults
[0m02:16:14.845594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF999CD730>]}
[0m02:16:14.846539 [info ] [Thread-4 (]: 4 of 8 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m02:16:14.847590 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:16:14.852650 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_country
[0m02:16:14.853913 [debug] [Thread-2 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m02:16:14.853282 [info ] [Thread-3 (]: 5 of 8 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m02:16:14.855831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.dim_country)
[0m02:16:14.856392 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_country
[0m02:16:14.860096 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m02:16:14.855230 [info ] [Thread-2 (]: 6 of 8 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m02:16:14.861168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_hits_products, now model.ga_retail_project.int_sessions_enriched)
[0m02:16:14.861784 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m02:16:14.867638 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m02:16:14.868740 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_country
[0m02:16:14.873270 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m02:16:14.874564 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m02:16:14.877818 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m02:16:14.878707 [debug] [Thread-3 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m02:16:14.879225 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:16:14.883166 [debug] [Thread-2 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

with sessions as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),

hits as (
    select *
    from e2e-dbt-project.analytics_stg.stg_hits_products
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m02:16:14.911707 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:17.030595 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fa439a11-54cf-4524-aa85-e9013e73436e&page=queryresults
[0m02:16:17.090591 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bcd8c3e9-4952-43ab-bddd-f27673d2b7f4&page=queryresults
[0m02:16:17.776323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF999CDC70>]}
[0m02:16:17.778767 [info ] [Thread-2 (]: 6 of 8 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.91s]
[0m02:16:17.782347 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m02:16:17.784694 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:16:17.786770 [info ] [Thread-1 (]: 7 of 8 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m02:16:17.789015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_date, now model.ga_retail_project.fct_sales_item)
[0m02:16:17.790659 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:16:17.815635 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:16:17.818666 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:16:17.875991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:19.417790 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:16:19.419024 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into e2e-dbt-project.analytics_mart.fct_sales_item as DBT_INTERNAL_DEST
        using (

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
),

-- keep only true item-level transaction rows (clean nulls at source)
filtered as (
    select *
    from base
    where transaction_id is not null
      and product_sku    is not null
      and revenue_usd    is not null
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from filtered

where session_date >
  (select coalesce(max(session_date), date('1970-01-01')) from e2e-dbt-project.analytics_mart.fct_sales_item)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_id = DBT_INTERNAL_DEST.transaction_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_sku = DBT_INTERNAL_DEST.product_sku
                ) and (
                    DBT_INTERNAL_SOURCE.visit_id = DBT_INTERNAL_DEST.visit_id
                )

    
    when matched then update set
        `session_date` = DBT_INTERNAL_SOURCE.`session_date`,`visitor_id` = DBT_INTERNAL_SOURCE.`visitor_id`,`visit_id` = DBT_INTERNAL_SOURCE.`visit_id`,`country` = DBT_INTERNAL_SOURCE.`country`,`traffic_source` = DBT_INTERNAL_SOURCE.`traffic_source`,`traffic_medium` = DBT_INTERNAL_SOURCE.`traffic_medium`,`traffic_campaign` = DBT_INTERNAL_SOURCE.`traffic_campaign`,`transaction_id` = DBT_INTERNAL_SOURCE.`transaction_id`,`product_sku` = DBT_INTERNAL_SOURCE.`product_sku`,`product_name` = DBT_INTERNAL_SOURCE.`product_name`,`product_category` = DBT_INTERNAL_SOURCE.`product_category`,`product_quantity` = DBT_INTERNAL_SOURCE.`product_quantity`,`product_price_usd` = DBT_INTERNAL_SOURCE.`product_price_usd`,`revenue_usd` = DBT_INTERNAL_SOURCE.`revenue_usd`,`revenue_local` = DBT_INTERNAL_SOURCE.`revenue_local`
    

    when not matched then insert
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)
    values
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)


    
[0m02:16:19.475903 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF999CD850>]}
[0m02:16:19.476669 [info ] [Thread-3 (]: 5 of 8 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (94.0 rows, 31.0 KiB processed)[0m in 4.62s]
[0m02:16:19.477672 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_country
[0m02:16:20.314735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:976f1bc7-cc36-42ca-98a5-c5ddeda90996&page=queryresults
[0m02:16:22.782201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF999CEED0>]}
[0m02:16:22.784988 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mMERGE (0.0 rows, 11.4 MiB processed)[0m in 4.99s]
[0m02:16:22.788641 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:16:22.791564 [debug] [Thread-4 (]: Began running node model.ga_retail_project.dim_visitors
[0m02:16:22.793754 [info ] [Thread-4 (]: 8 of 8 START sql table model analytics_mart.dim_visitors ....................... [RUN]
[0m02:16:22.796458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions_with_fx, now model.ga_retail_project.dim_visitors)
[0m02:16:22.798342 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.dim_visitors
[0m02:16:22.807465 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.dim_visitors"
[0m02:16:22.817100 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.dim_visitors
[0m02:16:22.822025 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.dim_visitors"
[0m02:16:22.824423 [debug] [Thread-4 (]: On model.ga_retail_project.dim_visitors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_visitors"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_visitors
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_visitors.sql
WITH visitors AS (
    SELECT
        visitor_id,
        COUNT(DISTINCT visit_id) AS total_sessions,
        COUNT(DISTINCT transaction_id) AS total_transactions
    FROM e2e-dbt-project.analytics_mart.fct_sales_item
    GROUP BY visitor_id
)

SELECT * FROM visitors
    );
  
[0m02:16:22.825084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:16:24.617757 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:93008eae-5994-4b3c-b9a2-4e7b96d16d20&page=queryresults
[0m02:16:26.952224 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02c92405-f3f2-4c94-b715-0b9948245adf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF999CC650>]}
[0m02:16:26.954634 [info ] [Thread-4 (]: 8 of 8 OK created sql table model analytics_mart.dim_visitors .................. [[32mCREATE TABLE (2.3k rows, 1.3 MiB processed)[0m in 4.16s]
[0m02:16:26.958133 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.dim_visitors
[0m02:16:26.963563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:16:26.970244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:26.971571 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:16:26.972841 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:16:26.974089 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:16:26.975330 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:16:26.976428 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:16:26.977506 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:16:26.978581 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m02:16:26.979631 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:16:26.980698 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m02:16:26.981751 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_visitors' was properly closed.
[0m02:16:26.983143 [info ] [MainThread]: 
[0m02:16:26.984821 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 4 view models in 0 hours 0 minutes and 21.74 seconds (21.74s).
[0m02:16:26.991572 [debug] [MainThread]: Command end result
[0m02:16:27.034098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:16:27.036782 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:16:27.043400 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:16:27.043740 [info ] [MainThread]: 
[0m02:16:27.044352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:16:27.044904 [info ] [MainThread]: 
[0m02:16:27.045501 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m02:16:27.046289 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:16:27.047589 [debug] [MainThread]: Command `dbt run` succeeded at 02:16:27.047462 after 28.37 seconds
[0m02:16:27.048025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF969E9DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF981BF830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF98320230>]}
[0m02:16:27.048421 [debug] [MainThread]: Flushing usage events
[0m02:16:28.272092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:44.999167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E37D42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E146DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E481FD90>]}


============================== 02:16:45.004317 | ccb31e05-6d2f-40bc-a510-3fdf2e290871 ==============================
[0m02:16:45.004317 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:16:45.005475 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:16:48.300249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccb31e05-6d2f-40bc-a510-3fdf2e290871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E3B33950>]}
[0m02:16:48.362228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccb31e05-6d2f-40bc-a510-3fdf2e290871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A688352F10>]}
[0m02:16:48.362831 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:16:49.070965 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:16:49.315593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:16:49.315978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:16:49.381752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb31e05-6d2f-40bc-a510-3fdf2e290871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6883AD450>]}
[0m02:16:49.512444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:16:49.514884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:16:49.560217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccb31e05-6d2f-40bc-a510-3fdf2e290871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689B56E40>]}
[0m02:16:49.560726 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:16:49.561306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb31e05-6d2f-40bc-a510-3fdf2e290871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689B46970>]}
[0m02:16:49.564731 [info ] [MainThread]: 
[0m02:16:49.565339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:16:49.565873 [info ] [MainThread]: 
[0m02:16:49.566551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:16:49.571637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:16:49.572000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:49.600727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:16:49.601563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:49.602652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:16:49.603010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:51.513235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb31e05-6d2f-40bc-a510-3fdf2e290871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689BBBC70>]}
[0m02:16:51.514249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:16:51.524159 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:16:51.524781 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:16:51.525342 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:16:51.526437 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:16:51.525922 [info ] [Thread-1 (]: 1 of 34 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0  [RUN]
[0m02:16:51.529083 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619'
[0m02:16:51.529578 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:16:51.527055 [info ] [Thread-4 (]: 4 of 34 START test not_null_dim_country_country ................................ [RUN]
[0m02:16:51.536444 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m02:16:51.542330 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:16:51.527783 [info ] [Thread-2 (]: 2 of 34 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0  [RUN]
[0m02:16:51.555706 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba'
[0m02:16:51.556514 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:16:51.528384 [info ] [Thread-3 (]: 3 of 34 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m02:16:51.582806 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619"
[0m02:16:51.584533 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m02:16:51.587866 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:16:51.591231 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba"
[0m02:16:51.592489 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:16:51.594578 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:16:51.617187 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:16:51.650945 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619"
[0m02:16:51.651864 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:16:51.652558 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:16:51.655694 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba"
[0m02:16:51.658668 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:16:51.659788 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:16:51.662207 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:16:51.662852 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from e2e-dbt-project.analytics_mart.fct_sales_item

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m02:16:51.663414 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:16:51.695111 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m02:16:51.695853 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:16:51.725216 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from e2e-dbt-project.analytics_mart.fct_sales_item

where not(revenue_local revenue_local >= 0)


  
  
      
    ) dbt_internal_test
[0m02:16:51.725947 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:16:51.729269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:16:51.730112 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:16:53.550094 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:67bfa8ee-cf1b-4add-8203-d5289a5158db&page=queryresults
[0m02:16:53.552121 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:67bfa8ee-cf1b-4add-8203-d5289a5158db&page=queryresults
[0m02:16:53.572868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:82e39bbf-22d6-4064-9b57-0ce1aa673158&page=queryresults
[0m02:16:53.575458 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:82e39bbf-22d6-4064-9b57-0ce1aa673158&page=queryresults
[0m02:16:53.606450 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql
[0m02:16:53.608320 [error] [Thread-2 (]: 2 of 34 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.05s]
[0m02:16:53.612419 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql
[0m02:16:53.613350 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba
[0m02:16:53.615068 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:16:53.616088 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql.
[0m02:16:53.614151 [error] [Thread-1 (]: 1 of 34 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0  [[31mERROR[0m in 2.09s]
[0m02:16:53.618985 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619
[0m02:16:53.619535 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:16:53.616821 [info ] [Thread-2 (]: 5 of 34 START test not_null_dim_date_date ...................................... [RUN]
[0m02:16:53.620700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0.7c38818cba, now test.ga_retail_project.not_null_dim_date_date.78f11e7735)
[0m02:16:53.621206 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:16:53.625938 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_date.78f11e7735"
[0m02:16:53.626687 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql.
[0m02:16:53.620034 [info ] [Thread-1 (]: 6 of 34 START test not_null_dim_products_product_sku ........................... [RUN]
[0m02:16:53.627915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0.ceafe52619, now test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343)
[0m02:16:53.628522 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:16:53.634030 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:16:53.635070 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:16:53.638689 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_date.78f11e7735"
[0m02:16:53.639601 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:16:53.642649 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:16:53.643734 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from e2e-dbt-project.analytics_mart.dim_date
where date is null



  
  
      
    ) dbt_internal_test
[0m02:16:53.644288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:53.644997 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:16:53.645535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:53.807483 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c2f8d7e4-4f33-4cca-9c78-5c83ab990d8f&page=queryresults
[0m02:16:53.836357 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d3cfe9e3-0221-4988-85e3-52727814f5c3&page=queryresults
[0m02:16:55.439000 [info ] [Thread-4 (]: 4 of 34 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 3.90s]
[0m02:16:55.446910 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:16:55.444640 [info ] [Thread-3 (]: 3 of 34 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.86s]
[0m02:16:55.449289 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:16:55.451988 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:16:55.455341 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:16:55.453707 [info ] [Thread-4 (]: 7 of 34 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m02:16:55.457414 [info ] [Thread-3 (]: 8 of 34 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m02:16:55.459642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m02:16:55.461401 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m02:16:55.463096 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:16:55.464767 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:16:55.479115 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:16:55.489826 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:16:55.491584 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:16:55.494500 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:16:55.495233 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:16:55.497921 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:16:55.498901 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:16:55.499507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:16:55.534065 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:16:55.534837 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:16:55.568738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ffd18040-6663-4429-85be-871ce96cf5c9&page=queryresults
[0m02:16:55.669424 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f6a5d1fe-0748-4637-950d-8b1569878b2f&page=queryresults
[0m02:16:55.670495 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f6a5d1fe-0748-4637-950d-8b1569878b2f&page=queryresults
[0m02:16:55.681933 [debug] [Thread-2 (]: Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:7]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:16:55.682648 [error] [Thread-2 (]: 5 of 34 ERROR not_null_dim_date_date ........................................... [[31mERROR[0m in 2.06s]
[0m02:16:55.683699 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:16:55.684573 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:16:55.685718 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.not_null_dim_date_date.78f11e7735' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:7]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql.
[0m02:16:55.685085 [info ] [Thread-2 (]: 9 of 34 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m02:16:55.686523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_date.78f11e7735, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m02:16:55.686983 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:16:55.691154 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:16:55.692196 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:16:55.694982 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:16:55.696189 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m02:16:55.696813 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:57.051612 [info ] [Thread-1 (]: 6 of 34 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.42s]
[0m02:16:57.052773 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:16:57.053334 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:16:57.053742 [info ] [Thread-1 (]: 10 of 34 START test not_null_fct_sales_item_session_date ....................... [RUN]
[0m02:16:57.054477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m02:16:57.055078 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:16:57.059363 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:16:57.060391 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:16:57.063126 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:16:57.064213 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:16:57.064840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:16:57.620848 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9900c92b-06b8-4bc4-8329-d26d4e95f0be&page=queryresults
[0m02:16:57.771250 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eda51b9d-05e7-48dd-a2ec-5364df4e2238&page=queryresults
[0m02:16:57.930898 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5ca4f670-fd5c-474e-9850-f8f4eef3aba6&page=queryresults
[0m02:16:58.544237 [info ] [Thread-4 (]: 7 of 34 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.08s]
[0m02:16:58.545344 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:16:58.545873 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:16:58.546371 [info ] [Thread-4 (]: 11 of 34 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m02:16:58.547184 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m02:16:58.547720 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:16:58.553113 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:16:58.554507 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:16:58.557918 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:16:58.559274 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:16:58.559833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:16:58.675006 [error] [Thread-3 (]: 8 of 34 FAIL 882 not_null_fct_sales_item_product_sku ........................... [[31mFAIL 882[0m in 3.21s]
[0m02:16:58.676022 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:16:58.676571 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:16:58.677070 [info ] [Thread-3 (]: 12 of 34 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m02:16:58.677763 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m02:16:58.678254 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:16:58.683296 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:16:58.684921 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:16:58.688326 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:16:58.690219 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:16:58.691184 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:16:58.854004 [error] [Thread-2 (]: 9 of 34 FAIL 43746 not_null_fct_sales_item_revenue_usd ......................... [[31mFAIL 43746[0m in 3.17s]
[0m02:16:58.854935 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:16:58.855384 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:16:58.855806 [info ] [Thread-2 (]: 13 of 34 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m02:16:58.856443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m02:16:58.856841 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:16:58.860706 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:16:58.869283 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:16:58.872177 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:16:58.873435 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:16:58.873919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:16:58.951483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:32f3af89-2fcd-441d-a82e-718e123e65c6&page=queryresults
[0m02:16:59.865164 [info ] [Thread-1 (]: 10 of 34 PASS not_null_fct_sales_item_session_date ............................. [[32mPASS[0m in 2.81s]
[0m02:16:59.866508 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:16:59.867301 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:16:59.868066 [info ] [Thread-1 (]: 14 of 34 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m02:16:59.868909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m02:16:59.869313 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:16:59.873114 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:16:59.874090 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:16:59.879479 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:16:59.880502 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:16:59.880939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:00.823794 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9ac1d619-d114-4d21-960e-89ba072d0974&page=queryresults
[0m02:17:01.287670 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:951acda3-7a1f-4aa7-b1cc-542d34223769&page=queryresults
[0m02:17:01.292864 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:160d34ce-2542-430a-9516-0768149edcd4&page=queryresults
[0m02:17:01.795032 [error] [Thread-4 (]: 11 of 34 FAIL 48209 not_null_fct_sales_item_transaction_id ..................... [[31mFAIL 48209[0m in 3.25s]
[0m02:17:01.798355 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:17:01.799901 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:17:01.801595 [info ] [Thread-4 (]: 15 of 34 START test not_null_product_categories_product_category ............... [RUN]
[0m02:17:01.803714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m02:17:01.805866 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:17:01.819055 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:17:01.822277 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:17:01.827958 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:17:01.830021 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m02:17:01.830861 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:01.894372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8fb7fa6e-f287-4492-8405-ad3612c5510f&page=queryresults
[0m02:17:02.667901 [info ] [Thread-3 (]: 12 of 34 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 3.99s]
[0m02:17:02.668844 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:17:02.669287 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:17:02.669696 [info ] [Thread-3 (]: 16 of 34 START test not_null_product_categories_product_sku .................... [RUN]
[0m02:17:02.670350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m02:17:02.670764 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:17:02.674699 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:17:02.675689 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:17:02.678803 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:17:02.679915 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:17:02.680373 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:03.178093 [info ] [Thread-2 (]: 13 of 34 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 4.32s]
[0m02:17:03.178950 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:17:03.179346 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:17:03.179710 [info ] [Thread-2 (]: 17 of 34 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m02:17:03.180271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m02:17:03.180616 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:17:03.184528 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:17:03.185671 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:17:03.188232 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:17:03.189230 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:17:03.189649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:03.339019 [info ] [Thread-1 (]: 14 of 34 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 3.47s]
[0m02:17:03.340110 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:17:03.340643 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:17:03.341145 [info ] [Thread-1 (]: 18 of 34 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m02:17:03.341831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m02:17:03.342285 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:17:03.346300 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:17:03.347387 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:17:03.350431 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:17:03.351527 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:17:03.351998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:03.706633 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3432565c-5e23-4ccb-969d-3ef6f0393aef&page=queryresults
[0m02:17:04.618076 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9d0a2f8a-ad41-4b6c-a61e-3f468162b126&page=queryresults
[0m02:17:04.707224 [info ] [Thread-4 (]: 15 of 34 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 2.90s]
[0m02:17:04.710218 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:17:04.711845 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:17:04.713634 [info ] [Thread-4 (]: 19 of 34 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m02:17:04.716949 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m02:17:04.718886 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:17:04.732069 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:17:04.734067 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:17:04.739832 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:17:04.742152 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:17:04.743590 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:05.097196 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:89410bb7-6b13-4066-937d-3bec1a011d6e&page=queryresults
[0m02:17:05.349416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:683ba293-935a-4418-9b29-dcc943fc3bb6&page=queryresults
[0m02:17:05.481030 [info ] [Thread-3 (]: 16 of 34 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 2.81s]
[0m02:17:05.482585 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:17:05.483442 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:17:05.484203 [info ] [Thread-3 (]: 20 of 34 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m02:17:05.485222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m02:17:05.485995 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:17:05.494895 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:17:05.495969 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:17:05.498858 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:17:05.500442 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:17:05.501312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:06.461317 [info ] [Thread-2 (]: 17 of 34 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 3.28s]
[0m02:17:06.462237 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:17:06.462665 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:17:06.463075 [info ] [Thread-2 (]: 21 of 34 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m02:17:06.463733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m02:17:06.464146 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:17:06.468179 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:17:06.469321 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:17:06.472019 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:17:06.473121 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m02:17:06.473562 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:06.609249 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:220c9f18-888a-4bb8-9ba4-ea69990a46ec&page=queryresults
[0m02:17:06.831785 [info ] [Thread-1 (]: 18 of 34 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.49s]
[0m02:17:06.832852 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:17:06.833307 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:17:06.833715 [info ] [Thread-1 (]: 22 of 34 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m02:17:06.834395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m02:17:06.834805 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:17:06.838692 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:17:06.839663 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:17:06.842268 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:17:06.843180 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:17:06.843617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:07.309927 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bc44bb84-f98b-492e-af2b-dd5097aeff1a&page=queryresults
[0m02:17:08.053218 [info ] [Thread-4 (]: 19 of 34 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 3.34s]
[0m02:17:08.054148 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:17:08.054561 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:17:08.054953 [info ] [Thread-4 (]: 23 of 34 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m02:17:08.055536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m02:17:08.055939 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:17:08.060083 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:17:08.068784 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:17:08.071882 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:17:08.073034 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:17:08.073503 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:08.430959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cc173896-54aa-4f44-86c1-a9c54b810c98&page=queryresults
[0m02:17:08.676781 [info ] [Thread-3 (]: 20 of 34 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 3.19s]
[0m02:17:08.678519 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:17:08.679654 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:17:08.680840 [info ] [Thread-3 (]: 24 of 34 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m02:17:08.682280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m02:17:08.683279 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:17:08.692528 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:17:08.695200 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:17:08.702493 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:17:08.704900 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m02:17:08.706216 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:08.751539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6e3e7ac6-7f5d-418e-9b6b-db9f2f0dfc37&page=queryresults
[0m02:17:09.284483 [info ] [Thread-2 (]: 21 of 34 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.82s]
[0m02:17:09.285333 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:17:09.285706 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:17:09.286054 [info ] [Thread-2 (]: 25 of 34 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m02:17:09.286615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m02:17:09.286989 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:17:09.290583 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:17:09.291714 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:17:09.294216 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:17:09.295150 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m02:17:09.295564 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:09.594636 [info ] [Thread-1 (]: 22 of 34 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.76s]
[0m02:17:09.595516 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:17:09.595926 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m02:17:09.596305 [info ] [Thread-1 (]: 26 of 34 START test stg_hits_products_quality .................................. [RUN]
[0m02:17:09.596888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m02:17:09.597241 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m02:17:09.600032 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:17:09.601133 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m02:17:09.603263 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:17:09.604324 [debug] [Thread-1 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:17:09.604748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:09.922836 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b910295d-039f-4eb0-9da4-7b52375d50a6&page=queryresults
[0m02:17:10.653266 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c4a4061-38a7-4c19-97d8-1da7ce4dba9e&page=queryresults
[0m02:17:10.756451 [info ] [Thread-4 (]: 23 of 34 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 2.70s]
[0m02:17:10.757314 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:17:10.757713 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:17:10.758101 [info ] [Thread-4 (]: 27 of 34 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m02:17:10.758776 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m02:17:10.759349 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:17:10.761622 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:17:10.762526 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:17:10.764742 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:17:10.766004 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:17:10.766475 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:11.134100 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:33e7d9d0-f968-4909-b7a1-ca836f861f42&page=queryresults
[0m02:17:11.573235 [info ] [Thread-3 (]: 24 of 34 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 2.89s]
[0m02:17:11.574986 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:17:11.575516 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:17:11.575995 [info ] [Thread-3 (]: 28 of 34 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m02:17:11.576952 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m02:17:11.578677 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:17:11.582179 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:17:11.583263 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c45b25c-7f03-42a6-a319-26c1b1c8f7a0&page=queryresults
[0m02:17:11.593281 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:17:11.597275 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:17:11.598869 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:17:11.599498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:12.157301 [info ] [Thread-2 (]: 25 of 34 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 2.87s]
[0m02:17:12.158157 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:17:12.158550 [debug] [Thread-2 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m02:17:12.158913 [info ] [Thread-2 (]: 29 of 34 START test test_non_negative_values ................................... [RUN]
[0m02:17:12.159488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m02:17:12.159851 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m02:17:12.162360 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m02:17:12.163263 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m02:17:12.167217 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m02:17:12.169848 [debug] [Thread-2 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:17:12.170518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:12.825540 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:94269f42-eb9b-4f21-b1a4-9b83b9e95207&page=queryresults
[0m02:17:13.038284 [info ] [Thread-1 (]: 26 of 34 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.44s]
[0m02:17:13.039208 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m02:17:13.039637 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:17:13.040028 [info ] [Thread-1 (]: 30 of 34 START test unique_dim_country_country ................................. [RUN]
[0m02:17:13.040578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m02:17:13.040956 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:17:13.046542 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:17:13.047604 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:17:13.049814 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:17:13.050830 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:17:13.051275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:13.666826 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:728ce773-2c1b-4cb7-b4cc-314dc753f8f4&page=queryresults
[0m02:17:14.108221 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c8bb9f15-9877-4829-817f-41962c106f0e&page=queryresults
[0m02:17:14.118428 [info ] [Thread-4 (]: 27 of 34 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.36s]
[0m02:17:14.119280 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:17:14.119686 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:17:14.120064 [info ] [Thread-4 (]: 31 of 34 START test unique_dim_date_date ....................................... [RUN]
[0m02:17:14.120671 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_dim_date_date.dd069a8d31)
[0m02:17:14.121041 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:17:14.124648 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_date.dd069a8d31"
[0m02:17:14.125596 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:17:14.128179 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_date.dd069a8d31"
[0m02:17:14.129090 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:17:14.129505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:15.060455 [info ] [Thread-2 (]: 29 of 34 PASS test_non_negative_values ......................................... [[32mPASS[0m in 2.90s]
[0m02:17:15.061416 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m02:17:15.061868 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:17:15.062290 [info ] [Thread-2 (]: 32 of 34 START test unique_dim_products_product_sku ............................ [RUN]
[0m02:17:15.062951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m02:17:15.063372 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:17:15.067574 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:17:15.068807 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:17:15.071740 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:17:15.072701 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:17:15.073160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:17:15.103327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5b97eff6-35ba-4803-a0e5-aea33c7e6166&page=queryresults
[0m02:17:15.130578 [info ] [Thread-3 (]: 28 of 34 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.55s]
[0m02:17:15.131582 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:17:15.132063 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:17:15.132704 [info ] [Thread-3 (]: 33 of 34 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m02:17:15.133351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_with_fx_local_nonnegative, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m02:17:15.133780 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:17:15.137878 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:17:15.138955 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:17:15.141255 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:17:15.142287 [debug] [Thread-3 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:17:15.142757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:17:15.933062 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:927e6fad-9e6d-452e-a44b-a2a742ec1b6d&page=queryresults
[0m02:17:15.933679 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:927e6fad-9e6d-452e-a44b-a2a742ec1b6d&page=queryresults
[0m02:17:15.941151 [debug] [Thread-4 (]: Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:17:15.941731 [error] [Thread-4 (]: 31 of 34 ERROR unique_dim_date_date ............................................ [[31mERROR[0m in 1.82s]
[0m02:17:15.942616 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:17:15.943085 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:17:15.944085 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.unique_dim_date_date.dd069a8d31' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql.
[0m02:17:15.943519 [info ] [Thread-4 (]: 34 of 34 START test unique_product_categories_product_sku ...................... [RUN]
[0m02:17:15.944796 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_date_date.dd069a8d31, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m02:17:15.945234 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:17:15.949389 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:17:15.958969 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:17:15.962080 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:17:15.963409 [debug] [Thread-4 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:17:15.963910 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:17:16.501390 [info ] [Thread-1 (]: 30 of 34 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 3.46s]
[0m02:17:16.502343 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:17:17.040043 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4e3fa3bb-f089-4b68-b754-4755233a4e8d&page=queryresults
[0m02:17:17.312977 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4b5990f6-eb20-45a6-b41c-0c68ac430b33&page=queryresults
[0m02:17:17.701200 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c858f031-4772-4968-b2a6-6df1caf6374b&page=queryresults
[0m02:17:17.871618 [info ] [Thread-2 (]: 32 of 34 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 2.81s]
[0m02:17:17.875711 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:17:18.158694 [info ] [Thread-3 (]: 33 of 34 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 3.03s]
[0m02:17:18.159818 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:17:18.480269 [info ] [Thread-4 (]: 34 of 34 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 2.54s]
[0m02:17:18.481389 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:17:18.483245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:17:18.485374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:18.485795 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:17:18.486192 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:17:18.486592 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:17:18.486978 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_country_country.11db8eecec' was properly closed.
[0m02:17:18.487364 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m02:17:18.487743 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m02:17:18.488164 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m02:17:18.488679 [info ] [MainThread]: 
[0m02:17:18.489379 [info ] [MainThread]: Finished running 34 data tests in 0 hours 0 minutes and 28.92 seconds (28.92s).
[0m02:17:18.499912 [debug] [MainThread]: Command end result
[0m02:17:18.549428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:17:18.552159 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:17:18.561569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:17:18.561966 [info ] [MainThread]: 
[0m02:17:18.562578 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m02:17:18.563162 [info ] [MainThread]: 
[0m02:17:18.563842 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)[0m
[0m02:17:18.564504 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql
[0m02:17:18.565124 [info ] [MainThread]: 
[0m02:17:18.565774 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_00388fabe07ac9b39600414935c66cd8.sql
[0m02:17:18.566414 [info ] [MainThread]: 
[0m02:17:18.567001 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)[0m
[0m02:17:18.567670 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0 (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql
[0m02:17:18.568274 [info ] [MainThread]: 
[0m02:17:18.568837 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_2f5611252388e8906206af5ec3d8da40.sql
[0m02:17:18.569383 [info ] [MainThread]: 
[0m02:17:18.570019 [error] [MainThread]: [31mFailure in test not_null_dim_date_date (models\mart\mart_models.yml)[0m
[0m02:17:18.570622 [error] [MainThread]:   Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:7]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:17:18.571127 [info ] [MainThread]: 
[0m02:17:18.571686 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:17:18.572181 [info ] [MainThread]: 
[0m02:17:18.572761 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_product_sku (models\mart\mart_models.yml)[0m
[0m02:17:18.573376 [error] [MainThread]:   Got 882 results, configured to fail if != 0
[0m02:17:18.573897 [info ] [MainThread]: 
[0m02:17:18.574523 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_product_sku.sql
[0m02:17:18.575097 [info ] [MainThread]: 
[0m02:17:18.575667 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_revenue_usd (models\mart\mart_models.yml)[0m
[0m02:17:18.576242 [error] [MainThread]:   Got 43746 results, configured to fail if != 0
[0m02:17:18.576716 [info ] [MainThread]: 
[0m02:17:18.577290 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_revenue_usd.sql
[0m02:17:18.577794 [info ] [MainThread]: 
[0m02:17:18.578373 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_transaction_id (models\mart\mart_models.yml)[0m
[0m02:17:18.579016 [error] [MainThread]:   Got 48209 results, configured to fail if != 0
[0m02:17:18.579536 [info ] [MainThread]: 
[0m02:17:18.580162 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_transaction_id.sql
[0m02:17:18.580694 [info ] [MainThread]: 
[0m02:17:18.581296 [error] [MainThread]: [31mFailure in test unique_dim_date_date (models\mart\mart_models.yml)[0m
[0m02:17:18.581860 [error] [MainThread]:   Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:17:18.582380 [info ] [MainThread]: 
[0m02:17:18.582911 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:17:18.583437 [info ] [MainThread]: 
[0m02:17:18.583968 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=7 SKIP=0 NO-OP=0 TOTAL=34
[0m02:17:18.585142 [debug] [MainThread]: Command `dbt test` failed at 02:17:18.585020 after 33.74 seconds
[0m02:17:18.585546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6E47D07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689AB50D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68A08E830>]}
[0m02:17:18.585943 [debug] [MainThread]: Flushing usage events
[0m02:17:20.693582 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:21:12.777182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025588AC42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025586739D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025589B0FD90>]}


============================== 02:21:12.783414 | ea8ce697-8af3-47ed-bf87-68751a42b9fb ==============================
[0m02:21:12.783414 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:21:12.784451 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:21:17.144800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025588E1F950>]}
[0m02:21:17.241484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AE596F10>]}
[0m02:21:17.242399 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:21:18.283190 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:21:18.630502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:21:18.631632 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m02:21:19.331946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AEBEC950>]}
[0m02:21:19.518777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:21:19.522365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:21:19.566939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AE62D7C0>]}
[0m02:21:19.567613 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:21:19.568350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AEDEEB30>]}
[0m02:21:19.571196 [info ] [MainThread]: 
[0m02:21:19.571855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:21:19.572485 [info ] [MainThread]: 
[0m02:21:19.573336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:21:19.579350 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:21:19.579985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:21.634563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:21:21.635379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:21.636110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:21:21.636998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:21.637850 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:21:21.638440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:24.059097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AF043C70>]}
[0m02:21:24.060094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:24.072055 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m02:21:24.073030 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m02:21:24.073928 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:21:24.074836 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m02:21:24.075976 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m02:21:24.077078 [info ] [Thread-3 (]: 3 of 5 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m02:21:24.080948 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m02:21:24.078429 [info ] [Thread-4 (]: 4 of 5 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m02:21:24.082435 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m02:21:24.079757 [info ] [Thread-2 (]: 2 of 5 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m02:21:24.083460 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m02:21:24.085488 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:21:24.086685 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m02:21:24.087862 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m02:21:24.099377 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m02:21:24.100091 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:21:24.104411 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m02:21:24.105096 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m02:21:24.115304 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:21:24.119593 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m02:21:24.126847 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m02:21:24.146810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:21:24.147894 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m02:21:24.151591 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:21:24.152215 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:21:24.193545 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m02:21:24.233425 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:21:24.255313 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:21:26.682487 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m02:21:26.683923 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m02:21:26.860727 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:21:26.863292 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m02:21:26.865367 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m02:21:26.868338 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into e2e-dbt-project.analytics_mart.fct_sales_item as DBT_INTERNAL_DEST
        using (

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
),

-- keep only true item-level transaction rows (clean nulls at source)
filtered as (
    select *
    from base
    where transaction_id is not null
      and product_sku    is not null
      and revenue_usd    is not null
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from filtered

where session_date >
  (select coalesce(max(session_date), date('1970-01-01')) from e2e-dbt-project.analytics_mart.fct_sales_item)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_id = DBT_INTERNAL_DEST.transaction_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_sku = DBT_INTERNAL_DEST.product_sku
                ) and (
                    DBT_INTERNAL_SOURCE.visit_id = DBT_INTERNAL_DEST.visit_id
                )

    
    when matched then update set
        `session_date` = DBT_INTERNAL_SOURCE.`session_date`,`visitor_id` = DBT_INTERNAL_SOURCE.`visitor_id`,`visit_id` = DBT_INTERNAL_SOURCE.`visit_id`,`country` = DBT_INTERNAL_SOURCE.`country`,`traffic_source` = DBT_INTERNAL_SOURCE.`traffic_source`,`traffic_medium` = DBT_INTERNAL_SOURCE.`traffic_medium`,`traffic_campaign` = DBT_INTERNAL_SOURCE.`traffic_campaign`,`transaction_id` = DBT_INTERNAL_SOURCE.`transaction_id`,`product_sku` = DBT_INTERNAL_SOURCE.`product_sku`,`product_name` = DBT_INTERNAL_SOURCE.`product_name`,`product_category` = DBT_INTERNAL_SOURCE.`product_category`,`product_quantity` = DBT_INTERNAL_SOURCE.`product_quantity`,`product_price_usd` = DBT_INTERNAL_SOURCE.`product_price_usd`,`revenue_usd` = DBT_INTERNAL_SOURCE.`revenue_usd`,`revenue_local` = DBT_INTERNAL_SOURCE.`revenue_local`
    

    when not matched then insert
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)
    values
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)


    
[0m02:21:26.869261 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_date.sql
WITH dates AS (
    SELECT
        day AS date_day,
        EXTRACT(YEAR FROM day) AS year,
        EXTRACT(QUARTER FROM day) AS quarter,
        EXTRACT(MONTH FROM day) AS month,
        FORMAT_DATE('%B', day) AS month_name,
        EXTRACT(DAY FROM day) AS day_of_month,
        EXTRACT(DAYOFWEEK FROM day) AS day_of_week,
        FORMAT_DATE('%A', day) AS day_name
    FROM UNNEST(
        GENERATE_DATE_ARRAY('2016-01-01', '2018-12-31', INTERVAL 1 DAY)
    ) AS day
)

SELECT * FROM dates
    );
  
[0m02:21:26.872114 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_products.sql
WITH products AS (
    SELECT
        product_sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(product_category) AS product_category
    FROM e2e-dbt-project.analytics_stg.stg_hits_products
    WHERE product_sku IS NOT NULL
    GROUP BY product_sku
)

SELECT * FROM products
    );
  
[0m02:21:27.576627 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:96917e26-e87a-4386-bac5-92abcdffc11b&page=queryresults
[0m02:21:27.603284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:64563ff3-338d-493e-b819-1dfc9ab66ea6&page=queryresults
[0m02:21:27.604340 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5453adc0-ea40-466b-9a64-3127f14e73a8&page=queryresults
[0m02:21:28.074014 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cc4f802b-915e-4e43-80f7-3822143933fd&page=queryresults
[0m02:21:29.904166 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AEEA9FD0>]}
[0m02:21:29.905189 [info ] [Thread-3 (]: 3 of 5 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (435.0 rows, 3.3 MiB processed)[0m in 5.82s]
[0m02:21:29.906382 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m02:21:29.973828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AF0714F0>]}
[0m02:21:29.976544 [info ] [Thread-2 (]: 2 of 5 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (1.1k rows, 0 processed)[0m in 5.89s]
[0m02:21:29.979326 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m02:21:30.078874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AF0DBC50>]}
[0m02:21:30.079771 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (94.0 rows, 31.0 KiB processed)[0m in 6.00s]
[0m02:21:30.080877 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m02:21:30.842403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AED742D0>]}
[0m02:21:30.844941 [info ] [Thread-4 (]: 4 of 5 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mMERGE (0.0 rows, 11.4 MiB processed)[0m in 6.76s]
[0m02:21:30.847226 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:21:30.849052 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_visitors
[0m02:21:30.850583 [info ] [Thread-3 (]: 5 of 5 START sql table model analytics_mart.dim_visitors ....................... [RUN]
[0m02:21:30.851887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_products, now model.ga_retail_project.dim_visitors)
[0m02:21:30.852943 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_visitors
[0m02:21:30.858315 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_visitors"
[0m02:21:30.860225 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_visitors
[0m02:21:30.866988 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:21:32.802208 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_visitors"
[0m02:21:32.806067 [debug] [Thread-3 (]: On model.ga_retail_project.dim_visitors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_visitors"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_visitors
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_visitors.sql
WITH visitors AS (
    SELECT
        visitor_id,
        COUNT(DISTINCT visit_id) AS total_sessions,
        COUNT(DISTINCT transaction_id) AS total_transactions
    FROM e2e-dbt-project.analytics_mart.fct_sales_item
    GROUP BY visitor_id
)

SELECT * FROM visitors
    );
  
[0m02:21:33.410080 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7adaca1b-258e-462d-9d1b-99eb46675f82&page=queryresults
[0m02:21:36.085525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8ce697-8af3-47ed-bf87-68751a42b9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AEEA2350>]}
[0m02:21:36.088882 [info ] [Thread-3 (]: 5 of 5 OK created sql table model analytics_mart.dim_visitors .................. [[32mCREATE TABLE (2.3k rows, 1.3 MiB processed)[0m in 5.23s]
[0m02:21:36.092322 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_visitors
[0m02:21:36.097679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:21:36.105314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:21:36.106859 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:21:36.108113 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:21:36.109311 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:21:36.110548 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:21:36.111868 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m02:21:36.113093 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_visitors' was properly closed.
[0m02:21:36.114297 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:21:36.115490 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m02:21:36.117025 [info ] [MainThread]: 
[0m02:21:36.118894 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 16.54 seconds (16.54s).
[0m02:21:36.125342 [debug] [MainThread]: Command end result
[0m02:21:36.183746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:21:36.187558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:21:36.196162 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:21:36.196639 [info ] [MainThread]: 
[0m02:21:36.197390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:21:36.198106 [info ] [MainThread]: 
[0m02:21:36.198967 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:21:36.200617 [debug] [MainThread]: Command `dbt run` succeeded at 02:21:36.200432 after 23.68 seconds
[0m02:21:36.201183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AEEDBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B06BBFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B06BBF50>]}
[0m02:21:36.201736 [debug] [MainThread]: Flushing usage events
[0m02:21:37.793413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:21:41.942148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD8EB42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD6B29D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9EFFD90>]}


============================== 02:21:41.948290 | efed43d5-2892-4f1d-a64f-d3c78092f779 ==============================
[0m02:21:41.948290 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:21:41.949288 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:21:46.412105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efed43d5-2892-4f1d-a64f-d3c78092f779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD920F950>]}
[0m02:21:46.509236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efed43d5-2892-4f1d-a64f-d3c78092f779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFE952F10>]}
[0m02:21:46.510162 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:21:47.557938 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:21:47.906388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:21:47.906899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:21:48.006079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efed43d5-2892-4f1d-a64f-d3c78092f779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFE9AD450>]}
[0m02:21:48.196792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:21:48.200262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:21:48.258824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efed43d5-2892-4f1d-a64f-d3c78092f779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFF1FAE40>]}
[0m02:21:48.259470 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:21:48.260208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efed43d5-2892-4f1d-a64f-d3c78092f779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFF1EEA50>]}
[0m02:21:48.264778 [info ] [MainThread]: 
[0m02:21:48.265481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:21:48.266219 [info ] [MainThread]: 
[0m02:21:48.267366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:21:48.274952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:21:48.275749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:48.276529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:21:48.277210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:48.316561 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:21:48.317870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:21:50.769018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efed43d5-2892-4f1d-a64f-d3c78092f779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFF1A7BA0>]}
[0m02:21:50.769720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:21:50.778672 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:21:50.779337 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:21:50.779938 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:21:50.781188 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:21:50.780560 [info ] [Thread-1 (]: 1 of 33 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m02:21:50.782035 [info ] [Thread-4 (]: 4 of 33 START test not_null_dim_products_product_sku ........................... [RUN]
[0m02:21:50.784309 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m02:21:50.785118 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343'
[0m02:21:50.782628 [info ] [Thread-3 (]: 3 of 33 START test not_null_dim_date_date ...................................... [RUN]
[0m02:21:50.786027 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:21:50.783288 [info ] [Thread-2 (]: 2 of 33 START test not_null_dim_country_country ................................ [RUN]
[0m02:21:50.786966 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:21:50.787761 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_date_date.78f11e7735'
[0m02:21:50.801431 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m02:21:50.820703 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:21:50.833615 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:21:50.834611 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:21:50.835501 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:21:50.841672 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_date.78f11e7735"
[0m02:21:50.846784 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:21:50.847812 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:21:50.848529 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:21:50.881594 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:21:50.884313 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:21:50.885182 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:21:50.891177 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_date.78f11e7735"
[0m02:21:50.891957 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:21:50.894993 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:21:50.895840 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:21:50.896561 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:21:50.897195 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:21:50.898012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:21:50.898647 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from e2e-dbt-project.analytics_mart.dim_date
where date is null



  
  
      
    ) dbt_internal_test
[0m02:21:50.899447 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m02:21:50.900491 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:21:50.901043 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:21:53.741792 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:97078150-d644-479b-abd7-051591300148&page=queryresults
[0m02:21:53.743802 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:97078150-d644-479b-abd7-051591300148&page=queryresults
[0m02:21:53.761929 [debug] [Thread-3 (]: Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:7]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:21:53.762761 [error] [Thread-3 (]: 3 of 33 ERROR not_null_dim_date_date ........................................... [[31mERROR[0m in 2.98s]
[0m02:21:53.764487 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_date_date.78f11e7735
[0m02:21:53.765149 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:21:53.766483 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.not_null_dim_date_date.78f11e7735' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:7]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql.
[0m02:21:53.765720 [info ] [Thread-3 (]: 5 of 33 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m02:21:53.768268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_date.78f11e7735, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m02:21:53.768885 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:21:53.774306 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:21:53.775695 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:21:53.779386 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:21:53.780638 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:21:53.781253 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:21:53.822711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5d23b7a2-2a86-4caa-8690-66a87787f44b&page=queryresults
[0m02:21:53.930309 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0703f270-5e7b-4b90-9cf9-c683776293b8&page=queryresults
[0m02:21:53.987873 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:126b378f-e1d6-4718-96cc-091c96b62c50&page=queryresults
[0m02:21:55.451385 [info ] [Thread-4 (]: 4 of 33 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 4.67s]
[0m02:21:55.454452 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:21:55.456110 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:21:55.457839 [info ] [Thread-4 (]: 6 of 33 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m02:21:55.459972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m02:21:55.461451 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:21:55.471313 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:21:55.478186 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:21:55.481968 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:21:55.477668 [info ] [Thread-2 (]: 2 of 33 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 4.68s]
[0m02:21:55.483057 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:21:55.483586 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:21:55.484079 [info ] [Thread-2 (]: 7 of 33 START test not_null_fct_sales_item_revenue_local ....................... [RUN]
[0m02:21:55.484846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392)
[0m02:21:55.485336 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:21:55.489866 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m02:21:55.490831 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:21:55.491383 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:21:55.528360 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:21:55.531406 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m02:21:55.532825 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_local
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_local is null



  
  
      
    ) dbt_internal_test
[0m02:21:55.533365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:21:55.993344 [info ] [Thread-1 (]: 1 of 33 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 5.21s]
[0m02:21:55.994637 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:21:55.995415 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:21:55.996041 [info ] [Thread-1 (]: 8 of 33 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m02:21:55.996793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m02:21:55.997191 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:21:56.001091 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:21:56.002199 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:21:56.005029 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:21:56.006123 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m02:21:56.006809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:56.049666 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5abf4da5-277d-4fff-a6c6-e8a025202f15&page=queryresults
[0m02:21:56.842982 [info ] [Thread-3 (]: 5 of 33 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.07s]
[0m02:21:56.843920 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:21:56.844291 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:21:56.844632 [info ] [Thread-3 (]: 9 of 33 START test not_null_fct_sales_item_session_date ........................ [RUN]
[0m02:21:56.845193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m02:21:56.845545 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:21:56.849075 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:21:56.849937 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:21:56.852355 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:21:56.853183 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:21:56.853603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:21:57.612185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:26bfc2ba-b9e1-4edf-a6e5-5b45784a400c&page=queryresults
[0m02:21:57.641684 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e127f3f7-c653-4c4a-8ef2-6b5d81adbaed&page=queryresults
[0m02:21:57.992007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9c2fb8b0-504a-455f-ba9e-b75cf63035ae&page=queryresults
[0m02:21:58.472990 [error] [Thread-2 (]: 7 of 33 FAIL 43759 not_null_fct_sales_item_revenue_local ....................... [[31mFAIL 43759[0m in 2.99s]
[0m02:21:58.476047 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:21:58.477697 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:21:58.479444 [info ] [Thread-2 (]: 10 of 33 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m02:21:58.481519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m02:21:58.483031 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:21:58.496175 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:21:58.498580 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:21:58.505150 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:21:58.512654 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:21:58.511751 [error] [Thread-4 (]: 6 of 33 FAIL 882 not_null_fct_sales_item_product_sku ........................... [[31mFAIL 882[0m in 3.05s]
[0m02:21:58.513863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:21:58.515187 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:21:58.516346 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:21:58.517272 [info ] [Thread-4 (]: 11 of 33 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m02:21:58.518878 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m02:21:58.519831 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:21:58.530148 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:21:58.576378 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:21:58.579764 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:21:58.580955 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:21:58.581489 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:21:58.885523 [error] [Thread-1 (]: 8 of 33 FAIL 43746 not_null_fct_sales_item_revenue_usd ......................... [[31mFAIL 43746[0m in 2.89s]
[0m02:21:58.886417 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:21:58.886821 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:21:58.887192 [info ] [Thread-1 (]: 12 of 33 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m02:21:58.887770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m02:21:58.888144 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:21:58.891782 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:21:58.892636 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:21:58.895072 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:21:58.896552 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:21:58.897114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:21:59.182672 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8abaa5c2-a27d-4e74-96f1-c505ecf7d221&page=queryresults
[0m02:22:00.264407 [info ] [Thread-3 (]: 9 of 33 PASS not_null_fct_sales_item_session_date .............................. [[32mPASS[0m in 3.42s]
[0m02:22:00.268353 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:22:00.270099 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:22:00.272178 [info ] [Thread-3 (]: 13 of 33 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m02:22:00.274838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m02:22:00.276558 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:22:00.290890 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:22:00.293575 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:22:00.304831 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:22:00.306246 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:22:00.306887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:22:00.865502 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:48329b34-41bc-43a3-a8ee-2ad8db35a385&page=queryresults
[0m02:22:00.927196 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fbf9339c-07d1-481a-a982-87ae0f1078ff&page=queryresults
[0m02:22:01.055144 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cfddbdde-4f91-4efd-9fb4-aafd86a47d46&page=queryresults
[0m02:22:01.896633 [error] [Thread-2 (]: 10 of 33 FAIL 48209 not_null_fct_sales_item_transaction_id ..................... [[31mFAIL 48209[0m in 3.41s]
[0m02:22:01.900938 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:22:01.902698 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:22:01.904949 [info ] [Thread-2 (]: 14 of 33 START test not_null_product_categories_product_category ............... [RUN]
[0m02:22:01.907174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m02:22:01.908876 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:22:01.921781 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:22:01.923874 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:22:01.929943 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:22:01.931579 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m02:22:01.932343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:22:02.276508 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e2d1feee-1690-4648-98a1-610e86b426d1&page=queryresults
[0m02:22:02.499208 [info ] [Thread-4 (]: 11 of 33 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 3.98s]
[0m02:22:02.500555 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:22:02.501099 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:22:02.501664 [info ] [Thread-4 (]: 15 of 33 START test not_null_product_categories_product_sku .................... [RUN]
[0m02:22:02.502448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m02:22:02.502875 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:22:02.506974 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:22:02.507934 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:22:02.510713 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:22:02.511636 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:22:02.512093 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:22:02.819427 [info ] [Thread-1 (]: 12 of 33 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 3.93s]
[0m02:22:02.820335 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:22:02.820785 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:22:02.821206 [info ] [Thread-1 (]: 16 of 33 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m02:22:02.821796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m02:22:02.822191 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:22:02.825985 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:22:02.826910 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:22:02.829529 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:22:02.830422 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:22:02.830865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:03.877927 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e146eba6-3a0c-48ff-a275-87158dfc71b6&page=queryresults
[0m02:22:03.960433 [info ] [Thread-3 (]: 13 of 33 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 3.69s]
[0m02:22:03.961336 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:22:03.961741 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:22:03.962116 [info ] [Thread-3 (]: 17 of 33 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m02:22:03.962704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m02:22:03.963071 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:22:03.967002 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:22:03.968044 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:22:03.970689 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:22:03.971518 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:22:03.971940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:22:04.602664 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:89e662c0-a368-4694-ad2c-4b177e431b8c&page=queryresults
[0m02:22:04.688870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dc3a4e4d-789c-4c1e-8e2a-df596ce4519b&page=queryresults
[0m02:22:04.731284 [info ] [Thread-2 (]: 14 of 33 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 2.82s]
[0m02:22:04.732288 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:22:04.732710 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:22:04.733141 [info ] [Thread-2 (]: 18 of 33 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m02:22:04.733879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m02:22:04.734610 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:22:04.742820 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:22:04.744260 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:22:04.750003 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:22:04.751736 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:22:04.752716 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:22:05.481798 [info ] [Thread-4 (]: 15 of 33 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 2.98s]
[0m02:22:05.485776 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:22:05.488296 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:22:05.490212 [info ] [Thread-4 (]: 19 of 33 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m02:22:05.492945 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m02:22:05.494631 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:22:05.508998 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:22:05.512416 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:22:05.522106 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:22:05.524707 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:22:05.526112 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:22:05.829829 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c3caca3a-a3b1-46ea-abfc-40afa26e3300&page=queryresults
[0m02:22:06.032630 [info ] [Thread-1 (]: 16 of 33 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 3.21s]
[0m02:22:06.033556 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:22:06.034003 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:22:06.034416 [info ] [Thread-1 (]: 20 of 33 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m02:22:06.035099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m02:22:06.035584 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:22:06.039756 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:22:06.040684 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:22:06.042916 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:22:06.043792 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m02:22:06.044234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:06.630183 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:724c626d-f674-4b5b-b7c2-de4b28e91394&page=queryresults
[0m02:22:07.183722 [info ] [Thread-3 (]: 17 of 33 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.22s]
[0m02:22:07.184783 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:22:07.185216 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:22:07.185624 [info ] [Thread-3 (]: 21 of 33 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m02:22:07.186238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m02:22:07.186661 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:22:07.190764 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:22:07.191698 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:22:07.194372 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:22:07.195254 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:22:07.195698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:22:07.460963 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:62a0a62d-3296-4439-9328-9fa57778b529&page=queryresults
[0m02:22:07.922031 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a9859576-4ad0-4e42-8844-230a52467342&page=queryresults
[0m02:22:07.983954 [info ] [Thread-2 (]: 18 of 33 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 3.25s]
[0m02:22:07.984910 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:22:07.985350 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:22:07.985756 [info ] [Thread-2 (]: 22 of 33 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m02:22:07.986396 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m02:22:07.986801 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:22:07.990762 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:22:07.991668 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:22:07.994276 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:22:07.995143 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:22:07.995571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:22:08.836213 [info ] [Thread-4 (]: 19 of 33 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 3.34s]
[0m02:22:08.837132 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:22:08.837562 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:22:08.838038 [info ] [Thread-4 (]: 23 of 33 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m02:22:08.838694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m02:22:08.839096 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:22:08.842970 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:22:08.849491 [info ] [Thread-1 (]: 20 of 33 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.81s]
[0m02:22:08.850722 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:22:08.851274 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:22:08.852149 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:22:08.857440 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:22:08.858259 [info ] [Thread-1 (]: 24 of 33 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m02:22:08.859382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m02:22:08.860050 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:22:08.868036 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:22:08.868816 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m02:22:08.869600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:22:08.871212 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:22:08.901735 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:22:08.903700 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m02:22:08.904701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:09.133890 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1743c0b5-be42-4da3-8070-445d0b1f6003&page=queryresults
[0m02:22:09.974434 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:babc3ca0-0b67-4ed5-ae83-a42703cf7b4e&page=queryresults
[0m02:22:09.996600 [info ] [Thread-3 (]: 21 of 33 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.81s]
[0m02:22:09.997656 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:22:09.998208 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m02:22:09.998716 [info ] [Thread-3 (]: 25 of 33 START test stg_hits_products_quality .................................. [RUN]
[0m02:22:09.999377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m02:22:09.999954 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m02:22:10.003258 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:22:10.004401 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m02:22:10.013348 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:22:10.014512 [debug] [Thread-3 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:22:10.015146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:22:10.826961 [info ] [Thread-2 (]: 22 of 33 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 2.84s]
[0m02:22:10.830318 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:22:10.831451 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:22:10.833112 [info ] [Thread-2 (]: 26 of 33 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m02:22:10.835085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m02:22:10.836675 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:22:10.845600 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:22:10.847738 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:22:10.850734 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:22:10.852060 [debug] [Thread-2 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:22:10.852769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:22:11.046721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:489744d4-53c4-4051-bc38-50d66ef54fe0&page=queryresults
[0m02:22:11.125204 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab756cfd-884f-467c-9f34-bdc1fa7d1f5f&page=queryresults
[0m02:22:11.861448 [info ] [Thread-1 (]: 24 of 33 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.00s]
[0m02:22:11.862669 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:22:11.863119 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:22:11.863637 [info ] [Thread-1 (]: 27 of 33 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m02:22:11.864368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m02:22:11.864773 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:22:11.868092 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:22:11.869144 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:22:11.871979 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:22:11.872971 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:22:11.873483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:11.919285 [info ] [Thread-4 (]: 23 of 33 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.08s]
[0m02:22:11.920266 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:22:11.920741 [debug] [Thread-4 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m02:22:11.921300 [info ] [Thread-4 (]: 28 of 33 START test test_non_negative_values ................................... [RUN]
[0m02:22:11.922027 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.test_non_negative_values)
[0m02:22:11.922415 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m02:22:11.924839 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m02:22:11.925950 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m02:22:11.928414 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m02:22:11.929712 [debug] [Thread-4 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:22:11.930602 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:22:12.000235 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:839e567d-f782-4596-8259-c42fe3744ab6&page=queryresults
[0m02:22:12.917715 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:59da94bf-10ca-4edc-9a21-b67df0b6e3e9&page=queryresults
[0m02:22:13.357172 [info ] [Thread-3 (]: 25 of 33 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.36s]
[0m02:22:13.360265 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m02:22:13.361818 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:22:13.363748 [info ] [Thread-3 (]: 29 of 33 START test unique_dim_country_country ................................. [RUN]
[0m02:22:13.367814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m02:22:13.370559 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:22:13.391771 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:22:13.394111 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:22:13.397782 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:22:13.399295 [debug] [Thread-3 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:22:13.400155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:22:14.063763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:87c177d6-a800-4e90-83d8-48566d86093b&page=queryresults
[0m02:22:14.099180 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7a230e27-4a26-4906-8f56-496375045bc2&page=queryresults
[0m02:22:14.283558 [info ] [Thread-2 (]: 26 of 33 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.45s]
[0m02:22:14.284499 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:22:14.284927 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:22:14.285440 [info ] [Thread-2 (]: 30 of 33 START test unique_dim_date_date ....................................... [RUN]
[0m02:22:14.286096 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_dim_date_date.dd069a8d31)
[0m02:22:14.286481 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:22:14.290319 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_date.dd069a8d31"
[0m02:22:14.291363 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:22:14.294161 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_date.dd069a8d31"
[0m02:22:14.295216 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:22:14.295838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:22:14.922152 [info ] [Thread-4 (]: 28 of 33 PASS test_non_negative_values ......................................... [[32mPASS[0m in 3.00s]
[0m02:22:14.923352 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m02:22:14.924120 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:22:14.924812 [info ] [Thread-4 (]: 31 of 33 START test unique_dim_products_product_sku ............................ [RUN]
[0m02:22:14.925662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m02:22:14.926212 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:22:14.931904 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:22:14.933992 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:22:14.939098 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:22:14.941154 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:22:14.942175 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:22:15.384390 [info ] [Thread-1 (]: 27 of 33 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.52s]
[0m02:22:15.385405 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:22:15.385807 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:22:15.386363 [info ] [Thread-1 (]: 32 of 33 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m02:22:15.387086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_with_fx_local_nonnegative, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m02:22:15.387430 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:22:15.390924 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:22:15.391798 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:22:15.393795 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:22:15.394629 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:22:15.395030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:22:15.700147 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:53c73403-dba6-4848-a3bf-e713b048532b&page=queryresults
[0m02:22:16.270705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f3f37c6a-5f91-4fde-b77f-25d9755a7a09&page=queryresults
[0m02:22:16.271726 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f3f37c6a-5f91-4fde-b77f-25d9755a7a09&page=queryresults
[0m02:22:16.278457 [debug] [Thread-2 (]: Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:22:16.278944 [error] [Thread-2 (]: 30 of 33 ERROR unique_dim_date_date ............................................ [[31mERROR[0m in 1.99s]
[0m02:22:16.279790 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_date_date.dd069a8d31
[0m02:22:16.280207 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:22:16.280963 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.unique_dim_date_date.dd069a8d31' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql.
[0m02:22:16.281849 [info ] [Thread-2 (]: 33 of 33 START test unique_product_categories_product_sku ...................... [RUN]
[0m02:22:16.282903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_date_date.dd069a8d31, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m02:22:16.283704 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:22:16.291443 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:22:16.292975 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:22:16.296618 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:22:16.297948 [debug] [Thread-2 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:22:16.298850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:22:16.495402 [info ] [Thread-3 (]: 29 of 33 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 3.13s]
[0m02:22:16.496441 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:22:17.361861 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:83d4aecc-fd6b-4afe-a6ae-48fdfc4de2d5&page=queryresults
[0m02:22:17.682408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:508833c7-57b7-4059-9a7e-60decb40177c&page=queryresults
[0m02:22:18.135045 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:94ab44f1-d970-45c0-85ac-48ae7c97e140&page=queryresults
[0m02:22:18.175882 [info ] [Thread-4 (]: 31 of 33 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 3.25s]
[0m02:22:18.180588 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:22:18.798681 [info ] [Thread-1 (]: 32 of 33 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 3.41s]
[0m02:22:18.802276 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:22:18.989088 [info ] [Thread-2 (]: 33 of 33 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 2.71s]
[0m02:22:18.990964 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:22:18.993930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:22:18.996951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:18.997377 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:22:18.997811 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:22:18.998156 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:22:18.998506 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m02:22:18.999125 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m02:22:18.999854 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_country_country.11db8eecec' was properly closed.
[0m02:22:19.000350 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m02:22:19.000849 [info ] [MainThread]: 
[0m02:22:19.001535 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 30.73 seconds (30.73s).
[0m02:22:19.011080 [debug] [MainThread]: Command end result
[0m02:22:19.078012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:22:19.080721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:22:19.089793 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:22:19.090184 [info ] [MainThread]: 
[0m02:22:19.090804 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m02:22:19.091309 [info ] [MainThread]: 
[0m02:22:19.091936 [error] [MainThread]: [31mFailure in test not_null_dim_date_date (models\mart\mart_models.yml)[0m
[0m02:22:19.092506 [error] [MainThread]:   Database Error in test not_null_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:7]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:22:19.093043 [info ] [MainThread]: 
[0m02:22:19.093611 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_dim_date_date.sql
[0m02:22:19.094143 [info ] [MainThread]: 
[0m02:22:19.094714 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_revenue_local (models\mart\mart_models.yml)[0m
[0m02:22:19.095344 [error] [MainThread]:   Got 43759 results, configured to fail if != 0
[0m02:22:19.095806 [info ] [MainThread]: 
[0m02:22:19.096625 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_revenue_local.sql
[0m02:22:19.097259 [info ] [MainThread]: 
[0m02:22:19.097952 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_product_sku (models\mart\mart_models.yml)[0m
[0m02:22:19.098662 [error] [MainThread]:   Got 882 results, configured to fail if != 0
[0m02:22:19.099403 [info ] [MainThread]: 
[0m02:22:19.100198 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_product_sku.sql
[0m02:22:19.100766 [info ] [MainThread]: 
[0m02:22:19.101395 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_revenue_usd (models\mart\mart_models.yml)[0m
[0m02:22:19.102097 [error] [MainThread]:   Got 43746 results, configured to fail if != 0
[0m02:22:19.102712 [info ] [MainThread]: 
[0m02:22:19.103677 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_revenue_usd.sql
[0m02:22:19.104483 [info ] [MainThread]: 
[0m02:22:19.105431 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_transaction_id (models\mart\mart_models.yml)[0m
[0m02:22:19.106375 [error] [MainThread]:   Got 48209 results, configured to fail if != 0
[0m02:22:19.107083 [info ] [MainThread]: 
[0m02:22:19.108018 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_transaction_id.sql
[0m02:22:19.108816 [info ] [MainThread]: 
[0m02:22:19.109754 [error] [MainThread]: [31mFailure in test unique_dim_date_date (models\mart\mart_models.yml)[0m
[0m02:22:19.110594 [error] [MainThread]:   Database Error in test unique_dim_date_date (models\mart\mart_models.yml)
  Unrecognized name: date at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:22:19.111664 [info ] [MainThread]: 
[0m02:22:19.112402 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\unique_dim_date_date.sql
[0m02:22:19.113011 [info ] [MainThread]: 
[0m02:22:19.113810 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=33
[0m02:22:19.115311 [debug] [MainThread]: Command `dbt test` failed at 02:22:19.115168 after 37.39 seconds
[0m02:22:19.115783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9ECC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFF739D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DFF73B1D0>]}
[0m02:22:19.116283 [debug] [MainThread]: Flushing usage events
[0m02:22:20.205944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:41.673001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF40E42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF1D59D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF5123D90>]}


============================== 02:26:41.678117 | 2558df03-6caf-4cdf-8ea5-257b496b8f80 ==============================
[0m02:26:41.678117 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:26:41.678913 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m02:26:41.862536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2558df03-6caf-4cdf-8ea5-257b496b8f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF4443950>]}
[0m02:26:41.970128 [debug] [MainThread]: Command `dbt clean` succeeded at 02:26:41.969951 after 0.48 seconds
[0m02:26:41.970545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF51998C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF5199040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF640C650>]}
[0m02:26:41.970939 [debug] [MainThread]: Flushing usage events
[0m02:26:43.471595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:50.408711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8877B42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E885419D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8887F3D90>]}


============================== 02:26:50.413720 | d0409fc0-889f-4ac4-93f5-7b2c587e0877 ==============================
[0m02:26:50.413720 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:26:50.414520 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:26:50.587700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0409fc0-889f-4ac4-93f5-7b2c587e0877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E887B13950>]}
[0m02:26:50.628297 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-a1dwive3'
[0m02:26:50.628756 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:26:53.951210 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:26:53.956465 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:26:54.552855 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:26:54.572427 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:26:55.468641 [info ] [MainThread]: Installed from version 1.3.0
[0m02:26:55.469307 [info ] [MainThread]: Up to date!
[0m02:26:55.469842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0409fc0-889f-4ac4-93f5-7b2c587e0877', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E888869590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E888869F20>]}
[0m02:26:55.471690 [debug] [MainThread]: Command `dbt deps` succeeded at 02:26:55.471560 after 5.20 seconds
[0m02:26:55.472067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E889A01750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8886728A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E8899B47D0>]}
[0m02:26:55.472456 [debug] [MainThread]: Flushing usage events
[0m02:26:56.593933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:11.727148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA93E42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA7055D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAA42FD90>]}


============================== 02:27:11.732338 | 681cb0a2-5ff9-4018-b853-29a07c03166e ==============================
[0m02:27:11.732338 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:27:11.733203 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_country dim_date dim_visitors', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:27:15.459307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA9747950>]}
[0m02:27:15.531638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDEAAF10>]}
[0m02:27:15.532391 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:27:16.307806 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:27:16.309068 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:27:16.309706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDEFC950>]}
[0m02:27:18.899626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF432D50>]}
[0m02:27:19.042375 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:27:19.045394 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:27:19.082633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDF8D8D0>]}
[0m02:27:19.083152 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:27:19.083735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF793C70>]}
[0m02:27:19.086292 [info ] [MainThread]: 
[0m02:27:19.086875 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:27:19.087438 [info ] [MainThread]: 
[0m02:27:19.088167 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:27:19.093082 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:27:19.093488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:20.861221 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:27:20.863194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:20.865043 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:27:20.867207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:20.870069 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:27:20.886058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:27:22.944137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF66DF10>]}
[0m02:27:22.944869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:27:22.952890 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m02:27:22.953477 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m02:27:22.954117 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_visitors
[0m02:27:22.954796 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m02:27:22.955436 [info ] [Thread-2 (]: 2 of 3 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m02:27:22.957083 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m02:27:22.957840 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m02:27:22.956213 [info ] [Thread-3 (]: 3 of 3 START sql table model analytics_mart.dim_visitors ....................... [RUN]
[0m02:27:22.958587 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m02:27:22.959163 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m02:27:22.959839 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_visitors'
[0m02:27:22.969090 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m02:27:22.980713 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */


        select 

    datetime_diff(
        cast((select max_d from bounds) as datetime),
        cast((select min_d from bounds) as datetime),
        day
    )

  
[0m02:27:22.981332 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_visitors
[0m02:27:22.982123 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:27:22.985627 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_visitors"
[0m02:27:23.024043 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m02:27:23.044933 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:27:23.045640 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_visitors
[0m02:27:23.048037 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:27:25.002470 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m02:27:25.003449 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_visitors"
[0m02:27:25.008835 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m02:27:25.010340 [debug] [Thread-3 (]: On model.ga_retail_project.dim_visitors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_visitors"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_visitors
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_visitors.sql
WITH visitors AS (
    SELECT
        visitor_id,
        COUNT(DISTINCT visit_id) AS total_sessions,
        COUNT(DISTINCT transaction_id) AS total_transactions
    FROM e2e-dbt-project.analytics_mart.fct_sales_item
    GROUP BY visitor_id
)

SELECT * FROM visitors
    );
  
[0m02:27:25.041311 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c46286bf-7529-4b35-bc23-f0f3e1f29f93&page=queryresults
[0m02:27:25.044359 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c46286bf-7529-4b35-bc23-f0f3e1f29f93&page=queryresults
[0m02:27:25.091669 [debug] [Thread-2 (]: Database Error in model dim_date (models\mart\dim_date.sql)
  Table "bounds" must be qualified with a dataset (e.g. dataset.table).
[0m02:27:25.095360 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCFDA4E10>]}
[0m02:27:25.097068 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model analytics_mart.dim_date .................. [[31mERROR[0m in 2.13s]
[0m02:27:25.098673 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m02:27:25.099558 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models\mart\dim_date.sql)
  Table "bounds" must be qualified with a dataset (e.g. dataset.table)..
[0m02:27:25.614517 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3eb4e6cf-c0b8-4bb5-a764-bd09db849ed9&page=queryresults
[0m02:27:25.832113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e30b451d-4764-41ba-b4da-288ea73053d8&page=queryresults
[0m02:27:28.005214 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DC83F6AD0>]}
[0m02:27:28.006903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '681cb0a2-5ff9-4018-b853-29a07c03166e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD0164DD0>]}
[0m02:27:28.007732 [info ] [Thread-3 (]: 3 of 3 OK created sql table model analytics_mart.dim_visitors .................. [[32mCREATE TABLE (2.3k rows, 1.3 MiB processed)[0m in 5.05s]
[0m02:27:28.009343 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_visitors
[0m02:27:28.008470 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (94.0 rows, 31.0 KiB processed)[0m in 5.05s]
[0m02:27:28.010762 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m02:27:28.012708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:28.014773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:28.015132 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:27:28.015467 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:27:28.015802 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:27:28.016136 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:27:28.016461 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m02:27:28.016787 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m02:27:28.017107 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_visitors' was properly closed.
[0m02:27:28.017576 [info ] [MainThread]: 
[0m02:27:28.018310 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.93 seconds (8.93s).
[0m02:27:28.020420 [debug] [MainThread]: Command end result
[0m02:27:28.061349 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:27:28.064003 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:27:28.072555 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:27:28.072978 [info ] [MainThread]: 
[0m02:27:28.073647 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:27:28.074256 [info ] [MainThread]: 
[0m02:27:28.075000 [error] [MainThread]: [31mFailure in model dim_date (models\mart\dim_date.sql)[0m
[0m02:27:28.075680 [error] [MainThread]:   Database Error in model dim_date (models\mart\dim_date.sql)
  Table "bounds" must be qualified with a dataset (e.g. dataset.table).
[0m02:27:28.076286 [info ] [MainThread]: 
[0m02:27:28.076944 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m02:27:28.078340 [debug] [MainThread]: Command `dbt run` failed at 02:27:28.078191 after 16.50 seconds
[0m02:27:28.078829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DAA47CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA3C88440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCF68FBF0>]}
[0m02:27:28.079303 [debug] [MainThread]: Flushing usage events
[0m02:27:29.206227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:42.376254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F17742F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EF3E9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F27BFD90>]}


============================== 02:29:42.381947 | cd21f688-180e-4185-a7e3-9119fe48d505 ==============================
[0m02:29:42.381947 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:29:42.382767 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_date', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:29:45.650113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1F1ACF950>]}
[0m02:29:45.720065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E196326F10>]}
[0m02:29:45.720715 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:29:46.404550 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:29:46.662550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:29:46.663281 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\dim_date.sql
[0m02:29:47.131519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19637D250>]}
[0m02:29:47.253881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:29:47.256341 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:29:47.290324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1963A57C0>]}
[0m02:29:47.290809 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:29:47.291386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197BC9710>]}
[0m02:29:47.293265 [info ] [MainThread]: 
[0m02:29:47.293814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:29:47.294316 [info ] [MainThread]: 
[0m02:29:47.295020 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:29:47.296194 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:29:47.296564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:49.183548 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:29:49.184648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:49.185926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:29:49.187070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:49.188066 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:29:49.188717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:29:51.443013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197B45570>]}
[0m02:29:51.443747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:29:51.452642 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_date
[0m02:29:51.453493 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m02:29:51.454537 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m02:29:51.455119 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_date
[0m02:29:51.466362 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m02:29:51.468165 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_date
[0m02:29:51.491381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:29:53.405795 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m02:29:53.407285 [debug] [Thread-1 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m02:29:54.123638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:420c6178-efb9-4725-9ed4-cbe408b22cc1&page=queryresults
[0m02:29:56.723464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd21f688-180e-4185-a7e3-9119fe48d505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197BABB90>]}
[0m02:29:56.724284 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (1.0 rows, 25.0 KiB processed)[0m in 5.27s]
[0m02:29:56.725364 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_date
[0m02:29:56.727187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:29:56.729245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:29:56.729963 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:29:56.730472 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:29:56.730880 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:29:56.731233 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:29:56.731591 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m02:29:56.732000 [info ] [MainThread]: 
[0m02:29:56.732588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m02:29:56.733668 [debug] [MainThread]: Command end result
[0m02:29:56.783636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:29:56.788259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:29:56.796400 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:29:56.796870 [info ] [MainThread]: 
[0m02:29:56.797582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:29:56.798236 [info ] [MainThread]: 
[0m02:29:56.798966 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:29:56.800966 [debug] [MainThread]: Command `dbt run` succeeded at 02:29:56.800773 after 14.61 seconds
[0m02:29:56.801812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1978BBE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197D18C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E197D18CD0>]}
[0m02:29:56.802669 [debug] [MainThread]: Flushing usage events
[0m02:29:58.185623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:30:09.480009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188FF4042F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188FD075D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001888052BD90>]}


============================== 02:30:09.486966 | d54849d8-6527-4bc3-91c9-2968b9223be5 ==============================
[0m02:30:09.486966 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:30:09.487884 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select fct_sales_item --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:30:13.241525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188FF763950>]}
[0m02:30:13.313055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A40F6F10>]}
[0m02:30:13.314092 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:30:14.109633 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:30:14.382688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:14.383082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:14.460112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A414D350>]}
[0m02:30:14.618338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:30:14.622694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:30:14.659396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A41757C0>]}
[0m02:30:14.659896 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:30:14.660537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A5689E10>]}
[0m02:30:14.662513 [info ] [MainThread]: 
[0m02:30:14.663095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:30:14.663613 [info ] [MainThread]: 
[0m02:30:14.664324 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:30:14.665329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:30:14.665763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:16.403675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:30:16.405233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:16.406708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:30:16.408920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:16.410382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:30:16.411560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:18.789302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A58486D0>]}
[0m02:30:18.789909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:18.796912 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:30:18.797631 [info ] [Thread-1 (]: 1 of 1 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m02:30:18.798487 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:30:18.798947 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:30:18.821619 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:30:18.823742 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:30:18.884465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:30:20.540005 [debug] [Thread-1 (]: Hard refreshing `e2e-dbt-project`.`analytics_mart`.`fct_sales_item` because it is not replaceable
[0m02:30:20.897154 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:30:20.898952 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_category, product_sku

    
    OPTIONS()
    as (
      

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
),

-- Only keep real transacted items; drop rows that break tests
filtered as (
    select *
    from base
    where transaction_id is not null
      and product_sku    is not null
      and revenue_usd    is not null
      and revenue_local  is not null
      and session_date   is not null
      and coalesce(product_quantity, 0) > 0   -- optional, tighten quality
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from filtered

    );
  
[0m02:30:21.783204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1b277fd6-5e0d-4031-aee8-03f39ed46198&page=queryresults
[0m02:30:24.943787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54849d8-6527-4bc3-91c9-2968b9223be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A586E810>]}
[0m02:30:24.944634 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mCREATE TABLE (185.0 rows, 3.9 MiB processed)[0m in 6.14s]
[0m02:30:24.945691 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:30:24.947305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:30:24.949466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:30:24.949842 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:30:24.950222 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:30:24.950578 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:30:24.950914 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:30:24.951251 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:30:24.951785 [info ] [MainThread]: 
[0m02:30:24.952548 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m02:30:24.954389 [debug] [MainThread]: Command end result
[0m02:30:25.011957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:30:25.014829 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:30:25.024475 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:30:25.024935 [info ] [MainThread]: 
[0m02:30:25.025635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:30:25.026254 [info ] [MainThread]: 
[0m02:30:25.026976 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:30:25.028255 [debug] [MainThread]: Command `dbt run` succeeded at 02:30:25.028119 after 15.71 seconds
[0m02:30:25.028689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A5853800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A58BC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188A58BC910>]}
[0m02:30:25.029128 [debug] [MainThread]: Flushing usage events
[0m02:30:26.154578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:30:40.851661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413CEC42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413AB29D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413DF0FD90>]}


============================== 02:30:40.856744 | 44cb53dd-1951-4415-90e4-73bdadb0f8fa ==============================
[0m02:30:40.856744 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:30:40.857565 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:30:44.442392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44cb53dd-1951-4415-90e4-73bdadb0f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413D223950>]}
[0m02:30:44.514171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44cb53dd-1951-4415-90e4-73bdadb0f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024162942F10>]}
[0m02:30:44.514901 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:30:45.260188 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:30:45.509970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:30:45.510370 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:30:45.587825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44cb53dd-1951-4415-90e4-73bdadb0f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416299D450>]}
[0m02:30:45.728675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:30:45.731214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:30:45.777744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44cb53dd-1951-4415-90e4-73bdadb0f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416317AE40>]}
[0m02:30:45.778303 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:30:45.778872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44cb53dd-1951-4415-90e4-73bdadb0f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024163166B30>]}
[0m02:30:45.782520 [info ] [MainThread]: 
[0m02:30:45.783105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:30:45.783628 [info ] [MainThread]: 
[0m02:30:45.784268 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:30:45.789693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:30:45.790111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:45.820670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:30:45.822248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:45.822889 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:30:45.823245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:30:47.724898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44cb53dd-1951-4415-90e4-73bdadb0f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241631D7C70>]}
[0m02:30:47.726813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:30:47.743853 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:30:47.744650 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:30:47.745372 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:30:47.746865 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:30:47.746159 [info ] [Thread-1 (]: 1 of 33 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m02:30:47.747609 [info ] [Thread-4 (]: 4 of 33 START test not_null_dim_products_product_sku ........................... [RUN]
[0m02:30:47.750416 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m02:30:47.748727 [info ] [Thread-3 (]: 3 of 33 START test not_null_dim_date_dt ........................................ [RUN]
[0m02:30:47.751477 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343'
[0m02:30:47.749538 [info ] [Thread-2 (]: 2 of 33 START test not_null_dim_country_country ................................ [RUN]
[0m02:30:47.752859 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:30:47.754326 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_date_dt.58a291f69b'
[0m02:30:47.755277 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:30:47.756045 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m02:30:47.781973 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:30:47.782551 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:30:47.795914 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:30:47.796490 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:30:47.801854 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m02:30:47.807539 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:30:47.809800 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:30:47.848938 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m02:30:47.849711 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:30:47.852399 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m02:30:47.853127 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:30:47.855918 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:30:47.856696 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:30:47.859217 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:30:47.860356 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m02:30:47.860876 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:30:47.891118 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:30:47.891690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:30:47.892800 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_date_dt.58a291f69b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from e2e-dbt-project.analytics_mart.dim_date
where dt is null



  
  
      
    ) dbt_internal_test
[0m02:30:47.893270 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:30:47.893996 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:30:47.894444 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:30:50.139580 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7eedbeba-f844-4a63-9e3a-467bdf2d5166&page=queryresults
[0m02:30:50.161204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e93dc5f4-43f3-4a4d-b317-d80a317765a1&page=queryresults
[0m02:30:50.229493 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:65805951-5c33-45c7-aa7c-8858b23e96c0&page=queryresults
[0m02:30:50.439291 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fbc954e7-66ca-4050-8026-33249b5f5abc&page=queryresults
[0m02:30:51.165277 [info ] [Thread-4 (]: 4 of 33 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.41s]
[0m02:30:51.174297 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:30:51.181567 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:30:51.179883 [info ] [Thread-2 (]: 2 of 33 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 3.42s]
[0m02:30:51.187611 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:30:51.184123 [info ] [Thread-4 (]: 5 of 33 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m02:30:51.190576 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:30:51.193007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m02:30:51.195663 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:30:51.194518 [info ] [Thread-2 (]: 6 of 33 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m02:30:51.205382 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:30:51.206465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m02:30:51.207532 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:30:51.213828 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:30:51.214742 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:30:51.217588 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:30:51.218435 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:30:51.221829 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:30:51.222764 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:51.223530 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:30:51.259549 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:30:51.260145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:30:51.396985 [info ] [Thread-3 (]: 3 of 33 PASS not_null_dim_date_dt .............................................. [[32mPASS[0m in 3.64s]
[0m02:30:51.400993 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:30:51.403753 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:30:51.405699 [info ] [Thread-3 (]: 7 of 33 START test not_null_fct_sales_item_revenue_local ....................... [RUN]
[0m02:30:51.408394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_dt.58a291f69b, now test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392)
[0m02:30:51.410408 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:30:51.421921 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m02:30:51.424012 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:30:51.428403 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m02:30:51.429772 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_local
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_local is null



  
  
      
    ) dbt_internal_test
[0m02:30:51.430407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:30:51.591475 [info ] [Thread-1 (]: 1 of 33 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.84s]
[0m02:30:51.592513 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m02:30:51.592943 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:30:51.593338 [info ] [Thread-1 (]: 8 of 33 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m02:30:51.593947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m02:30:51.594430 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:30:51.598377 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:30:51.599329 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:30:51.601539 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:30:51.602921 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m02:30:51.604290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:53.574233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a35ff05-7723-48d9-84f2-5fad30457c09&page=queryresults
[0m02:30:53.593548 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78c4ab2d-be70-4951-8b06-d31af5208f41&page=queryresults
[0m02:30:53.703353 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4b1ea0a5-0808-421f-9f2e-72747a80ac83&page=queryresults
[0m02:30:53.803911 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9b00f673-9a09-4185-a5af-88acc0355aa2&page=queryresults
[0m02:30:54.471989 [info ] [Thread-2 (]: 6 of 33 PASS not_null_fct_sales_item_product_sku ............................... [[32mPASS[0m in 3.26s]
[0m02:30:54.475283 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:30:54.477041 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:30:54.478961 [info ] [Thread-2 (]: 9 of 33 START test not_null_fct_sales_item_session_date ........................ [RUN]
[0m02:30:54.481234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m02:30:54.482840 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:30:54.498560 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:30:54.506697 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:30:54.511061 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:30:54.505973 [info ] [Thread-4 (]: 5 of 33 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.31s]
[0m02:30:54.516958 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:30:54.517538 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:30:54.518054 [info ] [Thread-4 (]: 10 of 33 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m02:30:54.523274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m02:30:54.521493 [info ] [Thread-3 (]: 7 of 33 PASS not_null_fct_sales_item_revenue_local ............................. [[32mPASS[0m in 3.11s]
[0m02:30:54.524557 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:30:54.525267 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:30:54.526113 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:30:54.531850 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:30:54.532591 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:30:54.533233 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:30:54.534239 [info ] [Thread-3 (]: 11 of 33 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m02:30:54.569327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m02:30:54.570341 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:30:54.571017 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:30:54.575764 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:30:54.581512 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:30:54.583049 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:54.583611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:30:54.624570 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:30:54.631590 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:30:54.634282 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:30:54.635392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:30:54.794187 [info ] [Thread-1 (]: 8 of 33 PASS not_null_fct_sales_item_revenue_usd ............................... [[32mPASS[0m in 3.20s]
[0m02:30:54.795573 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:30:54.796297 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:30:54.797163 [info ] [Thread-1 (]: 12 of 33 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m02:30:54.798012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m02:30:54.798448 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:30:54.803233 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:30:54.811902 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:30:54.814898 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:30:54.816148 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:54.816626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:30:56.833908 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8102f6f7-ca2c-45f2-85a8-3684cc9251e5&page=queryresults
[0m02:30:56.925340 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:94ad6c9b-8e8b-417b-bd0a-3d2418f6b72f&page=queryresults
[0m02:30:56.955166 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8b7daa39-49e4-40e3-b46d-7638055a2ad9&page=queryresults
[0m02:30:57.165163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9feeaf5a-e4ed-4bbf-84aa-9e603e8cb86d&page=queryresults
[0m02:30:57.771667 [info ] [Thread-2 (]: 9 of 33 PASS not_null_fct_sales_item_session_date .............................. [[32mPASS[0m in 3.29s]
[0m02:30:57.774989 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:30:57.775944 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:30:57.776972 [info ] [Thread-2 (]: 13 of 33 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m02:30:57.778257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m02:30:57.779163 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:30:57.793965 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:30:57.796310 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:30:57.800118 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:30:57.801399 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:30:57.801965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:30:57.867446 [info ] [Thread-4 (]: 10 of 33 PASS not_null_fct_sales_item_transaction_id ........................... [[32mPASS[0m in 3.34s]
[0m02:30:57.868562 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:30:57.869097 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:30:57.869579 [info ] [Thread-4 (]: 14 of 33 START test not_null_product_categories_product_category ............... [RUN]
[0m02:30:57.870356 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m02:30:57.870861 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:30:57.875984 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:30:57.877386 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:30:57.883734 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:30:57.885307 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m02:30:57.886238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:30:58.308073 [info ] [Thread-3 (]: 11 of 33 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 3.74s]
[0m02:30:58.309026 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:30:58.309479 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:30:58.309891 [info ] [Thread-3 (]: 15 of 33 START test not_null_product_categories_product_sku .................... [RUN]
[0m02:30:58.310551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m02:30:58.310969 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:30:58.314937 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:30:58.315868 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:30:58.319133 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:30:58.322647 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:30:58.323162 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:30:58.609150 [info ] [Thread-1 (]: 12 of 33 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 3.81s]
[0m02:30:58.610095 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:30:58.610563 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:30:58.610972 [info ] [Thread-1 (]: 16 of 33 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m02:30:58.611585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m02:30:58.612002 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:30:58.615838 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:30:58.617063 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:30:58.620090 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:30:58.621524 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:30:58.622042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:00.109131 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ebd8fd81-fd24-447f-96d9-f08b42985d5c&page=queryresults
[0m02:31:00.199202 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3d8838a6-1c1d-4b62-b95d-691916866c67&page=queryresults
[0m02:31:00.389590 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:23096fd2-efe9-4225-8e42-c67c4b2ff536&page=queryresults
[0m02:31:00.677359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:481390a5-a2f5-4b31-b9ed-dbe6c9a34771&page=queryresults
[0m02:31:01.061576 [info ] [Thread-4 (]: 14 of 33 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 3.19s]
[0m02:31:01.062682 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:31:01.063220 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:31:01.063726 [info ] [Thread-4 (]: 17 of 33 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m02:31:01.064477 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m02:31:01.064981 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:31:01.070144 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:31:01.071512 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:31:01.075037 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:31:01.076420 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:31:01.077073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:31:01.300563 [info ] [Thread-3 (]: 15 of 33 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 2.99s]
[0m02:31:01.301522 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:31:01.301962 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:31:01.302379 [info ] [Thread-3 (]: 18 of 33 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m02:31:01.303055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m02:31:01.303475 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:31:01.307615 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:31:01.308639 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:31:01.311496 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:31:01.312675 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:01.313306 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:31:02.294252 [info ] [Thread-1 (]: 16 of 33 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 3.68s]
[0m02:31:02.295348 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:31:02.295793 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:31:02.296210 [info ] [Thread-1 (]: 19 of 33 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m02:31:02.296851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m02:31:02.297272 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:31:02.301400 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:31:02.302577 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:31:02.305550 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:31:02.306851 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:31:02.307345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:02.601679 [info ] [Thread-2 (]: 13 of 33 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 4.82s]
[0m02:31:02.603002 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:31:02.603866 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:31:02.604759 [info ] [Thread-2 (]: 20 of 33 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m02:31:02.605663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m02:31:02.606094 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:31:02.610283 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:31:02.611465 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:31:02.614114 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:31:02.615418 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m02:31:02.615955 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:31:03.069570 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d6a6f1de-a50a-44ed-94ab-8793bfbff418&page=queryresults
[0m02:31:03.190346 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ebc2ae6f-0dde-4479-b290-5bbd1e2d81e4&page=queryresults
[0m02:31:04.184275 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:398b6f4f-c237-4da6-8e15-df57dc2064b5&page=queryresults
[0m02:31:04.462071 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8cf69c60-81de-4289-938d-d5fd7bdf07b3&page=queryresults
[0m02:31:04.610755 [info ] [Thread-3 (]: 18 of 33 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 3.31s]
[0m02:31:04.615351 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:31:04.617406 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:31:04.619374 [info ] [Thread-3 (]: 21 of 33 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m02:31:04.628092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m02:31:04.635425 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:31:04.633879 [info ] [Thread-4 (]: 17 of 33 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.57s]
[0m02:31:04.653164 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:31:04.656912 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:31:04.659573 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:31:04.662017 [info ] [Thread-4 (]: 22 of 33 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m02:31:04.664573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m02:31:04.666280 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:31:04.668193 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:31:04.681736 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:31:04.711175 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:31:04.716396 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:31:04.718298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:31:04.801980 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:31:04.806898 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:31:04.809021 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:31:04.809631 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:31:05.346506 [info ] [Thread-2 (]: 20 of 33 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.74s]
[0m02:31:05.347447 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:31:05.347877 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:31:05.348276 [info ] [Thread-2 (]: 23 of 33 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m02:31:05.348911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m02:31:05.349343 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:31:05.353502 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:31:05.354498 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:31:05.357163 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:31:05.358210 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m02:31:05.358852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:31:05.392955 [info ] [Thread-1 (]: 19 of 33 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 3.10s]
[0m02:31:05.394274 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:31:05.395156 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:31:05.396024 [info ] [Thread-1 (]: 24 of 33 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m02:31:05.397077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m02:31:05.397479 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:31:05.401402 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:31:05.403136 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:31:05.405936 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:31:05.407022 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m02:31:05.407478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:06.753613 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:03519218-f01d-4604-85a9-948fe5851cfb&page=queryresults
[0m02:31:06.856724 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:71a27b7f-7e73-4c2b-9ef7-8756add59207&page=queryresults
[0m02:31:07.377164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a26aafe9-b101-4977-b5db-69e14edb65c3&page=queryresults
[0m02:31:07.446319 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8898da05-8350-4a36-8776-e54745eef91a&page=queryresults
[0m02:31:07.715051 [info ] [Thread-3 (]: 21 of 33 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 3.09s]
[0m02:31:07.723404 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:31:07.730241 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m02:31:07.736577 [info ] [Thread-4 (]: 22 of 33 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.07s]
[0m02:31:07.741389 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:31:07.738228 [info ] [Thread-3 (]: 25 of 33 START test stg_hits_products_quality .................................. [RUN]
[0m02:31:07.743802 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:31:07.749731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m02:31:07.754295 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m02:31:07.751757 [info ] [Thread-4 (]: 26 of 33 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m02:31:07.761155 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:31:07.762475 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m02:31:07.765035 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:31:07.769907 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:31:07.773638 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m02:31:07.778346 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:31:07.779276 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:31:07.782162 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:31:07.783704 [debug] [Thread-3 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:31:07.784352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:31:07.784987 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:31:07.785648 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:31:08.327448 [info ] [Thread-2 (]: 23 of 33 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 2.98s]
[0m02:31:08.328406 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:31:08.328852 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:31:08.329278 [info ] [Thread-2 (]: 27 of 33 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m02:31:08.329919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m02:31:08.330357 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:31:08.333080 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:31:08.334381 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:31:08.337068 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:31:08.338463 [debug] [Thread-2 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:31:08.339008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:31:08.397691 [info ] [Thread-1 (]: 24 of 33 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.00s]
[0m02:31:08.398609 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:31:08.399054 [debug] [Thread-1 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m02:31:08.399530 [info ] [Thread-1 (]: 28 of 33 START test test_non_negative_values ................................... [RUN]
[0m02:31:08.400312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m02:31:08.400950 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m02:31:08.548270 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m02:31:08.549641 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m02:31:08.552257 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m02:31:08.553535 [debug] [Thread-1 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:31:08.554057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:09.895979 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4b17a6a7-2a92-4e67-88a0-f6ddf6b0e429&page=queryresults
[0m02:31:10.199740 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3eddbe5e-fba2-4dfc-86e2-3c5275e1f4cd&page=queryresults
[0m02:31:10.630848 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:27aec3fd-5be9-4069-b501-3ce0ca97f57d&page=queryresults
[0m02:31:10.697904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e01df9ab-5fe0-421b-83df-f488eb5d3943&page=queryresults
[0m02:31:11.303294 [info ] [Thread-4 (]: 26 of 33 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 3.54s]
[0m02:31:11.308115 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:31:11.310018 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:31:11.311699 [info ] [Thread-4 (]: 29 of 33 START test unique_dim_country_country ................................. [RUN]
[0m02:31:11.315148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m02:31:11.316997 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:31:11.332257 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:31:11.333925 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:31:11.338063 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:31:11.339515 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:11.340164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:31:11.541279 [info ] [Thread-3 (]: 25 of 33 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 3.79s]
[0m02:31:11.542297 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m02:31:11.542756 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:31:11.543154 [info ] [Thread-3 (]: 30 of 33 START test unique_dim_date_dt ......................................... [RUN]
[0m02:31:11.543815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_dim_date_dt.bbad368071)
[0m02:31:11.544240 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:31:11.548394 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m02:31:11.549725 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:31:11.553126 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m02:31:11.554270 [debug] [Thread-3 (]: On test.ga_retail_project.unique_dim_date_dt.bbad368071: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_dt.bbad368071"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select dt as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where dt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:11.554795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:31:11.650489 [info ] [Thread-1 (]: 28 of 33 PASS test_non_negative_values ......................................... [[32mPASS[0m in 3.25s]
[0m02:31:11.651494 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m02:31:11.651958 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:31:11.652392 [info ] [Thread-1 (]: 31 of 33 START test unique_dim_products_product_sku ............................ [RUN]
[0m02:31:11.653063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m02:31:11.653487 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:31:11.657385 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:31:11.658525 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:31:11.661684 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:31:11.663429 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:11.664372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:31:12.011171 [info ] [Thread-2 (]: 27 of 33 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.68s]
[0m02:31:12.011992 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:31:12.012398 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:31:12.012875 [info ] [Thread-2 (]: 32 of 33 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m02:31:12.013460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_with_fx_local_nonnegative, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m02:31:12.013857 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:31:12.018053 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:31:12.019736 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:31:12.022363 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:31:12.023378 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:12.024022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:31:13.641541 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dc997f37-9cc4-4666-aedc-f939b8ce2dc2&page=queryresults
[0m02:31:13.702756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:75325f89-be56-47cf-843c-67abdf5a459b&page=queryresults
[0m02:31:13.997908 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:962de5a4-b8c7-4ede-9e61-e1ffcd1dfde9&page=queryresults
[0m02:31:14.311237 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c0f9f6b8-8463-42e1-9729-8567aaf42edf&page=queryresults
[0m02:31:14.533789 [info ] [Thread-4 (]: 29 of 33 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 3.22s]
[0m02:31:14.538056 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:31:14.539984 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:31:14.542316 [info ] [Thread-4 (]: 33 of 33 START test unique_product_categories_product_sku ...................... [RUN]
[0m02:31:14.550171 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_country_country.11db8eecec, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m02:31:14.558951 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:31:14.557231 [info ] [Thread-1 (]: 31 of 33 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 2.90s]
[0m02:31:14.578363 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:31:14.580891 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:31:14.596494 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:31:14.604407 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:31:14.609755 [debug] [Thread-4 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:31:14.610943 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:31:14.954894 [info ] [Thread-3 (]: 30 of 33 PASS unique_dim_date_dt ............................................... [[32mPASS[0m in 3.41s]
[0m02:31:14.958409 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:31:15.214702 [info ] [Thread-2 (]: 32 of 33 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 3.20s]
[0m02:31:15.215685 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:31:16.736749 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7d2e49db-395a-45d9-acf0-d4d60cd9b2c9&page=queryresults
[0m02:31:17.620751 [info ] [Thread-4 (]: 33 of 33 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 3.07s]
[0m02:31:17.624514 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:31:17.629406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:31:17.634360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:31:17.635517 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:31:17.636792 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:31:17.637674 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:31:17.638546 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m02:31:17.639414 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m02:31:17.640291 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_date_dt.bbad368071' was properly closed.
[0m02:31:17.641157 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m02:31:17.642192 [info ] [MainThread]: 
[0m02:31:17.643519 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 31.86 seconds (31.86s).
[0m02:31:17.655377 [debug] [MainThread]: Command end result
[0m02:31:17.699636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:31:17.702712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:31:17.712985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:31:17.713401 [info ] [MainThread]: 
[0m02:31:17.714032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:31:17.714644 [info ] [MainThread]: 
[0m02:31:17.715264 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m02:31:17.716606 [debug] [MainThread]: Command `dbt test` succeeded at 02:31:17.716454 after 37.01 seconds
[0m02:31:17.717016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002413DEC07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241635A6A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241635A4E10>]}
[0m02:31:17.717429 [debug] [MainThread]: Flushing usage events
[0m02:31:19.087197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:38:00.873850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265E9A242F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265E7699D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265EAA6FD90>]}


============================== 01:38:00.879745 | 1efcedc9-b06a-4396-b511-dbac4f51d2cc ==============================
[0m01:38:00.879745 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:38:00.881140 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:38:04.601306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265E9D83950>]}
[0m01:38:04.661563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658E526F10>]}
[0m01:38:04.662169 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:38:05.413480 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:38:06.819422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:38:06.819762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:38:06.881324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658E57D350>]}
[0m01:38:06.997305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:38:07.019377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:38:07.099809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658E5A57C0>]}
[0m01:38:07.100235 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:38:07.100743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FAC5E10>]}
[0m01:38:07.102809 [info ] [MainThread]: 
[0m01:38:07.103304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:38:07.103763 [info ] [MainThread]: 
[0m01:38:07.104578 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:38:07.108786 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:38:07.109104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:07.109825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:38:07.110130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:07.164029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:38:07.164706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:09.348900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:38:09.349253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:09.349984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:38:09.350309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:09.376043 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:38:09.376751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:38:11.110693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FC79B20>]}
[0m01:38:11.111129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:38:11.127124 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:38:11.127615 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:38:11.128285 [info ] [Thread-1 (]: 1 of 9 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:38:11.129717 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:38:11.130065 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:38:11.136868 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:38:11.129030 [info ] [Thread-2 (]: 2 of 9 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:38:11.137986 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:38:11.138711 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:38:11.142061 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:38:11.143424 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:38:11.175298 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:38:11.176270 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:38:11.179129 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:38:11.179976 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:38:11.180879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:38:11.183331 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:38:11.208543 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:38:12.948979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c7dbe7ea-0470-4f4f-8650-4c10679a81b9&page=queryresults
[0m01:38:12.979086 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8b517e9b-5710-4884-8fcf-aa7f1a944886&page=queryresults
[0m01:38:15.344503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FC977D0>]}
[0m01:38:15.345467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FCFDFF0>]}
[0m01:38:15.345092 [info ] [Thread-1 (]: 1 of 9 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 4.21s]
[0m01:38:15.346274 [info ] [Thread-2 (]: 2 of 9 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 4.21s]
[0m01:38:15.347139 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:38:15.347726 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:38:15.348529 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m01:38:15.349792 [debug] [Thread-4 (]: Began running node model.ga_retail_project.dim_date
[0m01:38:15.350597 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:38:15.349307 [info ] [Thread-3 (]: 3 of 9 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m01:38:15.351621 [info ] [Thread-4 (]: 4 of 9 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m01:38:15.353241 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m01:38:15.352235 [info ] [Thread-1 (]: 5 of 9 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:38:15.354312 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m01:38:15.354909 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m01:38:15.355556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_hits_products, now model.ga_retail_project.stg_sessions_with_fx)
[0m01:38:15.356313 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.dim_date
[0m01:38:15.359228 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m01:38:15.359688 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:38:15.362676 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m01:38:15.367571 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:38:15.369542 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:38:15.372660 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:38:15.373220 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m01:38:15.373707 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.dim_date
[0m01:38:15.393926 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:38:15.396772 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:38:15.448266 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as with base as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:38:15.448764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:17.118983 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m01:38:17.120164 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_products.sql
WITH products AS (
    SELECT
        product_sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(product_category) AS product_category
    FROM e2e-dbt-project.analytics_stg.stg_hits_products
    WHERE product_sku IS NOT NULL
    GROUP BY product_sku
)

SELECT * FROM products
    );
  
[0m01:38:17.133402 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m01:38:17.134688 [debug] [Thread-4 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m01:38:17.283602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cbda9dd8-86f0-4f6c-b1c4-a7e30d6f1ccd&page=queryresults
[0m01:38:17.753865 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e7b2aee3-518b-4f07-9591-11a9c569378a&page=queryresults
[0m01:38:17.796210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659031A2B0>]}
[0m01:38:17.796775 [info ] [Thread-1 (]: 5 of 9 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.44s]
[0m01:38:17.797533 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:38:17.798151 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_country
[0m01:38:17.798914 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:38:17.798568 [info ] [Thread-2 (]: 6 of 9 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m01:38:17.799892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.dim_country)
[0m01:38:17.800218 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_country
[0m01:38:17.802599 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m01:38:17.799443 [info ] [Thread-1 (]: 7 of 9 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:38:17.803456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions_with_fx, now model.ga_retail_project.int_sessions_enriched)
[0m01:38:17.804067 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:38:17.808469 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:38:17.809258 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_country
[0m01:38:17.820844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:38:17.846533 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:38:17.850957 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:38:17.852820 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

with sessions as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),

hits as (
    select *
    from e2e-dbt-project.analytics_stg.stg_hits_products
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m01:38:17.853619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:18.233479 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3bfe9962-8877-4330-bbc4-00932f996ab2&page=queryresults
[0m01:38:19.415784 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m01:38:19.416933 [debug] [Thread-2 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m01:38:19.775815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:29b86382-cfe2-4d88-a478-4b8a2801fd66&page=queryresults
[0m01:38:19.797668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026590328250>]}
[0m01:38:19.798218 [info ] [Thread-3 (]: 3 of 9 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (435.0 rows, 3.3 MiB processed)[0m in 4.44s]
[0m01:38:19.799147 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m01:38:20.196380 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:81f6d57f-c6d0-4517-8921-af567283d182&page=queryresults
[0m01:38:20.289929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FD8E660>]}
[0m01:38:20.293470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002658FD070B0>]}
[0m01:38:20.290496 [info ] [Thread-1 (]: 7 of 9 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.49s]
[0m01:38:20.294606 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:38:20.293963 [info ] [Thread-4 (]: 4 of 9 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (1.0 rows, 25.0 KiB processed)[0m in 4.94s]
[0m01:38:20.295631 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.dim_date
[0m01:38:20.296099 [debug] [Thread-3 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:38:20.296538 [info ] [Thread-3 (]: 8 of 9 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m01:38:20.297101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_products, now model.ga_retail_project.fct_sales_item)
[0m01:38:20.297630 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:38:20.307516 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:38:20.308530 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:38:20.349919 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:38:21.703028 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:38:21.704555 [debug] [Thread-3 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_category, product_sku

    
    OPTIONS()
    as (
      

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
),

-- Only keep real transacted items; drop rows that break tests
filtered as (
    select *
    from base
    where transaction_id is not null
      and product_sku    is not null
      and revenue_usd    is not null
      and revenue_local  is not null
      and session_date   is not null
      and coalesce(product_quantity, 0) > 0   -- optional, tighten quality
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from filtered

    );
  
[0m01:38:22.387457 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a98e484e-9bb7-4f38-9c2c-7364224b830d&page=queryresults
[0m01:38:22.570625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659033E630>]}
[0m01:38:22.571224 [info ] [Thread-2 (]: 6 of 9 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (94.0 rows, 31.0 KiB processed)[0m in 4.77s]
[0m01:38:22.572036 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_country
[0m01:38:25.594038 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659033DC10>]}
[0m01:38:25.594579 [info ] [Thread-3 (]: 8 of 9 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mCREATE TABLE (185.0 rows, 3.9 MiB processed)[0m in 5.30s]
[0m01:38:25.595511 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:38:25.596217 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_visitors
[0m01:38:25.596615 [info ] [Thread-1 (]: 9 of 9 START sql table model analytics_mart.dim_visitors ....................... [RUN]
[0m01:38:25.597319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.int_sessions_enriched, now model.ga_retail_project.dim_visitors)
[0m01:38:25.597643 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_visitors
[0m01:38:25.600216 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_visitors"
[0m01:38:25.609913 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_visitors
[0m01:38:25.612535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:38:26.963884 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_visitors"
[0m01:38:26.964893 [debug] [Thread-1 (]: On model.ga_retail_project.dim_visitors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_visitors"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_visitors
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_visitors.sql
WITH visitors AS (
    SELECT
        visitor_id,
        COUNT(DISTINCT visit_id) AS total_sessions,
        COUNT(DISTINCT transaction_id) AS total_transactions
    FROM e2e-dbt-project.analytics_mart.fct_sales_item
    GROUP BY visitor_id
)

SELECT * FROM visitors
    );
  
[0m01:38:27.453558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2b013932-240b-4321-be09-2487c7a7b666&page=queryresults
[0m01:38:29.838728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1efcedc9-b06a-4396-b511-dbac4f51d2cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659049FBF0>]}
[0m01:38:29.839275 [info ] [Thread-1 (]: 9 of 9 OK created sql table model analytics_mart.dim_visitors .................. [[32mCREATE TABLE (41.0 rows, 8.3 KiB processed)[0m in 4.24s]
[0m01:38:29.840228 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_visitors
[0m01:38:29.842125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:38:29.843577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:38:29.843845 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:38:29.844097 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:38:29.844344 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:38:29.844587 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:38:29.844846 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:38:29.845165 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:38:29.845415 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_visitors' was properly closed.
[0m01:38:29.845657 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m01:38:29.845900 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:38:29.846142 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m01:38:29.855176 [info ] [MainThread]: 
[0m01:38:29.855913 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 4 view models in 0 hours 0 minutes and 22.74 seconds (22.74s).
[0m01:38:29.860115 [debug] [MainThread]: Command end result
[0m01:38:29.893356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:38:29.895628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:38:29.903402 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:38:29.903772 [info ] [MainThread]: 
[0m01:38:29.904324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:38:29.904832 [info ] [MainThread]: 
[0m01:38:29.905336 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m01:38:29.906437 [debug] [MainThread]: Command `dbt run` succeeded at 01:38:29.906326 after 29.23 seconds
[0m01:38:29.906804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659033F8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659049CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002659049D2B0>]}
[0m01:38:29.907163 [debug] [MainThread]: Flushing usage events
[0m01:38:31.457280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:34.202080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018590B542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001858E7EDD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018591B9FD90>]}


============================== 01:39:34.206218 | 9bd60511-2137-4b3c-b81b-503ee3971960 ==============================
[0m01:39:34.206218 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:34.206883 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:39:37.025020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018590EAF950>]}
[0m01:39:37.084641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B5626F10>]}
[0m01:39:37.085237 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:39:37.699827 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:39:37.905881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:39:37.906222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:39:37.967410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B567D350>]}
[0m01:39:38.081300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:39:38.083444 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:39:38.112293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B56A57C0>]}
[0m01:39:38.112718 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:39:38.113230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6BB9E10>]}
[0m01:39:38.115271 [info ] [MainThread]: 
[0m01:39:38.115796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:39:38.116230 [info ] [MainThread]: 
[0m01:39:38.116846 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:39:38.121441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:39:38.122309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:38.122901 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:39:38.123839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:38.124574 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:39:38.125175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:39.982964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:39:39.983347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:40.013216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:39:40.013597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:40.015066 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:39:40.015462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:41.731257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6D797E0>]}
[0m01:39:41.731689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:39:41.737853 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:39:41.738785 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:39:41.738333 [info ] [Thread-1 (]: 1 of 9 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:39:41.740241 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:39:41.740601 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:39:41.747309 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:39:41.739576 [info ] [Thread-2 (]: 2 of 9 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:39:41.748050 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:39:41.748395 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:39:41.750308 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:39:41.751593 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:39:41.761917 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:39:41.795069 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:39:41.796378 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:39:41.797813 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:39:41.798659 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:39:41.799974 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:39:41.800766 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:39:43.620106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8528afb7-54b2-4243-b7cc-87fe622622ce&page=queryresults
[0m01:39:43.650064 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cb0cdb67-def6-4e5f-aeb2-a6139ae7bd6a&page=queryresults
[0m01:39:44.209751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6D9EF90>]}
[0m01:39:44.210707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6DF5FF0>]}
[0m01:39:44.210392 [info ] [Thread-1 (]: 1 of 9 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m01:39:44.211925 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:39:44.212691 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m01:39:44.211263 [info ] [Thread-2 (]: 2 of 9 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.46s]
[0m01:39:44.213778 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:39:44.214721 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:39:44.213120 [info ] [Thread-3 (]: 3 of 9 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m01:39:44.215709 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m01:39:44.216050 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m01:39:44.218278 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m01:39:44.218697 [debug] [Thread-4 (]: Began running node model.ga_retail_project.dim_date
[0m01:39:44.215180 [info ] [Thread-1 (]: 5 of 9 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:39:44.219982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_hits_products, now model.ga_retail_project.stg_sessions_with_fx)
[0m01:39:44.220735 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:39:44.225478 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:39:44.219108 [info ] [Thread-4 (]: 4 of 9 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m01:39:44.226600 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m01:39:44.227000 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.dim_date
[0m01:39:44.229347 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m01:39:44.229761 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m01:39:44.240876 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:39:44.268662 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:39:44.271442 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:39:44.272379 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.dim_date
[0m01:39:44.276644 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:39:44.279984 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as with base as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:39:44.304295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:46.000381 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m01:39:46.001737 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m01:39:46.002603 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_products.sql
WITH products AS (
    SELECT
        product_sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(product_category) AS product_category
    FROM e2e-dbt-project.analytics_stg.stg_hits_products
    WHERE product_sku IS NOT NULL
    GROUP BY product_sku
)

SELECT * FROM products
    );
  
[0m01:39:46.003594 [debug] [Thread-4 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m01:39:46.192999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cf04f6be-35b1-4c55-a1c7-a062f8fd9050&page=queryresults
[0m01:39:46.583184 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:053d0550-e566-47cc-957d-d77034b32a17&page=queryresults
[0m01:39:46.686415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6E6E5D0>]}
[0m01:39:46.686969 [info ] [Thread-1 (]: 5 of 9 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m01:39:46.688015 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:39:46.688677 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_country
[0m01:39:46.689535 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:39:46.689105 [info ] [Thread-2 (]: 6 of 9 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m01:39:46.690546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.dim_country)
[0m01:39:46.690894 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_country
[0m01:39:46.693685 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m01:39:46.690090 [info ] [Thread-1 (]: 7 of 9 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:39:46.694599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions_with_fx, now model.ga_retail_project.int_sessions_enriched)
[0m01:39:46.695134 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:39:46.699022 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:39:46.700155 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_country
[0m01:39:46.703035 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:39:46.729182 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:39:46.733591 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:39:46.735164 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

with sessions as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),

hits as (
    select *
    from e2e-dbt-project.analytics_stg.stg_hits_products
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m01:39:46.735606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:47.022975 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:878f56cd-b1f3-406b-a7a6-3fdf3a3e341c&page=queryresults
[0m01:39:48.255505 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m01:39:48.256906 [debug] [Thread-2 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m01:39:48.584472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a73b3cd-1c16-4fe2-9262-22e815acc8c7&page=queryresults
[0m01:39:48.927929 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B74306D0>]}
[0m01:39:48.928479 [info ] [Thread-4 (]: 4 of 9 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (1.0 rows, 25.0 KiB processed)[0m in 4.70s]
[0m01:39:48.929425 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.dim_date
[0m01:39:48.976097 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2f9fa2ac-5298-4aa7-9d9c-52271b120962&page=queryresults
[0m01:39:49.108892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6E6A900>]}
[0m01:39:49.109449 [info ] [Thread-1 (]: 7 of 9 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m01:39:49.110218 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:39:49.110898 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:39:49.111323 [info ] [Thread-4 (]: 8 of 9 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m01:39:49.111897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_date, now model.ga_retail_project.fct_sales_item)
[0m01:39:49.112245 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:39:49.120680 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:39:49.121560 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:39:49.161909 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:39:49.166784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B6E05850>]}
[0m01:39:49.167970 [info ] [Thread-3 (]: 3 of 9 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (435.0 rows, 3.3 MiB processed)[0m in 4.95s]
[0m01:39:49.195004 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m01:39:50.592967 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:39:50.595152 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into e2e-dbt-project.analytics_mart.fct_sales_item as DBT_INTERNAL_DEST
        using (

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
),

-- Only keep real transacted items; drop rows that break tests
filtered as (
    select *
    from base
    where transaction_id is not null
      and product_sku    is not null
      and revenue_usd    is not null
      and revenue_local  is not null
      and session_date   is not null
      and coalesce(product_quantity, 0) > 0   -- optional, tighten quality
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from filtered

where session_date >
  (select coalesce(max(session_date), date('1970-01-01')) from e2e-dbt-project.analytics_mart.fct_sales_item)

        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_id = DBT_INTERNAL_DEST.transaction_id
                ) and (
                    DBT_INTERNAL_SOURCE.product_sku = DBT_INTERNAL_DEST.product_sku
                ) and (
                    DBT_INTERNAL_SOURCE.visit_id = DBT_INTERNAL_DEST.visit_id
                )

    
    when matched then update set
        `session_date` = DBT_INTERNAL_SOURCE.`session_date`,`visitor_id` = DBT_INTERNAL_SOURCE.`visitor_id`,`visit_id` = DBT_INTERNAL_SOURCE.`visit_id`,`country` = DBT_INTERNAL_SOURCE.`country`,`traffic_source` = DBT_INTERNAL_SOURCE.`traffic_source`,`traffic_medium` = DBT_INTERNAL_SOURCE.`traffic_medium`,`traffic_campaign` = DBT_INTERNAL_SOURCE.`traffic_campaign`,`transaction_id` = DBT_INTERNAL_SOURCE.`transaction_id`,`product_sku` = DBT_INTERNAL_SOURCE.`product_sku`,`product_name` = DBT_INTERNAL_SOURCE.`product_name`,`product_category` = DBT_INTERNAL_SOURCE.`product_category`,`product_quantity` = DBT_INTERNAL_SOURCE.`product_quantity`,`product_price_usd` = DBT_INTERNAL_SOURCE.`product_price_usd`,`revenue_usd` = DBT_INTERNAL_SOURCE.`revenue_usd`,`revenue_local` = DBT_INTERNAL_SOURCE.`revenue_local`
    

    when not matched then insert
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)
    values
        (`session_date`, `visitor_id`, `visit_id`, `country`, `traffic_source`, `traffic_medium`, `traffic_campaign`, `transaction_id`, `product_sku`, `product_name`, `product_category`, `product_quantity`, `product_price_usd`, `revenue_usd`, `revenue_local`)


    
[0m01:39:51.090223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B7443290>]}
[0m01:39:51.090788 [info ] [Thread-2 (]: 6 of 9 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (94.0 rows, 31.0 KiB processed)[0m in 4.40s]
[0m01:39:51.091682 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_country
[0m01:39:51.338308 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c5a35254-ec26-401a-bf12-60cad4342cd2&page=queryresults
[0m01:39:53.943954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B759CD10>]}
[0m01:39:53.944502 [info ] [Thread-4 (]: 8 of 9 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mMERGE (0.0 rows, 3.9 MiB processed)[0m in 4.83s]
[0m01:39:53.945298 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:39:53.946042 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_visitors
[0m01:39:53.946484 [info ] [Thread-1 (]: 9 of 9 START sql table model analytics_mart.dim_visitors ....................... [RUN]
[0m01:39:53.947264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.int_sessions_enriched, now model.ga_retail_project.dim_visitors)
[0m01:39:53.947594 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_visitors
[0m01:39:53.950320 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_visitors"
[0m01:39:53.951156 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_visitors
[0m01:39:53.953031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:55.331988 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_visitors"
[0m01:39:55.332913 [debug] [Thread-1 (]: On model.ga_retail_project.dim_visitors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_visitors"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_visitors
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_visitors.sql
WITH visitors AS (
    SELECT
        visitor_id,
        COUNT(DISTINCT visit_id) AS total_sessions,
        COUNT(DISTINCT transaction_id) AS total_transactions
    FROM e2e-dbt-project.analytics_mart.fct_sales_item
    GROUP BY visitor_id
)

SELECT * FROM visitors
    );
  
[0m01:39:55.772086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:507fc95f-4b3b-44fa-882d-0644fdf0c32b&page=queryresults
[0m01:39:57.836559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd60511-2137-4b3c-b81b-503ee3971960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B759E450>]}
[0m01:39:57.837120 [info ] [Thread-1 (]: 9 of 9 OK created sql table model analytics_mart.dim_visitors .................. [[32mCREATE TABLE (41.0 rows, 8.3 KiB processed)[0m in 3.89s]
[0m01:39:57.837962 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_visitors
[0m01:39:57.839737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:39:57.841144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:57.841415 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:39:57.841666 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:39:57.841913 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:39:57.842160 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:39:57.842404 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:39:57.842650 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:39:57.842935 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_visitors' was properly closed.
[0m01:39:57.843181 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m01:39:57.843425 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m01:39:57.843668 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:39:57.844003 [info ] [MainThread]: 
[0m01:39:57.844489 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 4 view models in 0 hours 0 minutes and 19.73 seconds (19.73s).
[0m01:39:57.847723 [debug] [MainThread]: Command end result
[0m01:39:57.879452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:39:57.882189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:39:57.889694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:39:57.890070 [info ] [MainThread]: 
[0m01:39:57.890612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:57.891126 [info ] [MainThread]: 
[0m01:39:57.891658 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m01:39:57.892762 [debug] [MainThread]: Command `dbt run` succeeded at 01:39:57.892650 after 23.86 seconds
[0m01:39:57.893165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B75D3A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B75D3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185B75D3890>]}
[0m01:39:57.893507 [debug] [MainThread]: Flushing usage events
[0m01:40:00.085752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:09.580697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6DAD42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6B739D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6EB1BD90>]}


============================== 01:40:09.584936 | 4ebcc368-4bd7-4e0a-9fe2-9759eee238b4 ==============================
[0m01:40:09.584936 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:40:09.585558 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:40:12.530492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ebcc368-4bd7-4e0a-9fe2-9759eee238b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6DE33950>]}
[0m01:40:12.589644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ebcc368-4bd7-4e0a-9fe2-9759eee238b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E12622F10>]}
[0m01:40:12.590416 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:40:13.244399 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:40:13.460415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:40:13.460752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:40:13.523485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ebcc368-4bd7-4e0a-9fe2-9759eee238b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1267D450>]}
[0m01:40:13.644235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:40:13.646421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:40:13.700476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ebcc368-4bd7-4e0a-9fe2-9759eee238b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13E26E40>]}
[0m01:40:13.700963 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:40:13.701480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ebcc368-4bd7-4e0a-9fe2-9759eee238b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13E16B30>]}
[0m01:40:13.704398 [info ] [MainThread]: 
[0m01:40:13.704897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:40:13.705381 [info ] [MainThread]: 
[0m01:40:13.706019 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:13.710380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:40:13.710700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:13.736307 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:40:13.736693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:13.761771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:40:13.762138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:15.545053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ebcc368-4bd7-4e0a-9fe2-9759eee238b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13E87C70>]}
[0m01:40:15.545483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:15.550685 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:40:15.551208 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m01:40:15.551838 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m01:40:15.552194 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m01:40:15.552547 [info ] [Thread-1 (]: 1 of 33 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m01:40:15.552994 [info ] [Thread-2 (]: 2 of 33 START test not_null_dim_country_country ................................ [RUN]
[0m01:40:15.554771 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m01:40:15.555378 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m01:40:15.553526 [info ] [Thread-3 (]: 3 of 33 START test not_null_dim_date_dt ........................................ [RUN]
[0m01:40:15.556038 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:40:15.556481 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m01:40:15.557073 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_date_dt.58a291f69b'
[0m01:40:15.553953 [info ] [Thread-4 (]: 4 of 33 START test not_null_dim_products_product_sku ........................... [RUN]
[0m01:40:15.593604 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m01:40:15.579954 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:40:15.594557 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m01:40:15.595269 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343'
[0m01:40:15.601321 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m01:40:15.601865 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m01:40:15.606128 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m01:40:15.606660 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:40:15.607280 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m01:40:15.627759 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:40:15.629885 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m01:40:15.630731 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m01:40:15.631250 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m01:40:15.634005 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m01:40:15.635847 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m01:40:15.636249 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m01:40:15.637114 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m01:40:15.637789 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:15.638408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:40:15.638949 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m01:40:15.639763 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_date_dt.58a291f69b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from e2e-dbt-project.analytics_mart.dim_date
where dt is null



  
  
      
    ) dbt_internal_test
[0m01:40:15.640285 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:40:15.665705 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:40:17.804947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7f6fc042-2eac-4284-893a-8ba31cb0957d&page=queryresults
[0m01:40:17.954888 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fd0d0033-9b7b-4499-ad7b-22a2a1e5d582&page=queryresults
[0m01:40:17.965142 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:59e3a207-3d73-4d4e-80f9-3776d2380f65&page=queryresults
[0m01:40:17.974631 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:851da80d-c4f5-4ee0-8715-b65d03e4d1ae&page=queryresults
[0m01:40:18.820469 [info ] [Thread-2 (]: 2 of 33 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 3.27s]
[0m01:40:18.821320 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m01:40:18.821678 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m01:40:18.822105 [info ] [Thread-2 (]: 5 of 33 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m01:40:18.822673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m01:40:18.822996 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m01:40:18.826680 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m01:40:18.836494 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m01:40:18.838933 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m01:40:18.840233 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:40:18.841184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:18.888769 [info ] [Thread-4 (]: 4 of 33 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.29s]
[0m01:40:18.890919 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m01:40:18.891564 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m01:40:18.892189 [info ] [Thread-4 (]: 6 of 33 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m01:40:18.894685 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m01:40:18.895074 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m01:40:18.894049 [info ] [Thread-3 (]: 3 of 33 PASS not_null_dim_date_dt .............................................. [[32mPASS[0m in 3.34s]
[0m01:40:18.900184 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m01:40:18.901523 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m01:40:18.902261 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m01:40:18.902840 [info ] [Thread-3 (]: 7 of 33 START test not_null_fct_sales_item_revenue_local ....................... [RUN]
[0m01:40:18.903615 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_dt.58a291f69b, now test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392)
[0m01:40:18.904107 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m01:40:18.904431 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m01:40:18.906843 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m01:40:18.909923 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m01:40:18.911025 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m01:40:18.911644 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:18.912329 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m01:40:18.914978 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m01:40:18.944150 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_local
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_local is null



  
  
      
    ) dbt_internal_test
[0m01:40:18.944990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:19.128851 [info ] [Thread-1 (]: 1 of 33 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.57s]
[0m01:40:19.129829 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:40:19.130219 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m01:40:19.130951 [info ] [Thread-1 (]: 8 of 33 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m01:40:19.131786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m01:40:19.132505 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m01:40:19.137139 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m01:40:19.146827 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m01:40:19.150017 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m01:40:19.151867 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m01:40:19.152729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:21.079241 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fef2b4ba-493b-4032-a4ca-e6b2a3550209&page=queryresults
[0m01:40:21.079983 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a6d821c7-5568-48d7-8c4f-39116d6aaece&page=queryresults
[0m01:40:21.087263 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0d5ded58-2e8c-4398-a1c7-6458efd6fb30&page=queryresults
[0m01:40:21.417471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3d6e1618-9e15-46ca-a902-96005cc09119&page=queryresults
[0m01:40:21.830860 [info ] [Thread-2 (]: 5 of 33 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.01s]
[0m01:40:21.832017 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m01:40:21.832574 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m01:40:21.833030 [info ] [Thread-2 (]: 9 of 33 START test not_null_fct_sales_item_session_date ........................ [RUN]
[0m01:40:21.833646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m01:40:21.833997 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m01:40:21.837340 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m01:40:21.848097 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m01:40:21.850782 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m01:40:21.854533 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:40:21.854078 [info ] [Thread-4 (]: 6 of 33 PASS not_null_fct_sales_item_product_sku ............................... [[32mPASS[0m in 2.96s]
[0m01:40:21.855104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:21.855651 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m01:40:21.856385 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m01:40:21.857660 [info ] [Thread-4 (]: 10 of 33 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m01:40:21.886642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m01:40:21.888355 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m01:40:21.894721 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m01:40:21.896670 [info ] [Thread-3 (]: 7 of 33 PASS not_null_fct_sales_item_revenue_local ............................. [[32mPASS[0m in 2.99s]
[0m01:40:21.897804 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m01:40:21.898628 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:40:21.901500 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m01:40:21.909543 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m01:40:21.899518 [info ] [Thread-3 (]: 11 of 33 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m01:40:21.912979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m01:40:21.914120 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:40:21.922674 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m01:40:21.929092 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:40:21.934822 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m01:40:21.936439 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m01:40:21.937272 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:21.938452 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:40:21.941268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:22.201464 [info ] [Thread-1 (]: 8 of 33 PASS not_null_fct_sales_item_revenue_usd ............................... [[32mPASS[0m in 3.07s]
[0m01:40:22.202639 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m01:40:22.203419 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:40:22.204146 [info ] [Thread-1 (]: 12 of 33 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m01:40:22.204795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m01:40:22.205143 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:40:22.208574 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m01:40:22.209899 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:40:22.214776 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m01:40:22.216322 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:40:22.217100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:24.022711 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7c8193a1-3df4-4f37-a899-5f034f74de63&page=queryresults
[0m01:40:24.260565 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7ae86915-c685-4ceb-a65e-97d314eef43d&page=queryresults
[0m01:40:24.332003 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c73f342-07ec-4507-bec8-e43ccc59d5b2&page=queryresults
[0m01:40:24.772632 [info ] [Thread-2 (]: 9 of 33 PASS not_null_fct_sales_item_session_date .............................. [[32mPASS[0m in 2.94s]
[0m01:40:24.773482 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m01:40:24.773880 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:40:24.774339 [info ] [Thread-2 (]: 13 of 33 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m01:40:24.774961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m01:40:24.775325 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:40:24.778707 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m01:40:24.779612 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:40:24.782678 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m01:40:24.784097 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:40:24.784772 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:24.921181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:93b602da-379d-4f1d-b7ae-0f874a7de410&page=queryresults
[0m01:40:25.075594 [info ] [Thread-4 (]: 10 of 33 PASS not_null_fct_sales_item_transaction_id ........................... [[32mPASS[0m in 3.19s]
[0m01:40:25.076680 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m01:40:25.077055 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m01:40:25.077519 [info ] [Thread-4 (]: 14 of 33 START test not_null_product_categories_product_category ............... [RUN]
[0m01:40:25.078057 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m01:40:25.078405 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m01:40:25.081784 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m01:40:25.082766 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m01:40:25.087437 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m01:40:25.088852 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m01:40:25.089725 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:25.486534 [info ] [Thread-3 (]: 11 of 33 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 3.57s]
[0m01:40:25.488126 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:40:25.488564 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m01:40:25.488995 [info ] [Thread-3 (]: 15 of 33 START test not_null_product_categories_product_sku .................... [RUN]
[0m01:40:25.489785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m01:40:25.490205 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m01:40:25.493614 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m01:40:25.494881 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m01:40:25.499463 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m01:40:25.500724 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m01:40:25.501541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:26.357132 [info ] [Thread-1 (]: 12 of 33 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 4.15s]
[0m01:40:26.358302 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:40:26.358720 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m01:40:26.359176 [info ] [Thread-1 (]: 16 of 33 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m01:40:26.359723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m01:40:26.360066 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m01:40:26.363373 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m01:40:26.364550 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m01:40:26.368480 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m01:40:26.369881 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m01:40:26.370704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:27.032815 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:29cf83b5-09fb-451c-b9cf-25d5863c0183&page=queryresults
[0m01:40:27.042635 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:62a2e81e-beb2-40a5-ab8f-2c60b304b846&page=queryresults
[0m01:40:27.673919 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:11632a13-2596-4a54-aa14-8c758ce66677&page=queryresults
[0m01:40:27.798437 [info ] [Thread-4 (]: 14 of 33 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 2.72s]
[0m01:40:27.799812 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m01:40:27.800439 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:40:27.801045 [info ] [Thread-4 (]: 17 of 33 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m01:40:27.802342 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m01:40:27.802809 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:40:27.806232 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:40:27.808170 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:40:27.812766 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:40:27.814261 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:40:27.815350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:28.184437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8606330d-9ac6-44ce-a954-f3a04af0685e&page=queryresults
[0m01:40:28.469265 [info ] [Thread-3 (]: 15 of 33 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 2.98s]
[0m01:40:28.470365 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m01:40:28.470747 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:40:28.471183 [info ] [Thread-3 (]: 18 of 33 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m01:40:28.471893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m01:40:28.472632 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:40:28.480430 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:40:28.490591 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:40:28.496182 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:40:28.497973 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:40:28.498852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:28.543630 [info ] [Thread-2 (]: 13 of 33 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 3.77s]
[0m01:40:28.544601 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:40:28.545066 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:40:28.545486 [info ] [Thread-2 (]: 19 of 33 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m01:40:28.546109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m01:40:28.546456 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:40:28.550529 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:40:28.551380 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:40:28.553283 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:40:28.554573 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:40:28.555411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:29.439887 [info ] [Thread-1 (]: 16 of 33 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 3.08s]
[0m01:40:29.440979 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m01:40:29.441355 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m01:40:29.441787 [info ] [Thread-1 (]: 20 of 33 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m01:40:29.442364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m01:40:29.442703 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m01:40:29.446169 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m01:40:29.447653 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m01:40:29.450854 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m01:40:29.451946 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m01:40:29.452458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:29.595347 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bac49307-78ab-4ed8-b8e2-4836dd3770db&page=queryresults
[0m01:40:30.436522 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bcf0cd3f-b33d-4808-b5f0-c238a04459cd&page=queryresults
[0m01:40:30.446098 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:10c65cde-194d-4871-a18a-99f6f1abc60a&page=queryresults
[0m01:40:30.809398 [info ] [Thread-4 (]: 17 of 33 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.01s]
[0m01:40:30.810278 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:40:30.810686 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m01:40:30.811070 [info ] [Thread-4 (]: 21 of 33 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m01:40:30.811653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m01:40:30.812030 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m01:40:30.815998 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m01:40:30.816924 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m01:40:30.819491 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m01:40:30.820391 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m01:40:30.820812 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:31.378682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d2537015-320a-4058-807a-dad5f43a6bde&page=queryresults
[0m01:40:31.619908 [info ] [Thread-3 (]: 18 of 33 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 3.15s]
[0m01:40:31.620776 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:40:31.621172 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m01:40:31.621545 [info ] [Thread-3 (]: 22 of 33 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m01:40:31.622121 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m01:40:31.622486 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m01:40:31.626004 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m01:40:31.626891 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m01:40:31.629319 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m01:40:31.630561 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m01:40:31.631152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:31.679534 [info ] [Thread-2 (]: 19 of 33 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 3.13s]
[0m01:40:31.680431 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:40:31.681099 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m01:40:31.681609 [info ] [Thread-2 (]: 23 of 33 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m01:40:31.682339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m01:40:31.682721 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m01:40:31.687423 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m01:40:31.688313 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m01:40:31.691087 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m01:40:31.691992 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m01:40:31.692399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:32.170177 [info ] [Thread-1 (]: 20 of 33 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.73s]
[0m01:40:32.171039 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m01:40:32.171425 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m01:40:32.171787 [info ] [Thread-1 (]: 24 of 33 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m01:40:32.172357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m01:40:32.172718 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m01:40:32.176198 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m01:40:32.177049 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m01:40:32.180161 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m01:40:32.182139 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m01:40:32.182666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:32.768934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:124a9d1c-b717-4ac5-9bfb-6b63166d0204&page=queryresults
[0m01:40:33.492381 [info ] [Thread-4 (]: 21 of 33 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.68s]
[0m01:40:33.493239 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m01:40:33.493648 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m01:40:33.494020 [info ] [Thread-4 (]: 25 of 33 START test stg_hits_products_quality .................................. [RUN]
[0m01:40:33.494592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m01:40:33.494962 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m01:40:33.497810 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m01:40:33.507508 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m01:40:33.510113 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m01:40:33.512223 [debug] [Thread-4 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m01:40:33.512846 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:33.709223 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:814c83be-d9af-42f4-9f53-8f45c1170728&page=queryresults
[0m01:40:33.950717 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:db46acbe-0f2a-41ef-9628-8af440707164&page=queryresults
[0m01:40:34.081100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5a52ca82-4ddb-4380-b1fe-fac13e84d250&page=queryresults
[0m01:40:34.443238 [info ] [Thread-3 (]: 22 of 33 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 2.82s]
[0m01:40:34.445041 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m01:40:34.445457 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m01:40:34.445846 [info ] [Thread-3 (]: 26 of 33 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m01:40:34.447350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m01:40:34.447978 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m01:40:34.453354 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m01:40:34.454511 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m01:40:34.456517 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m01:40:34.457655 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m01:40:34.458259 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:34.702662 [info ] [Thread-2 (]: 23 of 33 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.02s]
[0m01:40:34.703499 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m01:40:34.703869 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m01:40:34.704207 [info ] [Thread-2 (]: 27 of 33 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m01:40:34.704766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m01:40:34.705130 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m01:40:34.707422 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m01:40:34.708627 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m01:40:34.710560 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m01:40:34.712623 [debug] [Thread-2 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m01:40:34.713371 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:34.863335 [info ] [Thread-1 (]: 24 of 33 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 2.69s]
[0m01:40:34.864278 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m01:40:34.864830 [debug] [Thread-1 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m01:40:34.865187 [info ] [Thread-1 (]: 28 of 33 START test test_non_negative_values ................................... [RUN]
[0m01:40:34.865867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m01:40:34.866626 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m01:40:35.022952 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m01:40:35.024640 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m01:40:35.029723 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m01:40:35.031225 [debug] [Thread-1 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m01:40:35.031670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:35.111220 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e25b1d35-e651-46d4-a308-c83b94fa8b23&page=queryresults
[0m01:40:36.211649 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a1a1c690-62cb-4bfc-b676-a96363f6c3b2&page=queryresults
[0m01:40:36.425085 [info ] [Thread-4 (]: 25 of 33 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 2.93s]
[0m01:40:36.425927 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m01:40:36.426313 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m01:40:36.426675 [info ] [Thread-4 (]: 29 of 33 START test unique_dim_country_country ................................. [RUN]
[0m01:40:36.427235 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m01:40:36.427592 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m01:40:36.432975 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m01:40:36.442211 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m01:40:36.445115 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m01:40:36.446602 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:40:36.447104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:36.832579 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7a7a0a18-fda6-43c9-9dc5-b84e6b81b840&page=queryresults
[0m01:40:36.942475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2c983646-350e-48ca-82f8-a28b9b3e3efa&page=queryresults
[0m01:40:37.415994 [info ] [Thread-3 (]: 26 of 33 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 2.97s]
[0m01:40:37.416878 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m01:40:37.417276 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m01:40:37.417623 [info ] [Thread-3 (]: 30 of 33 START test unique_dim_date_dt ......................................... [RUN]
[0m01:40:37.418198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_dim_date_dt.bbad368071)
[0m01:40:37.418564 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m01:40:37.421987 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m01:40:37.423100 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m01:40:37.425628 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m01:40:37.426433 [debug] [Thread-3 (]: On test.ga_retail_project.unique_dim_date_dt.bbad368071: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_dt.bbad368071"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select dt as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where dt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:40:37.426830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:40:37.825907 [info ] [Thread-1 (]: 28 of 33 PASS test_non_negative_values ......................................... [[32mPASS[0m in 2.96s]
[0m01:40:37.826770 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m01:40:37.827167 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m01:40:37.827532 [info ] [Thread-1 (]: 31 of 33 START test unique_dim_products_product_sku ............................ [RUN]
[0m01:40:37.828058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m01:40:37.828421 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m01:40:37.832125 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m01:40:37.841360 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m01:40:37.843913 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m01:40:37.844934 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:40:37.845376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:38.056515 [info ] [Thread-2 (]: 27 of 33 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 3.35s]
[0m01:40:38.057405 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m01:40:38.057818 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m01:40:38.058196 [info ] [Thread-2 (]: 32 of 33 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m01:40:38.058742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_with_fx_local_nonnegative, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m01:40:38.059121 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m01:40:38.062668 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m01:40:38.071953 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m01:40:38.074209 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m01:40:38.075468 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:40:38.075909 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:38.153852 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:89d136a6-0ad9-4c8f-b08f-4312b2155fd0&page=queryresults
[0m01:40:38.927015 [info ] [Thread-4 (]: 29 of 33 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 2.50s]
[0m01:40:38.927894 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m01:40:38.928267 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m01:40:38.928616 [info ] [Thread-4 (]: 33 of 33 START test unique_product_categories_product_sku ...................... [RUN]
[0m01:40:38.929182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_country_country.11db8eecec, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m01:40:38.929558 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m01:40:38.933771 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m01:40:38.934753 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m01:40:38.937257 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m01:40:38.946415 [debug] [Thread-4 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:40:38.947252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:40:39.265591 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6e6518cd-e8f4-4e40-b32f-16cdd163e4d3&page=queryresults
[0m01:40:39.795339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d2f8439-0ab2-4cd3-ad53-cc30866a9616&page=queryresults
[0m01:40:40.038383 [info ] [Thread-3 (]: 30 of 33 PASS unique_dim_date_dt ............................................... [[32mPASS[0m in 2.62s]
[0m01:40:40.039559 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m01:40:40.096383 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:debeb287-a7d8-4551-93b9-3ab03151166c&page=queryresults
[0m01:40:40.528943 [info ] [Thread-1 (]: 31 of 33 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 2.70s]
[0m01:40:40.530066 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m01:40:40.777057 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8477c16c-56c6-4259-a6b1-e3bee059ac63&page=queryresults
[0m01:40:40.859430 [info ] [Thread-2 (]: 32 of 33 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 2.80s]
[0m01:40:40.860268 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m01:40:41.670968 [info ] [Thread-4 (]: 33 of 33 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 2.74s]
[0m01:40:41.671954 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m01:40:41.674195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:41.675667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:41.675949 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:40:41.676215 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:40:41.676480 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:40:41.676740 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m01:40:41.677027 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m01:40:41.677288 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_date_dt.bbad368071' was properly closed.
[0m01:40:41.677544 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m01:40:41.677856 [info ] [MainThread]: 
[0m01:40:41.678327 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 27.97 seconds (27.97s).
[0m01:40:41.684211 [debug] [MainThread]: Command end result
[0m01:40:41.716788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:40:41.719419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:40:41.727033 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:40:41.727386 [info ] [MainThread]: 
[0m01:40:41.727931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:40:41.728439 [info ] [MainThread]: 
[0m01:40:41.728941 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m01:40:41.730074 [debug] [MainThread]: Command `dbt test` succeeded at 01:40:41.729962 after 32.28 seconds
[0m01:40:41.730436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6EAD07D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13F149F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13F16780>]}
[0m01:40:41.730837 [debug] [MainThread]: Flushing usage events
[0m01:40:42.761006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:57:41.822926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026309CB42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263078D9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630ACFFD90>]}


============================== 01:57:41.827116 | 77b9ffde-6264-4e59-9197-c2fe61835b8b ==============================
[0m01:57:41.827116 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:57:41.827805 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products --vars {ga_start: 20170801, ga_end: 20170831}', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:57:44.705766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630A00F950>]}
[0m01:57:44.765488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002632E766F10>]}
[0m01:57:44.766081 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:57:45.403441 [debug] [MainThread]: checksum: 1e90f719968ab3cc5d4a1b3cead01d0522bcc14be0784e871139563265874820, vars: {'ga_end': 20170831, 'ga_start': 20170801}, profile: , target: , version: 1.10.9
[0m01:57:45.525338 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:57:45.525924 [debug] [MainThread]: previous checksum: 1e90f719968ab3cc5d4a1b3cead01d0522bcc14be0784e871139563265874820, current checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23
[0m01:57:45.526219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002632FD8DB50>]}
[0m01:57:47.547919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002632FFBB890>]}
[0m01:57:47.661016 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:57:47.663771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:57:47.694471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002632FF55D30>]}
[0m01:57:47.694916 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:57:47.695433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026330223930>]}
[0m01:57:47.697319 [info ] [MainThread]: 
[0m01:57:47.697798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:57:47.698270 [info ] [MainThread]: 
[0m01:57:47.698881 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:57:47.702541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:57:47.702866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:49.224237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:57:49.224605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:49.249384 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:57:49.249780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:49.250588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:57:49.250886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:50.975585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026330202BD0>]}
[0m01:57:50.976207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:50.982805 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:57:50.983758 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:57:50.983322 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:57:50.985195 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:57:50.985602 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:57:50.992517 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:57:50.984506 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:57:50.993255 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:57:50.993602 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:57:50.998051 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:57:50.998968 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:57:50.999363 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:57:51.032642 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:57:51.035322 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:57:51.037999 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  where _TABLE_SUFFIX between 20170801 and 20170831
)

select *
from src;


[0m01:57:51.039219 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:57:51.040399 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between 20170801 and 20170831
    and p.productSKU is not null
)

select *
from base;


[0m01:57:51.041266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:57:52.944309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ee407cfa-83d2-4feb-95f9-4f473e13f86e&page=queryresults
[0m01:57:53.023981 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6bcd5a30-8ba2-4cdc-a190-693068a041bb&page=queryresults
[0m01:57:53.204692 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ee407cfa-83d2-4feb-95f9-4f473e13f86e&page=queryresults
[0m01:57:53.284764 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6bcd5a30-8ba2-4cdc-a190-693068a041bb&page=queryresults
[0m01:57:53.317201 [debug] [Thread-1 (]: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  No matching signature for operator BETWEEN
    Argument types: STRING, INT64, INT64
    Signature: (T1) BETWEEN (T1) AND (T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [32:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:57:53.322501 [debug] [Thread-2 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  No matching signature for operator BETWEEN
    Argument types: STRING, INT64, INT64
    Signature: (T1) BETWEEN (T1) AND (T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [26:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:57:53.323287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263302AB6A0>]}
[0m01:57:53.324238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77b9ffde-6264-4e59-9197-c2fe61835b8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026309FF0230>]}
[0m01:57:53.323909 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model analytics_stg.stg_hits_products ........... [[31mERROR[0m in 2.33s]
[0m01:57:53.325480 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:57:53.326090 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_hits_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  No matching signature for operator BETWEEN
    Argument types: STRING, INT64, INT64
    Signature: (T1) BETWEEN (T1) AND (T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [32:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql.
[0m01:57:53.324798 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model analytics_stg.stg_sessions ................ [[31mERROR[0m in 2.33s]
[0m01:57:53.327393 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:57:53.328000 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  No matching signature for operator BETWEEN
    Argument types: STRING, INT64, INT64
    Signature: (T1) BETWEEN (T1) AND (T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [26:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m01:57:53.329375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:57:53.330972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:57:53.331258 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:57:53.331525 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:57:53.331788 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:57:53.332052 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:57:53.332312 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:57:53.332571 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:57:53.332913 [info ] [MainThread]: 
[0m01:57:53.333391 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m01:57:53.334384 [debug] [MainThread]: Command end result
[0m01:57:53.368333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:57:53.371741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:57:53.377461 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:57:53.377784 [info ] [MainThread]: 
[0m01:57:53.378325 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:57:53.378787 [info ] [MainThread]: 
[0m01:57:53.379424 [error] [MainThread]: [31mFailure in model stg_hits_products (models\staging\stg_hits_products.sql)[0m
[0m01:57:53.380020 [error] [MainThread]:   Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  No matching signature for operator BETWEEN
    Argument types: STRING, INT64, INT64
    Signature: (T1) BETWEEN (T1) AND (T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [32:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:57:53.380549 [info ] [MainThread]: 
[0m01:57:53.381032 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:57:53.381443 [info ] [MainThread]: 
[0m01:57:53.381904 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m01:57:53.382422 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  No matching signature for operator BETWEEN
    Argument types: STRING, INT64, INT64
    Signature: (T1) BETWEEN (T1) AND (T1)
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [26:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:57:53.382910 [info ] [MainThread]: 
[0m01:57:53.383408 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m01:57:53.383871 [info ] [MainThread]: 
[0m01:57:53.384370 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m01:57:53.385530 [debug] [MainThread]: Command `dbt run` failed at 01:57:53.385417 after 11.74 seconds
[0m01:57:53.385925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026330081B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263301D6AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630AD4CFA0>]}
[0m01:57:53.386323 [debug] [MainThread]: Flushing usage events
[0m01:57:55.417228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:45.710225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA8B042F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA6765D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA9B4BD90>]}


============================== 02:00:45.714489 | 08f9c13d-e103-449d-bd30-95d1514b149c ==============================
[0m02:00:45.714489 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:00:45.715216 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products --vars {ga_start: 20170801, ga_end: 20170831}', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m02:00:48.674092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBA8E63950>]}
[0m02:00:48.732744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCD5B6F10>]}
[0m02:00:48.733332 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:00:49.381741 [debug] [MainThread]: checksum: 1e90f719968ab3cc5d4a1b3cead01d0522bcc14be0784e871139563265874820, vars: {'ga_end': 20170831, 'ga_start': 20170801}, profile: , target: , version: 1.10.9
[0m02:00:49.621910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:00:49.622575 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m02:00:49.622974 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m02:00:50.083015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCEC06250>]}
[0m02:00:50.200719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:00:50.202969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:00:50.233531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCD6517C0>]}
[0m02:00:50.233952 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:00:50.234465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCED57E70>]}
[0m02:00:50.236308 [info ] [MainThread]: 
[0m02:00:50.236801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:00:50.237258 [info ] [MainThread]: 
[0m02:00:50.237874 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:00:50.241598 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:00:50.241915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:51.838964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:00:51.839345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:51.864841 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:00:51.865221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:51.866856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:00:51.867430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:53.553012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCEDE1570>]}
[0m02:00:53.553459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:00:53.559665 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:00:53.560612 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:00:53.560203 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:00:53.561661 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:00:53.562014 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:00:53.570846 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:00:53.561091 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:00:53.571892 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:00:53.572272 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:00:53.575970 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:00:53.577842 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:00:53.586559 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:00:53.615697 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:00:53.617466 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:00:53.619901 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
where _TABLE_SUFFIX between '20170801' 
                        and '20170831'
    and p.productSKU is not null
)

select *
from base;


[0m02:00:53.620688 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:00:53.621496 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170801' 
                        and '20170831'
)

select *
from src;


[0m02:00:53.622299 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:00:55.448440 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d3d8feef-25ee-4f78-97a1-319f17c6f371&page=queryresults
[0m02:00:55.448976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84fdc333-8e3e-4070-abd7-b6e8e13cf3b2&page=queryresults
[0m02:00:56.042191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCED5BE90>]}
[0m02:00:56.043117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f9c13d-e103-449d-bd30-95d1514b149c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCF0371D0>]}
[0m02:00:56.042805 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m02:00:56.044350 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:00:56.043692 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.48s]
[0m02:00:56.045218 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:00:56.046784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:00:56.048249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:56.048518 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:00:56.048768 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:00:56.049012 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:00:56.049255 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:00:56.049495 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:00:56.049738 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:00:56.050043 [info ] [MainThread]: 
[0m02:00:56.050522 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m02:00:56.052541 [debug] [MainThread]: Command end result
[0m02:00:56.090732 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:00:56.092985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:00:56.098270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:00:56.098574 [info ] [MainThread]: 
[0m02:00:56.099101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:56.099601 [info ] [MainThread]: 
[0m02:00:56.100103 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m02:00:56.101207 [debug] [MainThread]: Command `dbt run` succeeded at 02:00:56.101098 after 10.57 seconds
[0m02:00:56.101570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCEF76B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCEFA2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCF032FD0>]}
[0m02:00:56.101931 [debug] [MainThread]: Flushing usage events
[0m02:00:58.330193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:12.561069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A7BA42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A583DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A8BEFD90>]}


============================== 02:04:12.565257 | 29a30d52-14bc-4e91-861b-f61105ab6c53 ==============================
[0m02:04:12.565257 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:04:12.565922 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:04:15.395724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A7F03950>]}
[0m02:04:15.457195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CC65AF10>]}
[0m02:04:15.457813 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:04:16.095157 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:04:16.228162 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:04:16.228729 [debug] [MainThread]: previous checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, current checksum: 1e90f719968ab3cc5d4a1b3cead01d0522bcc14be0784e871139563265874820
[0m02:04:16.229016 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:04:16.229602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CDCA1B50>]}
[0m02:04:18.257158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CDEAB890>]}
[0m02:04:18.363457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:18.365583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:18.395485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CDE45D30>]}
[0m02:04:18.395912 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:04:18.396399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CE113930>]}
[0m02:04:18.398233 [info ] [MainThread]: 
[0m02:04:18.398732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:04:18.399175 [info ] [MainThread]: 
[0m02:04:18.399755 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:18.404176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:18.404993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:19.926430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:04:19.926801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:19.951906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:04:19.952491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:19.953662 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:04:19.954004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:21.658895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CE0F2BD0>]}
[0m02:04:21.659350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:21.665708 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:04:21.666637 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:04:21.666243 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:04:21.667685 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:04:21.668036 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:04:21.675878 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:04:21.667110 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:04:21.676623 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:04:21.676975 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:04:21.679893 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:04:21.680843 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:04:21.712313 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:04:21.713397 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:04:21.715956 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:04:21.716875 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
where _TABLE_SUFFIX between '20170801'
                          and '20170831'
  and p.productSKU is not null

)

select *
from base;


[0m02:04:21.717331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:21.717782 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170801'
                          and '20170831'
)

select *
from src;


[0m02:04:21.718222 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:04:23.527539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a02df96c-fe38-4708-8a2d-a0715ef1cb9f&page=queryresults
[0m02:04:23.546491 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e79efc76-0558-4217-9163-da2a30bfd998&page=queryresults
[0m02:04:24.152850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CE19BB70>]}
[0m02:04:24.153764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29a30d52-14bc-4e91-861b-f61105ab6c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A7EE0230>]}
[0m02:04:24.153453 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m02:04:24.155161 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:04:24.154526 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.48s]
[0m02:04:24.155977 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:04:24.157983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:24.159367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:24.159637 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:04:24.159891 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:04:24.160139 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:04:24.160385 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:04:24.160629 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:04:24.160871 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:04:24.161176 [info ] [MainThread]: 
[0m02:04:24.161616 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m02:04:24.162549 [debug] [MainThread]: Command end result
[0m02:04:24.202536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:24.205334 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:24.212021 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:04:24.212362 [info ] [MainThread]: 
[0m02:04:24.212882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:24.213339 [info ] [MainThread]: 
[0m02:04:24.213861 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m02:04:24.214939 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:24.214831 after 11.83 seconds
[0m02:04:24.215300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CE79FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3CD81AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A8C3CFA0>]}
[0m02:04:24.215654 [debug] [MainThread]: Flushing usage events
[0m02:04:25.608406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:03.735944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5774742F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5750D9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5784BFD90>]}


============================== 02:05:03.740581 | ee681987-e8ff-4728-8c87-0b73638870aa ==============================
[0m02:05:03.740581 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:05:03.741260 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:05:06.608582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5777D3950>]}
[0m02:05:06.669799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D046F10>]}
[0m02:05:06.670418 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:05:07.349580 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:05:07.574158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:05:07.574502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:05:07.639695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D09D350>]}
[0m02:05:07.761388 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:05:07.763631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:05:07.793134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D0DD7C0>]}
[0m02:05:07.793560 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:05:07.794087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D6083D0>]}
[0m02:05:07.795847 [info ] [MainThread]: 
[0m02:05:07.796318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:05:07.796766 [info ] [MainThread]: 
[0m02:05:07.797356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:05:07.801579 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:05:07.802229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:09.457703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:05:09.458062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:09.482633 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:05:09.483001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:09.484170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:05:09.484552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:11.168167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D7C9230>]}
[0m02:05:11.168581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:05:11.175193 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:05:11.175648 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:05:11.176162 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:05:11.177682 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:05:11.176781 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:05:11.178242 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:05:11.178734 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:05:11.187352 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:05:11.188194 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:05:11.192092 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:05:11.193940 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:05:11.221318 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:05:11.222794 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:05:11.225287 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:05:11.226948 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170801'
                          and '20170831'
)

select *
from src;


[0m02:05:11.227445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:05:11.227945 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
where _TABLE_SUFFIX between '20170801'
                          and '20170831'
  and p.productSKU is not null

)

select *
from base;


[0m02:05:11.228389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:05:13.006983 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f9eca7f3-9dd6-495e-9153-668835eddfb0&page=queryresults
[0m02:05:13.027017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a888a617-c753-4bd7-8b1d-5b9d17d61674&page=queryresults
[0m02:05:13.615602 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D7EF7D0>]}
[0m02:05:13.616373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee681987-e8ff-4728-8c87-0b73638870aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D845A70>]}
[0m02:05:13.617476 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m02:05:13.619778 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:05:13.618508 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m02:05:13.621161 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:05:13.623179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:13.626141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:13.626742 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:05:13.627277 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:05:13.627807 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:05:13.628348 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:05:13.628865 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:05:13.629427 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:05:13.630168 [info ] [MainThread]: 
[0m02:05:13.630900 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m02:05:13.633027 [debug] [MainThread]: Command end result
[0m02:05:13.687067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:05:13.690301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:05:13.696188 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:05:13.696524 [info ] [MainThread]: 
[0m02:05:13.697051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:05:13.697562 [info ] [MainThread]: 
[0m02:05:13.698075 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m02:05:13.699174 [debug] [MainThread]: Command `dbt run` succeeded at 02:05:13.699065 after 10.09 seconds
[0m02:05:13.699524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D833B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D8899A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51D8954D0>]}
[0m02:05:13.699877 [debug] [MainThread]: Flushing usage events
[0m02:05:14.778324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:12:55.603077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC4FD942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC4DA1DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC50DDFD90>]}


============================== 02:12:55.607330 | 7993a830-21f7-4f10-8fb5-dcaac2780c30 ==============================
[0m02:12:55.607330 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:12:55.608002 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh --select stg_sessions stg_hits_products', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:12:58.464435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC500F7950>]}
[0m02:12:58.525076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC75816F10>]}
[0m02:12:58.525711 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:12:59.172822 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:12:59.407989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:12:59.408625 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m02:12:59.409033 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m02:12:59.878192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC75E6E250>]}
[0m02:12:59.993113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:12:59.995251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:13:00.032751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC758AD7C0>]}
[0m02:13:00.033228 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:13:00.033915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC75FE7E70>]}
[0m02:13:00.035873 [info ] [MainThread]: 
[0m02:13:00.036485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:13:00.037077 [info ] [MainThread]: 
[0m02:13:00.037855 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:13:00.041502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:13:00.041823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:01.650708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:13:01.651068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:01.651737 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:13:01.652084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:01.678302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:13:01.678665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:03.362866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC76079300>]}
[0m02:13:03.363294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:13:03.369705 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:13:03.370142 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:13:03.370645 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:13:03.372374 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:13:03.371364 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:13:03.372939 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:13:03.373541 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:13:03.381068 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:13:03.381560 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:13:03.384623 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:13:03.386369 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:13:03.387370 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:13:03.430420 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:13:03.431628 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:13:03.433500 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
where cast(_TABLE_SUFFIX as string) between '20170801'
                                        and '20170831'
  and p.productSKU is not null

)

select *
from base;


[0m02:13:03.434047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:13:03.434555 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where cast(_TABLE_SUFFIX as string) between '20170801'
                                        and '20170831'
)

select *
from src;


[0m02:13:03.434989 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:13:05.221498 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fe88a0ca-0741-48a4-a29f-b0c35c1c225b&page=queryresults
[0m02:13:05.261625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1d871e0b-a4aa-480a-bb9c-d14f5e9553b2&page=queryresults
[0m02:13:05.856198 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC760D7C50>]}
[0m02:13:05.857125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7993a830-21f7-4f10-8fb5-dcaac2780c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC762B1E90>]}
[0m02:13:05.856812 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.48s]
[0m02:13:05.858353 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:13:05.857704 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.48s]
[0m02:13:05.859214 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:13:05.860818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:13:05.862271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:13:05.862540 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:13:05.862788 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:13:05.863031 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:13:05.863272 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:13:05.863515 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:13:05.863754 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:13:05.864059 [info ] [MainThread]: 
[0m02:13:05.864541 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m02:13:05.866123 [debug] [MainThread]: Command end result
[0m02:13:05.899102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:13:05.901279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:13:05.906470 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:13:05.907020 [info ] [MainThread]: 
[0m02:13:05.907690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:13:05.908306 [info ] [MainThread]: 
[0m02:13:05.908950 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m02:13:05.910068 [debug] [MainThread]: Command `dbt run` succeeded at 02:13:05.909957 after 10.48 seconds
[0m02:13:05.910423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC76283390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC7624ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC7619E850>]}
[0m02:13:05.910820 [debug] [MainThread]: Flushing usage events
[0m02:13:07.864193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:17:44.346713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3D5D42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3B249D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3E61FD90>]}


============================== 02:17:44.350915 | da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9 ==============================
[0m02:17:44.350915 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:17:44.351609 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_sessions --vars {ga_start: 20170101, ga_end: 20170131}', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:17:47.424263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3D933950>]}
[0m02:17:47.486293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63066F10>]}
[0m02:17:47.486913 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:17:48.169394 [debug] [MainThread]: checksum: 7235c250eb29f62156f3f3a6efd7566c745a27709de29ceb554aee3045f70690, vars: {'ga_end': 20170131, 'ga_start': 20170101}, profile: , target: , version: 1.10.9
[0m02:17:48.315748 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:17:48.316373 [debug] [MainThread]: previous checksum: 7235c250eb29f62156f3f3a6efd7566c745a27709de29ceb554aee3045f70690, current checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23
[0m02:17:48.316704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD636EDB50>]}
[0m02:17:50.382850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD638EB890>]}
[0m02:17:50.495506 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:17:50.497762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:17:50.530867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63885D30>]}
[0m02:17:50.531588 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:17:50.532270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63B53930>]}
[0m02:17:50.534589 [info ] [MainThread]: 
[0m02:17:50.535250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:17:50.535738 [info ] [MainThread]: 
[0m02:17:50.536344 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:17:50.537445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:17:50.537765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:52.055283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:17:52.055646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:52.082519 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:17:52.083580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:17:52.084222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:52.084826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:53.854433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63B32D50>]}
[0m02:17:53.854893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:17:53.861870 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:17:53.862433 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:17:53.863368 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:17:53.863740 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:17:53.870907 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:17:53.871972 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:17:53.904529 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:17:53.906078 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where cast(_TABLE_SUFFIX as string) between '20170101'
                                        and '20170131'
)

select *
from src;


[0m02:17:53.908525 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:17:55.582896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ffafcbad-acef-4225-8cc4-594994376d72&page=queryresults
[0m02:17:56.202015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da8fab5f-f00c-4f10-99ea-a1cb30b7ffa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63BDB490>]}
[0m02:17:56.202648 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m02:17:56.203519 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:17:56.205124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:17:56.206651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:56.207141 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:17:56.207424 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:17:56.207797 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:17:56.208065 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:17:56.208313 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:17:56.208602 [info ] [MainThread]: 
[0m02:17:56.209051 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m02:17:56.210287 [debug] [MainThread]: Command end result
[0m02:17:56.247232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:17:56.249402 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:17:56.254921 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:17:56.255251 [info ] [MainThread]: 
[0m02:17:56.255881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:17:56.256286 [info ] [MainThread]: 
[0m02:17:56.256735 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:17:56.257688 [debug] [MainThread]: Command `dbt run` succeeded at 02:17:56.257586 after 12.10 seconds
[0m02:17:56.258279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63C294F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD63B27920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3DF59A50>]}
[0m02:17:56.258610 [debug] [MainThread]: Flushing usage events
[0m02:17:58.365966 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:33.074062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BF2342F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BCEA9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C027FD90>]}


============================== 11:57:33.080357 | bf1ff727-0e00-499a-9ac0-a027e2ac52c7 ==============================
[0m11:57:33.080357 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:57:33.081181 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_hits_products', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:57:37.046564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198BF593950>]}
[0m11:57:37.119288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E4CC6F10>]}
[0m11:57:37.119990 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:57:37.846421 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:57:38.014034 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:57:38.014723 [debug] [MainThread]: previous checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, current checksum: 7235c250eb29f62156f3f3a6efd7566c745a27709de29ceb554aee3045f70690
[0m11:57:38.015056 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:57:38.015598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E534DB50>]}
[0m11:57:40.246691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E554B890>]}
[0m11:57:40.370841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m11:57:40.382242 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m11:57:40.430216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E54DA270>]}
[0m11:57:40.430716 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m11:57:40.431306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E5833930>]}
[0m11:57:40.433223 [info ] [MainThread]: 
[0m11:57:40.433774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:40.434313 [info ] [MainThread]: 
[0m11:57:40.435044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:57:40.436160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m11:57:40.436524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:42.148261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m11:57:42.149644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:42.151012 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m11:57:42.152553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:42.153768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m11:57:42.154499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:44.087215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E5796C90>]}
[0m11:57:44.087840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:44.104612 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m11:57:44.105309 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m11:57:44.106234 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m11:57:44.106717 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m11:57:44.117273 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m11:57:44.118506 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m11:57:44.155657 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m11:57:44.157073 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
where _TABLE_SUFFIX between '20160101'
                        and '20170831'
  and p.productSKU is not null

)

select *
from base;


[0m11:57:44.157672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:57:46.058046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b2ff7728-4ccf-43df-86f9-88a2fe13012c&page=queryresults
[0m11:57:46.823369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1ff727-0e00-499a-9ac0-a027e2ac52c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E58EB330>]}
[0m11:57:46.824158 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.72s]
[0m11:57:46.825063 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m11:57:46.826813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:46.829437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:46.829813 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m11:57:46.830148 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m11:57:46.830451 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m11:57:46.830753 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m11:57:46.831052 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m11:57:46.831401 [info ] [MainThread]: 
[0m11:57:46.831997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m11:57:46.833293 [debug] [MainThread]: Command end result
[0m11:57:46.873994 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m11:57:46.876662 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m11:57:46.883215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m11:57:46.883604 [info ] [MainThread]: 
[0m11:57:46.884372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:46.885123 [info ] [MainThread]: 
[0m11:57:46.885799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:57:46.887234 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:46.887098 after 14.03 seconds
[0m11:57:46.887691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E5885130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E57B7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198E5543BD0>]}
[0m11:57:46.888237 [debug] [MainThread]: Flushing usage events
[0m11:57:48.419551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:16.203902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E1DB642F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E1B7E5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E1EBAFD90>]}


============================== 11:58:16.209229 | 41129cbd-0b25-46f0-91c9-55e6195790dc ==============================
[0m11:58:16.209229 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:58:16.210077 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m11:58:19.495423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E1DEC3950>]}
[0m11:58:19.561263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E435F6F10>]}
[0m11:58:19.561886 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:58:20.217779 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m11:58:20.462865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:58:20.463227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:58:20.531100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E4364D350>]}
[0m11:58:20.663757 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m11:58:20.666162 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m11:58:20.701342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E4368D7C0>]}
[0m11:58:20.701868 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m11:58:20.702443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43BB83D0>]}
[0m11:58:20.704358 [info ] [MainThread]: 
[0m11:58:20.704953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:20.705523 [info ] [MainThread]: 
[0m11:58:20.706241 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:58:20.707451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m11:58:20.707825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:22.455596 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m11:58:22.456434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:22.457527 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m11:58:22.458014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:22.491058 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m11:58:22.491507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:24.844422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43DDF860>]}
[0m11:58:24.846674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:24.860127 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m11:58:24.861158 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m11:58:24.862697 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m11:58:24.863802 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m11:58:24.885169 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m11:58:24.886969 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m11:58:24.930551 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m11:58:24.931874 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20160101'
                        and '20170831'
)

select *
from src;


[0m11:58:24.932530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:26.776878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a9506660-57bb-40b1-a3e3-d30c24fd3c17&page=queryresults
[0m11:58:27.457661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41129cbd-0b25-46f0-91c9-55e6195790dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43D9ED50>]}
[0m11:58:27.458486 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m11:58:27.459488 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m11:58:27.461118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:27.463092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:27.463483 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m11:58:27.463806 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m11:58:27.464124 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m11:58:27.464439 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m11:58:27.464751 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m11:58:27.465108 [info ] [MainThread]: 
[0m11:58:27.465690 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m11:58:27.466674 [debug] [MainThread]: Command end result
[0m11:58:27.508960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m11:58:27.511642 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m11:58:27.518525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m11:58:27.518930 [info ] [MainThread]: 
[0m11:58:27.519582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:27.520159 [info ] [MainThread]: 
[0m11:58:27.520792 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:58:27.522609 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:27.522422 after 11.46 seconds
[0m11:58:27.523176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43D82830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43E2F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013E43E2F390>]}
[0m11:58:27.523640 [debug] [MainThread]: Flushing usage events
[0m11:58:28.849724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:36.712206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016318CA42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016316919D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016319CE7D90>]}


============================== 11:58:36.717413 | 48260576-b85a-42eb-91df-f189fd83b3b7 ==============================
[0m11:58:36.717413 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:58:36.718259 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:58:36.887786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48260576-b85a-42eb-91df-f189fd83b3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016318FFF950>]}
[0m11:58:37.001805 [debug] [MainThread]: Command `dbt clean` succeeded at 11:58:37.001673 after 0.43 seconds
[0m11:58:37.002196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016319D558C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016319D55040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001631AF6C650>]}
[0m11:58:37.002587 [debug] [MainThread]: Flushing usage events
[0m11:58:38.129267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:27.728625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BA0842F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B7CF9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BB0C7D90>]}


============================== 11:59:27.738078 | df372cf1-e009-4f48-beda-7e9485e2ab10 ==============================
[0m11:59:27.738078 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:59:27.739576 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m11:59:27.977121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df372cf1-e009-4f48-beda-7e9485e2ab10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BA3DF950>]}
[0m11:59:28.013543 [debug] [MainThread]: Command `dbt clean` succeeded at 11:59:28.013354 after 0.50 seconds
[0m11:59:28.014100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BB1418C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BB141040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BC2BC650>]}
[0m11:59:28.014666 [debug] [MainThread]: Flushing usage events
[0m11:59:29.580852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:53.644650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA75742F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA51F9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA85B3D90>]}


============================== 11:59:53.650929 | cd9ae623-b3d7-418c-afd7-a6c29ce067d0 ==============================
[0m11:59:53.650929 [info ] [MainThread]: Running with dbt=1.10.9
[0m11:59:53.651982 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m11:59:53.884165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd9ae623-b3d7-418c-afd7-a6c29ce067d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA78CF950>]}
[0m11:59:53.945206 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-_8fgy8yh'
[0m11:59:53.945795 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:59:55.796608 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:59:55.798607 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:59:56.477225 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:59:56.483945 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:59:57.622560 [info ] [MainThread]: Installed from version 1.3.0
[0m11:59:57.623299 [info ] [MainThread]: Up to date!
[0m11:59:57.623993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd9ae623-b3d7-418c-afd7-a6c29ce067d0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8625590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8625F20>]}
[0m11:59:57.626418 [debug] [MainThread]: Command `dbt deps` succeeded at 11:59:57.626244 after 4.17 seconds
[0m11:59:57.626934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9811750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA84328A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA97C47D0>]}
[0m11:59:57.627464 [debug] [MainThread]: Flushing usage events
[0m11:59:58.929746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:18.048220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F2B9442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F295B5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F2C98FD90>]}


============================== 12:00:18.054676 | 147dd9f4-ce3e-4d8b-97be-926fc5251227 ==============================
[0m12:00:18.054676 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:00:18.055679 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:00:22.611482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F2BC9F950>]}
[0m12:00:22.709653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50466F10>]}
[0m12:00:22.710610 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:00:23.727609 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:00:23.729264 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:00:23.730009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F504BC950>]}
[0m12:00:27.228040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F519F1B80>]}
[0m12:00:27.432746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:00:27.437095 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:00:27.490119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F504F2CF0>]}
[0m12:00:27.491107 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:00:27.492168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F51E0DBF0>]}
[0m12:00:27.496412 [info ] [MainThread]: 
[0m12:00:27.497442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:27.498519 [info ] [MainThread]: 
[0m12:00:27.500108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:00:27.509855 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:00:27.510772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:27.512160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:00:27.513252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:27.514264 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:00:27.515615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:30.468101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:00:30.468841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:30.469667 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:00:30.470862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:30.471584 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:00:30.512673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:33.225547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F51C2DFD0>]}
[0m12:00:33.226665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:33.238709 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m12:00:33.240199 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m12:00:33.241285 [info ] [Thread-1 (]: 1 of 9 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m12:00:33.244332 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m12:00:33.242571 [info ] [Thread-2 (]: 2 of 9 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m12:00:33.246125 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m12:00:33.247254 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m12:00:33.259979 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m12:00:33.265972 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m12:00:33.273926 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m12:00:33.278905 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m12:00:33.279925 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m12:00:33.343023 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m12:00:33.343842 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m12:00:33.348781 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the same date window
-- Usage example:
--   dbt run --select stg_hits_products --vars '{ga_start: "20170801", ga_end: "20170831"}'

with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)                    as session_date,
    cast(fullVisitorId as string)                          as visitor_id,
    cast(visitId as string)                                as visit_id,
    geoNetwork.country                                     as country,
    trafficSource.source                                   as traffic_source,
    trafficSource.medium                                   as traffic_medium,
    trafficSource.campaign                                 as traffic_campaign,
    h.transaction.transactionId                            as transaction_id,
    p.productSKU                                           as product_sku,
    p.v2ProductName                                        as product_name,
    p.v2ProductCategory                                    as product_category,
    p.productQuantity                                      as product_quantity,
    -- GA prices are micros; keep this as "local" until FX conversion
    safe_divide(p.productPrice, 1e6)                       as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6)     as item_revenue_local   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
where _TABLE_SUFFIX between '20160101'
                        and '20170831'
  and p.productSKU is not null

)

select *
from base;


[0m12:00:33.349967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:33.350925 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20160101'
                        and '20170831'
)

select *
from src;


[0m12:00:33.351793 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:00:35.999141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6896ecdf-a788-4d44-bb5a-565ee29db3f6&page=queryresults
[0m12:00:36.068790 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:46208831-7dc8-49b8-914f-94d6256f1c09&page=queryresults
[0m12:00:36.756508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F51FF0EC0>]}
[0m12:00:36.757223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F2BC80230>]}
[0m12:00:36.758087 [info ] [Thread-1 (]: 1 of 9 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 3.51s]
[0m12:00:36.760182 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m12:00:36.759045 [info ] [Thread-2 (]: 2 of 9 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.51s]
[0m12:00:36.761722 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m12:00:36.762612 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m12:00:36.764135 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m12:00:36.763497 [info ] [Thread-3 (]: 3 of 9 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m12:00:36.765221 [debug] [Thread-4 (]: Began running node model.ga_retail_project.dim_date
[0m12:00:36.766786 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m12:00:36.765979 [info ] [Thread-1 (]: 5 of 9 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m12:00:36.768873 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m12:00:36.768087 [info ] [Thread-4 (]: 4 of 9 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m12:00:36.769757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_hits_products, now model.ga_retail_project.stg_sessions_with_fx)
[0m12:00:36.775360 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m12:00:36.776166 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m12:00:36.776750 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m12:00:36.777535 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.dim_date
[0m12:00:36.783221 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m12:00:36.787183 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m12:00:36.788446 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m12:00:36.804759 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:00:36.806152 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.dim_date
[0m12:00:36.811178 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:00:36.811955 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m12:00:36.821229 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m12:00:36.903437 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as with base as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m12:00:36.904510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:39.415378 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m12:00:39.417863 [debug] [Thread-4 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m12:00:39.450604 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m12:00:39.452348 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_products.sql
WITH products AS (
    SELECT
        product_sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(product_category) AS product_category
    FROM e2e-dbt-project.analytics_stg.stg_hits_products
    WHERE product_sku IS NOT NULL
    GROUP BY product_sku
)

SELECT * FROM products
    );
  
[0m12:00:39.861270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d76135cc-9932-445d-8b87-ec56d0854028&page=queryresults
[0m12:00:40.160931 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ec0599bf-e0c4-4679-9194-4a8f2c670d44&page=queryresults
[0m12:00:40.181210 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6e928576-3ed4-40ad-bc9b-0602a612a7a8&page=queryresults
[0m12:00:40.445848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F525D0BD0>]}
[0m12:00:40.446758 [info ] [Thread-1 (]: 5 of 9 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 3.68s]
[0m12:00:40.447986 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m12:00:40.448816 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_country
[0m12:00:40.449390 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m12:00:40.450058 [info ] [Thread-2 (]: 6 of 9 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m12:00:40.451496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.dim_country)
[0m12:00:40.450755 [info ] [Thread-1 (]: 7 of 9 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m12:00:40.452247 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_country
[0m12:00:40.452874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions_with_fx, now model.ga_retail_project.int_sessions_enriched)
[0m12:00:40.458954 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m12:00:40.459953 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m12:00:40.469253 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m12:00:40.471973 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_country
[0m12:00:40.476053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:00:40.478057 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m12:00:40.481942 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m12:00:40.530918 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

with sessions as (
    select *
    from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),

hits as (
    select *
    from e2e-dbt-project.analytics_stg.stg_hits_products
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m12:00:40.532051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:42.757310 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m12:00:42.761505 [debug] [Thread-2 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m12:00:43.286169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4ad86835-255e-451d-a4f6-696d2d4d1d0a&page=queryresults
[0m12:00:43.575814 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4ad86835-255e-451d-a4f6-696d2d4d1d0a&page=queryresults
[0m12:00:43.623973 [debug] [Thread-1 (]: Database Error in model int_sessions_enriched (models\intermediate\int_sessions_enriched.sql)
  Name product_price_usd not found inside h at [36:7]
  compiled code at target\run\ga_retail_project\models\intermediate\int_sessions_enriched.sql
[0m12:00:43.624944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F53795A20>]}
[0m12:00:43.625857 [error] [Thread-1 (]: 7 of 9 ERROR creating sql view model analytics_int.int_sessions_enriched ....... [[31mERROR[0m in 3.17s]
[0m12:00:43.627092 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m12:00:43.627892 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.int_sessions_enriched' to be skipped because of status 'error'.  Reason: Database Error in model int_sessions_enriched (models\intermediate\int_sessions_enriched.sql)
  Name product_price_usd not found inside h at [36:7]
  compiled code at target\run\ga_retail_project\models\intermediate\int_sessions_enriched.sql.
[0m12:00:43.629892 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m12:00:43.630795 [info ] [Thread-1 (]: 8 of 9 SKIP relation analytics_mart.fct_sales_item ............................. [[33mSKIP[0m]
[0m12:00:43.631910 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m12:00:43.633077 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_visitors
[0m12:00:43.633689 [info ] [Thread-1 (]: 9 of 9 SKIP relation analytics_mart.dim_visitors ............................... [[33mSKIP[0m]
[0m12:00:43.634843 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_visitors
[0m12:00:43.644709 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c5f9c688-01a5-4711-9f38-29619d431c56&page=queryresults
[0m12:00:50.632810 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ec0599bf-e0c4-4679-9194-4a8f2c670d44&page=queryresults
[0m12:00:50.660435 [debug] [Thread-3 (]: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:00:50.661634 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F526E6D50>]}
[0m12:00:50.663142 [error] [Thread-3 (]: 3 of 9 ERROR creating sql table model analytics_mart.dim_products .............. [[31mERROR[0m in 13.90s]
[0m12:00:50.664570 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m12:00:50.665506 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql.
[0m12:00:56.350816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F526E7050>]}
[0m12:00:56.351711 [info ] [Thread-2 (]: 6 of 9 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (222.0 rows, 10.1 MiB processed)[0m in 15.90s]
[0m12:00:56.352920 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_country
[0m12:00:57.395990 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147dd9f4-ce3e-4d8b-97be-926fc5251227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F526E4CB0>]}
[0m12:00:57.396875 [info ] [Thread-4 (]: 4 of 9 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (366.0 rows, 0 processed)[0m in 20.62s]
[0m12:00:57.398087 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.dim_date
[0m12:00:57.400153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:57.402749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:57.403257 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:00:57.403736 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:00:57.404196 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:00:57.404657 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:00:57.405240 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:00:57.405792 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:00:57.406778 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m12:00:57.407884 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m12:00:57.408951 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m12:00:57.410039 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m12:00:57.411137 [info ] [MainThread]: 
[0m12:00:57.412412 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 4 view models in 0 hours 0 minutes and 29.91 seconds (29.91s).
[0m12:00:57.416269 [debug] [MainThread]: Command end result
[0m12:00:57.483887 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:00:57.487316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:00:57.496894 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:00:57.497408 [info ] [MainThread]: 
[0m12:00:57.498203 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:00:57.498938 [info ] [MainThread]: 
[0m12:00:57.499823 [error] [MainThread]: [31mFailure in model int_sessions_enriched (models\intermediate\int_sessions_enriched.sql)[0m
[0m12:00:57.500665 [error] [MainThread]:   Database Error in model int_sessions_enriched (models\intermediate\int_sessions_enriched.sql)
  Name product_price_usd not found inside h at [36:7]
  compiled code at target\run\ga_retail_project\models\intermediate\int_sessions_enriched.sql
[0m12:00:57.501371 [info ] [MainThread]: 
[0m12:00:57.502235 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\int_sessions_enriched.sql
[0m12:00:57.503013 [info ] [MainThread]: 
[0m12:00:57.503945 [error] [MainThread]: [31mFailure in model dim_products (models\mart\dim_products.sql)[0m
[0m12:00:57.504770 [error] [MainThread]:   Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:00:57.505612 [info ] [MainThread]: 
[0m12:00:57.506596 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\dim_products.sql
[0m12:00:57.507648 [info ] [MainThread]: 
[0m12:00:57.508694 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=9
[0m12:00:57.510715 [debug] [MainThread]: Command `dbt run` failed at 12:00:57.510440 after 39.65 seconds
[0m12:00:57.511692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5382B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5382BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F5382B890>]}
[0m12:00:57.512743 [debug] [MainThread]: Flushing usage events
[0m12:00:58.960849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:41.540422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1781B42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A175E25D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1791FFD90>]}


============================== 12:07:41.546609 | 87479775-3d1f-41bd-a03a-5cc269115ee8 ==============================
[0m12:07:41.546609 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:07:41.547615 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_products dim_country dim_date fct_sales_item --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:07:45.900306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A178513950>]}
[0m12:07:45.997580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11F056F10>]}
[0m12:07:45.998474 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:07:47.024791 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:07:47.400462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:07:47.401503 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\dim_products.sql
[0m12:07:47.402166 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m12:07:47.402795 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\intermediate\int_sessions_enriched.sql
[0m12:07:48.106752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11F0AFC50>]}
[0m12:07:48.292532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:07:48.296187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:07:48.339677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11F0F17C0>]}
[0m12:07:48.340326 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:07:48.341007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11F81BAF0>]}
[0m12:07:48.344618 [info ] [MainThread]: 
[0m12:07:48.345324 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:48.346034 [info ] [MainThread]: 
[0m12:07:48.347004 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:48.353267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:07:48.353949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:50.507628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:07:50.512819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:50.515154 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:07:50.516754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:50.518646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:07:50.519999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:53.007748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11F8A4120>]}
[0m12:07:53.009128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:53.021263 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m12:07:53.022444 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m12:07:53.023179 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m12:07:53.023773 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m12:07:53.024545 [info ] [Thread-2 (]: 2 of 4 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m12:07:53.027689 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m12:07:53.028253 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m12:07:53.038491 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m12:07:53.025285 [info ] [Thread-3 (]: 3 of 4 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m12:07:53.039790 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m12:07:53.025979 [info ] [Thread-4 (]: 4 of 4 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m12:07:53.040947 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m12:07:53.026883 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m12:07:53.048225 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m12:07:53.052960 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m12:07:53.053653 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m12:07:53.054415 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m12:07:53.055116 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m12:07:53.079009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:07:53.079877 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m12:07:53.090577 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m12:07:53.094548 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m12:07:53.098209 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m12:07:53.101593 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:53.142728 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m12:07:53.193779 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m12:07:53.199300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:07:53.244410 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:07:55.641668 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m12:07:55.643069 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m12:07:55.712296 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m12:07:55.715773 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with src as (
  select
    product_sku,
    any_value(product_name)    as product_name,
    any_value(product_category) as product_category
  from e2e-dbt-project.analytics_stg.stg_hits_products
  where product_sku is not null
  group by product_sku
)

select * from src
    );
  
[0m12:07:55.732051 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m12:07:55.734090 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m12:07:55.801355 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m12:07:55.814097 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_category, product_sku

    
    OPTIONS()
    as (
      

with base as (
    select *
    from e2e-dbt-project.analytics_int.int_sessions_enriched
),

-- Only keep real transacted items; drop rows that break tests
filtered as (
    select *
    from base
    where transaction_id is not null
      and product_sku    is not null
      and revenue_usd    is not null
      and revenue_local  is not null
      and session_date   is not null
      and coalesce(product_quantity, 0) > 0   -- optional, tighten quality
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from filtered

    );
  
[0m12:07:56.479779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f07c0cdf-ef5d-42dc-83aa-6477733cccd3&page=queryresults
[0m12:07:56.491156 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a89c2322-33fa-4a74-9b51-fb8889b875aa&page=queryresults
[0m12:07:56.591770 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ca48e937-4b3e-409d-8930-19a91ba83c6a&page=queryresults
[0m12:07:56.839403 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:56e20b58-bf41-456c-8946-a0241040b266&page=queryresults
[0m12:07:57.180062 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:56e20b58-bf41-456c-8946-a0241040b266&page=queryresults
[0m12:07:57.196923 [debug] [Thread-4 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Name product_price_usd not found inside h; failed to parse view 'e2e-dbt-project.analytics_int.int_sessions_enriched' at [29:7]
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:07:57.201331 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11FA85F10>]}
[0m12:07:57.203059 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model analytics_mart.fct_sales_item ...... [[31mERROR[0m in 4.15s]
[0m12:07:57.204689 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m12:07:57.205920 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Name product_price_usd not found inside h; failed to parse view 'e2e-dbt-project.analytics_int.int_sessions_enriched' at [29:7]
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m12:08:08.233433 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a89c2322-33fa-4a74-9b51-fb8889b875aa&page=queryresults
[0m12:08:08.249913 [debug] [Thread-3 (]: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:08:08.250695 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11FAEB490>]}
[0m12:08:08.251589 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model analytics_mart.dim_products .............. [[31mERROR[0m in 15.21s]
[0m12:08:08.252894 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m12:08:08.253771 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql.
[0m12:08:09.425963 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1185D2AD0>]}
[0m12:08:09.426872 [info ] [Thread-2 (]: 2 of 4 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (366.0 rows, 0 processed)[0m in 16.40s]
[0m12:08:09.428067 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m12:08:14.871289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87479775-3d1f-41bd-a03a-5cc269115ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11F9F6250>]}
[0m12:08:14.873762 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (222.0 rows, 10.1 MiB processed)[0m in 21.82s]
[0m12:08:14.877110 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m12:08:14.882397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:14.888771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:14.890081 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:08:14.891321 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:08:14.892504 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:08:14.893492 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:08:14.894250 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m12:08:14.895037 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m12:08:14.895809 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m12:08:14.896571 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m12:08:14.897546 [info ] [MainThread]: 
[0m12:08:14.898668 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 26.55 seconds (26.55s).
[0m12:08:14.901738 [debug] [MainThread]: Command end result
[0m12:08:14.954198 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:08:14.958239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:08:14.966766 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:08:14.967239 [info ] [MainThread]: 
[0m12:08:14.967979 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:08:14.968679 [info ] [MainThread]: 
[0m12:08:14.969505 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m12:08:14.970332 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Name product_price_usd not found inside h; failed to parse view 'e2e-dbt-project.analytics_int.int_sessions_enriched' at [29:7]
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:08:14.971054 [info ] [MainThread]: 
[0m12:08:14.971848 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:08:14.972543 [info ] [MainThread]: 
[0m12:08:14.973366 [error] [MainThread]: [31mFailure in model dim_products (models\mart\dim_products.sql)[0m
[0m12:08:14.974167 [error] [MainThread]:   Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:08:14.974834 [info ] [MainThread]: 
[0m12:08:14.975613 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\dim_products.sql
[0m12:08:14.976329 [info ] [MainThread]: 
[0m12:08:14.977280 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m12:08:14.978913 [debug] [MainThread]: Command `dbt run` failed at 12:08:14.978726 after 33.69 seconds
[0m12:08:14.979510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A17924CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A172A98440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A11FF630B0>]}
[0m12:08:14.980081 [debug] [MainThread]: Flushing usage events
[0m12:08:16.278739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:46.758369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF129E42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF106D9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF13A23D90>]}


============================== 12:16:46.764726 | d7d9376a-9a10-4e49-b423-d0894287140f ==============================
[0m12:16:46.764726 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:16:46.765727 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:16:47.001900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7d9376a-9a10-4e49-b423-d0894287140f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF12D43950>]}
[0m12:16:47.125269 [debug] [MainThread]: Command `dbt clean` succeeded at 12:16:47.125070 after 0.64 seconds
[0m12:16:47.125852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF13AA18C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF13AA1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF14C1C650>]}
[0m12:16:47.126490 [debug] [MainThread]: Flushing usage events
[0m12:16:48.704644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:33.561770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B2FD242F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B2D9ADD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B30D63D90>]}


============================== 12:18:33.567988 | 4299d897-a26a-4618-bf6a-f9bc325d4d8c ==============================
[0m12:18:33.567988 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:18:33.568947 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:18:33.806735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4299d897-a26a-4618-bf6a-f9bc325d4d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B30083950>]}
[0m12:18:33.855245 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-9foy3zl_'
[0m12:18:33.855834 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:18:37.693619 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:18:37.696323 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:18:38.524327 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:18:38.531452 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:18:39.648285 [info ] [MainThread]: Installed from version 1.3.0
[0m12:18:39.648999 [info ] [MainThread]: Up to date!
[0m12:18:39.649672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4299d897-a26a-4618-bf6a-f9bc325d4d8c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B30DE1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B30DE1F20>]}
[0m12:18:39.652395 [debug] [MainThread]: Command `dbt deps` succeeded at 12:18:39.652220 after 6.35 seconds
[0m12:18:39.652904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B32021750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B30BE28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B31FD47D0>]}
[0m12:18:39.653434 [debug] [MainThread]: Flushing usage events
[0m12:18:40.966457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:45.574107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F5C7642F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F5A3D9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F5D7AFD90>]}


============================== 12:18:45.580368 | a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d ==============================
[0m12:18:45.580368 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:18:45.581356 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products stg_sessions_with_fx int_sessions_enriched --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:18:50.125116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F5CAC7950>]}
[0m12:18:50.224136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F01316F10>]}
[0m12:18:50.225098 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:18:51.246669 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:18:51.248300 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:18:51.249052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F0136C950>]}
[0m12:18:54.506342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F028A1B80>]}
[0m12:18:54.687911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:18:54.692065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:18:54.736804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F013A2CF0>]}
[0m12:18:54.737468 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:18:54.738218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F02CC1B20>]}
[0m12:18:54.741837 [info ] [MainThread]: 
[0m12:18:54.742558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:54.743300 [info ] [MainThread]: 
[0m12:18:54.744318 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:54.750454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:18:54.751206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:54.751892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:18:54.752704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:57.207749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:18:57.208497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:57.209242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:18:57.210608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:57.211316 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:18:57.211821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:59.648884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F02ADDC10>]}
[0m12:18:59.649641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:59.658233 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m12:18:59.658890 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m12:18:59.659665 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m12:18:59.661269 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m12:18:59.661827 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m12:18:59.673108 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m12:18:59.660383 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m12:18:59.674284 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m12:18:59.674994 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m12:18:59.682234 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m12:18:59.694136 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m12:18:59.737438 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m12:18:59.738389 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m12:18:59.742124 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m12:18:59.745901 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the date window controlled by vars.
with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)              as session_date,
    cast(fullVisitorId as string)                    as visitor_id,
    cast(visitId as string)                          as visit_id,
    geoNetwork.country                               as country,
    trafficSource.source                             as traffic_source,
    trafficSource.medium                             as traffic_medium,
    trafficSource.campaign                           as traffic_campaign,
    h.transaction.transactionId                      as transaction_id,
    p.productSKU                                     as product_sku,
    p.v2ProductName                                  as product_name,
    p.v2ProductCategory                              as product_category,
    p.productQuantity                                as product_quantity,
    -- GA prices are in micros in the export; treat as "local" at this stage
    safe_divide(p.productPrice, 1e6)                 as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6) as item_revenue_local
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between '20160101'
                        and '20170831'
    and p.productSKU is not null
)
select * from base;


[0m12:18:59.747144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:59.748064 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20160101'
                        and '20170831'
)

select *
from src;


[0m12:18:59.748941 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:19:02.430705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:17ec0848-4173-43b5-bbeb-c808c58aac89&page=queryresults
[0m12:19:02.539115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5ef95706-818e-4d01-a8f4-efc2334def8f&page=queryresults
[0m12:19:03.149465 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F02E08100>]}
[0m12:19:03.150481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F5CAA4230>]}
[0m12:19:03.150142 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.47s]
[0m12:19:03.151517 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m12:19:03.151981 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 3.49s]
[0m12:19:03.152966 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m12:19:03.153445 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m12:19:03.153945 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m12:19:03.154690 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m12:19:03.155082 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m12:19:03.158415 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m12:19:03.168137 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m12:19:03.171431 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m12:19:03.173225 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as 

with cc as (
  select country, currency
  from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
  select rate_date, currency, rate_to_usd
  from `e2e-dbt-project`.`ext`.`fx_rates`
),
s as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions
)
select
  s.session_date,
  s.visitor_id,
  s.visit_id,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  s.visits,
  s.transactions,
  s.revenue_usd as session_revenue_usd_raw,  -- may be null
  cc.currency    as local_currency,
  fx.rate_to_usd
from s
left join cc
  on lower(cc.country) = lower(s.country)
left join fx
  on fx.rate_date = s.session_date
 and fx.currency  = cc.currency;


[0m12:19:03.173757 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:19:04.993206 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7e582a70-4e61-465a-bdbe-35556e5121a5&page=queryresults
[0m12:19:05.557015 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F03413ED0>]}
[0m12:19:05.558091 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m12:19:05.559455 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m12:19:05.560587 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m12:19:05.561513 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m12:19:05.562626 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m12:19:05.563268 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m12:19:05.568232 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m12:19:05.570611 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m12:19:05.575570 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m12:19:05.577527 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

-- Silver: join item-level hits with session-day FX, compute USD metrics.
with sess as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),
items as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    -- local currency amounts from staging
    product_price_local,
    item_revenue_local
  from e2e-dbt-project.analytics_stg.stg_hits_products
),
joined as (
  select
    i.session_date,
    i.visitor_id,
    i.visit_id,
    i.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    i.transaction_id,
    i.product_sku,
    i.product_name,
    i.product_category,
    i.product_quantity,
    i.product_price_local,
    coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) as revenue_local,
    -- FX conversion at session_date granularity
    (i.product_price_local * s.rate_to_usd) as product_price_usd,
    (coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) * s.rate_to_usd) as revenue_usd,
    s.rate_to_usd,
    s.local_currency
  from items i
  left join sess s
    on s.session_date = i.session_date
   and s.visitor_id   = i.visitor_id
   and s.visit_id     = i.visit_id
   and lower(s.country) = lower(i.country)
)

select * from joined;


[0m12:19:05.578252 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:19:07.845850 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c331ab47-c222-41d8-a2c1-39ea402033fb&page=queryresults
[0m12:19:08.418639 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b68b0c-2bbd-47bf-9a36-5f95d7d7559d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F02E55DA0>]}
[0m12:19:08.420888 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.86s]
[0m12:19:08.423786 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m12:19:08.428546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:08.434866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:08.436254 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:19:08.437365 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:19:08.438460 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:19:08.439650 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:19:08.440746 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:19:08.441933 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m12:19:08.443100 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m12:19:08.444284 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m12:19:08.445349 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m12:19:08.446725 [info ] [MainThread]: 
[0m12:19:08.448419 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 13.70 seconds (13.70s).
[0m12:19:08.453680 [debug] [MainThread]: Command end result
[0m12:19:08.505045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:19:08.507594 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:19:08.523042 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:19:08.523450 [info ] [MainThread]: 
[0m12:19:08.524028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:08.524587 [info ] [MainThread]: 
[0m12:19:08.525162 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:19:08.526365 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:08.526242 after 23.14 seconds
[0m12:19:08.526896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F034A3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F02CA78F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F03550650>]}
[0m12:19:08.527303 [debug] [MainThread]: Flushing usage events
[0m12:19:09.605741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:17.317466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0170342F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A014CC5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A01807FD90>]}


============================== 12:19:17.322426 | 93a0cad6-ecfb-403c-8695-5163b783b9b7 ==============================
[0m12:19:17.322426 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:19:17.323215 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_products dim_country dim_date fct_sales_item --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m12:19:20.505238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A017393950>]}
[0m12:19:20.568961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03BAEAF10>]}
[0m12:19:20.569572 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:19:21.219498 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:19:21.448487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:21.448836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:21.511556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03BB3D350>]}
[0m12:19:21.633241 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:19:21.635623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:19:21.673112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03BB817C0>]}
[0m12:19:21.673582 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:19:21.674135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D0783D0>]}
[0m12:19:21.676603 [info ] [MainThread]: 
[0m12:19:21.677145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:21.677639 [info ] [MainThread]: 
[0m12:19:21.678318 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:19:21.682479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:19:21.682829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:23.259203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:19:23.259945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:23.260656 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:19:23.261106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:23.328637 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:19:23.329076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:25.095461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D224BB0>]}
[0m12:19:25.096628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:25.106454 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m12:19:25.107245 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m12:19:25.107978 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m12:19:25.109356 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m12:19:25.108768 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m12:19:25.110224 [info ] [Thread-3 (]: 3 of 4 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m12:19:25.113170 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m12:19:25.113950 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m12:19:25.114541 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m12:19:25.111156 [info ] [Thread-2 (]: 2 of 4 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m12:19:25.115315 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m12:19:25.111941 [info ] [Thread-4 (]: 4 of 4 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m12:19:25.126789 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m12:19:25.127778 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m12:19:25.132121 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m12:19:25.132901 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m12:19:25.133639 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m12:19:25.134428 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m12:19:25.138228 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m12:19:25.150188 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m12:19:25.151184 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m12:19:25.160621 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m12:19:25.180596 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:19:25.184311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:25.185007 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m12:19:25.187361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:19:25.187935 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m12:19:25.288468 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:19:27.163903 [debug] [Thread-4 (]: Hard refreshing `e2e-dbt-project`.`analytics_mart`.`fct_sales_item` because it is not replaceable
[0m12:19:27.265630 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m12:19:27.267745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m12:19:27.279578 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m12:19:27.280481 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      -- models/mart/dim_country.sql
WITH countries AS (
    SELECT
        DISTINCT country,
        currency
    FROM e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)

SELECT * FROM countries
    );
  
[0m12:19:27.313576 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m12:19:27.314818 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with src as (
  select
    product_sku,
    any_value(product_name)     as product_name,
    any_value(product_category) as product_category
  from e2e-dbt-project.analytics_stg.stg_hits_products
  where product_sku is not null
  group by product_sku
)
select * from src
    );
  
[0m12:19:27.464132 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m12:19:27.465730 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_sku, product_category

    
    OPTIONS()
    as (
      

with base as (
  select * from e2e-dbt-project.analytics_int.int_sessions_enriched
)

select
  session_date,
  visitor_id,
  visit_id,
  country,
  traffic_source,
  traffic_medium,
  traffic_campaign,
  transaction_id,
  product_sku,
  product_name,
  product_category,
  product_quantity,
  product_price_usd,
  revenue_usd,
  revenue_local
from base


    );
  
[0m12:19:28.073793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:809a4237-11fa-447b-9b3f-611f60134f8b&page=queryresults
[0m12:19:28.106816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fa508a89-c27d-4afc-bc4f-8c5040b711ff&page=queryresults
[0m12:19:28.108996 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:01e3f1cc-883b-4da8-82f8-c5d3a6bede31&page=queryresults
[0m12:19:28.365532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9d0b4730-1e14-4edc-9a67-04b23ab31fd0&page=queryresults
[0m12:19:28.394211 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fa508a89-c27d-4afc-bc4f-8c5040b711ff&page=queryresults
[0m12:19:28.407559 [debug] [Thread-1 (]: Database Error in model dim_country (models\mart\dim_country.sql)
  Unrecognized name: currency at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\dim_country.sql
[0m12:19:28.410523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D6F8290>]}
[0m12:19:28.411489 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model analytics_mart.dim_country ............... [[31mERROR[0m in 3.30s]
[0m12:19:28.412730 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m12:19:28.413549 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.dim_country' to be skipped because of status 'error'.  Reason: Database Error in model dim_country (models\mart\dim_country.sql)
  Unrecognized name: currency at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\dim_country.sql.
[0m12:19:38.054824 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:01e3f1cc-883b-4da8-82f8-c5d3a6bede31&page=queryresults
[0m12:19:38.069988 [debug] [Thread-3 (]: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:19:38.070646 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D2B6BA0>]}
[0m12:19:38.071400 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model analytics_mart.dim_products .............. [[31mERROR[0m in 12.96s]
[0m12:19:38.072421 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m12:19:38.073203 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql.
[0m12:19:39.705710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D6E0230>]}
[0m12:19:39.706521 [info ] [Thread-2 (]: 2 of 4 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (366.0 rows, 0 processed)[0m in 14.58s]
[0m12:19:39.707626 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m12:19:40.047998 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9d0b4730-1e14-4edc-9a67-04b23ab31fd0&page=queryresults
[0m12:19:40.077314 [debug] [Thread-4 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Query exceeded limit for bytes billed: 1000000000. 1593835520 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:19:40.079199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93a0cad6-ecfb-403c-8695-5163b783b9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A016C600D0>]}
[0m12:19:40.081004 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model analytics_mart.fct_sales_item ...... [[31mERROR[0m in 14.95s]
[0m12:19:40.083344 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m12:19:40.084719 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Query exceeded limit for bytes billed: 1000000000. 1593835520 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m12:19:40.087789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:40.090808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:40.091377 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:19:40.091918 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:19:40.092436 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:19:40.092958 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:19:40.093475 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m12:19:40.094062 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m12:19:40.094919 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m12:19:40.095819 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m12:19:40.096707 [info ] [MainThread]: 
[0m12:19:40.097453 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 18.42 seconds (18.42s).
[0m12:19:40.099395 [debug] [MainThread]: Command end result
[0m12:19:40.136546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:19:40.139067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:19:40.145690 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:19:40.146084 [info ] [MainThread]: 
[0m12:19:40.146698 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:19:40.147259 [info ] [MainThread]: 
[0m12:19:40.147889 [error] [MainThread]: [31mFailure in model dim_country (models\mart\dim_country.sql)[0m
[0m12:19:40.148521 [error] [MainThread]:   Database Error in model dim_country (models\mart\dim_country.sql)
  Unrecognized name: currency at [18:9]
  compiled code at target\run\ga_retail_project\models\mart\dim_country.sql
[0m12:19:40.149065 [info ] [MainThread]: 
[0m12:19:40.149671 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\dim_country.sql
[0m12:19:40.150206 [info ] [MainThread]: 
[0m12:19:40.150817 [error] [MainThread]: [31mFailure in model dim_products (models\mart\dim_products.sql)[0m
[0m12:19:40.151430 [error] [MainThread]:   Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:19:40.151969 [info ] [MainThread]: 
[0m12:19:40.152598 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\dim_products.sql
[0m12:19:40.153131 [info ] [MainThread]: 
[0m12:19:40.153737 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m12:19:40.154338 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Query exceeded limit for bytes billed: 1000000000. 1593835520 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:19:40.154870 [info ] [MainThread]: 
[0m12:19:40.155487 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:19:40.156012 [info ] [MainThread]: 
[0m12:19:40.156568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m12:19:40.157789 [debug] [MainThread]: Command `dbt run` failed at 12:19:40.157663 after 22.97 seconds
[0m12:19:40.158226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0180CCFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0119A8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A03D6FEAB0>]}
[0m12:19:40.158793 [debug] [MainThread]: Flushing usage events
[0m12:19:41.497915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:46.126982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D855942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D83209D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D865D7D90>]}


============================== 12:24:46.133173 | eec248c0-502b-4784-b7b1-25e9bbec5d94 ==============================
[0m12:24:46.133173 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:24:46.134199 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:24:46.363022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec248c0-502b-4784-b7b1-25e9bbec5d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D858F3950>]}
[0m12:24:46.487070 [debug] [MainThread]: Command `dbt clean` succeeded at 12:24:46.486884 after 0.64 seconds
[0m12:24:46.487662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D866498C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D86649040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D877DC650>]}
[0m12:24:46.488216 [debug] [MainThread]: Flushing usage events
[0m12:24:47.985595 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:00.952444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F517D942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F515A09D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F518DD3D90>]}


============================== 12:25:00.958664 | 595820d1-e94a-4312-9c82-eddca6ba4f88 ==============================
[0m12:25:00.958664 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:25:00.959648 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:25:01.195916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '595820d1-e94a-4312-9c82-eddca6ba4f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5180F3950>]}
[0m12:25:01.244682 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-xtrqd6ti'
[0m12:25:01.245281 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:25:03.070743 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:25:03.073410 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:25:03.791394 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:25:03.797999 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:25:05.218489 [info ] [MainThread]: Installed from version 1.3.0
[0m12:25:05.219282 [info ] [MainThread]: Up to date!
[0m12:25:05.220025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '595820d1-e94a-4312-9c82-eddca6ba4f88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F518E45590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F518E45F20>]}
[0m12:25:05.222495 [debug] [MainThread]: Command `dbt deps` succeeded at 12:25:05.222322 after 4.48 seconds
[0m12:25:05.222997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F519FE1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F518C528A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F519F947D0>]}
[0m12:25:05.223520 [debug] [MainThread]: Flushing usage events
[0m12:25:06.759988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:11.344167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096F4D42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096D139D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002097051BD90>]}


============================== 12:25:11.350764 | 8b69d7f5-fd81-4764-91e5-7e1491dc007f ==============================
[0m12:25:11.350764 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:25:11.351789 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products stg_sessions_with_fx --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:25:15.956106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096F837950>]}
[0m12:25:16.056919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209140EAF10>]}
[0m12:25:16.057859 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:25:17.232096 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:25:17.233807 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:25:17.234548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091413C950>]}
[0m12:25:21.172028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020915676300>]}
[0m12:25:21.356538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:25:21.360867 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:25:21.405451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209141CC210>]}
[0m12:25:21.406093 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:25:21.406867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020915A81BF0>]}
[0m12:25:21.410095 [info ] [MainThread]: 
[0m12:25:21.410830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:21.411488 [info ] [MainThread]: 
[0m12:25:21.412757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:21.419911 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:25:21.420553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:23.625931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:25:23.628041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:23.629817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:25:23.632954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:23.636051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:25:23.639096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:26.277741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209158ADC10>]}
[0m12:25:26.278391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:26.286718 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m12:25:26.287643 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m12:25:26.288389 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m12:25:26.290377 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m12:25:26.289296 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m12:25:26.291115 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m12:25:26.291813 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m12:25:26.303801 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m12:25:26.304897 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m12:25:26.314307 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m12:25:26.318248 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m12:25:26.330153 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m12:25:26.382014 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m12:25:26.382537 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m12:25:26.387864 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the date window controlled by vars.
with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)              as session_date,
    cast(fullVisitorId as string)                    as visitor_id,
    cast(visitId as string)                          as visit_id,
    geoNetwork.country                               as country,
    trafficSource.source                             as traffic_source,
    trafficSource.medium                             as traffic_medium,
    trafficSource.campaign                           as traffic_campaign,
    h.transaction.transactionId                      as transaction_id,
    p.productSKU                                     as product_sku,
    p.v2ProductName                                  as product_name,
    p.v2ProductCategory                              as product_category,
    p.productQuantity                                as product_quantity,
    -- GA prices are in micros in the export; treat as "local" at this stage
    safe_divide(p.productPrice, 1e6)                 as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6) as item_revenue_local
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between '20160101'
                        and '20170831'
    and p.productSKU is not null
)
select * from base;


[0m12:25:26.389015 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20160101'
                        and '20170831'
)

select *
from src;


[0m12:25:26.389671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:26.390262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:25:28.997502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:52dd2f7a-6474-4108-b20c-f08d42ec48a9&page=queryresults
[0m12:25:29.028990 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b76584ea-34c3-4a56-9a00-86218fb371a6&page=queryresults
[0m12:25:29.750325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209161FC730>]}
[0m12:25:29.751084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020915C6C050>]}
[0m12:25:29.751955 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 3.46s]
[0m12:25:29.754010 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m12:25:29.752897 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.45s]
[0m12:25:29.755194 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m12:25:29.756111 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m12:25:29.756831 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m12:25:29.757951 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m12:25:29.758980 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m12:25:29.766833 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m12:25:29.777017 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m12:25:29.783633 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m12:25:29.785900 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as 

with cc as (
  select country, currency
  from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
  select rate_date, currency, rate_to_usd
  from `e2e-dbt-project`.`ext`.`fx_rates`
),
s as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions
)
select
  s.session_date,
  s.visitor_id,
  s.visit_id,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  s.visits,
  s.transactions,
  s.revenue_usd as session_revenue_usd_raw,  -- may be null
  cc.currency    as local_currency,
  fx.rate_to_usd
from s
left join cc
  on lower(cc.country) = lower(s.country)
left join fx
  on fx.rate_date = s.session_date
 and fx.currency  = cc.currency;


[0m12:25:29.786751 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:25:32.072079 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6d1cb791-23c5-4185-9cc6-89c12a073112&page=queryresults
[0m12:25:32.626356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b69d7f5-fd81-4764-91e5-7e1491dc007f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209161EB850>]}
[0m12:25:32.629145 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.87s]
[0m12:25:32.632955 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m12:25:32.638472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:32.644541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:32.645500 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:25:32.646333 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:25:32.647161 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:25:32.647981 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:25:32.648688 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m12:25:32.649402 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m12:25:32.649818 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m12:25:32.650363 [info ] [MainThread]: 
[0m12:25:32.651096 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 11.24 seconds (11.24s).
[0m12:25:32.652810 [debug] [MainThread]: Command end result
[0m12:25:32.719677 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:25:32.723082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:25:32.732176 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:25:32.732693 [info ] [MainThread]: 
[0m12:25:32.733495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:32.734202 [info ] [MainThread]: 
[0m12:25:32.734931 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:25:32.736461 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:32.736297 after 21.59 seconds
[0m12:25:32.736978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002097056CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020969E48440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020915B9AF30>]}
[0m12:25:32.737501 [debug] [MainThread]: Flushing usage events
[0m12:25:34.032209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:39.440985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB792842F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB76EE9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB7A2CBD90>]}


============================== 12:25:39.447161 | 0c74e790-59b3-4e82-8935-89e31167b2d5 ==============================
[0m12:25:39.447161 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:25:39.448194 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select int_sessions_enriched --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:25:43.824907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB795E7950>]}
[0m12:25:43.922758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1DEEAF10>]}
[0m12:25:43.923703 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:25:44.989010 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:25:45.353498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:45.354029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:45.457038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1DF3D350>]}
[0m12:25:45.652947 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:25:45.656393 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:25:45.701095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1DF7D7C0>]}
[0m12:25:45.701776 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:25:45.702504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1F479D30>]}
[0m12:25:45.705087 [info ] [MainThread]: 
[0m12:25:45.705779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:45.706449 [info ] [MainThread]: 
[0m12:25:45.707343 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:45.708843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:25:45.709501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:47.685528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:25:47.686294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:47.687070 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:25:47.687875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:47.688769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:25:47.689675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:50.510866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1F624940>]}
[0m12:25:50.512705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:50.538339 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m12:25:50.539440 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m12:25:50.540940 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m12:25:50.541741 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m12:25:50.565730 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m12:25:50.568024 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m12:25:50.614084 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m12:25:50.616357 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

-- Silver: join item-level hits with session-day FX, compute USD metrics.
with sess as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),
items as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    -- local currency amounts from staging
    product_price_local,
    item_revenue_local
  from e2e-dbt-project.analytics_stg.stg_hits_products
),
joined as (
  select
    i.session_date,
    i.visitor_id,
    i.visit_id,
    i.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    i.transaction_id,
    i.product_sku,
    i.product_name,
    i.product_category,
    i.product_quantity,
    i.product_price_local,
    coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) as revenue_local,
    -- FX conversion at session_date granularity
    (i.product_price_local * s.rate_to_usd) as product_price_usd,
    (coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) * s.rate_to_usd) as revenue_usd,
    s.rate_to_usd,
    s.local_currency
  from items i
  left join sess s
    on s.session_date = i.session_date
   and s.visitor_id   = i.visitor_id
   and s.visit_id     = i.visit_id
   and lower(s.country) = lower(i.country)
)

select * from joined;


[0m12:25:50.617690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:53.163382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cfbe47bd-c004-4b68-9327-b42df90cb9fb&page=queryresults
[0m12:25:53.863568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c74e790-59b3-4e82-8935-89e31167b2d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1F65EF90>]}
[0m12:25:53.864562 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 3.32s]
[0m12:25:53.865616 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m12:25:53.867218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:53.869511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:53.869861 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:25:53.870267 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:25:53.870690 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:25:53.871157 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:25:53.871516 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m12:25:53.871871 [info ] [MainThread]: 
[0m12:25:53.872410 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m12:25:53.873688 [debug] [MainThread]: Command end result
[0m12:25:53.923932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:25:53.926584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:25:53.934868 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:25:53.935373 [info ] [MainThread]: 
[0m12:25:53.936036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:53.936618 [info ] [MainThread]: 
[0m12:25:53.937218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:25:53.938544 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:53.938402 after 14.68 seconds
[0m12:25:53.938983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1F63B330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1F6EB610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1F6EB430>]}
[0m12:25:53.939537 [debug] [MainThread]: Flushing usage events
[0m12:25:56.135271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:52.383472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220782C42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022075F29D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207930BD90>]}


============================== 12:26:52.388667 | 5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d ==============================
[0m12:26:52.388667 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:26:52.389497 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select dim_country dim_products dim_date fct_sales_item --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:26:55.862762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022078623950>]}
[0m12:26:55.936809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201CE2AF10>]}
[0m12:26:55.937556 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:26:56.652681 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:26:56.892669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:56.893023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:56.961764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201CE7D350>]}
[0m12:26:57.101666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:26:57.104152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:26:57.138469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201CEBD7C0>]}
[0m12:26:57.138972 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:26:57.139548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E3B9D30>]}
[0m12:26:57.142276 [info ] [MainThread]: 
[0m12:26:57.142845 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:26:57.143371 [info ] [MainThread]: 
[0m12:26:57.144085 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:57.148479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:26:57.148856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:58.867330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:26:58.868403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:58.869182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:26:58.870340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:58.871042 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:26:58.873361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:00.967925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E5DD160>]}
[0m12:27:00.969448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:00.979592 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m12:27:00.980419 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m12:27:00.981178 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m12:27:00.982346 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m12:27:00.983354 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m12:27:00.984240 [info ] [Thread-3 (]: 3 of 4 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m12:27:00.986973 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m12:27:00.987903 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m12:27:00.985305 [info ] [Thread-4 (]: 4 of 4 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m12:27:00.988972 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m12:27:00.989953 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m12:27:00.986081 [info ] [Thread-2 (]: 2 of 4 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m12:27:00.991200 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m12:27:01.007575 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m12:27:01.011339 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m12:27:01.012031 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m12:27:01.012967 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m12:27:01.014192 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m12:27:01.025141 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m12:27:01.029516 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m12:27:01.031267 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m12:27:01.054560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:27:01.057364 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m12:27:01.090260 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m12:27:01.093084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:27:01.093535 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m12:27:01.095938 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:27:01.182957 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m12:27:01.242955 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_sku, product_category

    
    OPTIONS()
    as (
      

with base as (
  select * from e2e-dbt-project.analytics_int.int_sessions_enriched
)

select
  session_date,
  visitor_id,
  visit_id,
  country,
  traffic_source,
  traffic_medium,
  traffic_campaign,
  transaction_id,
  product_sku,
  product_name,
  product_category,
  product_quantity,
  product_price_usd,
  revenue_usd,
  revenue_local
from base


    );
  
[0m12:27:01.243596 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:27:03.145052 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m12:27:03.149373 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      

-- Country ↔ Currency from ext mapping (avoid scanning GA)
select distinct
  initcap(country)        as country,
  currency                as local_currency
from `e2e-dbt-project`.`ext`.`country_currency`
where country is not null
  and currency is not null
    );
  
[0m12:27:03.254565 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m12:27:03.258725 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m12:27:03.355707 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m12:27:03.369655 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with src as (
  select
    product_sku,
    any_value(product_name)      as product_name,
    any_value(product_category)  as product_category
  from e2e-dbt-project.analytics_stg.stg_hits_products
  where product_sku is not null
  group by product_sku
)
select * from src
    );
  
[0m12:27:03.761786 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:410ef988-453b-465b-a9b7-934dd7bce504&page=queryresults
[0m12:27:03.961727 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7cdfed71-9dba-449c-8eac-911df48f557a&page=queryresults
[0m12:27:03.971761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:572dfdbd-8edc-4e5b-ac62-84adb3bedd17&page=queryresults
[0m12:27:04.161910 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1e0339f7-b9e1-4cf4-861b-af551f80dbea&page=queryresults
[0m12:27:06.020082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E5A3350>]}
[0m12:27:06.020959 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (7.0 rows, 110.0 Bytes processed)[0m in 5.03s]
[0m12:27:06.022139 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m12:27:13.832606 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7cdfed71-9dba-449c-8eac-911df48f557a&page=queryresults
[0m12:27:13.884898 [debug] [Thread-4 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Query exceeded limit for bytes billed: 1000000000. 1593835520 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:27:13.886214 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E68F490>]}
[0m12:27:13.887723 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model analytics_mart.fct_sales_item ...... [[31mERROR[0m in 12.90s]
[0m12:27:13.888999 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m12:27:13.889944 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Query exceeded limit for bytes billed: 1000000000. 1593835520 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m12:27:14.184810 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1e0339f7-b9e1-4cf4-861b-af551f80dbea&page=queryresults
[0m12:27:14.217783 [debug] [Thread-3 (]: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:27:14.218932 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E62B390>]}
[0m12:27:14.220479 [error] [Thread-3 (]: 3 of 4 ERROR creating sql table model analytics_mart.dim_products .............. [[31mERROR[0m in 13.23s]
[0m12:27:14.222035 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m12:27:14.223318 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql.
[0m12:27:17.675694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8cc90a-a21e-4ab0-8d0c-8eb731b1911d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022079310F50>]}
[0m12:27:17.678421 [info ] [Thread-2 (]: 2 of 4 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (366.0 rows, 0 processed)[0m in 16.66s]
[0m12:27:17.681382 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m12:27:17.686391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:17.692256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:17.693517 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m12:27:17.695298 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m12:27:17.696919 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m12:27:17.698178 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m12:27:17.699861 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m12:27:17.700941 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m12:27:17.702642 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m12:27:17.704274 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m12:27:17.705899 [info ] [MainThread]: 
[0m12:27:17.707707 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 20.56 seconds (20.56s).
[0m12:27:17.712966 [debug] [MainThread]: Command end result
[0m12:27:17.835159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:27:17.838196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:27:17.845878 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m12:27:17.846286 [info ] [MainThread]: 
[0m12:27:17.846913 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m12:27:17.847509 [info ] [MainThread]: 
[0m12:27:17.848181 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m12:27:17.848971 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Query exceeded limit for bytes billed: 1000000000. 1593835520 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:27:17.849549 [info ] [MainThread]: 
[0m12:27:17.850206 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m12:27:17.850892 [info ] [MainThread]: 
[0m12:27:17.851497 [error] [MainThread]: [31mFailure in model dim_products (models\mart\dim_products.sql)[0m
[0m12:27:17.852329 [error] [MainThread]:   Database Error in model dim_products (models\mart\dim_products.sql)
  Query exceeded limit for bytes billed: 1000000000. 1377828864 or higher required.
  compiled code at target\run\ga_retail_project\models\mart\dim_products.sql
[0m12:27:17.852817 [info ] [MainThread]: 
[0m12:27:17.853540 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\dim_products.sql
[0m12:27:17.854203 [info ] [MainThread]: 
[0m12:27:17.854988 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m12:27:17.856282 [debug] [MainThread]: Command `dbt run` failed at 12:27:17.856150 after 25.68 seconds
[0m12:27:17.856749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207935CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022072B88440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201EDC7CB0>]}
[0m12:27:17.857217 [debug] [MainThread]: Flushing usage events
[0m12:27:19.868476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:16.193168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB15DF42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB13A69D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB16E33D90>]}


============================== 12:59:16.199613 | 6dc4bdb5-7a12-49e6-9b7b-6f6686e4731f ==============================
[0m12:59:16.199613 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:59:16.200559 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m12:59:16.448376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dc4bdb5-7a12-49e6-9b7b-6f6686e4731f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB1614F950>]}
[0m12:59:16.574788 [debug] [MainThread]: Command `dbt clean` succeeded at 12:59:16.574598 after 0.69 seconds
[0m12:59:16.575350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB16EAD8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB16EAD040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB1811C650>]}
[0m12:59:16.575897 [debug] [MainThread]: Flushing usage events
[0m12:59:17.966371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:22.089358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696FAE42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696D759D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970B23D90>]}


============================== 12:59:22.095708 | 9c7be5f4-ab89-49e0-a9a3-fbde73c20b14 ==============================
[0m12:59:22.095708 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:59:22.096674 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m12:59:22.330656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7be5f4-ab89-49e0-a9a3-fbde73c20b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002696FE3F950>]}
[0m12:59:22.388029 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-r1lq7of0'
[0m12:59:22.388705 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:59:24.241728 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:59:24.244701 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:59:24.941959 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:59:24.948363 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:59:26.132435 [info ] [MainThread]: Installed from version 1.3.0
[0m12:59:26.133167 [info ] [MainThread]: Up to date!
[0m12:59:26.133849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c7be5f4-ab89-49e0-a9a3-fbde73c20b14', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970B95590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026970B95F20>]}
[0m12:59:26.136279 [debug] [MainThread]: Command `dbt deps` succeeded at 12:59:26.136107 after 4.23 seconds
[0m12:59:26.136780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026971D41750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269709A28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026971CF47D0>]}
[0m12:59:26.137300 [debug] [MainThread]: Flushing usage events
[0m12:59:27.426135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:38.099090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024081EA42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240FFA99D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024082EEFD90>]}


============================== 12:59:38.106243 | 4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b ==============================
[0m12:59:38.106243 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:59:38.107273 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products stg_sessions_with_fx int_sessions_enriched --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m12:59:45.262363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024082207950>]}
[0m12:59:45.358470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A793AF10>]}
[0m12:59:45.359600 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m12:59:46.542941 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m12:59:46.544583 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:59:46.545304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A798C950>]}
[0m12:59:51.428630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A7EF6300>]}
[0m12:59:51.610479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m12:59:51.635633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m12:59:51.677051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A7A24210>]}
[0m12:59:51.677711 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m12:59:51.678443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A82F9BF0>]}
[0m12:59:51.681991 [info ] [MainThread]: 
[0m12:59:51.682682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:59:51.683336 [info ] [MainThread]: 
[0m12:59:51.684364 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:59:51.690638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:59:51.691504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:51.692490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m12:59:51.693299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:54.105304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m12:59:54.107115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:54.108816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m12:59:54.110762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:54.112729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m12:59:54.114338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:56.608899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A7FA1A90>]}
[0m12:59:56.610616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:56.625909 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m12:59:56.626781 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m12:59:56.627680 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m12:59:56.629615 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m12:59:56.628542 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m12:59:56.630514 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m12:59:56.631394 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m12:59:56.642640 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m12:59:56.643275 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m12:59:56.649824 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m12:59:56.654323 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m12:59:56.672741 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m12:59:56.706348 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m12:59:56.706909 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m12:59:56.711001 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170701'
                        and '20170801'
)

select *
from src;


[0m12:59:56.711724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:59:56.712414 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the date window controlled by vars.
with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)              as session_date,
    cast(fullVisitorId as string)                    as visitor_id,
    cast(visitId as string)                          as visit_id,
    geoNetwork.country                               as country,
    trafficSource.source                             as traffic_source,
    trafficSource.medium                             as traffic_medium,
    trafficSource.campaign                           as traffic_campaign,
    h.transaction.transactionId                      as transaction_id,
    p.productSKU                                     as product_sku,
    p.v2ProductName                                  as product_name,
    p.v2ProductCategory                              as product_category,
    p.productQuantity                                as product_quantity,
    -- GA prices are in micros in the export; treat as "local" at this stage
    safe_divide(p.productPrice, 1e6)                 as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6) as item_revenue_local
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between '20170701'
                        and '20170801'
    and p.productSKU is not null
)
select * from base;


[0m12:59:56.713237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:59.298838 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:77604c88-23a7-4fc1-8cd5-5d281221f012&page=queryresults
[0m12:59:59.308820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e0508279-8024-4402-83a5-8d890e47f021&page=queryresults
[0m13:00:02.643435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A84ECAA0>]}
[0m13:00:02.644078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A0EB2B70>]}
[0m13:00:02.645033 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 6.01s]
[0m13:00:02.647011 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m13:00:02.645892 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 6.01s]
[0m13:00:02.648434 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m13:00:02.649227 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m13:00:02.649917 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m13:00:02.650911 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m13:00:02.651445 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m13:00:02.656134 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m13:00:02.658353 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m13:00:02.662591 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m13:00:02.664807 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as 

with cc as (
  select country, currency
  from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
  select rate_date, currency, rate_to_usd
  from `e2e-dbt-project`.`ext`.`fx_rates`
),
s as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions
)
select
  s.session_date,
  s.visitor_id,
  s.visit_id,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  s.visits,
  s.transactions,
  s.revenue_usd as session_revenue_usd_raw,  -- may be null
  cc.currency    as local_currency,
  fx.rate_to_usd
from s
left join cc
  on lower(cc.country) = lower(s.country)
left join fx
  on fx.rate_date = s.session_date
 and fx.currency  = cc.currency;


[0m13:00:02.665526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:05.155207 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:61be5a87-1650-4b9b-8ddc-7848de01596e&page=queryresults
[0m13:00:05.728292 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A80306D0>]}
[0m13:00:05.730497 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 3.08s]
[0m13:00:05.733313 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m13:00:05.735660 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m13:00:05.737485 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m13:00:05.739916 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m13:00:05.741640 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m13:00:05.753512 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m13:00:05.758037 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m13:00:05.769266 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m13:00:05.772526 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

-- Silver: join item-level hits with session-day FX, compute USD metrics.
with sess as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),
items as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    -- local currency amounts from staging
    product_price_local,
    item_revenue_local
  from e2e-dbt-project.analytics_stg.stg_hits_products
),
joined as (
  select
    i.session_date,
    i.visitor_id,
    i.visit_id,
    i.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    i.transaction_id,
    i.product_sku,
    i.product_name,
    i.product_category,
    i.product_quantity,
    i.product_price_local,
    coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) as revenue_local,
    -- FX conversion at session_date granularity
    (i.product_price_local * s.rate_to_usd) as product_price_usd,
    (coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) * s.rate_to_usd) as revenue_usd,
    s.rate_to_usd,
    s.local_currency
  from items i
  left join sess s
    on s.session_date = i.session_date
   and s.visitor_id   = i.visitor_id
   and s.visit_id     = i.visit_id
   and lower(s.country) = lower(i.country)
)

select * from joined;


[0m13:00:05.774108 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:00:08.028943 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:49bfcbb4-57c6-4b2c-bb5f-27bec868318b&page=queryresults
[0m13:00:08.575542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6cd51c-8c6a-4e9c-8aa1-d6a97a1d7b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A84B2510>]}
[0m13:00:08.576836 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.84s]
[0m13:00:08.578170 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m13:00:08.580531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:08.583106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:08.583533 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m13:00:08.583939 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m13:00:08.584333 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:00:08.584723 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:00:08.585109 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:00:08.585494 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m13:00:08.585920 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m13:00:08.586306 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m13:00:08.586694 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m13:00:08.587180 [info ] [MainThread]: 
[0m13:00:08.587792 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 16.90 seconds (16.90s).
[0m13:00:08.589780 [debug] [MainThread]: Command end result
[0m13:00:08.629867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:00:08.632519 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:00:08.639079 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:00:08.639735 [info ] [MainThread]: 
[0m13:00:08.640370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:08.640947 [info ] [MainThread]: 
[0m13:00:08.641563 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:00:08.642987 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:08.642849 after 30.73 seconds
[0m13:00:08.643409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A8B17EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A8B143B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240A8B17D70>]}
[0m13:00:08.643838 [debug] [MainThread]: Flushing usage events
[0m13:00:09.828354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:43.551593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE915C42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F275D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9260FD90>]}


============================== 13:00:43.558494 | 9ebb1f0a-7d91-4331-9920-5c2317b500c3 ==============================
[0m13:00:43.558494 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:00:43.559519 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select dim_country dim_products dim_date fct_sales_item --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m13:00:46.881898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE91927950>]}
[0m13:00:46.950580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7056F10>]}
[0m13:00:46.951239 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:00:47.645924 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:00:47.897566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:47.897937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:47.970786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB70AD350>]}
[0m13:00:48.110395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:00:48.112922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:00:48.147720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB70ED7C0>]}
[0m13:00:48.148217 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m13:00:48.148832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7619D30>]}
[0m13:00:48.151473 [info ] [MainThread]: 
[0m13:00:48.152019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:00:48.152545 [info ] [MainThread]: 
[0m13:00:48.153234 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:00:48.158529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m13:00:48.158969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.814517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:00:49.815172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.815770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:00:49.816568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.817177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:00:49.817824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:51.793184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB783EA90>]}
[0m13:00:51.794158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:51.802559 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m13:00:51.803394 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m13:00:51.804010 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m13:00:51.804764 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m13:00:51.805403 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m13:00:51.806171 [info ] [Thread-4 (]: 4 of 4 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m13:00:51.808770 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m13:00:51.809554 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m13:00:51.807103 [info ] [Thread-3 (]: 3 of 4 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m13:00:51.810216 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m13:00:51.810730 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m13:00:51.807800 [info ] [Thread-2 (]: 2 of 4 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m13:00:51.811812 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m13:00:51.826891 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m13:00:51.842641 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m13:00:51.843356 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m13:00:51.843938 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m13:00:51.844723 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m13:00:51.848302 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m13:00:51.854986 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m13:00:51.856699 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m13:00:51.857636 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m13:00:51.877076 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:51.905877 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m13:00:51.909605 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:51.922135 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m13:00:51.940525 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:00:51.971077 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m13:00:52.055993 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_sku, product_category

    
    OPTIONS()
    as (
      

with base as (
  select * from e2e-dbt-project.analytics_int.int_sessions_enriched
)

select
  session_date,
  visitor_id,
  visit_id,
  country,
  traffic_source,
  traffic_medium,
  traffic_campaign,
  transaction_id,
  product_sku,
  product_name,
  product_category,
  product_quantity,
  product_price_usd,
  revenue_usd,
  revenue_local
from base


    );
  
[0m13:00:52.057023 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:00:54.006272 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m13:00:54.010815 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with src as (
  select
    product_sku,
    any_value(product_name)      as product_name,
    any_value(product_category)  as product_category
  from e2e-dbt-project.analytics_stg.stg_hits_products
  where product_sku is not null
  group by product_sku
)
select * from src
    );
  
[0m13:00:54.034035 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m13:00:54.045790 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      

-- Country ↔ Currency from ext mapping (avoid scanning GA)
select distinct
  initcap(country)        as country,
  currency                as local_currency
from `e2e-dbt-project`.`ext`.`country_currency`
where country is not null
  and currency is not null
    );
  
[0m13:00:54.085544 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m13:00:54.090058 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m13:00:54.702847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1457bc9d-e8da-4f78-ae51-df2a3e70a2e0&page=queryresults
[0m13:00:54.742757 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:89bcb80e-9912-422e-ba93-4757578a6f72&page=queryresults
[0m13:00:54.773178 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d462372a-7dfe-435d-8faf-739301e2d25b&page=queryresults
[0m13:00:54.812860 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:438618e9-2cdb-4b44-a371-b098f2101b8c&page=queryresults
[0m13:00:58.296690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7803950>]}
[0m13:00:58.297254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7856990>]}
[0m13:00:58.297926 [info ] [Thread-2 (]: 2 of 4 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (32.0 rows, 0 processed)[0m in 6.45s]
[0m13:00:58.299513 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m13:00:58.298652 [info ] [Thread-3 (]: 3 of 4 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (1.1k rows, 89.9 MiB processed)[0m in 6.48s]
[0m13:00:58.300448 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m13:01:02.351705 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB7927CF0>]}
[0m13:01:02.353957 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mCREATE TABLE (1.3m rows, 105.2 MiB processed)[0m in 10.54s]
[0m13:01:02.357047 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m13:01:05.828776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ebb1f0a-7d91-4331-9920-5c2317b500c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB75B62D0>]}
[0m13:01:05.829540 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (7.0 rows, 110.0 Bytes processed)[0m in 14.02s]
[0m13:01:05.830587 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m13:01:05.832468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:05.834939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:05.835371 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m13:01:05.835785 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:01:05.836185 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:01:05.836603 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:01:05.837047 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m13:01:05.837492 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m13:01:05.837877 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m13:01:05.838208 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m13:01:05.838794 [info ] [MainThread]: 
[0m13:01:05.839641 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 17.69 seconds (17.69s).
[0m13:01:05.842635 [debug] [MainThread]: Command end result
[0m13:01:05.902711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:01:05.906447 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:01:05.915582 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:01:05.916012 [info ] [MainThread]: 
[0m13:01:05.916630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:05.917221 [info ] [MainThread]: 
[0m13:01:05.918063 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:01:05.919348 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:05.919212 after 22.55 seconds
[0m13:01:05.919785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE9265CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8BEE8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEB77C7BF0>]}
[0m13:01:05.920342 [debug] [MainThread]: Flushing usage events
[0m13:01:07.135717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:31.804023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6DF8942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6DD509D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E08DBD90>]}


============================== 13:02:31.808915 | 33295bf8-e034-43ed-a406-d7046f8ce665 ==============================
[0m13:02:31.808915 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:02:31.809684 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m13:02:35.169276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33295bf8-e034-43ed-a406-d7046f8ce665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6DFBF3950>]}
[0m13:02:35.237912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33295bf8-e034-43ed-a406-d7046f8ce665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6843B2F10>]}
[0m13:02:35.238568 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:02:35.935277 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:02:36.175421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:36.175830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:36.244572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33295bf8-e034-43ed-a406-d7046f8ce665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68440D450>]}
[0m13:02:36.374067 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:02:36.376457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:02:36.452915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33295bf8-e034-43ed-a406-d7046f8ce665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C685BBAE40>]}
[0m13:02:36.453413 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m13:02:36.453996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33295bf8-e034-43ed-a406-d7046f8ce665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C685BAAA50>]}
[0m13:02:36.457802 [info ] [MainThread]: 
[0m13:02:36.458420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:36.458973 [info ] [MainThread]: 
[0m13:02:36.459698 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:02:36.464896 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:02:36.465257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:36.494560 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:02:36.495002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:36.525573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:02:36.526003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:38.420298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33295bf8-e034-43ed-a406-d7046f8ce665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C685C13C70>]}
[0m13:02:38.421004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:38.428745 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m13:02:38.429309 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:02:38.429822 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:02:38.430833 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:02:38.430361 [info ] [Thread-1 (]: 1 of 33 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m13:02:38.431412 [info ] [Thread-3 (]: 3 of 33 START test not_null_dim_date_dt ........................................ [RUN]
[0m13:02:38.433666 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m13:02:38.434430 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_date_dt.58a291f69b'
[0m13:02:38.434999 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m13:02:38.432083 [info ] [Thread-2 (]: 2 of 33 START test not_null_dim_country_country ................................ [RUN]
[0m13:02:38.435760 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:02:38.432642 [info ] [Thread-4 (]: 4 of 33 START test not_null_dim_products_product_sku ........................... [RUN]
[0m13:02:38.444190 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m13:02:38.462717 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m13:02:38.472939 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m13:02:38.473718 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343'
[0m13:02:38.474303 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:02:38.475248 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:02:38.480554 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m13:02:38.485150 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m13:02:38.486100 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:02:38.494120 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m13:02:38.524811 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m13:02:38.523042 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m13:02:38.525900 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:02:38.528724 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m13:02:38.529639 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:02:38.532095 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m13:02:38.533017 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m13:02:38.533740 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:02:38.534376 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_date_dt.58a291f69b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from e2e-dbt-project.analytics_mart.dim_date
where dt is null



  
  
      
    ) dbt_internal_test
[0m13:02:38.534899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:02:38.535778 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:02:38.536401 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:02:38.566541 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:02:38.567110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:02:40.872002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:319543c3-5017-4b5e-ad7c-e8ff29d68045&page=queryresults
[0m13:02:41.052101 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4ee9bc4c-aaff-494f-a75b-6222be4f6a6f&page=queryresults
[0m13:02:41.061743 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a56db5a-fc2e-45b8-b248-899ffe7db6ee&page=queryresults
[0m13:02:41.071662 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:98c615b6-421d-4af0-8106-0b51dc956545&page=queryresults
[0m13:02:42.076641 [info ] [Thread-3 (]: 3 of 33 PASS not_null_dim_date_dt .............................................. [[32mPASS[0m in 3.64s]
[0m13:02:42.077681 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:02:42.078149 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:02:42.078581 [info ] [Thread-3 (]: 5 of 33 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m13:02:42.079267 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_dt.58a291f69b, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m13:02:42.079706 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:02:42.083706 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m13:02:42.088410 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:02:42.091623 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m13:02:42.087778 [info ] [Thread-4 (]: 4 of 33 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.61s]
[0m13:02:42.093600 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:02:42.094101 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:02:42.094557 [info ] [Thread-4 (]: 6 of 33 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m13:02:42.096246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m13:02:42.098998 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:02:42.105115 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m13:02:42.105822 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:02:42.106515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:42.100733 [info ] [Thread-2 (]: 2 of 33 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 3.66s]
[0m13:02:42.107932 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:02:42.108498 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:02:42.108937 [info ] [Thread-2 (]: 7 of 33 START test not_null_fct_sales_item_revenue_local ....................... [RUN]
[0m13:02:42.109776 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:02:42.110316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392)
[0m13:02:42.166151 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m13:02:42.166964 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:02:42.177655 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m13:02:42.179304 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:02:42.180340 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:02:42.181372 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:02:42.229759 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m13:02:42.231732 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_local
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_local is null



  
  
      
    ) dbt_internal_test
[0m13:02:42.232413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:43.633661 [error] [Thread-1 (]: 1 of 33 FAIL 105 dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[31mFAIL 105[0m in 5.20s]
[0m13:02:43.634571 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m13:02:43.634972 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:02:43.635498 [info ] [Thread-1 (]: 8 of 33 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m13:02:43.636028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m13:02:43.636382 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:02:43.639763 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m13:02:43.640730 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:02:43.643210 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m13:02:43.644122 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m13:02:43.644532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:44.232806 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:000c74a1-5a52-405a-b453-a17395d2fb94&page=queryresults
[0m13:02:44.743467 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b6adada1-4a07-41c3-b1dc-2921b8b3d5be&page=queryresults
[0m13:02:44.744424 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:db58d126-2165-4987-96c0-2a0e70b147a3&page=queryresults
[0m13:02:45.315287 [info ] [Thread-3 (]: 5 of 33 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.24s]
[0m13:02:45.319449 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:02:45.321355 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:02:45.324357 [info ] [Thread-3 (]: 9 of 33 START test not_null_fct_sales_item_session_date ........................ [RUN]
[0m13:02:45.325438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m13:02:45.325934 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:02:45.330459 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m13:02:45.332188 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:02:45.335759 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m13:02:45.336982 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m13:02:45.337512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:45.615676 [error] [Thread-2 (]: 7 of 33 FAIL 1275554 not_null_fct_sales_item_revenue_local ..................... [[31mFAIL 1275554[0m in 3.51s]
[0m13:02:45.616671 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:02:45.617045 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:02:45.617392 [info ] [Thread-2 (]: 10 of 33 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m13:02:45.618001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m13:02:45.618401 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:02:45.622029 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m13:02:45.622995 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:02:45.625536 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m13:02:45.626441 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m13:02:45.626851 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:45.658143 [info ] [Thread-4 (]: 6 of 33 PASS not_null_fct_sales_item_product_sku ............................... [[32mPASS[0m in 3.56s]
[0m13:02:45.659167 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:02:45.659616 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:02:45.660018 [info ] [Thread-4 (]: 11 of 33 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m13:02:45.662541 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m13:02:45.662953 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:02:45.666794 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m13:02:45.667945 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:02:45.670089 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m13:02:45.671182 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m13:02:45.671893 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:02:45.793796 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:170ee602-86ba-44a8-bf34-a9ad1f9d69c6&page=queryresults
[0m13:02:46.677369 [error] [Thread-1 (]: 8 of 33 FAIL 1279041 not_null_fct_sales_item_revenue_usd ....................... [[31mFAIL 1279041[0m in 3.04s]
[0m13:02:46.678316 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:02:46.678725 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:02:46.679098 [info ] [Thread-1 (]: 12 of 33 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m13:02:46.679692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m13:02:46.680097 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:02:46.683851 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m13:02:46.685042 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:02:46.687537 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m13:02:46.688802 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:02:46.689447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:47.337739 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:66cecb72-6fce-4b01-bf84-fa631a293170&page=queryresults
[0m13:02:47.816162 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:66edccff-c3bc-4134-9fa7-b880e69dee92&page=queryresults
[0m13:02:47.845921 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:137e6a9b-2e33-41bb-abb3-13a057142ee2&page=queryresults
[0m13:02:48.200061 [info ] [Thread-3 (]: 9 of 33 PASS not_null_fct_sales_item_session_date .............................. [[32mPASS[0m in 2.87s]
[0m13:02:48.201162 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:02:48.201700 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:02:48.202198 [info ] [Thread-3 (]: 13 of 33 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m13:02:48.202933 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m13:02:48.203431 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:02:48.208049 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m13:02:48.209216 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:02:48.212497 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m13:02:48.213619 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:02:48.214287 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:48.729051 [error] [Thread-2 (]: 10 of 33 FAIL 1293662 not_null_fct_sales_item_transaction_id ................... [[31mFAIL 1293662[0m in 3.11s]
[0m13:02:48.729959 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:02:48.730370 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:02:48.730747 [info ] [Thread-2 (]: 14 of 33 START test not_null_product_categories_product_category ............... [RUN]
[0m13:02:48.731327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m13:02:48.731698 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:02:48.735934 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m13:02:48.737942 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:02:48.748503 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m13:02:48.750581 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m13:02:48.751544 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:48.837542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:21631bfc-526e-4b40-8dd2-3dd92f776c21&page=queryresults
[0m13:02:50.250849 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:082692d7-2670-4ece-8899-643d679333e0&page=queryresults
[0m13:02:50.631901 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:05863b0f-0529-478c-996d-a7a865ba510c&page=queryresults
[0m13:02:51.154369 [info ] [Thread-4 (]: 11 of 33 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 5.49s]
[0m13:02:51.155722 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:02:51.156181 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:02:51.156605 [info ] [Thread-4 (]: 15 of 33 START test not_null_product_categories_product_sku .................... [RUN]
[0m13:02:51.157272 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m13:02:51.157737 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:02:51.162149 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m13:02:51.163366 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:02:51.166729 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m13:02:51.167926 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:02:51.168495 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:02:51.621458 [info ] [Thread-2 (]: 14 of 33 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 2.89s]
[0m13:02:51.622330 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:02:51.622720 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:02:51.623084 [info ] [Thread-2 (]: 16 of 33 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m13:02:51.623650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m13:02:51.624009 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:02:51.627458 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m13:02:51.636061 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:02:51.639135 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m13:02:51.640442 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:02:51.641177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:51.841943 [info ] [Thread-1 (]: 12 of 33 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 5.16s]
[0m13:02:51.842823 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:02:51.843225 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:02:51.843597 [info ] [Thread-1 (]: 17 of 33 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m13:02:51.844173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m13:02:51.844539 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:02:51.848094 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m13:02:51.849032 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:02:51.851068 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m13:02:51.851953 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m13:02:51.852348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:53.033359 [info ] [Thread-3 (]: 13 of 33 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 4.83s]
[0m13:02:53.034218 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:02:53.034608 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:02:53.034975 [info ] [Thread-3 (]: 18 of 33 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m13:02:53.035538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m13:02:53.035888 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:02:53.040382 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m13:02:53.041648 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:02:53.044333 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m13:02:53.045390 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:02:53.045900 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:53.111142 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c554304c-f641-486d-9c39-66b4899ed470&page=queryresults
[0m13:02:53.561872 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c3c236ed-9e58-4c67-bd41-7267e8407f74&page=queryresults
[0m13:02:53.752621 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:559d1085-20d1-4c1d-a439-9a64baaf93ef&page=queryresults
[0m13:02:54.048295 [info ] [Thread-4 (]: 15 of 33 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 2.89s]
[0m13:02:54.049595 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:02:54.050258 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:02:54.050894 [info ] [Thread-4 (]: 19 of 33 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m13:02:54.051819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m13:02:54.052411 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:02:54.057662 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m13:02:54.058876 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:02:54.061942 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m13:02:54.063273 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:02:54.063883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:02:55.052998 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f3a6bca7-0d30-4764-b918-d2d655e72ac3&page=queryresults
[0m13:02:55.226218 [info ] [Thread-1 (]: 17 of 33 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.38s]
[0m13:02:55.227183 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:02:55.227632 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:02:55.228048 [info ] [Thread-1 (]: 20 of 33 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m13:02:55.228647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m13:02:55.229066 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:02:55.233014 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m13:02:55.234197 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:02:55.236826 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m13:02:55.237928 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m13:02:55.238449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:55.986310 [info ] [Thread-2 (]: 16 of 33 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 4.36s]
[0m13:02:55.987458 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:02:55.987983 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:02:55.988550 [info ] [Thread-2 (]: 21 of 33 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m13:02:55.989307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m13:02:55.989739 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:02:55.993921 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m13:02:55.994954 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:02:55.997645 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m13:02:55.998598 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m13:02:55.999196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:56.104166 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:91705852-f4eb-4644-9cc1-e0261287740f&page=queryresults
[0m13:02:57.115413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1d8adf46-7614-49f3-8efa-b870ebfe9945&page=queryresults
[0m13:02:57.248756 [info ] [Thread-3 (]: 18 of 33 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 4.21s]
[0m13:02:57.249742 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:02:57.250196 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:02:57.250621 [info ] [Thread-3 (]: 22 of 33 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m13:02:57.251268 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m13:02:57.251670 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:02:57.255626 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m13:02:57.257547 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:02:57.260520 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m13:02:57.262228 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m13:02:57.262717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:02:57.846553 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3ed7f5ff-ee22-406f-9876-df0c77fba0ba&page=queryresults
[0m13:02:57.985483 [info ] [Thread-1 (]: 20 of 33 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.76s]
[0m13:02:57.990352 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:02:57.993296 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:02:57.996205 [info ] [Thread-1 (]: 23 of 33 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m13:02:58.001001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m13:02:58.002680 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:02:58.017341 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m13:02:58.019505 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:02:58.025366 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m13:02:58.027294 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m13:02:58.027981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:58.261340 [info ] [Thread-4 (]: 19 of 33 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 4.21s]
[0m13:02:58.262963 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:02:58.263867 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:02:58.264731 [info ] [Thread-4 (]: 24 of 33 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m13:02:58.265655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m13:02:58.266071 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:02:58.270092 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m13:02:58.271376 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:02:58.276885 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m13:02:58.278855 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m13:02:58.279817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:02:58.692194 [info ] [Thread-2 (]: 21 of 33 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.70s]
[0m13:02:58.693783 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:02:58.694674 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m13:02:58.695602 [info ] [Thread-2 (]: 25 of 33 START test stg_hits_products_quality .................................. [RUN]
[0m13:02:58.696462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m13:02:58.696910 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m13:02:58.701112 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m13:02:58.702862 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m13:02:58.707699 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m13:02:58.709537 [debug] [Thread-2 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m13:02:58.710274 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:02:59.858187 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:862928dc-aadb-45a7-bc61-959cb86fe441&page=queryresults
[0m13:03:00.281476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5f24299d-3115-44cc-bc4e-946145016e6a&page=queryresults
[0m13:03:00.821943 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e8e99b11-29bc-428e-8e73-0af7a54276f6&page=queryresults
[0m13:03:00.841974 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f553d31b-d1da-4de8-bd85-7ee7f620b9ce&page=queryresults
[0m13:03:00.970966 [info ] [Thread-3 (]: 22 of 33 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.72s]
[0m13:03:00.974357 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:03:00.976085 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:03:00.977648 [info ] [Thread-3 (]: 26 of 33 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m13:03:00.979299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m13:03:00.980908 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:03:00.986775 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m13:03:00.988496 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:03:00.992780 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m13:03:00.994266 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m13:03:00.994904 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:03:01.211752 [info ] [Thread-1 (]: 23 of 33 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.21s]
[0m13:03:01.212648 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:03:01.213062 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:03:01.213444 [info ] [Thread-1 (]: 27 of 33 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m13:03:01.214068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m13:03:01.214465 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:03:01.217726 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m13:03:01.219709 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:03:01.225324 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m13:03:01.227457 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m13:03:01.227980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:01.319618 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e8e99b11-29bc-428e-8e73-0af7a54276f6&page=queryresults
[0m13:03:01.649674 [debug] [Thread-2 (]: Database Error in test stg_hits_products_quality (tests\stg_hits_products_quality.sql)
  Unrecognized name: product_price_usd; Did you mean product_price_local? at [20:7]
  compiled code at target\run\ga_retail_project\tests\stg_hits_products_quality.sql
[0m13:03:01.650316 [error] [Thread-2 (]: 25 of 33 ERROR stg_hits_products_quality ....................................... [[31mERROR[0m in 2.95s]
[0m13:03:01.651189 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m13:03:01.651724 [debug] [Thread-2 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m13:03:01.652748 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.stg_hits_products_quality' to be skipped because of status 'error'.  Reason: Database Error in test stg_hits_products_quality (tests\stg_hits_products_quality.sql)
  Unrecognized name: product_price_usd; Did you mean product_price_local? at [20:7]
  compiled code at target\run\ga_retail_project\tests\stg_hits_products_quality.sql.
[0m13:03:01.652140 [info ] [Thread-2 (]: 28 of 33 START test test_non_negative_values ................................... [RUN]
[0m13:03:01.654077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.test_non_negative_values)
[0m13:03:01.654516 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m13:03:01.657231 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m13:03:01.658275 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m13:03:01.661049 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m13:03:01.662025 [debug] [Thread-2 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m13:03:01.662476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:03:02.052105 [info ] [Thread-4 (]: 24 of 33 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.79s]
[0m13:03:02.053093 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:03:02.053466 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:03:02.053830 [info ] [Thread-4 (]: 29 of 33 START test unique_dim_country_country ................................. [RUN]
[0m13:03:02.054400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m13:03:02.054752 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:03:02.061432 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m13:03:02.062547 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:03:02.065375 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m13:03:02.066309 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:03:02.066730 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:03:03.031074 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:46db2234-259d-4773-a472-2a575b0be14f&page=queryresults
[0m13:03:03.854137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b3134cc5-ee42-4544-aa47-b90201b57fa5&page=queryresults
[0m13:03:04.195203 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c1408aec-d103-4ae8-9101-37316cb2ebc3&page=queryresults
[0m13:03:04.243416 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b3134cc5-ee42-4544-aa47-b90201b57fa5&page=queryresults
[0m13:03:04.265073 [debug] [Thread-1 (]: Database Error in test stg_sessions_with_fx_local_nonnegative (tests\stg_sessions_with_fx_local_nonnegative.sql)
  Unrecognized name: revenue_local at [13:7]
  compiled code at target\run\ga_retail_project\tests\stg_sessions_with_fx_local_nonnegative.sql
[0m13:03:04.266250 [error] [Thread-1 (]: 27 of 33 ERROR stg_sessions_with_fx_local_nonnegative .......................... [[31mERROR[0m in 3.05s]
[0m13:03:04.267762 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:03:04.268542 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:03:04.269532 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' to be skipped because of status 'error'.  Reason: Database Error in test stg_sessions_with_fx_local_nonnegative (tests\stg_sessions_with_fx_local_nonnegative.sql)
  Unrecognized name: revenue_local at [13:7]
  compiled code at target\run\ga_retail_project\tests\stg_sessions_with_fx_local_nonnegative.sql.
[0m13:03:04.270110 [info ] [Thread-1 (]: 30 of 33 START test unique_dim_date_dt ......................................... [RUN]
[0m13:03:04.271674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_with_fx_local_nonnegative, now test.ga_retail_project.unique_dim_date_dt.bbad368071)
[0m13:03:04.272398 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:03:04.277907 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m13:03:04.279181 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:03:04.282530 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m13:03:04.283796 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_date_dt.bbad368071: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_dt.bbad368071"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select dt as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where dt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:03:04.284328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:04.442609 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:18afebb8-017f-4b89-9ac9-ff03a40abc91&page=queryresults
[0m13:03:05.255005 [info ] [Thread-2 (]: 28 of 33 PASS test_non_negative_values ......................................... [[32mPASS[0m in 3.60s]
[0m13:03:05.256100 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m13:03:05.256529 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:03:05.256907 [info ] [Thread-2 (]: 31 of 33 START test unique_dim_products_product_sku ............................ [RUN]
[0m13:03:05.257503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m13:03:05.257897 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:03:05.261583 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m13:03:05.262527 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:03:05.265107 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m13:03:05.266028 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:03:05.266463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:03:05.366391 [info ] [Thread-4 (]: 29 of 33 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 3.31s]
[0m13:03:05.367297 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:03:05.367733 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:03:05.368241 [info ] [Thread-4 (]: 32 of 33 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m13:03:05.368846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_country_country.11db8eecec, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m13:03:05.369258 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:03:05.373360 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m13:03:05.374575 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:03:05.377617 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m13:03:05.378691 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:03:05.379159 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:03:06.176684 [info ] [Thread-3 (]: 26 of 33 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 5.20s]
[0m13:03:06.177652 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:03:06.178100 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:03:06.178519 [info ] [Thread-3 (]: 33 of 33 START test unique_product_categories_product_sku ...................... [RUN]
[0m13:03:06.179173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m13:03:06.179587 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:03:06.183477 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m13:03:06.193252 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:03:06.196214 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m13:03:06.197945 [debug] [Thread-3 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:03:06.198428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:03:06.414881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:98b3029f-cde9-454c-956a-6c2103d7c3d5&page=queryresults
[0m13:03:07.247984 [info ] [Thread-1 (]: 30 of 33 PASS unique_dim_date_dt ............................................... [[32mPASS[0m in 2.98s]
[0m13:03:07.248944 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:03:07.474950 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c5564987-c426-407e-88cd-013328aa4fd4&page=queryresults
[0m13:03:07.748359 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:387adc8b-1209-43a7-ae6a-8a7f48df1561&page=queryresults
[0m13:03:08.106281 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef546cbf-abae-4980-8f7a-d2a4ae05f79e&page=queryresults
[0m13:03:08.395900 [info ] [Thread-4 (]: 32 of 33 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 3.03s]
[0m13:03:08.399114 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:03:08.629532 [info ] [Thread-2 (]: 31 of 33 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 3.37s]
[0m13:03:08.630567 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:03:09.059794 [info ] [Thread-3 (]: 33 of 33 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 2.88s]
[0m13:03:09.063072 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:03:09.068814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:09.075570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:09.076985 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:03:09.078203 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:03:09.079426 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:03:09.080628 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_date_dt.bbad368071' was properly closed.
[0m13:03:09.081807 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m13:03:09.083009 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m13:03:09.084206 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m13:03:09.085641 [info ] [MainThread]: 
[0m13:03:09.087878 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 32.63 seconds (32.63s).
[0m13:03:09.113165 [debug] [MainThread]: Command end result
[0m13:03:09.162400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:03:09.165076 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:03:09.174481 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:03:09.174887 [info ] [MainThread]: 
[0m13:03:09.175489 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m13:03:09.176052 [info ] [MainThread]: 
[0m13:03:09.176681 [error] [MainThread]: [31mFailure in test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id (models\staging\staging_models.yml)[0m
[0m13:03:09.177308 [error] [MainThread]:   Got 105 results, configured to fail if != 0
[0m13:03:09.177821 [info ] [MainThread]: 
[0m13:03:09.178426 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\staging_models.yml\dbt_utils_unique_combination_o_ea8315e99b7db9b922a6af28250029c7.sql
[0m13:03:09.178976 [info ] [MainThread]: 
[0m13:03:09.179597 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_revenue_local (models\mart\mart_models.yml)[0m
[0m13:03:09.180200 [error] [MainThread]:   Got 1275554 results, configured to fail if != 0
[0m13:03:09.180714 [info ] [MainThread]: 
[0m13:03:09.181326 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_revenue_local.sql
[0m13:03:09.181851 [info ] [MainThread]: 
[0m13:03:09.182426 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_revenue_usd (models\mart\mart_models.yml)[0m
[0m13:03:09.182971 [error] [MainThread]:   Got 1279041 results, configured to fail if != 0
[0m13:03:09.183428 [info ] [MainThread]: 
[0m13:03:09.184002 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_revenue_usd.sql
[0m13:03:09.184479 [info ] [MainThread]: 
[0m13:03:09.185029 [error] [MainThread]: [31mFailure in test not_null_fct_sales_item_transaction_id (models\mart\mart_models.yml)[0m
[0m13:03:09.185585 [error] [MainThread]:   Got 1293662 results, configured to fail if != 0
[0m13:03:09.186068 [info ] [MainThread]: 
[0m13:03:09.186628 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\not_null_fct_sales_item_transaction_id.sql
[0m13:03:09.187125 [info ] [MainThread]: 
[0m13:03:09.187695 [error] [MainThread]: [31mFailure in test stg_hits_products_quality (tests\stg_hits_products_quality.sql)[0m
[0m13:03:09.188488 [error] [MainThread]:   Database Error in test stg_hits_products_quality (tests\stg_hits_products_quality.sql)
  Unrecognized name: product_price_usd; Did you mean product_price_local? at [20:7]
  compiled code at target\run\ga_retail_project\tests\stg_hits_products_quality.sql
[0m13:03:09.188999 [info ] [MainThread]: 
[0m13:03:09.189605 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\tests\stg_hits_products_quality.sql
[0m13:03:09.190087 [info ] [MainThread]: 
[0m13:03:09.190748 [error] [MainThread]: [31mFailure in test stg_sessions_with_fx_local_nonnegative (tests\stg_sessions_with_fx_local_nonnegative.sql)[0m
[0m13:03:09.191350 [error] [MainThread]:   Database Error in test stg_sessions_with_fx_local_nonnegative (tests\stg_sessions_with_fx_local_nonnegative.sql)
  Unrecognized name: revenue_local at [13:7]
  compiled code at target\run\ga_retail_project\tests\stg_sessions_with_fx_local_nonnegative.sql
[0m13:03:09.191858 [info ] [MainThread]: 
[0m13:03:09.192408 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\tests\stg_sessions_with_fx_local_nonnegative.sql
[0m13:03:09.192923 [info ] [MainThread]: 
[0m13:03:09.193432 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=33
[0m13:03:09.194639 [debug] [MainThread]: Command `dbt test` failed at 13:03:09.194513 after 37.59 seconds
[0m13:03:09.195044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E08907D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C685FC9E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C685FC8470>]}
[0m13:03:09.195441 [debug] [MainThread]: Flushing usage events
[0m13:03:10.319761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:43.606673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258219242F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002581F599D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025822963D90>]}


============================== 13:10:43.612943 | e3d80b0c-ead3-4232-b895-70d929e12fb5 ==============================
[0m13:10:43.612943 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:10:43.613991 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:10:43.842765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d80b0c-ead3-4232-b895-70d929e12fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025821C7F950>]}
[0m13:10:43.993542 [debug] [MainThread]: Command `dbt clean` succeeded at 13:10:43.993346 after 0.64 seconds
[0m13:10:43.994090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258229D98C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258229D9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025823B5C650>]}
[0m13:10:43.994633 [debug] [MainThread]: Flushing usage events
[0m13:10:45.375953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:53.904392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E11E42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154DEE7DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E2223D90>]}


============================== 13:10:53.910862 | 38a30185-de53-46a1-af23-b23d5a3f6777 ==============================
[0m13:10:53.910862 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:10:53.911845 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:10:54.147706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38a30185-de53-46a1-af23-b23d5a3f6777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E1543950>]}
[0m13:10:54.196328 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-ea_j45h0'
[0m13:10:54.196923 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:10:56.217049 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:10:56.219060 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:10:56.907746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:10:56.914767 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:10:58.012389 [info ] [MainThread]: Installed from version 1.3.0
[0m13:10:58.013154 [info ] [MainThread]: Up to date!
[0m13:10:58.013833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38a30185-de53-46a1-af23-b23d5a3f6777', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E22A1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E22A1F20>]}
[0m13:10:58.016366 [debug] [MainThread]: Command `dbt deps` succeeded at 13:10:58.016172 after 4.31 seconds
[0m13:10:58.016892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E34E1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E20A28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154E34947D0>]}
[0m13:10:58.017424 [debug] [MainThread]: Flushing usage events
[0m13:10:59.420860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:11.264142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB89BF42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB87869D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB8AC3BD90>]}


============================== 13:11:11.268795 | 84cf89ef-64db-4a5e-a65a-4f980c0a079a ==============================
[0m13:11:11.268795 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:11:11.269583 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products stg_sessions_with_fx int_sessions_enriched --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:11:14.665768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB89F57950>]}
[0m13:11:14.728985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAE6BAF10>]}
[0m13:11:14.729594 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:11:15.493450 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:11:15.494842 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:11:15.495485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAE70C950>]}
[0m13:11:18.095767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAFC47C50>]}
[0m13:11:18.226710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:11:18.237330 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:11:18.272115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAE7435B0>]}
[0m13:11:18.272622 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m13:11:18.273201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB0021BF0>]}
[0m13:11:18.275912 [info ] [MainThread]: 
[0m13:11:18.276614 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:18.277177 [info ] [MainThread]: 
[0m13:11:18.277894 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:11:18.282583 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m13:11:18.283012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:18.283954 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m13:11:18.284384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:20.194627 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:11:20.195646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:20.196296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:11:20.196712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:20.262077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:11:20.262511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:22.176131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB0051B50>]}
[0m13:11:22.176745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:22.183918 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m13:11:22.185091 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m13:11:22.184614 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m13:11:22.186457 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m13:11:22.186949 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m13:11:22.196637 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m13:11:22.185700 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m13:11:22.197837 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m13:11:22.198334 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m13:11:22.203796 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m13:11:22.207509 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m13:11:22.208285 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m13:11:22.258891 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m13:11:22.260959 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m13:11:22.264363 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170701'
                        and '20170801'
)

select *
from src;


[0m13:11:22.265036 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:22.265726 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the date window controlled by vars.
with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)              as session_date,
    cast(fullVisitorId as string)                    as visitor_id,
    cast(visitId as string)                          as visit_id,
    geoNetwork.country                               as country,
    trafficSource.source                             as traffic_source,
    trafficSource.medium                             as traffic_medium,
    trafficSource.campaign                           as traffic_campaign,
    h.transaction.transactionId                      as transaction_id,
    p.productSKU                                     as product_sku,
    p.v2ProductName                                  as product_name,
    p.v2ProductCategory                              as product_category,
    p.productQuantity                                as product_quantity,
    -- GA prices are in micros in the export; treat as "local" at this stage
    safe_divide(p.productPrice, 1e6)                 as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6) as item_revenue_local
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between '20170701'
                        and '20170801'
    and p.productSKU is not null
)
select * from base;


[0m13:11:22.266344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:24.417241 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1d7469ba-6335-4ed5-86b8-379c94798962&page=queryresults
[0m13:11:24.435140 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:948614e1-7be6-4581-b21b-8acb2c26e345&page=queryresults
[0m13:11:25.137907 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB0248AA0>]}
[0m13:11:25.139037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB89F34230>]}
[0m13:11:25.138668 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.94s]
[0m13:11:25.140477 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m13:11:25.141330 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m13:11:25.139688 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.95s]
[0m13:11:25.142702 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m13:11:25.141906 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m13:11:25.143809 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m13:11:25.144245 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m13:11:25.147986 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m13:11:25.149257 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m13:11:25.152874 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m13:11:25.154275 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as 

with cc as (
  select country, currency
  from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
  select rate_date, currency, rate_to_usd
  from `e2e-dbt-project`.`ext`.`fx_rates`
),
s as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions
)
select
  s.session_date,
  s.visitor_id,
  s.visit_id,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  s.visits,
  s.transactions,
  s.revenue_usd as session_revenue_usd_raw,  -- may be null
  cc.currency    as local_currency,
  fx.rate_to_usd
from s
left join cc
  on lower(cc.country) = lower(s.country)
left join fx
  on fx.rate_date = s.session_date
 and fx.currency  = cc.currency;


[0m13:11:25.154791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:26.990205 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9e7e0eb4-73ff-43ee-8c30-a14e75834eb1&page=queryresults
[0m13:11:27.563520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB023A5D0>]}
[0m13:11:27.564354 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m13:11:27.565413 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m13:11:27.566362 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m13:11:27.566956 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m13:11:27.567835 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m13:11:27.568313 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m13:11:27.572163 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m13:11:27.573655 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m13:11:27.577488 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m13:11:27.579643 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

-- Silver: join item-level hits with session-day FX, compute USD metrics.
with sess as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),
items as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    -- local currency amounts from staging
    product_price_local,
    item_revenue_local
  from e2e-dbt-project.analytics_stg.stg_hits_products
),
joined as (
  select
    i.session_date,
    i.visitor_id,
    i.visit_id,
    i.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    i.transaction_id,
    i.product_sku,
    i.product_name,
    i.product_category,
    i.product_quantity,
    i.product_price_local,
    coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) as revenue_local,
    -- FX conversion at session_date granularity
    (i.product_price_local * s.rate_to_usd) as product_price_usd,
    (coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) * s.rate_to_usd) as revenue_usd,
    s.rate_to_usd,
    s.local_currency
  from items i
  left join sess s
    on s.session_date = i.session_date
   and s.visitor_id   = i.visitor_id
   and s.visit_id     = i.visit_id
   and lower(s.country) = lower(i.country)
)

select * from joined;


[0m13:11:27.580552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:11:29.772381 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d643afbb-3f0c-4e94-914a-ab42a9bbc336&page=queryresults
[0m13:11:30.364308 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84cf89ef-64db-4a5e-a65a-4f980c0a079a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB0204360>]}
[0m13:11:30.366641 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.80s]
[0m13:11:30.369303 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m13:11:30.373733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:30.379949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:30.381118 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m13:11:30.382130 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m13:11:30.383167 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:11:30.384162 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:11:30.385160 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:11:30.386139 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m13:11:30.387143 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m13:11:30.388115 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m13:11:30.389100 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m13:11:30.390332 [info ] [MainThread]: 
[0m13:11:30.392193 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 12.11 seconds (12.11s).
[0m13:11:30.398157 [debug] [MainThread]: Command end result
[0m13:11:30.446998 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:11:30.449855 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:11:30.456938 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:11:30.457302 [info ] [MainThread]: 
[0m13:11:30.458082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:30.458805 [info ] [MainThread]: 
[0m13:11:30.459844 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:11:30.461518 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:30.461362 after 19.33 seconds
[0m13:11:30.461988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAFF6DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB0847E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB0847E30>]}
[0m13:11:30.462456 [debug] [MainThread]: Flushing usage events
[0m13:11:31.683656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:38.091956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2FAF42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2D769D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A30B3BD90>]}


============================== 13:11:38.097620 | d5028c74-b7aa-4ca9-9a45-060494007ebf ==============================
[0m13:11:38.097620 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:11:38.098479 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_country dim_products dim_date fct_sales_item --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:11:41.541361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2FE57950>]}
[0m13:11:41.606909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5462AF10>]}
[0m13:11:41.607559 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:11:42.312774 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:11:42.574135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:42.574551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:42.649263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5467D350>]}
[0m13:11:42.783046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:11:42.785438 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:11:42.819610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A546C17C0>]}
[0m13:11:42.820094 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m13:11:42.820666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55BB9D30>]}
[0m13:11:42.823247 [info ] [MainThread]: 
[0m13:11:42.823926 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:42.824474 [info ] [MainThread]: 
[0m13:11:42.825368 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:11:42.829809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m13:11:42.830203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:44.446312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:11:44.447953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:44.449164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:11:44.450859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:44.452295 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:11:44.453435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:46.422153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55D64AE0>]}
[0m13:11:46.422754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:46.432095 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m13:11:46.433087 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m13:11:46.433987 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m13:11:46.434884 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m13:11:46.436100 [info ] [Thread-4 (]: 4 of 4 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m13:11:46.437473 [info ] [Thread-3 (]: 3 of 4 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m13:11:46.438437 [info ] [Thread-2 (]: 2 of 4 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m13:11:46.441046 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m13:11:46.439692 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m13:11:46.442446 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_products'
[0m13:11:46.443459 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m13:11:46.444470 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m13:11:46.445643 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m13:11:46.446612 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m13:11:46.447534 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m13:11:46.482736 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m13:11:46.483834 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m13:11:46.491056 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m13:11:46.498305 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m13:11:46.505113 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m13:11:46.508539 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m13:11:46.509370 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m13:11:46.510075 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m13:11:46.535196 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m13:11:46.601247 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:46.601848 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:11:46.606403 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:46.611449 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:48.941563 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m13:11:48.942887 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m13:11:48.945352 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m13:11:48.958280 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m13:11:48.960635 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m13:11:48.962321 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with src as (
  select
    product_sku,
    any_value(product_name)      as product_name,
    any_value(product_category)  as product_category
  from e2e-dbt-project.analytics_stg.stg_hits_products
  where product_sku is not null
  group by product_sku
)
select * from src
    );
  
[0m13:11:48.964108 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_sku, product_category

    
    OPTIONS()
    as (
      

with base as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
  from e2e-dbt-project.analytics_int.int_sessions_enriched
  -- Keep only true sales lines
  where transaction_id is not null
    and coalesce(revenue_usd, 0) > 0
    and coalesce(product_quantity, 0) > 0
)

select * from base


    );
  
[0m13:11:48.964704 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      

-- Country ↔ Currency from ext mapping (avoid scanning GA)
select distinct
  initcap(country)        as country,
  currency                as local_currency
from `e2e-dbt-project`.`ext`.`country_currency`
where country is not null
  and currency is not null
    );
  
[0m13:11:49.590356 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2362cd4e-d218-47ba-b0ee-cf3de6be1470&page=queryresults
[0m13:11:49.770952 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:758b7270-d15f-47d2-bdf1-1f62b1ce2340&page=queryresults
[0m13:11:49.790217 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7341f2be-c86a-4f3a-89dc-37ceb3d3cffc&page=queryresults
[0m13:11:49.841314 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9147e774-d660-42a3-827a-66979fbae9b2&page=queryresults
[0m13:11:52.201220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55D9F050>]}
[0m13:11:52.202050 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (7.0 rows, 110.0 Bytes processed)[0m in 5.75s]
[0m13:11:52.203067 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m13:11:52.892617 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55DF9A70>]}
[0m13:11:52.894477 [info ] [Thread-2 (]: 2 of 4 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (32.0 rows, 0 processed)[0m in 6.45s]
[0m13:11:52.896876 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m13:11:53.116783 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A5622B610>]}
[0m13:11:53.119211 [info ] [Thread-3 (]: 3 of 4 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (1.1k rows, 89.9 MiB processed)[0m in 6.67s]
[0m13:11:53.122307 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m13:11:55.448401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5028c74-b7aa-4ca9-9a45-060494007ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A558454D0>]}
[0m13:11:55.450923 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mCREATE TABLE (3.8k rows, 105.2 MiB processed)[0m in 9.01s]
[0m13:11:55.454085 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m13:11:55.459246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:55.465815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:55.467091 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m13:11:55.468307 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:11:55.469470 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:11:55.470339 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:11:55.471177 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m13:11:55.472012 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m13:11:55.472833 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m13:11:55.473654 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m13:11:55.474592 [info ] [MainThread]: 
[0m13:11:55.475604 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 12.65 seconds (12.65s).
[0m13:11:55.478728 [debug] [MainThread]: Command end result
[0m13:11:55.523693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:11:55.526607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:11:55.533971 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:11:55.534373 [info ] [MainThread]: 
[0m13:11:55.535000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:55.535553 [info ] [MainThread]: 
[0m13:11:55.536141 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:11:55.537475 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:55.537341 after 17.59 seconds
[0m13:11:55.537902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A30B8CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2A468440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A55E84830>]}
[0m13:11:55.538331 [debug] [MainThread]: Flushing usage events
[0m13:11:56.878794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:50.288086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265031942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026500DF9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265041DFD90>]}


============================== 13:12:50.293319 | 817643dc-d70c-499f-af94-3864640e8647 ==============================
[0m13:12:50.293319 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:12:50.294148 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:12:53.969699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '817643dc-d70c-499f-af94-3864640e8647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265034EF950>]}
[0m13:12:54.041725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '817643dc-d70c-499f-af94-3864640e8647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026527C52F10>]}
[0m13:12:54.042463 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:12:54.887771 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:12:55.168442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:55.169139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:55.256430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817643dc-d70c-499f-af94-3864640e8647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026527CAD450>]}
[0m13:12:55.420606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:12:55.423251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:12:55.473228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817643dc-d70c-499f-af94-3864640e8647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002652945AE40>]}
[0m13:12:55.473735 [info ] [MainThread]: Found 9 models, 33 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m13:12:55.474327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817643dc-d70c-499f-af94-3864640e8647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026529446A50>]}
[0m13:12:55.479270 [info ] [MainThread]: 
[0m13:12:55.486174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:55.487121 [info ] [MainThread]: 
[0m13:12:55.488098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:12:55.495623 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m13:12:55.496429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:55.496985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m13:12:55.497669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:55.498227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m13:12:55.500188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:57.623577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817643dc-d70c-499f-af94-3864640e8647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265294B3BA0>]}
[0m13:12:57.624191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:57.632793 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m13:12:57.633451 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:12:57.634213 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:12:57.634743 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:12:57.635243 [info ] [Thread-1 (]: 1 of 33 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date  [RUN]
[0m13:12:57.635824 [info ] [Thread-3 (]: 3 of 33 START test not_null_dim_date_dt ........................................ [RUN]
[0m13:12:57.638372 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027'
[0m13:12:57.639499 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_date_dt.58a291f69b'
[0m13:12:57.636514 [info ] [Thread-4 (]: 4 of 33 START test not_null_dim_products_product_sku ........................... [RUN]
[0m13:12:57.640661 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m13:12:57.641295 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:12:57.637127 [info ] [Thread-2 (]: 2 of 33 START test not_null_dim_country_country ................................ [RUN]
[0m13:12:57.642423 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343'
[0m13:12:57.673436 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027"
[0m13:12:57.685746 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m13:12:57.686385 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m13:12:57.686892 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:12:57.687658 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:12:57.693769 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m13:12:57.700977 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m13:12:57.702082 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:12:57.710605 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m13:12:57.746843 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027"
[0m13:12:57.747992 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m13:12:57.748960 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:12:57.749801 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:12:57.752851 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m13:12:57.755106 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m13:12:57.756108 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id, session_date
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id, session_date
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m13:12:57.756680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:57.757557 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:12:57.758303 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:12:57.759006 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_date_dt.58a291f69b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from e2e-dbt-project.analytics_mart.dim_date
where dt is null



  
  
      
    ) dbt_internal_test
[0m13:12:57.759581 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:12:57.792187 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m13:12:57.794030 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:00.272315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ec6d683c-8393-474b-bd3a-709b7eeb4af8&page=queryresults
[0m13:13:00.292814 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a4ea9383-d29d-4cce-ab76-a4f0dd4791cb&page=queryresults
[0m13:13:00.332437 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6fa6574e-5190-4760-952a-95d2071f429a&page=queryresults
[0m13:13:00.589422 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a432e802-918e-46d5-a828-15679362d246&page=queryresults
[0m13:13:01.269844 [info ] [Thread-4 (]: 4 of 33 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.63s]
[0m13:13:01.272919 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m13:13:01.271876 [info ] [Thread-3 (]: 3 of 33 PASS not_null_dim_date_dt .............................................. [[32mPASS[0m in 3.63s]
[0m13:13:01.273637 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:13:01.274562 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m13:13:01.275795 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:13:01.275241 [info ] [Thread-4 (]: 5 of 33 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m13:13:01.277504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m13:13:01.276738 [info ] [Thread-3 (]: 6 of 33 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m13:13:01.278378 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:13:01.279018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_dt.58a291f69b, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m13:13:01.284874 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m13:13:01.285960 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:13:01.293572 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m13:13:01.295258 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:13:01.298255 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m13:13:01.299208 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:13:01.301833 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m13:13:01.302777 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:01.303558 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:01.305757 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:13:01.337647 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:01.475624 [info ] [Thread-2 (]: 2 of 33 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 3.79s]
[0m13:13:01.476786 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m13:13:01.477379 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:13:01.477941 [info ] [Thread-2 (]: 7 of 33 START test not_null_fct_sales_item_revenue_local ....................... [RUN]
[0m13:13:01.478681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392)
[0m13:13:01.479107 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:13:01.483439 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m13:13:01.484768 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:13:01.488537 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m13:13:01.489686 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_local
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_local is null



  
  
      
    ) dbt_internal_test
[0m13:13:01.490223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:02.758136 [info ] [Thread-1 (]: 1 of 33 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date  [[32mPASS[0m in 5.12s]
[0m13:13:02.759646 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m13:13:02.760371 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:13:02.760891 [info ] [Thread-1 (]: 8 of 33 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m13:13:02.761532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m13:13:02.761923 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:13:02.766427 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m13:13:02.767722 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:13:02.770842 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m13:13:02.771981 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m13:13:02.772582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:03.675016 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78ed1a4d-8854-4c2b-90a1-4fdd3bc886d7&page=queryresults
[0m13:13:03.954533 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:569c1987-421c-415f-a0ba-eeb29e9a5bb9&page=queryresults
[0m13:13:03.967268 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3790990f-2a56-46fe-afe3-6aee634c73f3&page=queryresults
[0m13:13:04.525722 [info ] [Thread-4 (]: 5 of 33 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.25s]
[0m13:13:04.531283 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m13:13:04.533030 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:13:04.534895 [info ] [Thread-4 (]: 9 of 33 START test not_null_fct_sales_item_session_date ........................ [RUN]
[0m13:13:04.542363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m13:13:04.545131 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:13:04.555864 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m13:13:04.559389 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:13:04.565026 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m13:13:04.566783 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m13:13:04.567769 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:04.821175 [info ] [Thread-3 (]: 6 of 33 PASS not_null_fct_sales_item_product_sku ............................... [[32mPASS[0m in 3.54s]
[0m13:13:04.822395 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m13:13:04.822833 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:13:04.823337 [info ] [Thread-3 (]: 10 of 33 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m13:13:04.824097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m13:13:04.824784 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:13:04.832349 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m13:13:04.833797 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:13:04.837038 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m13:13:04.838158 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:04.838822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:04.891476 [info ] [Thread-2 (]: 7 of 33 PASS not_null_fct_sales_item_revenue_local ............................. [[32mPASS[0m in 3.41s]
[0m13:13:04.893030 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m13:13:04.893722 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:13:04.894308 [info ] [Thread-2 (]: 11 of 33 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m13:13:04.895210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m13:13:04.896111 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:13:04.905281 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m13:13:04.907168 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:13:04.913874 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m13:13:04.916122 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m13:13:04.917149 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:04.961825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:747d1783-e21f-4980-a70e-a5e24de8fc78&page=queryresults
[0m13:13:05.951121 [info ] [Thread-1 (]: 8 of 33 PASS not_null_fct_sales_item_revenue_usd ............................... [[32mPASS[0m in 3.19s]
[0m13:13:05.952695 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m13:13:05.953507 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:13:05.954317 [info ] [Thread-1 (]: 12 of 33 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m13:13:05.955299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m13:13:05.956126 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:13:05.963160 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m13:13:05.972927 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:13:05.978207 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m13:13:05.979860 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:05.980819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:06.858439 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef174952-c19f-437f-9176-59d42c0afb6b&page=queryresults
[0m13:13:07.290879 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c8405d1c-f34a-4226-934c-54a82ae40084&page=queryresults
[0m13:13:07.407774 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b732c6ca-0930-4249-aac4-e5ba1ea38823&page=queryresults
[0m13:13:07.692476 [info ] [Thread-4 (]: 9 of 33 PASS not_null_fct_sales_item_session_date .............................. [[32mPASS[0m in 3.15s]
[0m13:13:07.695789 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m13:13:07.697735 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:13:07.700498 [info ] [Thread-4 (]: 13 of 33 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m13:13:07.703552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m13:13:07.705833 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:13:07.720363 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m13:13:07.724847 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:13:07.736959 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m13:13:07.738936 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:07.739918 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:08.118928 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a3abf703-b8e6-4507-a52e-8e180e0cd9ef&page=queryresults
[0m13:13:08.164092 [info ] [Thread-3 (]: 10 of 33 PASS not_null_fct_sales_item_transaction_id ........................... [[32mPASS[0m in 3.34s]
[0m13:13:08.165249 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m13:13:08.165705 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:13:08.166187 [info ] [Thread-3 (]: 14 of 33 START test not_null_product_categories_product_category ............... [RUN]
[0m13:13:08.166959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m13:13:08.167763 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:13:08.175663 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m13:13:08.177473 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:13:08.182990 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m13:13:08.184838 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m13:13:08.185717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:09.822804 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:58e1a6be-2a6c-4f40-805b-847d2718e458&page=queryresults
[0m13:13:10.023672 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b5bc2440-973a-4b16-9b62-10c8d400e1f7&page=queryresults
[0m13:13:10.180792 [info ] [Thread-2 (]: 11 of 33 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 5.29s]
[0m13:13:10.183217 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m13:13:10.184189 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:13:10.185244 [info ] [Thread-2 (]: 15 of 33 START test not_null_product_categories_product_sku .................... [RUN]
[0m13:13:10.186611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m13:13:10.187506 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:13:10.195992 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m13:13:10.197793 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:13:10.202158 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m13:13:10.204301 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:13:10.205079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:10.893767 [info ] [Thread-3 (]: 14 of 33 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 2.73s]
[0m13:13:10.898127 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m13:13:10.900302 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:13:10.902324 [info ] [Thread-3 (]: 16 of 33 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m13:13:10.904644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m13:13:10.905944 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:13:10.917673 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m13:13:10.928575 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:13:10.934194 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m13:13:10.936239 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m13:13:10.937171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:11.107223 [info ] [Thread-1 (]: 12 of 33 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 5.15s]
[0m13:13:11.108420 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m13:13:11.108880 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:13:11.109503 [info ] [Thread-1 (]: 17 of 33 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m13:13:11.110384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m13:13:11.110811 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:13:11.114632 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m13:13:11.115823 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:13:11.120042 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m13:13:11.121937 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m13:13:11.122890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:12.772683 [info ] [Thread-4 (]: 13 of 33 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 5.07s]
[0m13:13:12.775442 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m13:13:12.776813 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:13:12.778363 [info ] [Thread-4 (]: 18 of 33 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m13:13:12.781408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m13:13:12.783369 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:13:12.796788 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m13:13:12.800496 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:13:12.806298 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m13:13:12.808077 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:12.809044 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:13.004878 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a0179d4-1c2b-4bb1-b6d7-45808b7b35b9&page=queryresults
[0m13:13:13.013840 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:becbe11d-2ae3-4ddb-82ba-1e39645a27eb&page=queryresults
[0m13:13:13.164065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5bdd6ee6-4f9b-4f12-9fe3-23f6ae791ed7&page=queryresults
[0m13:13:13.900085 [info ] [Thread-2 (]: 15 of 33 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 3.71s]
[0m13:13:13.901234 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m13:13:13.901650 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:13:13.902131 [info ] [Thread-2 (]: 19 of 33 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m13:13:13.902895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m13:13:13.903665 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:13:13.911520 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m13:13:13.912915 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:13:13.916156 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m13:13:13.917305 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:13.918007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:14.528987 [info ] [Thread-1 (]: 17 of 33 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.42s]
[0m13:13:14.529988 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m13:13:14.530431 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:13:14.530945 [info ] [Thread-1 (]: 20 of 33 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m13:13:14.531637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m13:13:14.532053 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:13:14.536233 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m13:13:14.537680 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:13:14.541085 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m13:13:14.542577 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m13:13:14.543223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:14.716206 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bebce7f6-3bc7-448a-92c3-825b29cb6e25&page=queryresults
[0m13:13:15.399474 [info ] [Thread-3 (]: 16 of 33 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 4.49s]
[0m13:13:15.401370 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m13:13:15.402314 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:13:15.403365 [info ] [Thread-3 (]: 21 of 33 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m13:13:15.404663 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m13:13:15.406013 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:13:15.414567 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m13:13:15.416045 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:13:15.419668 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m13:13:15.420935 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m13:13:15.421730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:15.837617 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a62fe183-08e5-4912-9058-21cb5a6bb78c&page=queryresults
[0m13:13:16.517594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:91c52258-337b-4989-bde1-5b9ace0a307f&page=queryresults
[0m13:13:17.373378 [info ] [Thread-1 (]: 20 of 33 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.84s]
[0m13:13:17.374506 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m13:13:17.375037 [debug] [Thread-1 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:13:17.375649 [info ] [Thread-1 (]: 22 of 33 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m13:13:17.376478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m13:13:17.376999 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:13:17.383011 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m13:13:17.390739 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9a51f609-6576-43b5-a179-6c79613db31d&page=queryresults
[0m13:13:17.393116 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:13:17.397834 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m13:13:17.399768 [debug] [Thread-1 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m13:13:17.400556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:17.437272 [info ] [Thread-4 (]: 18 of 33 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 4.66s]
[0m13:13:17.438564 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m13:13:17.439116 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:13:17.439718 [info ] [Thread-4 (]: 23 of 33 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m13:13:17.440415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m13:13:17.440826 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:13:17.445969 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m13:13:17.447117 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:13:17.449526 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m13:13:17.450588 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m13:13:17.451059 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:17.934166 [info ] [Thread-2 (]: 19 of 33 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 4.03s]
[0m13:13:17.935417 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m13:13:17.935857 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:13:17.936366 [info ] [Thread-2 (]: 24 of 33 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m13:13:17.937182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m13:13:17.937888 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:13:17.946123 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m13:13:17.947332 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:13:17.950986 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m13:13:17.952678 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m13:13:17.953606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:18.194544 [info ] [Thread-3 (]: 21 of 33 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.79s]
[0m13:13:18.195715 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m13:13:18.196180 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m13:13:18.196631 [info ] [Thread-3 (]: 25 of 33 START test stg_hits_products_quality .................................. [RUN]
[0m13:13:18.197216 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.stg_hits_products_quality)
[0m13:13:18.197551 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m13:13:18.199817 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m13:13:18.200871 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m13:13:18.202858 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m13:13:18.203850 [debug] [Thread-3 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Ensure product price is present & non-negative for rows that should have a price
with t as (
  select *
  from e2e-dbt-project.analytics_stg.stg_hits_products
)
select *
from t
where product_price_local is null
   or product_price_local < 0
  
  
      
    ) dbt_internal_test
[0m13:13:18.204265 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:19.695533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:50c40864-072b-4c7c-90d8-32d4e942e622&page=queryresults
[0m13:13:19.701896 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2470d7db-995d-4aa1-82b4-90f66c345f9a&page=queryresults
[0m13:13:20.163370 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4bd64727-e081-4fa6-bb8d-87ef5c9255e3&page=queryresults
[0m13:13:20.175504 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f38156a-6c9c-4e2a-89d2-275df0f4ac03&page=queryresults
[0m13:13:20.571179 [info ] [Thread-4 (]: 23 of 33 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.13s]
[0m13:13:20.574677 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m13:13:20.576999 [debug] [Thread-4 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:13:20.580027 [info ] [Thread-4 (]: 26 of 33 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m13:13:20.583078 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m13:13:20.585726 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:13:20.595701 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m13:13:20.599198 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:13:20.606558 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m13:13:20.608899 [debug] [Thread-4 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m13:13:20.610438 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:20.729036 [info ] [Thread-1 (]: 22 of 33 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.35s]
[0m13:13:20.732392 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m13:13:20.733727 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:13:20.735255 [info ] [Thread-1 (]: 27 of 33 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m13:13:20.737487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m13:13:20.738772 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:13:20.899616 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m13:13:20.911704 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:13:20.918105 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m13:13:20.920323 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Check session_revenue_usd_raw is non-negative (when present), and FX is positive
with t as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)
select *
from t
where (session_revenue_usd_raw is not null and session_revenue_usd_raw < 0)
   or (rate_to_usd is not null and rate_to_usd <= 0)
  
  
      
    ) dbt_internal_test
[0m13:13:20.921433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:21.197018 [info ] [Thread-2 (]: 24 of 33 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.26s]
[0m13:13:21.198130 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m13:13:21.198517 [debug] [Thread-2 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m13:13:21.199083 [info ] [Thread-2 (]: 28 of 33 START test test_non_negative_values ................................... [RUN]
[0m13:13:21.199851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m13:13:21.200213 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m13:13:21.202942 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m13:13:21.203985 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m13:13:21.206629 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m13:13:21.207620 [debug] [Thread-2 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m13:13:21.208139 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:22.634959 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:af0ac824-da08-40ee-8a82-17cf709ac7f1&page=queryresults
[0m13:13:23.124103 [info ] [Thread-3 (]: 25 of 33 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 4.93s]
[0m13:13:23.126315 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m13:13:23.126974 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:13:23.127685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f4488ce5-7b46-4e94-aa49-81316ce32d8f&page=queryresults
[0m13:13:23.128178 [info ] [Thread-3 (]: 29 of 33 START test unique_dim_country_country ................................. [RUN]
[0m13:13:23.129148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m13:13:23.130079 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:13:23.139975 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m13:13:23.142651 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:13:23.147732 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m13:13:23.149799 [debug] [Thread-3 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:23.151245 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:23.865098 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:75d518e7-e18f-4181-aeb0-14745c842bd0&page=queryresults
[0m13:13:24.699438 [info ] [Thread-2 (]: 28 of 33 PASS test_non_negative_values ......................................... [[32mPASS[0m in 3.50s]
[0m13:13:24.702341 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m13:13:24.703317 [debug] [Thread-2 (]: Began running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:13:24.704356 [info ] [Thread-2 (]: 30 of 33 START test unique_dim_date_dt ......................................... [RUN]
[0m13:13:24.705856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_date_dt.bbad368071)
[0m13:13:24.707139 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:13:24.720204 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m13:13:24.722884 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:13:24.728827 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m13:13:24.730546 [debug] [Thread-2 (]: On test.ga_retail_project.unique_dim_date_dt.bbad368071: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_dt.bbad368071"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select dt as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where dt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:24.731413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:13:24.842585 [info ] [Thread-4 (]: 26 of 33 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 4.26s]
[0m13:13:24.845598 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m13:13:24.847458 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:13:24.849378 [info ] [Thread-4 (]: 31 of 33 START test unique_dim_products_product_sku ............................ [RUN]
[0m13:13:24.851690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_revenue_nonnegative, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m13:13:24.853234 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:13:24.865259 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m13:13:24.868504 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:13:24.874303 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m13:13:24.885506 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:24.886558 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:25.347308 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92839124-411e-4ec2-905b-b41eb49d1e07&page=queryresults
[0m13:13:25.971645 [info ] [Thread-1 (]: 27 of 33 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 5.23s]
[0m13:13:25.972783 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m13:13:25.973181 [debug] [Thread-1 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:13:25.973758 [info ] [Thread-1 (]: 32 of 33 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m13:13:25.974592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_sessions_with_fx_local_nonnegative, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m13:13:25.975077 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:13:25.979833 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m13:13:25.980925 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:13:25.984610 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m13:13:25.985689 [debug] [Thread-1 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:25.986161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:26.200392 [info ] [Thread-3 (]: 29 of 33 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 3.07s]
[0m13:13:26.201324 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m13:13:26.201771 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:13:26.202404 [info ] [Thread-3 (]: 33 of 33 START test unique_product_categories_product_sku ...................... [RUN]
[0m13:13:26.203353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_country_country.11db8eecec, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m13:13:26.204166 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:13:26.212035 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m13:13:26.220691 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:13:26.226004 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m13:13:26.228143 [debug] [Thread-3 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:26.229233 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:13:27.028763 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d3e9e429-e45f-4454-9953-dd63f09cd62a&page=queryresults
[0m13:13:27.152838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4dfe14a1-9b18-49c7-ae4e-3efa1dfa8bd3&page=queryresults
[0m13:13:27.957465 [info ] [Thread-4 (]: 31 of 33 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 3.11s]
[0m13:13:27.960299 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m13:13:27.990178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:56c9cd8a-8e5c-4bb1-b542-7332c96b698f&page=queryresults
[0m13:13:28.107664 [info ] [Thread-2 (]: 30 of 33 PASS unique_dim_date_dt ............................................... [[32mPASS[0m in 3.40s]
[0m13:13:28.110869 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m13:13:28.310961 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:73ee7b72-3975-4a25-a4d1-b07a62e5eccc&page=queryresults
[0m13:13:28.829559 [info ] [Thread-1 (]: 32 of 33 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 2.85s]
[0m13:13:28.830746 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m13:13:29.185881 [info ] [Thread-3 (]: 33 of 33 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 2.98s]
[0m13:13:29.189619 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m13:13:29.194608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:29.200454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:29.201401 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m13:13:29.202071 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m13:13:29.202773 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m13:13:29.203699 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m13:13:29.204496 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m13:13:29.204939 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_products_product_sku.ab7f821296' was properly closed.
[0m13:13:29.205401 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_date_dt.bbad368071' was properly closed.
[0m13:13:29.206392 [info ] [MainThread]: 
[0m13:13:29.209982 [info ] [MainThread]: Finished running 33 data tests in 0 hours 0 minutes and 33.72 seconds (33.72s).
[0m13:13:29.229545 [debug] [MainThread]: Command end result
[0m13:13:29.312268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m13:13:29.315106 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m13:13:29.324306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m13:13:29.324694 [info ] [MainThread]: 
[0m13:13:29.325355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:29.325918 [info ] [MainThread]: 
[0m13:13:29.326499 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m13:13:29.327675 [debug] [MainThread]: Command `dbt test` succeeded at 13:13:29.327550 after 39.24 seconds
[0m13:13:29.328066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265041907D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265293A52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265298B9BD0>]}
[0m13:13:29.328459 [debug] [MainThread]: Flushing usage events
[0m13:13:30.473371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:20.880375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA94542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA70C9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA493D90>]}


============================== 00:40:20.887359 | 473cefd9-bf0e-4265-acc3-5bc0e903e5c5 ==============================
[0m00:40:20.887359 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:40:20.888266 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m00:40:21.103851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '473cefd9-bf0e-4265-acc3-5bc0e903e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA97B3950>]}
[0m00:40:21.237208 [debug] [MainThread]: Command `dbt clean` succeeded at 00:40:21.237032 after 0.56 seconds
[0m00:40:21.237714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA5118C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA511040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFAA6BC650>]}
[0m00:40:21.238174 [debug] [MainThread]: Flushing usage events
[0m00:40:24.104562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:30.396560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D19142F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148CF589D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D2953D90>]}


============================== 00:40:30.402093 | 0170a889-1f81-4362-99cc-828d9bbc866e ==============================
[0m00:40:30.402093 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:40:30.402944 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:40:30.584533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0170a889-1f81-4362-99cc-828d9bbc866e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D1C6F950>]}
[0m00:40:30.629874 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-681y1f23'
[0m00:40:30.630358 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:40:32.252476 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:40:32.254390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:40:32.823125 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:40:32.828158 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:40:33.806520 [info ] [MainThread]: Installed from version 1.3.0
[0m00:40:33.807169 [info ] [MainThread]: Up to date!
[0m00:40:33.807786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0170a889-1f81-4362-99cc-828d9bbc866e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D29C5590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D29C5F20>]}
[0m00:40:33.809696 [debug] [MainThread]: Command `dbt deps` succeeded at 00:40:33.809548 after 3.59 seconds
[0m00:40:33.810104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D3BA1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D27D28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148D2B347D0>]}
[0m00:40:33.810584 [debug] [MainThread]: Flushing usage events
[0m00:40:34.945237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:29.606774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358AB442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235887B9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358BB8FD90>]}


============================== 00:55:29.612980 | 26c4a24c-d97e-41e9-8ea0-cfa8c951220d ==============================
[0m00:55:29.612980 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:55:29.613927 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select source:ext.fx_rates', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:55:35.050633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358AE9F950>]}
[0m00:55:35.148979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B05D2F10>]}
[0m00:55:35.149926 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:55:36.365489 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:55:36.367092 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:55:36.367794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B062CA50>]}
[0m00:55:40.306698 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m00:55:40.307571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0B87D40>]}
[0m00:55:40.514308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0CC33F0>]}
[0m00:55:40.698684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:55:40.726280 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:55:40.791516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B1132270>]}
[0m00:55:40.792247 [info ] [MainThread]: Found 9 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m00:55:40.792967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0BFF290>]}
[0m00:55:40.795795 [info ] [MainThread]: 
[0m00:55:40.796471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:55:40.797150 [info ] [MainThread]: 
[0m00:55:40.798051 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:40.805483 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m00:55:40.806599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:40.807498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m00:55:40.808357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:40.809211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m00:55:40.809690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:43.520353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c4a24c-d97e-41e9-8ea0-cfa8c951220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0EC3D80>]}
[0m00:55:43.521058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:43.530226 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m00:55:43.531438 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m00:55:43.532028 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m00:55:43.530894 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency  [RUN]
[0m00:55:43.533379 [debug] [Thread-3 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m00:55:43.532843 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_ext_fx_rates_currency ........................ [RUN]
[0m00:55:43.534948 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe'
[0m00:55:43.534012 [info ] [Thread-4 (]: 4 of 4 START test source_not_null_ext_fx_rates_rate_to_usd ..................... [RUN]
[0m00:55:43.536551 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c'
[0m00:55:43.535630 [info ] [Thread-3 (]: 3 of 4 START test source_not_null_ext_fx_rates_rate_date ....................... [RUN]
[0m00:55:43.537486 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m00:55:43.538338 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01'
[0m00:55:43.539018 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m00:55:43.539975 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354'
[0m00:55:43.553384 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe"
[0m00:55:43.554140 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m00:55:43.566476 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m00:55:43.567207 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m00:55:43.573542 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m00:55:43.579183 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m00:55:43.585166 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m00:55:43.618044 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m00:55:43.619137 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m00:55:43.622797 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe"
[0m00:55:43.623584 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m00:55:43.624271 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m00:55:43.627567 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m00:55:43.630638 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m00:55:43.637481 [debug] [Thread-3 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m00:55:43.638477 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m00:55:43.639190 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:55:43.639825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:55:43.640636 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m00:55:43.641325 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        rate_date, currency
    from `e2e-dbt-project`.`ext`.`fx_rates`
    group by rate_date, currency
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m00:55:43.642191 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:55:43.642863 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:55:46.664669 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c170402e-355a-48d8-ab1f-4c6656df59ea&page=queryresults
[0m00:55:46.722357 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aaac1bd7-e011-4f83-a043-00ee537b014e&page=queryresults
[0m00:55:46.728646 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:728d2b41-d254-409b-b508-416000e3ed32&page=queryresults
[0m00:55:46.774296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8f6bc9fb-bb42-4771-82c8-972d023001b9&page=queryresults
[0m00:55:49.306109 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency  [[32mPASS[0m in 5.77s]
[0m00:55:49.309358 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m00:55:49.311532 [info ] [Thread-3 (]: 3 of 4 PASS source_not_null_ext_fx_rates_rate_date ............................. [[32mPASS[0m in 5.77s]
[0m00:55:49.313346 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m00:55:49.328178 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_ext_fx_rates_currency .............................. [[32mPASS[0m in 5.79s]
[0m00:55:49.329549 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m00:55:49.427799 [info ] [Thread-4 (]: 4 of 4 PASS source_not_null_ext_fx_rates_rate_to_usd ........................... [[32mPASS[0m in 5.89s]
[0m00:55:49.429273 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m00:55:49.431739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:49.434284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:49.434746 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:55:49.435174 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m00:55:49.435591 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m00:55:49.436011 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe' was properly closed.
[0m00:55:49.436429 [debug] [MainThread]: Connection 'test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c' was properly closed.
[0m00:55:49.436953 [debug] [MainThread]: Connection 'test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01' was properly closed.
[0m00:55:49.437890 [debug] [MainThread]: Connection 'test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354' was properly closed.
[0m00:55:49.438386 [info ] [MainThread]: 
[0m00:55:49.439101 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m00:55:49.441214 [debug] [MainThread]: Command end result
[0m00:55:49.494497 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:55:49.497838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:55:49.507379 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:55:49.507865 [info ] [MainThread]: 
[0m00:55:49.508600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:49.509285 [info ] [MainThread]: 
[0m00:55:49.510028 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m00:55:49.510968 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:55:49.512615 [debug] [MainThread]: Command `dbt test` succeeded at 00:55:49.512448 after 20.20 seconds
[0m00:55:49.513155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B1195270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B110E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0F7DC50>]}
[0m00:55:49.513773 [debug] [MainThread]: Flushing usage events
[0m00:55:51.137589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:26.520887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016645E442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016643AB5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016646E8BD90>]}


============================== 01:10:26.527161 | 7b74b42c-1d8d-4522-aed2-26899233a555 ==============================
[0m01:10:26.527161 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:10:26.528167 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select vw_sales_by_date vw_sales_by_country vw_sales_by_product', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:10:30.925475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b74b42c-1d8d-4522-aed2-26899233a555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166461A3950>]}
[0m01:10:31.023903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b74b42c-1d8d-4522-aed2-26899233a555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666A916F10>]}
[0m01:10:31.024845 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:10:32.070391 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:10:32.445363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m01:10:32.446274 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\metrics\vw_sales_by_country.sql
[0m01:10:32.446815 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\metrics\vw_sales_by_date.sql
[0m01:10:32.447318 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\metrics\vw_sales_by_product.sql
[0m01:10:32.447945 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\dim_visitors.sql
[0m01:10:33.149085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b74b42c-1d8d-4522-aed2-26899233a555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666A96DB50>]}
[0m01:10:33.337935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:10:33.341410 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:10:33.386060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b74b42c-1d8d-4522-aed2-26899233a555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666A9B17C0>]}
[0m01:10:33.386714 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:10:33.387437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b74b42c-1d8d-4522-aed2-26899233a555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666C0BB150>]}
[0m01:10:33.390956 [info ] [MainThread]: 
[0m01:10:33.391659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:10:33.392329 [info ] [MainThread]: 
[0m01:10:33.393169 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:10:33.400213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:10:33.400900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:35.524869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics)
[0m01:10:35.527454 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics"
"
[0m01:10:35.555949 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics"} */
create schema if not exists e2e-dbt-project.analytics
  
[0m01:10:35.556683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:37.577173 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4968ba4a-c812-4bc7-a464-9bdcce8d9cf5&page=queryresults
[0m01:10:37.577867 [error] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4968ba4a-c812-4bc7-a464-9bdcce8d9cf5&page=queryresults
[0m01:10:37.578781 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
macro create_schema
[0m01:10:37.579317 [debug] [ThreadPool]: BigQuery adapter: Database Error
  Syntax error: Expected end of input but got "-" at [2:32]
[0m01:10:37.583297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:10:37.585803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:37.586281 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics' was properly closed.
[0m01:10:37.586756 [info ] [MainThread]: 
[0m01:10:37.587485 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m01:10:37.588395 [error] [MainThread]: Encountered an error:
Database Error
  Syntax error: Expected end of input but got "-" at [2:32]
[0m01:10:37.590111 [debug] [MainThread]: Command `dbt run` failed at 01:10:37.589924 after 11.34 seconds
[0m01:10:37.590797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666C15C390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016646E5C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666C182F90>]}
[0m01:10:37.591372 [debug] [MainThread]: Flushing usage events
[0m01:10:39.920664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:24.101543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF9DF42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF7A69D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFAE37D90>]}


============================== 01:16:24.108282 | e6bf8eee-706b-4479-a73f-bf48a213a071 ==============================
[0m01:16:24.108282 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:16:24.109280 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:16:24.338403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6bf8eee-706b-4479-a73f-bf48a213a071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFA153950>]}
[0m01:16:24.464382 [debug] [MainThread]: Command `dbt clean` succeeded at 01:16:24.464206 after 0.65 seconds
[0m01:16:24.464933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFAEB18C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFAEB1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFC02C650>]}
[0m01:16:24.465536 [debug] [MainThread]: Flushing usage events
[0m01:16:26.769425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:30.219745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD56542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD32C9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD6693D90>]}


============================== 01:16:30.226084 | 5a92515b-a714-43c0-af47-a7107e038f0d ==============================
[0m01:16:30.226084 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:16:30.227046 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:16:30.458908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a92515b-a714-43c0-af47-a7107e038f0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD59B3950>]}
[0m01:16:30.504161 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-qmba_imy'
[0m01:16:30.504839 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:16:32.293356 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:16:32.295339 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:16:32.993910 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:16:33.000417 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:16:34.219027 [info ] [MainThread]: Installed from version 1.3.0
[0m01:16:34.219768 [info ] [MainThread]: Up to date!
[0m01:16:34.220457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5a92515b-a714-43c0-af47-a7107e038f0d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD6705590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD6705F20>]}
[0m01:16:34.223310 [debug] [MainThread]: Command `dbt deps` succeeded at 01:16:34.223085 after 4.20 seconds
[0m01:16:34.223860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD7911750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD65128A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FD78447D0>]}
[0m01:16:34.224402 [debug] [MainThread]: Flushing usage events
[0m01:16:35.537899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:39.025777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34B542F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A327C9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A35B9FD90>]}


============================== 01:16:39.032068 | 3908a219-1392-458e-ac83-3691aef72cde ==============================
[0m01:16:39.032068 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:16:39.033054 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select vw_sales_by_date vw_sales_by_country vw_sales_by_product', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:16:43.582848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34EB7950>]}
[0m01:16:43.681539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A59616F10>]}
[0m01:16:43.682548 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:16:44.729888 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:16:44.731489 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:16:44.732233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5966C950>]}
[0m01:16:47.921700 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:16:47.922654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5ABA3890>]}
[0m01:16:48.128495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5ACD8130>]}
[0m01:16:48.317512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:16:48.329999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:16:48.375033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5AFC57E0>]}
[0m01:16:48.375780 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:16:48.376630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5AFD81D0>]}
[0m01:16:48.380013 [info ] [MainThread]: 
[0m01:16:48.380699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:16:48.381365 [info ] [MainThread]: 
[0m01:16:48.382413 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:16:48.388216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:16:48.389035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:50.538063 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:16:50.539997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:50.541794 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:16:50.543889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:50.546031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:16:50.547410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:53.253020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5AF1A2B0>]}
[0m01:16:53.254298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:53.269721 [debug] [Thread-1 (]: Began running node model.ga_retail_project.vw_sales_by_country
[0m01:16:53.271015 [debug] [Thread-3 (]: Began running node model.ga_retail_project.vw_sales_by_product
[0m01:16:53.272132 [debug] [Thread-2 (]: Began running node model.ga_retail_project.vw_sales_by_date
[0m01:16:53.274005 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_mart.vw_sales_by_country ................. [RUN]
[0m01:16:53.276087 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_mart.vw_sales_by_product ................. [RUN]
[0m01:16:53.279971 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.vw_sales_by_country'
[0m01:16:53.281587 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.vw_sales_by_product'
[0m01:16:53.277414 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_mart.vw_sales_by_date .................... [RUN]
[0m01:16:53.283260 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.vw_sales_by_country
[0m01:16:53.284462 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.vw_sales_by_product
[0m01:16:53.285934 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.vw_sales_by_date'
[0m01:16:53.308333 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_country"
[0m01:16:53.313691 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_product"
[0m01:16:53.314502 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.vw_sales_by_date
[0m01:16:53.322772 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_date"
[0m01:16:53.327376 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.vw_sales_by_country
[0m01:16:53.370339 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_country"
[0m01:16:53.371497 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.vw_sales_by_product
[0m01:16:53.372412 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.vw_sales_by_date
[0m01:16:53.376367 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_product"
[0m01:16:53.380619 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_date"
[0m01:16:53.386548 [debug] [Thread-2 (]: On model.ga_retail_project.vw_sales_by_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_date"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_date
  OPTIONS()
  as 

select
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  count(distinct transaction_id)                      as orders,
  count(distinct visitor_id)                          as visitors,
  safe_divide(sum(revenue_usd), count(distinct transaction_id)) as aov_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
group by dt;


[0m01:16:53.387244 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:16:53.388223 [debug] [Thread-1 (]: On model.ga_retail_project.vw_sales_by_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_country"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_country
  OPTIONS()
  as 

select
  country,
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  count(distinct transaction_id)                      as orders,
  safe_divide(sum(revenue_usd), count(distinct transaction_id)) as aov_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
group by country, dt;


[0m01:16:53.389041 [debug] [Thread-3 (]: On model.ga_retail_project.vw_sales_by_product: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_product"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_product
  OPTIONS()
  as 

select
  product_sku,
  product_name,
  product_category,
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  sum(product_quantity)                               as units,
  count(distinct transaction_id)                      as orders
from e2e-dbt-project.analytics_mart.fct_sales_item
group by product_sku, product_name, product_category, dt;


[0m01:16:53.389909 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:16:53.390773 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:16:56.169209 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fade750e-9c98-47c3-9d65-38d6e44d0046&page=queryresults
[0m01:16:56.198652 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6bcc9a31-fc58-48e9-9764-34010c27e530&page=queryresults
[0m01:16:56.199532 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:04661647-af91-4ae6-be3a-19791eaff404&page=queryresults
[0m01:16:56.931012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5B1A5270>]}
[0m01:16:56.931614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5C76E450>]}
[0m01:16:56.933000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3908a219-1392-458e-ac83-3691aef72cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34E830D0>]}
[0m01:16:56.932550 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_mart.vw_sales_by_date ............... [[32mCREATE VIEW (0 processed)[0m in 3.64s]
[0m01:16:56.934125 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_mart.vw_sales_by_product ............ [[32mCREATE VIEW (0 processed)[0m in 3.65s]
[0m01:16:56.936034 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.vw_sales_by_date
[0m01:16:56.937007 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.vw_sales_by_product
[0m01:16:56.934949 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_mart.vw_sales_by_country ............ [[32mCREATE VIEW (0 processed)[0m in 3.65s]
[0m01:16:56.938647 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.vw_sales_by_country
[0m01:16:56.940753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:56.943130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:56.943569 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:16:56.943981 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:16:56.944392 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:16:56.944795 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:16:56.945198 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_country' was properly closed.
[0m01:16:56.945613 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_product' was properly closed.
[0m01:16:56.946012 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_date' was properly closed.
[0m01:16:56.946632 [info ] [MainThread]: 
[0m01:16:56.947356 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m01:16:56.949129 [debug] [MainThread]: Command end result
[0m01:16:57.005845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:16:57.009609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:16:57.018036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:16:57.018536 [info ] [MainThread]: 
[0m01:16:57.019385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:57.020084 [info ] [MainThread]: 
[0m01:16:57.020857 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:16:57.022107 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:16:57.023882 [debug] [MainThread]: Command `dbt run` succeeded at 01:16:57.023685 after 18.19 seconds
[0m01:16:57.024439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5B0FE150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5AB071D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A5C7A3FB0>]}
[0m01:16:57.024967 [debug] [MainThread]: Flushing usage events
[0m01:16:58.319683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:46.371567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C741C342F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C73F899D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C742C7FD90>]}


============================== 01:31:46.378046 | 24a88dd8-47e8-43b6-a238-998e8ad6589b ==============================
[0m01:31:46.378046 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:31:46.379041 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_sessions stg_hits_product', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:31:50.980854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C741F93950>]}
[0m01:31:51.079095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7666E6F10>]}
[0m01:31:51.080021 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:31:52.108853 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:31:52.332163 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:31:52.332967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C767D4DB50>]}
[0m01:31:55.249066 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:31:55.250096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C767F3E990>]}
[0m01:31:55.455407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7677A0E50>]}
[0m01:31:55.631736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:31:55.635165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:31:55.679318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C768237D40>]}
[0m01:31:55.679982 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:31:55.680713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C768175490>]}
[0m01:31:55.682191 [warn ] [MainThread]: The selection criterion 'stg_hits_product' does not match any enabled nodes
[0m01:31:55.684457 [info ] [MainThread]: 
[0m01:31:55.685176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:31:55.685844 [info ] [MainThread]: 
[0m01:31:55.686973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:31:55.688614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:31:55.689355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:57.817906 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:31:57.819568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:57.821239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:31:57.823156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:57.825381 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:31:57.826554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:00.381527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C768249860>]}
[0m01:32:00.382226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:32:00.390776 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:32:00.391578 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:32:00.392619 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:32:00.393166 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:32:00.404076 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:32:00.406046 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:32:00.452208 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:32:00.454037 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170101'
                        and '20171231'
)

select *
from src;


[0m01:32:00.454709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:32:02.808656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2e63e3c9-ecbf-44c8-a91f-91653aad1b0a&page=queryresults
[0m01:32:03.551836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a88dd8-47e8-43b6-a238-998e8ad6589b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C741F70230>]}
[0m01:32:03.552825 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.16s]
[0m01:32:03.554022 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:32:03.556451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:32:03.558716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:03.559163 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:32:03.559575 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:32:03.559986 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:32:03.560597 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:32:03.561274 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:32:03.562171 [info ] [MainThread]: 
[0m01:32:03.563072 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m01:32:03.564364 [debug] [MainThread]: Command end result
[0m01:32:03.616577 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:32:03.619943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:32:03.629191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:32:03.629681 [info ] [MainThread]: 
[0m01:32:03.630462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:03.631136 [info ] [MainThread]: 
[0m01:32:03.631852 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:32:03.632793 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:32:03.634425 [debug] [MainThread]: Command `dbt run` succeeded at 01:32:03.634260 after 17.54 seconds
[0m01:32:03.634970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7682F5A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C741F5F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C742CCCFA0>]}
[0m01:32:03.635516 [debug] [MainThread]: Flushing usage events
[0m01:32:05.361546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:32:58.870963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC86D442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC849CDD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC87D8FD90>]}


============================== 01:32:58.877422 | 052445dd-0d58-4a67-bfbf-7825aa5a16e4 ==============================
[0m01:32:58.877422 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:32:58.878430 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_sessions stg_hits_products', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:33:03.325349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC870A3950>]}
[0m01:33:03.423997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCAC7C6F10>]}
[0m01:33:03.424925 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:33:04.469341 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:33:04.822998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:33:04.823527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:33:04.924042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCAC81D350>]}
[0m01:33:05.111812 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:33:05.115543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:33:05.159914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCAC85D7C0>]}
[0m01:33:05.160576 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:33:05.161324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCACF56B30>]}
[0m01:33:05.164440 [info ] [MainThread]: 
[0m01:33:05.165134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:33:05.165806 [info ] [MainThread]: 
[0m01:33:05.166806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:33:05.175462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:33:05.176371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:07.229043 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:33:07.231055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:07.233125 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:33:07.235551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:07.237367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:33:07.239486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:09.725381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCAD02B790>]}
[0m01:33:09.727267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:33:09.748310 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:33:09.747276 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:33:09.749844 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:33:09.752686 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:33:09.753755 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:33:09.751302 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:33:09.765944 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:33:09.769965 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:33:09.770618 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:33:09.775634 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:33:09.777004 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:33:09.821809 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:33:09.822480 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:33:09.826657 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:33:09.827904 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20170101'
                        and '20171231'
)

select *
from src;


[0m01:33:09.828734 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:33:09.829652 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the date window controlled by vars.
with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)              as session_date,
    cast(fullVisitorId as string)                    as visitor_id,
    cast(visitId as string)                          as visit_id,
    geoNetwork.country                               as country,
    trafficSource.source                             as traffic_source,
    trafficSource.medium                             as traffic_medium,
    trafficSource.campaign                           as traffic_campaign,
    h.transaction.transactionId                      as transaction_id,
    p.productSKU                                     as product_sku,
    p.v2ProductName                                  as product_name,
    p.v2ProductCategory                              as product_category,
    p.productQuantity                                as product_quantity,
    -- GA prices are in micros in the export; treat as "local" at this stage
    safe_divide(p.productPrice, 1e6)                 as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6) as item_revenue_local
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between '20170101'
                        and '20171231'
    and p.productSKU is not null
)
select * from base;


[0m01:33:09.830358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:33:12.470681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c2106672-3559-4a21-89a2-6c5cc38c9dcd&page=queryresults
[0m01:33:12.528332 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f4239330-8dfc-48f2-8386-b17cdd1cac0f&page=queryresults
[0m01:33:13.205000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCACD771D0>]}
[0m01:33:13.205619 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052445dd-0d58-4a67-bfbf-7825aa5a16e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCACFDDD30>]}
[0m01:33:13.206662 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 3.44s]
[0m01:33:13.208858 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:33:13.207655 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.45s]
[0m01:33:13.210175 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:33:13.212253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:33:13.214943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:33:13.215535 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:33:13.216030 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:33:13.216517 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:33:13.216947 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:33:13.217368 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:33:13.217786 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:33:13.218327 [info ] [MainThread]: 
[0m01:33:13.218995 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 8.05 seconds (8.05s).
[0m01:33:13.220576 [debug] [MainThread]: Command end result
[0m01:33:13.282733 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:33:13.286348 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:33:13.295705 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:33:13.296233 [info ] [MainThread]: 
[0m01:33:13.296957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:33:13.297615 [info ] [MainThread]: 
[0m01:33:13.298765 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:33:13.301941 [debug] [MainThread]: Command `dbt run` succeeded at 01:33:13.301682 after 14.65 seconds
[0m01:33:13.302855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCAD00BCF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCAD011D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCACA623D0>]}
[0m01:33:13.303765 [debug] [MainThread]: Flushing usage events
[0m01:33:14.920976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:51.301570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C9D242F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8C7999D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CAD6BD90>]}


============================== 01:40:51.307882 | ea810dfd-1faa-4c52-98f3-145516506817 ==============================
[0m01:40:51.307882 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:40:51.308919 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select int_sessions_enriched fct_sales_item dim_products dim_country dim_date --full-refresh --vars {ga_start: 20170101, ga_end: 20171231}', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:40:55.801950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CA087950>]}
[0m01:40:55.899976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EE7E6F10>]}
[0m01:40:55.900900 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:40:56.939684 [debug] [MainThread]: checksum: 180a360351ead210ef6bf1515da098349fa36b21374832129712a35b29d44c02, vars: {'ga_end': 20171231, 'ga_start': 20170101}, profile: , target: , version: 1.10.9
[0m01:40:57.146249 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:40:57.147078 [debug] [MainThread]: previous checksum: 180a360351ead210ef6bf1515da098349fa36b21374832129712a35b29d44c02, current checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23
[0m01:40:57.147544 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:40:57.148262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EFE51B50>]}
[0m01:41:00.083681 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:41:00.084631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F003E990>]}
[0m01:41:00.302663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EE8CCE50>]}
[0m01:41:00.484782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:41:00.488187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:41:00.533918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F0337BA0>]}
[0m01:41:00.534580 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:41:00.535292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F0281550>]}
[0m01:41:00.539360 [info ] [MainThread]: 
[0m01:41:00.540218 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:41:00.540840 [info ] [MainThread]: 
[0m01:41:00.541789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:00.548644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:41:00.549424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:00.550235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:41:00.550821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:02.973150 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:41:02.974189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:02.975111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:41:02.977517 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:41:02.978364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:02.976209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:05.440530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F03495A0>]}
[0m01:41:05.442206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:05.455408 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m01:41:05.456186 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_date
[0m01:41:05.457750 [debug] [Thread-3 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:41:05.457090 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics_mart.dim_country ........................ [RUN]
[0m01:41:05.458864 [info ] [Thread-2 (]: 2 of 5 START sql table model analytics_mart.dim_date ........................... [RUN]
[0m01:41:05.460644 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m01:41:05.459636 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:41:05.461648 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m01:41:05.462408 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m01:41:05.463197 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m01:41:05.463827 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_date
[0m01:41:05.475441 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m01:41:05.476087 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:41:05.480465 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m01:41:05.488489 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:41:05.491016 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:41:05.491658 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m01:41:05.502349 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_date
[0m01:41:05.549673 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:41:05.560352 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:41:05.564517 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:41:05.643410 [debug] [Thread-3 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

-- Silver: join item-level hits with session-day FX, compute USD metrics.
with sess as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),
items as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    -- local currency amounts from staging
    product_price_local,
    item_revenue_local
  from e2e-dbt-project.analytics_stg.stg_hits_products
),
joined as (
  select
    i.session_date,
    i.visitor_id,
    i.visit_id,
    i.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    i.transaction_id,
    i.product_sku,
    i.product_name,
    i.product_category,
    i.product_quantity,
    i.product_price_local,
    coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) as revenue_local,
    -- FX conversion at session_date granularity
    (i.product_price_local * s.rate_to_usd) as product_price_usd,
    (coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) * s.rate_to_usd) as revenue_usd,
    s.rate_to_usd,
    s.local_currency
  from items i
  left join sess s
    on s.session_date = i.session_date
   and s.visitor_id   = i.visitor_id
   and s.visit_id     = i.visit_id
   and lower(s.country) = lower(i.country)
)

select * from joined;


[0m01:41:05.644407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:41:08.155313 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m01:41:08.156282 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m01:41:08.158300 [debug] [Thread-2 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m01:41:08.160653 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      

-- Country ↔ Currency from ext mapping (avoid scanning GA)
select distinct
  initcap(country)        as country,
  currency                as local_currency
from `e2e-dbt-project`.`ext`.`country_currency`
where country is not null
  and currency is not null
    );
  
[0m01:41:08.559171 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:7e8ebb9d-64cd-406b-a1fa-04e5c77ebbd8&page=queryresults
[0m01:41:08.748689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cab4a60b-7af6-405c-8554-3ce6d725dcc2&page=queryresults
[0m01:41:09.186403 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:793e16d1-4a6e-492e-a3f8-424db6deb0d9&page=queryresults
[0m01:41:09.302253 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8CA064230>]}
[0m01:41:09.303247 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 3.84s]
[0m01:41:09.304534 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:41:09.305434 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:41:09.306127 [info ] [Thread-4 (]: 4 of 5 START sql incremental model analytics_mart.fct_sales_item ............... [RUN]
[0m01:41:09.307075 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:41:09.307721 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:41:09.316130 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:41:09.317461 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:41:09.378204 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:41:10.563230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F03F67D0>]}
[0m01:41:10.564162 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics_mart.dim_country ................... [[32mCREATE TABLE (7.0 rows, 110.0 Bytes processed)[0m in 5.10s]
[0m01:41:10.565370 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m01:41:11.326680 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:41:11.330052 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_sku, product_category

    
    OPTIONS()
    as (
      

with base as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
  from e2e-dbt-project.analytics_int.int_sessions_enriched
  -- Keep only true sales lines
  where transaction_id is not null
    and coalesce(revenue_usd, 0) > 0
    and coalesce(product_quantity, 0) > 0
)

select * from base


    );
  
[0m01:41:12.370590 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2aa9f9ed-2888-4e7d-9bde-1f5b8367cfdc&page=queryresults
[0m01:41:20.192622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F041B540>]}
[0m01:41:20.195108 [info ] [Thread-2 (]: 2 of 5 OK created sql table model analytics_mart.dim_date ...................... [[32mCREATE TABLE (213.0 rows, 0 processed)[0m in 14.73s]
[0m01:41:20.198561 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_date
[0m01:41:24.949458 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F0361550>]}
[0m01:41:24.951918 [info ] [Thread-4 (]: 4 of 5 OK created sql incremental model analytics_mart.fct_sales_item .......... [[32mCREATE TABLE (19.3k rows, 660.9 MiB processed)[0m in 15.64s]
[0m01:41:24.955948 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:41:24.958694 [debug] [Thread-3 (]: Began running node model.ga_retail_project.dim_products
[0m01:41:24.960698 [info ] [Thread-3 (]: 5 of 5 START sql table model analytics_mart.dim_products ....................... [RUN]
[0m01:41:24.963542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.int_sessions_enriched, now model.ga_retail_project.dim_products)
[0m01:41:24.966475 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.dim_products
[0m01:41:24.976936 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m01:41:24.980778 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.dim_products
[0m01:41:24.988108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:41:26.990631 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m01:41:27.001467 [debug] [Thread-3 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with base as (
  select
    product_sku,
    any_value(product_name)     as product_name,
    any_value(product_category) as product_category
  from e2e-dbt-project.analytics_mart.fct_sales_item
  group by product_sku
)
select * from base
    );
  
[0m01:41:27.615795 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f1bde24a-6ad7-4a56-a762-90a03798fcd5&page=queryresults
[0m01:41:30.115154 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea810dfd-1faa-4c52-98f3-145516506817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EFF40EF0>]}
[0m01:41:30.117643 [info ] [Thread-3 (]: 5 of 5 OK created sql table model analytics_mart.dim_products .................. [[32mCREATE TABLE (972.0 rows, 1.1 MiB processed)[0m in 5.15s]
[0m01:41:30.121156 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.dim_products
[0m01:41:30.127209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:30.134025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:30.135310 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:41:30.136564 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:41:30.137768 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:41:30.138768 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:41:30.139593 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:41:30.140429 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_country' was properly closed.
[0m01:41:30.141243 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_date' was properly closed.
[0m01:41:30.142077 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m01:41:30.142892 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:41:30.143802 [info ] [MainThread]: 
[0m01:41:30.145154 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 1 view model in 0 hours 0 minutes and 29.60 seconds (29.60s).
[0m01:41:30.154042 [debug] [MainThread]: Command end result
[0m01:41:30.220197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:41:30.223742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:41:30.233274 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:41:30.233812 [info ] [MainThread]: 
[0m01:41:30.234634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:41:30.235341 [info ] [MainThread]: 
[0m01:41:30.236089 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:41:30.237053 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:41:30.238691 [debug] [MainThread]: Command `dbt run` succeeded at 01:41:30.238527 after 39.20 seconds
[0m01:41:30.239211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F016AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F1B0BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F1B0B9B0>]}
[0m01:41:30.239742 [debug] [MainThread]: Flushing usage events
[0m01:41:32.801745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:44.328752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BACB42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281B8929D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BBCFBD90>]}


============================== 01:41:44.334884 | b2a32a86-ca59-4ca1-898a-af367cbcb2a0 ==============================
[0m01:41:44.334884 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:41:44.335885 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select vw_sales_by_date vw_sales_by_country vw_sales_by_product', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:41:48.756257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BB017950>]}
[0m01:41:48.854229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E0756F10>]}
[0m01:41:48.855151 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:41:49.872059 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:41:50.091088 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:41:50.091895 [debug] [MainThread]: previous checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, current checksum: 180a360351ead210ef6bf1515da098349fa36b21374832129712a35b29d44c02
[0m01:41:50.092390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E0DF1B50>]}
[0m01:41:52.994040 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:41:52.995177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E0FDE990>]}
[0m01:41:53.196448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E083CE50>]}
[0m01:41:53.372959 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:41:53.376315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:41:53.420791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E12D7BA0>]}
[0m01:41:53.421456 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m01:41:53.422188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E121D490>]}
[0m01:41:53.425569 [info ] [MainThread]: 
[0m01:41:53.426306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:41:53.426980 [info ] [MainThread]: 
[0m01:41:53.427930 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:53.434297 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:41:53.435019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:55.459341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:41:55.461073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:55.462749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:41:55.464710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:55.466638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:41:55.468643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:57.971458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E12E9C80>]}
[0m01:41:57.972159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:57.980896 [debug] [Thread-3 (]: Began running node model.ga_retail_project.vw_sales_by_product
[0m01:41:57.981568 [debug] [Thread-1 (]: Began running node model.ga_retail_project.vw_sales_by_country
[0m01:41:57.982773 [debug] [Thread-2 (]: Began running node model.ga_retail_project.vw_sales_by_date
[0m01:41:57.982348 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_mart.vw_sales_by_product ................. [RUN]
[0m01:41:57.985546 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.vw_sales_by_product'
[0m01:41:57.986107 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.vw_sales_by_product
[0m01:41:57.997726 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_product"
[0m01:41:57.983863 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_mart.vw_sales_by_country ................. [RUN]
[0m01:41:57.984557 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_mart.vw_sales_by_date .................... [RUN]
[0m01:41:57.999199 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.vw_sales_by_country'
[0m01:41:58.000083 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.vw_sales_by_date'
[0m01:41:58.000731 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.vw_sales_by_country
[0m01:41:58.001400 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.vw_sales_by_date
[0m01:41:58.006605 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.vw_sales_by_product
[0m01:41:58.006017 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_country"
[0m01:41:58.011753 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_date"
[0m01:41:58.058700 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_product"
[0m01:41:58.060794 [debug] [Thread-3 (]: On model.ga_retail_project.vw_sales_by_product: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_product"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_product
  OPTIONS()
  as 

select
  product_sku,
  product_name,
  product_category,
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  sum(product_quantity)                               as units,
  count(distinct transaction_id)                      as orders
from e2e-dbt-project.analytics_mart.fct_sales_item
group by product_sku, product_name, product_category, dt;


[0m01:41:58.061867 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.vw_sales_by_country
[0m01:41:58.062927 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:41:58.063836 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.vw_sales_by_date
[0m01:41:58.067771 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_country"
[0m01:41:58.071535 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_date"
[0m01:41:58.112584 [debug] [Thread-1 (]: On model.ga_retail_project.vw_sales_by_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_country"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_country
  OPTIONS()
  as 

select
  country,
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  count(distinct transaction_id)                      as orders,
  safe_divide(sum(revenue_usd), count(distinct transaction_id)) as aov_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
group by country, dt;


[0m01:41:58.113293 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:41:58.114180 [debug] [Thread-2 (]: On model.ga_retail_project.vw_sales_by_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_date"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_date
  OPTIONS()
  as 

select
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  count(distinct transaction_id)                      as orders,
  count(distinct visitor_id)                          as visitors,
  safe_divide(sum(revenue_usd), count(distinct transaction_id)) as aov_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
group by dt;


[0m01:41:58.114823 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:42:00.701673 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:249c2296-f394-4a06-bf83-d44e216b7749&page=queryresults
[0m01:42:00.711336 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:08ee5668-b543-4178-855b-095fd144fbbc&page=queryresults
[0m01:42:00.831084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6566e173-c50e-4243-860f-004ab38ab7b9&page=queryresults
[0m01:42:01.460616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E13CC410>]}
[0m01:42:01.461194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E29F0A70>]}
[0m01:42:01.462618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2a32a86-ca59-4ca1-898a-af367cbcb2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BAFE30D0>]}
[0m01:42:01.462124 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_mart.vw_sales_by_country ............ [[32mCREATE VIEW (0 processed)[0m in 3.46s]
[0m01:42:01.463730 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_mart.vw_sales_by_date ............... [[32mCREATE VIEW (0 processed)[0m in 3.46s]
[0m01:42:01.465629 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.vw_sales_by_country
[0m01:42:01.466634 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.vw_sales_by_date
[0m01:42:01.464549 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_mart.vw_sales_by_product ............ [[32mCREATE VIEW (0 processed)[0m in 3.47s]
[0m01:42:01.468870 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.vw_sales_by_product
[0m01:42:01.470968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:42:01.473349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:01.473807 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:42:01.474245 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:42:01.474683 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:42:01.475116 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:42:01.475558 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_product' was properly closed.
[0m01:42:01.475987 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_country' was properly closed.
[0m01:42:01.476412 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_date' was properly closed.
[0m01:42:01.476914 [info ] [MainThread]: 
[0m01:42:01.477603 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 8.05 seconds (8.05s).
[0m01:42:01.479345 [debug] [MainThread]: Command end result
[0m01:42:01.534580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:01.538208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:01.547257 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:42:01.552431 [info ] [MainThread]: 
[0m01:42:01.553268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:42:01.553976 [info ] [MainThread]: 
[0m01:42:01.554712 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:42:01.555682 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:42:01.557459 [debug] [MainThread]: Command `dbt run` succeeded at 01:42:01.557288 after 17.42 seconds
[0m01:42:01.558012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E0926630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E0E528D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281E12403B0>]}
[0m01:42:01.558549 [debug] [MainThread]: Flushing usage events
[0m01:42:02.821305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:40.595662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383BA42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213FFBE9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021384BEFD90>]}


============================== 02:04:40.600783 | 52b44fe5-6579-43ed-b287-144a9f0ad9e7 ==============================
[0m02:04:40.600783 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:04:40.601648 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:04:44.401522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021383EFF950>]}
[0m02:04:44.476088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213A867AF10>]}
[0m02:04:44.476796 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:04:45.183259 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:04:45.344693 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:04:45.345331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213A9CBDB50>]}
[0m02:04:47.320035 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m02:04:47.320835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213A9ECE990>]}
[0m02:04:47.481307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213A9730E50>]}
[0m02:04:47.618374 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:04:47.621215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:04:47.658757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AA1C7BA0>]}
[0m02:04:47.659270 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:04:47.659831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AA0FD490>]}
[0m02:04:47.662519 [info ] [MainThread]: 
[0m02:04:47.663062 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:04:47.663573 [info ] [MainThread]: 
[0m02:04:47.664263 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:04:47.670118 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:47.670749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:47.671367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:47.671745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:47.702590 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:04:47.703173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:49.778810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:04:49.780430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:49.781940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:04:49.784368 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:04:49.785544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:49.787115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:51.898695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AA1DA360>]}
[0m02:04:51.899267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:51.906893 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_country
[0m02:04:51.907940 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:04:51.908608 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:04:51.909284 [info ] [Thread-1 (]: 1 of 12 START sql table model analytics_mart.dim_country ....................... [RUN]
[0m02:04:51.909868 [info ] [Thread-2 (]: 2 of 12 START sql view model analytics_stg.stg_hits_products ................... [RUN]
[0m02:04:51.911616 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_country'
[0m02:04:51.912292 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:04:51.910702 [info ] [Thread-3 (]: 3 of 12 START sql view model analytics_stg.stg_sessions ........................ [RUN]
[0m02:04:51.912986 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_country
[0m02:04:51.913659 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:04:51.914796 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:04:51.932219 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_country"
[0m02:04:51.940122 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:04:51.940782 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:04:51.945091 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:04:51.945994 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_country
[0m02:04:51.968206 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:04:51.970866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:51.983080 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:04:52.011276 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:04:52.014817 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:04:52.048419 [debug] [Thread-2 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_hits_products
  OPTIONS()
  as 

-- Unnest product-level hits over the date window controlled by vars.
with base as (
  select
    parse_date('%Y%m%d', _TABLE_SUFFIX)              as session_date,
    cast(fullVisitorId as string)                    as visitor_id,
    cast(visitId as string)                          as visit_id,
    geoNetwork.country                               as country,
    trafficSource.source                             as traffic_source,
    trafficSource.medium                             as traffic_medium,
    trafficSource.campaign                           as traffic_campaign,
    h.transaction.transactionId                      as transaction_id,
    p.productSKU                                     as product_sku,
    p.v2ProductName                                  as product_name,
    p.v2ProductCategory                              as product_category,
    p.productQuantity                                as product_quantity,
    -- GA prices are in micros in the export; treat as "local" at this stage
    safe_divide(p.productPrice, 1e6)                 as product_price_local,
    safe_divide(h.transaction.transactionRevenue, 1e6) as item_revenue_local
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       unnest(hits) as h,
       unnest(h.product) as p
  where _TABLE_SUFFIX between '20160801'
                        and '20170801'
    and p.productSKU is not null
)
select * from base;


[0m02:04:52.049008 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:04:52.049884 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions
  OPTIONS()
  as 

-- Pull sessions over a configurable date window using _TABLE_SUFFIX
-- Usage example:
--   dbt run --select stg_sessions --vars '{ga_start: "20170801", ga_end: "20170831"}'

with src as (
  select
    -- Drive the session date from the shard suffix, not the row field
    parse_date('%Y%m%d', _TABLE_SUFFIX)                as session_date,
    cast(fullVisitorId as string)                      as visitor_id,
    cast(visitId as string)                            as visit_id,
    geoNetwork.country                                 as country,
    trafficSource.source                               as traffic_source,
    trafficSource.medium                               as traffic_medium,
    trafficSource.campaign                             as traffic_campaign,
    totals.visits                                      as visits,
    totals.transactions                                as transactions,
    safe_divide(totals.transactionRevenue, 1e6)        as revenue_usd   -- may be null
  from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
where _TABLE_SUFFIX between '20160801'
                        and '20170801'
)

select *
from src;


[0m02:04:52.050481 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:04:54.076773 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_country"
[0m02:04:54.078066 [debug] [Thread-1 (]: On model.ga_retail_project.dim_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_country"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_country
      
    
    

    
    OPTIONS()
    as (
      

-- Country ↔ Currency from ext mapping (avoid scanning GA)
select distinct
  initcap(country)        as country,
  currency                as local_currency
from `e2e-dbt-project`.`ext`.`country_currency`
where country is not null
  and currency is not null
    );
  
[0m02:04:54.359811 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0245377e-ec4f-4b47-b279-600580ced47e&page=queryresults
[0m02:04:54.361338 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b3063400-2480-45f3-aac8-9b54bd81b82c&page=queryresults
[0m02:04:54.709420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3845ac15-557d-4fb0-ae6f-38cc1fba65e8&page=queryresults
[0m02:04:55.068912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AA2A6990>]}
[0m02:04:55.069431 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB8E0560>]}
[0m02:04:55.070257 [info ] [Thread-2 (]: 2 of 12 OK created sql view model analytics_stg.stg_hits_products .............. [[32mCREATE VIEW (0 processed)[0m in 3.15s]
[0m02:04:55.072177 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:04:55.070989 [info ] [Thread-3 (]: 3 of 12 OK created sql view model analytics_stg.stg_sessions ................... [[32mCREATE VIEW (0 processed)[0m in 3.15s]
[0m02:04:55.073810 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:04:55.074850 [debug] [Thread-4 (]: Began running node model.ga_retail_project.dim_date
[0m02:04:55.075806 [debug] [Thread-2 (]: Began running node model.ga_retail_project.dim_visitors
[0m02:04:55.075414 [info ] [Thread-4 (]: 4 of 12 START sql table model analytics_mart.dim_date .......................... [RUN]
[0m02:04:55.077428 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:55.078126 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.dim_date'
[0m02:04:55.076714 [info ] [Thread-2 (]: 5 of 12 START sql table model analytics_mart.dim_visitors ...................... [RUN]
[0m02:04:55.079479 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.dim_date
[0m02:04:55.078941 [info ] [Thread-3 (]: 6 of 12 START sql view model analytics_stg.stg_sessions_with_fx ................ [RUN]
[0m02:04:55.080207 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_hits_products, now model.ga_retail_project.dim_visitors)
[0m02:04:55.083759 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.dim_date"
[0m02:04:55.084512 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.stg_sessions_with_fx)
[0m02:04:55.085091 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.dim_visitors
[0m02:04:55.085959 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:55.092359 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.dim_visitors"
[0m02:04:55.096647 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:04:55.097483 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.dim_date
[0m02:04:55.100221 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:04:55.101102 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:55.105528 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:04:55.140293 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.dim_visitors
[0m02:04:55.145536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:04:55.187044 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view e2e-dbt-project.analytics_stg.stg_sessions_with_fx
  OPTIONS()
  as 

with cc as (
  select country, currency
  from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
  select rate_date, currency, rate_to_usd
  from `e2e-dbt-project`.`ext`.`fx_rates`
),
s as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions
)
select
  s.session_date,
  s.visitor_id,
  s.visit_id,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  s.visits,
  s.transactions,
  s.revenue_usd as session_revenue_usd_raw,  -- may be null
  cc.currency    as local_currency,
  fx.rate_to_usd
from s
left join cc
  on lower(cc.country) = lower(s.country)
left join fx
  on fx.rate_date = s.session_date
 and fx.currency  = cc.currency;


[0m02:04:55.188712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:04:56.986240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AA20CF30>]}
[0m02:04:56.987091 [info ] [Thread-1 (]: 1 of 12 OK created sql table model analytics_mart.dim_country .................. [[32mCREATE TABLE (7.0 rows, 110.0 Bytes processed)[0m in 5.07s]
[0m02:04:56.988090 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_country
[0m02:04:57.191972 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.dim_date"
[0m02:04:57.193069 [debug] [Thread-4 (]: On model.ga_retail_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_date"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_date
      
    
    

    
    OPTIONS()
    as (
      

-- Simple, robust date dimension built from observed session dates
select
  session_date as dt
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is not null
group by session_date
    );
  
[0m02:04:57.262063 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.dim_visitors"
[0m02:04:57.263419 [debug] [Thread-2 (]: On model.ga_retail_project.dim_visitors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_visitors"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_visitors
      
    
    

    
    OPTIONS()
    as (
      

-- Attribute-only visitor dimension. No additive measures here.
with base as (
  select
    cast(visitor_id as string)                                as visitor_id,
    min(session_date)                                         as first_seen_date,
    max(session_date)                                         as last_seen_date,
    any_value(country)                                        as last_country,  -- arbitrary but stable enough
    any_value(traffic_source)                                 as last_source,
    any_value(traffic_medium)                                 as last_medium
  from e2e-dbt-project.analytics_stg.stg_sessions
  group by visitor_id
)

select * from base
    );
  
[0m02:04:57.702590 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b3515a22-7956-4e49-b5e4-c47ca487af0a&page=queryresults
[0m02:04:57.915200 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:17d037d1-4c08-488c-99a5-7df631825395&page=queryresults
[0m02:04:57.964345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:693c423d-5b14-44a2-8aff-69c0e02682f8&page=queryresults
[0m02:04:58.241094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB86E150>]}
[0m02:04:58.242482 [info ] [Thread-3 (]: 6 of 12 OK created sql view model analytics_stg.stg_sessions_with_fx ........... [[32mCREATE VIEW (0 processed)[0m in 3.16s]
[0m02:04:58.243762 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:04:58.244539 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m02:04:58.245218 [info ] [Thread-1 (]: 7 of 12 START sql view model analytics_int.int_sessions_enriched ............... [RUN]
[0m02:04:58.246004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_country, now model.ga_retail_project.int_sessions_enriched)
[0m02:04:58.246489 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m02:04:58.250912 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m02:04:58.252795 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m02:04:58.257140 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m02:04:58.258900 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view e2e-dbt-project.analytics_int.int_sessions_enriched
  OPTIONS()
  as 

-- Silver: join item-level hits with session-day FX, compute USD metrics.
with sess as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
),
items as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    -- local currency amounts from staging
    product_price_local,
    item_revenue_local
  from e2e-dbt-project.analytics_stg.stg_hits_products
),
joined as (
  select
    i.session_date,
    i.visitor_id,
    i.visit_id,
    i.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    i.transaction_id,
    i.product_sku,
    i.product_name,
    i.product_category,
    i.product_quantity,
    i.product_price_local,
    coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) as revenue_local,
    -- FX conversion at session_date granularity
    (i.product_price_local * s.rate_to_usd) as product_price_usd,
    (coalesce(i.item_revenue_local, i.product_quantity * i.product_price_local) * s.rate_to_usd) as revenue_usd,
    s.rate_to_usd,
    s.local_currency
  from items i
  left join sess s
    on s.session_date = i.session_date
   and s.visitor_id   = i.visitor_id
   and s.visit_id     = i.visit_id
   and lower(s.country) = lower(i.country)
)

select * from joined;


[0m02:04:58.259650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:00.394761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b3ca4e6a-de19-4ce4-9318-265acee38fe3&page=queryresults
[0m02:05:01.009247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB86E990>]}
[0m02:05:01.010365 [info ] [Thread-1 (]: 7 of 12 OK created sql view model analytics_int.int_sessions_enriched .......... [[32mCREATE VIEW (0 processed)[0m in 2.76s]
[0m02:05:01.011820 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m02:05:01.012894 [debug] [Thread-3 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:05:01.013711 [info ] [Thread-3 (]: 8 of 12 START sql incremental model analytics_mart.fct_sales_item .............. [RUN]
[0m02:05:01.014588 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions_with_fx, now model.ga_retail_project.fct_sales_item)
[0m02:05:01.015654 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:05:01.028113 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:05:01.029675 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:05:01.095197 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:03.014811 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:05:03.016386 [debug] [Thread-3 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.fct_sales_item
      
    partition by session_date
    cluster by country, product_sku, product_category

    
    OPTIONS()
    as (
      

with base as (
  select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
  from e2e-dbt-project.analytics_int.int_sessions_enriched
  -- Keep only true sales lines
  where transaction_id is not null
    and coalesce(revenue_usd, 0) > 0
    and coalesce(product_quantity, 0) > 0
)

select * from base


    );
  
[0m02:05:03.948279 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:29f259f8-25e8-4fb0-b478-3e58964f9044&page=queryresults
[0m02:05:14.512531 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB86D4F0>]}
[0m02:05:14.513354 [info ] [Thread-4 (]: 4 of 12 OK created sql table model analytics_mart.dim_date ..................... [[32mCREATE TABLE (366.0 rows, 0 processed)[0m in 19.43s]
[0m02:05:14.514566 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.dim_date
[0m02:05:17.621774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB86DD30>]}
[0m02:05:17.623545 [info ] [Thread-2 (]: 5 of 12 OK created sql table model analytics_mart.dim_visitors ................. [[32mCREATE TABLE (714.2k rows, 44.8 MiB processed)[0m in 22.54s]
[0m02:05:17.625908 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.dim_visitors
[0m02:05:23.265089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB86D1F0>]}
[0m02:05:23.266516 [info ] [Thread-3 (]: 8 of 12 OK created sql incremental model analytics_mart.fct_sales_item ......... [[32mCREATE TABLE (35.4k rows, 1.5 GiB processed)[0m in 22.25s]
[0m02:05:23.268693 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:05:23.270264 [debug] [Thread-2 (]: Began running node model.ga_retail_project.vw_sales_by_date
[0m02:05:23.271170 [debug] [Thread-4 (]: Began running node model.ga_retail_project.vw_sales_by_country
[0m02:05:23.272003 [debug] [Thread-3 (]: Began running node model.ga_retail_project.vw_sales_by_product
[0m02:05:23.272867 [debug] [Thread-1 (]: Began running node model.ga_retail_project.dim_products
[0m02:05:23.274067 [info ] [Thread-2 (]: 11 of 12 START sql view model analytics_mart.vw_sales_by_date .................. [RUN]
[0m02:05:23.275417 [info ] [Thread-4 (]: 10 of 12 START sql view model analytics_mart.vw_sales_by_country ............... [RUN]
[0m02:05:23.278331 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_visitors, now model.ga_retail_project.vw_sales_by_date)
[0m02:05:23.279308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.dim_date, now model.ga_retail_project.vw_sales_by_country)
[0m02:05:23.276593 [info ] [Thread-3 (]: 12 of 12 START sql view model analytics_mart.vw_sales_by_product ............... [RUN]
[0m02:05:23.280036 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.vw_sales_by_date
[0m02:05:23.280658 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.vw_sales_by_country
[0m02:05:23.277729 [info ] [Thread-1 (]: 9 of 12 START sql table model analytics_mart.dim_products ...................... [RUN]
[0m02:05:23.281455 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.fct_sales_item, now model.ga_retail_project.vw_sales_by_product)
[0m02:05:23.288075 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_date"
[0m02:05:23.293824 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_country"
[0m02:05:23.294419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.int_sessions_enriched, now model.ga_retail_project.dim_products)
[0m02:05:23.294925 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.vw_sales_by_product
[0m02:05:23.295656 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.dim_products
[0m02:05:23.299966 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.vw_sales_by_product"
[0m02:05:23.305787 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.dim_products"
[0m02:05:23.306772 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.vw_sales_by_date
[0m02:05:23.307607 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.vw_sales_by_country
[0m02:05:23.310495 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_date"
[0m02:05:23.313369 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_country"
[0m02:05:23.314307 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.vw_sales_by_product
[0m02:05:23.318143 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.vw_sales_by_product"
[0m02:05:23.318989 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.dim_products
[0m02:05:23.322056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:23.322848 [debug] [Thread-2 (]: On model.ga_retail_project.vw_sales_by_date: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_date"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_date
  OPTIONS()
  as 

select
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  count(distinct transaction_id)                      as orders,
  count(distinct visitor_id)                          as visitors,
  safe_divide(sum(revenue_usd), count(distinct transaction_id)) as aov_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
group by dt;


[0m02:05:23.323489 [debug] [Thread-4 (]: On model.ga_retail_project.vw_sales_by_country: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_country"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_country
  OPTIONS()
  as 

select
  country,
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  count(distinct transaction_id)                      as orders,
  safe_divide(sum(revenue_usd), count(distinct transaction_id)) as aov_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
group by country, dt;


[0m02:05:23.324223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:05:23.325896 [debug] [Thread-3 (]: On model.ga_retail_project.vw_sales_by_product: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.vw_sales_by_product"} */


  create or replace view e2e-dbt-project.analytics_mart.vw_sales_by_product
  OPTIONS()
  as 

select
  product_sku,
  product_name,
  product_category,
  session_date                                        as dt,
  sum(revenue_usd)                                    as revenue_usd,
  sum(revenue_local)                                  as revenue_local,
  sum(product_quantity)                               as units,
  count(distinct transaction_id)                      as orders
from e2e-dbt-project.analytics_mart.fct_sales_item
group by product_sku, product_name, product_category, dt;


[0m02:05:23.326359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:23.357480 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:25.403636 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.dim_products"
[0m02:05:25.408421 [debug] [Thread-1 (]: On model.ga_retail_project.dim_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.dim_products"} */

  
    

    create or replace table e2e-dbt-project.analytics_mart.dim_products
      
    
    

    
    OPTIONS()
    as (
      

with base as (
  select
    product_sku,
    any_value(product_name)     as product_name,
    any_value(product_category) as product_category
  from e2e-dbt-project.analytics_mart.fct_sales_item
  group by product_sku
)
select * from base
    );
  
[0m02:05:25.630593 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:69bb92fb-4a3b-42e9-9a46-9bc8511dcc94&page=queryresults
[0m02:05:25.789730 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5084644d-fded-45be-ba0b-50774cc763ff&page=queryresults
[0m02:05:25.870453 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:97ad7547-2d5a-44c8-9b23-65ae13cb4649&page=queryresults
[0m02:05:25.961007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b1bcbb48-b6f6-404d-84dd-78f47f064a9e&page=queryresults
[0m02:05:26.227774 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB9B2E10>]}
[0m02:05:26.230545 [info ] [Thread-4 (]: 10 of 12 OK created sql view model analytics_mart.vw_sales_by_country .......... [[32mCREATE VIEW (0 processed)[0m in 2.95s]
[0m02:05:26.235810 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.vw_sales_by_country
[0m02:05:26.358363 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB9B03B0>]}
[0m02:05:26.359201 [info ] [Thread-3 (]: 12 of 12 OK created sql view model analytics_mart.vw_sales_by_product .......... [[32mCREATE VIEW (0 processed)[0m in 3.08s]
[0m02:05:26.360233 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.vw_sales_by_product
[0m02:05:26.416599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB9B2ED0>]}
[0m02:05:26.417432 [info ] [Thread-2 (]: 11 of 12 OK created sql view model analytics_mart.vw_sales_by_date ............. [[32mCREATE VIEW (0 processed)[0m in 3.14s]
[0m02:05:26.418628 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.vw_sales_by_date
[0m02:05:29.385849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b44fe5-6579-43ed-b287-144a9f0ad9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB9B3770>]}
[0m02:05:29.388595 [info ] [Thread-1 (]: 9 of 12 OK created sql table model analytics_mart.dim_products ................. [[32mCREATE TABLE (1.1k rows, 2.0 MiB processed)[0m in 6.09s]
[0m02:05:29.392244 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.dim_products
[0m02:05:29.396225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:05:29.406171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:29.407050 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:05:29.407934 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:05:29.408880 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:05:29.410034 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:05:29.410803 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:05:29.411617 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:05:29.412321 [debug] [MainThread]: Connection 'model.ga_retail_project.dim_products' was properly closed.
[0m02:05:29.413093 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_date' was properly closed.
[0m02:05:29.413779 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_product' was properly closed.
[0m02:05:29.414445 [debug] [MainThread]: Connection 'model.ga_retail_project.vw_sales_by_country' was properly closed.
[0m02:05:29.415333 [info ] [MainThread]: 
[0m02:05:29.416176 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 7 view models in 0 hours 0 minutes and 41.75 seconds (41.75s).
[0m02:05:29.419931 [debug] [MainThread]: Command end result
[0m02:05:29.487849 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:05:29.490883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:05:29.498501 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:05:29.498915 [info ] [MainThread]: 
[0m02:05:29.499571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:05:29.500144 [info ] [MainThread]: 
[0m02:05:29.500710 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m02:05:29.501749 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m02:05:29.503977 [debug] [MainThread]: Command `dbt run` succeeded at 02:05:29.503785 after 49.12 seconds
[0m02:05:29.504450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213A9F94770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AA285A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AB86D9D0>]}
[0m02:05:29.504883 [debug] [MainThread]: Flushing usage events
[0m02:05:31.705735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:35.321347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A77A8942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A77852DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A77B8DFD90>]}


============================== 02:05:35.327252 | 8cbed08d-5117-46f9-b2b7-9c36d2dffeb6 ==============================
[0m02:05:35.327252 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:05:35.328178 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m02:05:38.839572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cbed08d-5117-46f9-b2b7-9c36d2dffeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A77ABF3950>]}
[0m02:05:38.911100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cbed08d-5117-46f9-b2b7-9c36d2dffeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7203B2F10>]}
[0m02:05:38.911817 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:05:39.630777 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:05:39.884769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:05:39.885144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:05:39.951921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cbed08d-5117-46f9-b2b7-9c36d2dffeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72040D450>]}
[0m02:05:40.082265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:05:40.084927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:05:40.131666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cbed08d-5117-46f9-b2b7-9c36d2dffeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720BF7020>]}
[0m02:05:40.132173 [info ] [MainThread]: Found 12 models, 34 data tests, 1 seed, 2 sources, 1 exposure, 612 macros
[0m02:05:40.132788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbed08d-5117-46f9-b2b7-9c36d2dffeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720BEEF90>]}
[0m02:05:40.136893 [info ] [MainThread]: 
[0m02:05:40.137515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:05:40.138046 [info ] [MainThread]: 
[0m02:05:40.138840 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:05:40.143989 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:05:40.144511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:40.174853 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:05:40.175359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:40.206047 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m02:05:40.206469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:42.192807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cbed08d-5117-46f9-b2b7-9c36d2dffeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720C5BD40>]}
[0m02:05:42.194108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:05:42.204527 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m02:05:42.205558 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:05:42.206241 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:05:42.206834 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m02:05:42.207336 [info ] [Thread-1 (]: 1 of 34 START test dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency  [RUN]
[0m02:05:42.207958 [info ] [Thread-3 (]: 3 of 34 START test not_null_dim_country_country ................................ [RUN]
[0m02:05:42.210568 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe'
[0m02:05:42.208916 [info ] [Thread-4 (]: 4 of 34 START test not_null_dim_date_dt ........................................ [RUN]
[0m02:05:42.211627 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_country_country.efd0998505'
[0m02:05:42.212568 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m02:05:42.209802 [info ] [Thread-2 (]: 2 of 34 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date  [RUN]
[0m02:05:42.213626 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_dim_date_dt.58a291f69b'
[0m02:05:42.214126 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:05:42.237766 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027'
[0m02:05:42.244674 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe"
[0m02:05:42.245395 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:05:42.258144 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:05:42.259015 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m02:05:42.265323 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m02:05:42.273884 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027"
[0m02:05:42.275437 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m02:05:42.308683 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe"
[0m02:05:42.309430 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:05:42.312680 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"
[0m02:05:42.313466 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:05:42.316592 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_country_country.efd0998505"
[0m02:05:42.317524 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m02:05:42.320983 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027"
[0m02:05:42.322255 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_country_country.efd0998505: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_country_country.efd0998505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from e2e-dbt-project.analytics_mart.dim_country
where country is null



  
  
      
    ) dbt_internal_test
[0m02:05:42.323028 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_date_dt.58a291f69b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_date_dt.58a291f69b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dt
from e2e-dbt-project.analytics_mart.dim_date
where dt is null



  
  
      
    ) dbt_internal_test
[0m02:05:42.324069 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        rate_date, currency
    from `e2e-dbt-project`.`ext`.`fx_rates`
    group by rate_date, currency
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:05:42.324844 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:05:42.325453 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:05:42.326016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:05:42.326577 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id, session_date
    from e2e-dbt-project.analytics_stg.stg_sessions
    group by visitor_id, visit_id, session_date
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:05:42.327544 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:05:44.902802 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cec0917f-6f8f-43b5-a373-62098ece09d4&page=queryresults
[0m02:05:44.952470 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:81560690-9043-4b5c-80f2-7565455e8e7e&page=queryresults
[0m02:05:45.012164 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b2659333-2b85-440e-9c47-e4cb379c8f79&page=queryresults
[0m02:05:45.271338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4521898b-363d-4383-b7d5-829b5bd81ad8&page=queryresults
[0m02:05:45.915670 [info ] [Thread-3 (]: 3 of 34 PASS not_null_dim_country_country ...................................... [[32mPASS[0m in 3.70s]
[0m02:05:45.921968 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_country_country.efd0998505
[0m02:05:45.923072 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:05:45.924682 [info ] [Thread-3 (]: 5 of 34 START test not_null_dim_products_product_sku ........................... [RUN]
[0m02:05:45.926049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_country_country.efd0998505, now test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343)
[0m02:05:45.927064 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:05:45.934152 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:05:45.945841 [info ] [Thread-4 (]: 4 of 34 PASS not_null_dim_date_dt .............................................. [[32mPASS[0m in 3.73s]
[0m02:05:45.946711 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:05:45.947464 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_date_dt.58a291f69b
[0m02:05:45.950571 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"
[0m02:05:45.951219 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:05:45.952566 [info ] [Thread-4 (]: 6 of 34 START test not_null_dim_visitors_visitor_id ............................ [RUN]
[0m02:05:45.953617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_date_dt.58a291f69b, now test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3)
[0m02:05:45.954205 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:05:45.959257 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:05:45.960229 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.dim_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:05:45.960980 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:45.996585 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:05:46.000525 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"
[0m02:05:46.003042 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_mart.dim_visitors
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:05:46.004105 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:46.243746 [info ] [Thread-1 (]: 1 of 34 PASS dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency  [[32mPASS[0m in 4.03s]
[0m02:05:46.244694 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe
[0m02:05:46.245248 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:05:46.245755 [info ] [Thread-1 (]: 7 of 34 START test not_null_fct_sales_item_product_sku ......................... [RUN]
[0m02:05:46.246382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_source_unique_combination_of_columns_ext_fx_rates_rate_date__currency.76d53d14fe, now test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e)
[0m02:05:46.246776 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:05:46.250830 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:05:46.252266 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:05:46.255059 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"
[0m02:05:46.256140 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:05:46.256845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:48.283037 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:75194427-a2a7-46da-8c54-0191abfda792&page=queryresults
[0m02:05:48.425679 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f1c6e90e-aafb-44ae-bfb5-ed8cf5d3dad9&page=queryresults
[0m02:05:49.026542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:742537f8-4518-4b39-af9f-23e589133ab1&page=queryresults
[0m02:05:49.329605 [info ] [Thread-4 (]: 6 of 34 PASS not_null_dim_visitors_visitor_id .................................. [[32mPASS[0m in 3.38s]
[0m02:05:49.336942 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3
[0m02:05:49.338867 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:05:49.341547 [info ] [Thread-4 (]: 8 of 34 START test not_null_fct_sales_item_revenue_local ....................... [RUN]
[0m02:05:49.344838 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_visitors_visitor_id.c034ca95d3, now test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392)
[0m02:05:49.346978 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:05:49.357627 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m02:05:49.359566 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:05:49.367592 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"
[0m02:05:49.370341 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_local
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_local is null



  
  
      
    ) dbt_internal_test
[0m02:05:49.371259 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:49.427465 [info ] [Thread-3 (]: 5 of 34 PASS not_null_dim_products_product_sku ................................. [[32mPASS[0m in 3.50s]
[0m02:05:49.428599 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343
[0m02:05:49.429116 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:05:49.429718 [info ] [Thread-3 (]: 9 of 34 START test not_null_fct_sales_item_revenue_usd ......................... [RUN]
[0m02:05:49.430446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_dim_products_product_sku.1098c1a343, now test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc)
[0m02:05:49.430928 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:05:49.435908 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:05:49.437688 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:05:49.441492 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"
[0m02:05:49.442801 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from e2e-dbt-project.analytics_mart.fct_sales_item
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m02:05:49.443617 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:49.939040 [info ] [Thread-1 (]: 7 of 34 PASS not_null_fct_sales_item_product_sku ............................... [[32mPASS[0m in 3.69s]
[0m02:05:49.940070 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e
[0m02:05:49.940484 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:05:49.941026 [info ] [Thread-1 (]: 10 of 34 START test not_null_fct_sales_item_session_date ....................... [RUN]
[0m02:05:49.941791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_product_sku.c32f68e54e, now test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50)
[0m02:05:49.942140 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:05:49.945654 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:05:49.946631 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:05:49.949454 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"
[0m02:05:49.950579 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_mart.fct_sales_item
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:05:49.951267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:52.250111 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:48e5ad29-fd00-4469-8a68-ced9d9166562&page=queryresults
[0m02:05:52.258997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:df3dadfe-cf82-4c01-8406-4cd58f8ae42f&page=queryresults
[0m02:05:52.940548 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab79d7f3-7398-4769-b363-d528005ec3de&page=queryresults
[0m02:05:53.140923 [info ] [Thread-4 (]: 8 of 34 PASS not_null_fct_sales_item_revenue_local ............................. [[32mPASS[0m in 3.80s]
[0m02:05:53.144858 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392
[0m02:05:53.146212 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:05:53.147540 [info ] [Thread-4 (]: 11 of 34 START test not_null_fct_sales_item_transaction_id ..................... [RUN]
[0m02:05:53.149253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_local.7b5a88f392, now test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98)
[0m02:05:53.150972 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:05:53.158922 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:05:53.161253 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:05:53.165243 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"
[0m02:05:53.166582 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from e2e-dbt-project.analytics_mart.fct_sales_item
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m02:05:53.167377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:53.241423 [info ] [Thread-1 (]: 10 of 34 PASS not_null_fct_sales_item_session_date ............................. [[32mPASS[0m in 3.30s]
[0m02:05:53.242515 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50
[0m02:05:53.243026 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:05:53.243618 [info ] [Thread-1 (]: 12 of 34 START test not_null_int_sessions_enriched_session_date ................ [RUN]
[0m02:05:53.244409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_session_date.3690555d50, now test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da)
[0m02:05:53.244874 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:05:53.249446 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:05:53.251039 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:05:53.259506 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m02:05:53.261516 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_int.int_sessions_enriched
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:05:53.262386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:05:54.241982 [info ] [Thread-3 (]: 9 of 34 PASS not_null_fct_sales_item_revenue_usd ............................... [[32mPASS[0m in 4.81s]
[0m02:05:54.242883 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc
[0m02:05:54.243303 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:05:54.243876 [info ] [Thread-3 (]: 13 of 34 START test not_null_int_sessions_enriched_visit_id .................... [RUN]
[0m02:05:54.244675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_revenue_usd.3a4855d5fc, now test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9)
[0m02:05:54.245043 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:05:54.248645 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:05:54.258666 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:05:54.264847 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m02:05:54.267309 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:05:54.268140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:05:55.580425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:babbd3e8-9a3e-49d0-ba13-65d128a98e0f&page=queryresults
[0m02:05:55.902905 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ecbb2d07-d610-49b4-be54-6367f8a9083e&page=queryresults
[0m02:05:56.464154 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:699790a2-8fda-4823-a369-f0d2bfb50f75&page=queryresults
[0m02:05:56.814418 [info ] [Thread-4 (]: 11 of 34 PASS not_null_fct_sales_item_transaction_id ........................... [[32mPASS[0m in 3.67s]
[0m02:05:56.815505 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98
[0m02:05:56.815996 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:05:56.816565 [info ] [Thread-4 (]: 14 of 34 START test not_null_int_sessions_enriched_visitor_id .................. [RUN]
[0m02:05:56.817343 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_fct_sales_item_transaction_id.984a9f1b98, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m02:05:56.817892 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:05:56.824787 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:05:56.826734 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:05:56.831703 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m02:05:56.833297 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_int.int_sessions_enriched
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:05:56.834067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:05:58.893787 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1b6c5390-8165-47d7-92df-c973b5d5a15e&page=queryresults
[0m02:05:59.149271 [info ] [Thread-2 (]: 2 of 34 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date  [[32mPASS[0m in 16.91s]
[0m02:05:59.151301 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027
[0m02:05:59.151924 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:05:59.152815 [info ] [Thread-2 (]: 15 of 34 START test not_null_product_categories_product_category ............... [RUN]
[0m02:05:59.154868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id__session_date.1a7095a027, now test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0)
[0m02:05:59.155534 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:05:59.161007 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:05:59.162792 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:05:59.166561 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"
[0m02:05:59.169427 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category
from e2e-dbt-project.analytics_stg.product_categories
where product_category is null



  
  
      
    ) dbt_internal_test
[0m02:05:59.170205 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:06:01.139761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:98ceb23f-4095-4ebc-87d6-51521e2c2987&page=queryresults
[0m02:06:02.084296 [info ] [Thread-2 (]: 15 of 34 PASS not_null_product_categories_product_category ..................... [[32mPASS[0m in 2.93s]
[0m02:06:02.088656 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0
[0m02:06:02.090474 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:06:02.092495 [info ] [Thread-2 (]: 16 of 34 START test not_null_product_categories_product_sku .................... [RUN]
[0m02:06:02.094723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_category.bc21a487b0, now test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05)
[0m02:06:02.096345 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:06:02.105486 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:06:02.108272 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:06:02.114748 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"
[0m02:06:02.117332 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.product_categories
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:06:02.118520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:06:04.091768 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b3c36f19-0141-4524-96f2-2ff2e65e9bff&page=queryresults
[0m02:06:04.950083 [info ] [Thread-2 (]: 16 of 34 PASS not_null_product_categories_product_sku .......................... [[32mPASS[0m in 2.86s]
[0m02:06:04.954951 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05
[0m02:06:04.958531 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:06:04.962133 [info ] [Thread-2 (]: 17 of 34 START test not_null_stg_hits_products_product_sku ..................... [RUN]
[0m02:06:04.965401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_product_categories_product_sku.1546ab5c05, now test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90)
[0m02:06:04.967339 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:06:04.986197 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:06:04.996606 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:06:05.000786 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"
[0m02:06:05.003627 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sku
from e2e-dbt-project.analytics_stg.stg_hits_products
where product_sku is null



  
  
      
    ) dbt_internal_test
[0m02:06:05.004317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:06:06.364277 [info ] [Thread-1 (]: 12 of 34 PASS not_null_int_sessions_enriched_session_date ...................... [[32mPASS[0m in 13.12s]
[0m02:06:06.365327 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m02:06:06.365818 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:06:06.366386 [info ] [Thread-1 (]: 18 of 34 START test not_null_stg_sessions_session_date ......................... [RUN]
[0m02:06:06.367146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da, now test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e)
[0m02:06:06.367664 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:06:06.375478 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:06:06.378418 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:06:06.385198 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m02:06:06.387222 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from e2e-dbt-project.analytics_stg.stg_sessions
where session_date is null



  
  
      
    ) dbt_internal_test
[0m02:06:06.388257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:06.971818 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bad350ce-d159-46b0-9b7c-98d326df6c03&page=queryresults
[0m02:06:07.317640 [info ] [Thread-3 (]: 13 of 34 PASS not_null_int_sessions_enriched_visit_id .......................... [[32mPASS[0m in 13.07s]
[0m02:06:07.318910 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m02:06:07.319378 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:06:07.319906 [info ] [Thread-3 (]: 19 of 34 START test not_null_stg_sessions_visit_id ............................. [RUN]
[0m02:06:07.320738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m02:06:07.321582 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:06:07.330465 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:06:07.332226 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:06:07.335497 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m02:06:07.336849 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m02:06:07.337575 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:06:08.363185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dcf0f8ad-1c11-4f86-9bc3-a29a3728026b&page=queryresults
[0m02:06:09.296380 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1e399308-69bd-41ab-a384-4e22b9b2c1ef&page=queryresults
[0m02:06:09.775541 [info ] [Thread-1 (]: 18 of 34 PASS not_null_stg_sessions_session_date ............................... [[32mPASS[0m in 3.41s]
[0m02:06:09.779332 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m02:06:09.781115 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:06:09.783989 [info ] [Thread-1 (]: 20 of 34 START test not_null_stg_sessions_visitor_id ........................... [RUN]
[0m02:06:09.787239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m02:06:09.789683 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:06:09.807122 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:06:09.810221 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:06:09.816734 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m02:06:09.819497 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from e2e-dbt-project.analytics_stg.stg_sessions
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m02:06:09.821011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:11.839455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eeca1e5d-b82d-407f-87e8-7e25d6ae7947&page=queryresults
[0m02:06:15.486473 [info ] [Thread-4 (]: 14 of 34 PASS not_null_int_sessions_enriched_visitor_id ........................ [[32mPASS[0m in 18.67s]
[0m02:06:15.490207 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m02:06:15.492023 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:06:15.494022 [info ] [Thread-4 (]: 21 of 34 START test source_not_null_ext_country_currency_country ............... [RUN]
[0m02:06:15.497068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52, now test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f)
[0m02:06:15.499896 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:06:15.513536 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:06:15.516979 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:06:15.525351 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"
[0m02:06:15.527674 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country
from `e2e-dbt-project`.`ext`.`country_currency`
where country is null



  
  
      
    ) dbt_internal_test
[0m02:06:15.529047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:17.512295 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:adea277a-1f18-4ba1-876c-95890c168edf&page=queryresults
[0m02:06:17.773277 [info ] [Thread-2 (]: 17 of 34 PASS not_null_stg_hits_products_product_sku ........................... [[32mPASS[0m in 12.81s]
[0m02:06:17.776027 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90
[0m02:06:17.777389 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:06:17.779139 [info ] [Thread-2 (]: 22 of 34 START test source_not_null_ext_country_currency_currency .............. [RUN]
[0m02:06:17.781194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_hits_products_product_sku.e960862d90, now test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c)
[0m02:06:17.784807 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:06:17.799212 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:06:17.805010 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:06:17.811743 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"
[0m02:06:17.814306 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`country_currency`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:06:17.815482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:06:18.348460 [info ] [Thread-4 (]: 21 of 34 PASS source_not_null_ext_country_currency_country ..................... [[32mPASS[0m in 2.85s]
[0m02:06:18.349642 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f
[0m02:06:18.350063 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:06:18.350574 [info ] [Thread-4 (]: 23 of 34 START test source_not_null_ext_fx_rates_currency ...................... [RUN]
[0m02:06:18.351408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_country.c3d542dd4f, now test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c)
[0m02:06:18.352339 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:06:18.361466 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:06:18.363202 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:06:18.369708 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"
[0m02:06:18.371548 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `e2e-dbt-project`.`ext`.`fx_rates`
where currency is null



  
  
      
    ) dbt_internal_test
[0m02:06:18.372264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:19.843333 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a89082c7-8273-461d-83e8-1560cd9807b5&page=queryresults
[0m02:06:20.485441 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1eca3a48-6978-4ded-be32-c04f1c22699c&page=queryresults
[0m02:06:20.718788 [info ] [Thread-2 (]: 22 of 34 PASS source_not_null_ext_country_currency_currency .................... [[32mPASS[0m in 2.94s]
[0m02:06:20.720293 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c
[0m02:06:20.721018 [debug] [Thread-2 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:06:20.721988 [info ] [Thread-2 (]: 24 of 34 START test source_not_null_ext_fx_rates_rate_date ..................... [RUN]
[0m02:06:20.723237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_country_currency_currency.711d368f5c, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354)
[0m02:06:20.724085 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:06:20.731048 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:06:20.733528 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:06:20.744899 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"
[0m02:06:20.746518 [debug] [Thread-2 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_date
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_date is null



  
  
      
    ) dbt_internal_test
[0m02:06:20.747350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:06:21.371257 [info ] [Thread-4 (]: 23 of 34 PASS source_not_null_ext_fx_rates_currency ............................ [[32mPASS[0m in 3.02s]
[0m02:06:21.372459 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c
[0m02:06:21.372925 [debug] [Thread-4 (]: Began running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:06:21.373584 [info ] [Thread-4 (]: 25 of 34 START test source_not_null_ext_fx_rates_rate_to_usd ................... [RUN]
[0m02:06:21.374504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_currency.7653c6bd6c, now test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01)
[0m02:06:21.374926 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:06:21.379246 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:06:21.380475 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:06:21.545162 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"
[0m02:06:21.547225 [debug] [Thread-4 (]: On test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate_to_usd
from `e2e-dbt-project`.`ext`.`fx_rates`
where rate_to_usd is null



  
  
      
    ) dbt_internal_test
[0m02:06:21.547901 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:23.047864 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4a6b3aa8-924f-4699-92a6-86391f137492&page=queryresults
[0m02:06:23.517226 [info ] [Thread-3 (]: 19 of 34 PASS not_null_stg_sessions_visit_id ................................... [[32mPASS[0m in 16.20s]
[0m02:06:23.519412 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m02:06:23.520496 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m02:06:23.521488 [info ] [Thread-3 (]: 26 of 34 START test stg_hits_products_quality .................................. [RUN]
[0m02:06:23.522760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.stg_hits_products_quality)
[0m02:06:23.523587 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m02:06:23.529160 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:06:23.532327 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m02:06:23.538315 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m02:06:23.541771 [debug] [Thread-3 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Ensure product price is present & non-negative for rows that should have a price
with t as (
  select *
  from e2e-dbt-project.analytics_stg.stg_hits_products
)
select *
from t
where product_price_local is null
   or product_price_local < 0
  
  
      
    ) dbt_internal_test
[0m02:06:23.543293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:06:23.798550 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:98683a67-a00d-44a6-9c0d-7a9049d5455d&page=queryresults
[0m02:06:23.894175 [info ] [Thread-2 (]: 24 of 34 PASS source_not_null_ext_fx_rates_rate_date ........................... [[32mPASS[0m in 3.17s]
[0m02:06:23.895355 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354
[0m02:06:23.895787 [debug] [Thread-2 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:06:23.896293 [info ] [Thread-2 (]: 27 of 34 START test stg_sessions_revenue_nonnegative ........................... [RUN]
[0m02:06:23.897006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_date.404919c354, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m02:06:23.897411 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:06:23.899914 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:06:23.900950 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:06:23.904065 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m02:06:23.905334 [debug] [Thread-2 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from e2e-dbt-project.analytics_stg.stg_sessions
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m02:06:23.906065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:06:24.033853 [info ] [Thread-1 (]: 20 of 34 PASS not_null_stg_sessions_visitor_id ................................. [[32mPASS[0m in 14.25s]
[0m02:06:24.035393 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m02:06:24.036413 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:06:24.037549 [info ] [Thread-1 (]: 28 of 34 START test stg_sessions_with_fx_local_nonnegative ..................... [RUN]
[0m02:06:24.038862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94, now test.ga_retail_project.stg_sessions_with_fx_local_nonnegative)
[0m02:06:24.039834 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:06:24.045822 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:06:24.047988 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:06:24.052111 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m02:06:24.054085 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Check session_revenue_usd_raw is non-negative (when present), and FX is positive
with t as (
  select *
  from e2e-dbt-project.analytics_stg.stg_sessions_with_fx
)
select *
from t
where (session_revenue_usd_raw is not null and session_revenue_usd_raw < 0)
   or (rate_to_usd is not null and rate_to_usd <= 0)
  
  
      
    ) dbt_internal_test
[0m02:06:24.055107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:24.624239 [info ] [Thread-4 (]: 25 of 34 PASS source_not_null_ext_fx_rates_rate_to_usd ......................... [[32mPASS[0m in 3.25s]
[0m02:06:24.625270 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01
[0m02:06:24.625717 [debug] [Thread-4 (]: Began running node test.ga_retail_project.test_non_negative_values
[0m02:06:24.626319 [info ] [Thread-4 (]: 29 of 34 START test test_non_negative_values ................................... [RUN]
[0m02:06:24.627139 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.source_not_null_ext_fx_rates_rate_to_usd.2d8f230a01, now test.ga_retail_project.test_non_negative_values)
[0m02:06:24.627533 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.test_non_negative_values
[0m02:06:24.630013 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.test_non_negative_values"
[0m02:06:24.631010 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.test_non_negative_values
[0m02:06:24.633243 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.test_non_negative_values"
[0m02:06:24.634387 [debug] [Thread-4 (]: On test.ga_retail_project.test_non_negative_values: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.test_non_negative_values"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/test_non_negative_values.sql
select *
from e2e-dbt-project.analytics_mart.fct_sales_item
where product_price_usd < 0
   or revenue_usd < 0
   or revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m02:06:24.635087 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:25.732657 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5947bbef-4fe6-46d9-aae1-ec270f01cab6&page=queryresults
[0m02:06:26.244481 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:53c63858-bcf6-4d59-b009-7906840ba9a2&page=queryresults
[0m02:06:26.618622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ac86cf70-131f-47c4-99a7-7621230e2c4a&page=queryresults
[0m02:06:27.204866 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:753e60b7-f476-41ab-a422-8d9cc61844d0&page=queryresults
[0m02:06:28.133794 [info ] [Thread-4 (]: 29 of 34 PASS test_non_negative_values ......................................... [[32mPASS[0m in 3.51s]
[0m02:06:28.137210 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.test_non_negative_values
[0m02:06:28.138970 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:06:28.140872 [info ] [Thread-4 (]: 30 of 34 START test unique_dim_country_country ................................. [RUN]
[0m02:06:28.143728 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.test_non_negative_values, now test.ga_retail_project.unique_dim_country_country.11db8eecec)
[0m02:06:28.145871 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:06:28.181215 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:06:28.183938 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:06:28.191364 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_country_country.11db8eecec"
[0m02:06:28.193701 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_country_country.11db8eecec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_country_country.11db8eecec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country as unique_field
  from e2e-dbt-project.analytics_mart.dim_country
  where country is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:06:28.195007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:30.246402 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:56b4d27f-27fd-4052-a877-c49ea56e063c&page=queryresults
[0m02:06:31.151226 [info ] [Thread-4 (]: 30 of 34 PASS unique_dim_country_country ....................................... [[32mPASS[0m in 3.01s]
[0m02:06:31.152429 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_country_country.11db8eecec
[0m02:06:31.152863 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:06:31.153389 [info ] [Thread-4 (]: 31 of 34 START test unique_dim_date_dt ......................................... [RUN]
[0m02:06:31.154082 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_country_country.11db8eecec, now test.ga_retail_project.unique_dim_date_dt.bbad368071)
[0m02:06:31.154627 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:06:31.158394 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m02:06:31.159435 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:06:31.161722 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_date_dt.bbad368071"
[0m02:06:31.162718 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_date_dt.bbad368071: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_date_dt.bbad368071"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select dt as unique_field
  from e2e-dbt-project.analytics_mart.dim_date
  where dt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:06:31.163180 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:33.447891 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ed4a75bf-27c5-4ae1-a30f-90f60f119d2c&page=queryresults
[0m02:06:34.491299 [info ] [Thread-4 (]: 31 of 34 PASS unique_dim_date_dt ............................................... [[32mPASS[0m in 3.34s]
[0m02:06:34.494698 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_date_dt.bbad368071
[0m02:06:34.496623 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:06:34.498648 [info ] [Thread-4 (]: 32 of 34 START test unique_dim_products_product_sku ............................ [RUN]
[0m02:06:34.501539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_date_dt.bbad368071, now test.ga_retail_project.unique_dim_products_product_sku.ab7f821296)
[0m02:06:34.504754 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:06:34.525462 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:06:34.530654 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:06:34.541480 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"
[0m02:06:34.545196 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_products_product_sku.ab7f821296: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_products_product_sku.ab7f821296"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_mart.dim_products
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:06:34.547291 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:36.725723 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:08259862-f46e-48e9-b154-95f437bfd2ac&page=queryresults
[0m02:06:37.558696 [info ] [Thread-4 (]: 32 of 34 PASS unique_dim_products_product_sku .................................. [[32mPASS[0m in 3.06s]
[0m02:06:37.561565 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_products_product_sku.ab7f821296
[0m02:06:37.562853 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:06:37.563925 [info ] [Thread-4 (]: 33 of 34 START test unique_dim_visitors_visitor_id ............................. [RUN]
[0m02:06:37.565376 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.unique_dim_products_product_sku.ab7f821296, now test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c)
[0m02:06:37.567025 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:06:37.583515 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:06:37.586945 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:06:37.593648 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"
[0m02:06:37.597293 [debug] [Thread-4 (]: On test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visitor_id as unique_field
  from e2e-dbt-project.analytics_mart.dim_visitors
  where visitor_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:06:37.598274 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:06:40.436214 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:82392da5-baa4-49bb-aaf9-61fe4a12af6f&page=queryresults
[0m02:06:40.883527 [info ] [Thread-3 (]: 26 of 34 PASS stg_hits_products_quality ........................................ [[32mPASS[0m in 17.36s]
[0m02:06:40.887064 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m02:06:40.889813 [debug] [Thread-3 (]: Began running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:06:40.892463 [info ] [Thread-3 (]: 34 of 34 START test unique_product_categories_product_sku ...................... [RUN]
[0m02:06:40.894702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.stg_hits_products_quality, now test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb)
[0m02:06:40.897389 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:06:40.908903 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:06:40.911734 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:06:40.916134 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"
[0m02:06:40.918158 [debug] [Thread-3 (]: On test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sku as unique_field
  from e2e-dbt-project.analytics_stg.product_categories
  where product_sku is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:06:40.919403 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:06:41.390003 [info ] [Thread-4 (]: 33 of 34 PASS unique_dim_visitors_visitor_id ................................... [[32mPASS[0m in 3.82s]
[0m02:06:41.391059 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c
[0m02:06:41.559896 [info ] [Thread-2 (]: 27 of 34 PASS stg_sessions_revenue_nonnegative ................................. [[32mPASS[0m in 17.66s]
[0m02:06:41.560986 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m02:06:42.838395 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:adfbaa10-59c1-455e-a9ef-c3aaffc5e436&page=queryresults
[0m02:06:43.433608 [info ] [Thread-1 (]: 28 of 34 PASS stg_sessions_with_fx_local_nonnegative ........................... [[32mPASS[0m in 19.39s]
[0m02:06:43.438841 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m02:06:43.673127 [info ] [Thread-3 (]: 34 of 34 PASS unique_product_categories_product_sku ............................ [[32mPASS[0m in 2.78s]
[0m02:06:43.674362 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb
[0m02:06:43.676305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:06:43.678415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:43.678826 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:06:43.679223 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:06:43.679591 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m02:06:43.679955 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m02:06:43.680323 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_product_categories_product_sku.9f67cac6eb' was properly closed.
[0m02:06:43.680686 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_dim_visitors_visitor_id.2a2aabfa1c' was properly closed.
[0m02:06:43.681049 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m02:06:43.681488 [info ] [MainThread]: 
[0m02:06:43.682122 [info ] [MainThread]: Finished running 34 data tests in 0 hours 1 minutes and 3.54 seconds (63.54s).
[0m02:06:43.691953 [debug] [MainThread]: Command end result
[0m02:06:43.742161 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:06:43.745686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:06:43.756964 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:06:43.757423 [info ] [MainThread]: 
[0m02:06:43.758126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:06:43.758748 [info ] [MainThread]: 
[0m02:06:43.759354 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=34
[0m02:06:43.760673 [debug] [MainThread]: Command `dbt test` succeeded at 02:06:43.760541 after 68.60 seconds
[0m02:06:43.761097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A77B8AC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720B65390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A720BE6BA0>]}
[0m02:06:43.761524 [debug] [MainThread]: Flushing usage events
[0m02:06:45.071947 [debug] [MainThread]: An error was encountered while trying to flush usage events
