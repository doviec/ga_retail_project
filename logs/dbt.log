[0m01:19:04.180463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D65D302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66D73ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66D739D0>]}


============================== 01:19:04.184943 | 75b150c7-78ca-4585-8cba-b797e5672011 ==============================
[0m01:19:04.184943 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:04.185646 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:19:04.212765 [info ] [MainThread]: dbt version: 1.10.9
[0m01:19:04.213335 [info ] [MainThread]: python version: 3.13.6
[0m01:19:04.213882 [info ] [MainThread]: python path: c:\Projects\ga_retail_project\.venv\Scripts\python.exe
[0m01:19:04.215225 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:19:07.068739 [info ] [MainThread]: Using profiles dir at C:\Users\dovie\.dbt
[0m01:19:07.069310 [info ] [MainThread]: Using profiles.yml file at C:\Users\dovie\.dbt\profiles.yml
[0m01:19:07.070045 [info ] [MainThread]: Using dbt_project.yml file at C:\Projects\ga_retail_project\dbt_project.yml
[0m01:19:07.070524 [info ] [MainThread]: adapter type: bigquery
[0m01:19:07.071750 [info ] [MainThread]: adapter version: 1.10.1
[0m01:19:07.173896 [info ] [MainThread]: Configuration:
[0m01:19:07.174421 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:07.175043 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:07.177438 [info ] [MainThread]: Required dependencies:
[0m01:19:07.177951 [debug] [MainThread]: Executing "git --help"
[0m01:19:07.204842 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:07.205327 [debug] [MainThread]: STDERR: "b''"
[0m01:19:07.205662 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:07.206205 [info ] [MainThread]: Connection:
[0m01:19:07.207286 [info ] [MainThread]:   method: service-account
[0m01:19:07.209220 [info ] [MainThread]:   database: e2e-dbt-project
[0m01:19:07.209666 [info ] [MainThread]:   execution_project: e2e-dbt-project
[0m01:19:07.210578 [info ] [MainThread]:   schema: stg
[0m01:19:07.211099 [info ] [MainThread]:   location: US
[0m01:19:07.211896 [info ] [MainThread]:   priority: None
[0m01:19:07.212426 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:19:07.213457 [info ] [MainThread]:   impersonate_service_account: None
[0m01:19:07.213907 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:19:07.214806 [info ] [MainThread]:   job_retries: 1
[0m01:19:07.215261 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:19:07.216063 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:19:07.217820 [info ] [MainThread]:   timeout_seconds: 300
[0m01:19:07.218264 [info ] [MainThread]:   client_id: None
[0m01:19:07.219954 [info ] [MainThread]:   token_uri: None
[0m01:19:07.220401 [info ] [MainThread]:   compute_region: None
[0m01:19:07.221305 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:19:07.221914 [info ] [MainThread]:   gcs_bucket: None
[0m01:19:07.222805 [info ] [MainThread]:   dataproc_batch: None
[0m01:19:07.224981 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:19:07.825474 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:19:07.825875 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:07.826179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:09.726808 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8e641c8-cc9d-42b5-88f7-7832a4896090&page=queryresults
[0m01:19:10.429976 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:10.430865 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:10.432941 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:10.432702 after 6.42 seconds
[0m01:19:10.433496 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:10.434027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BA06650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BB70DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B88A030>]}
[0m01:19:10.434580 [debug] [MainThread]: Flushing usage events
[0m01:19:11.970060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:24:16.999962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859B6E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C72BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C72B9D0>]}


============================== 01:24:17.004462 | 6709a55e-22cb-4ba3-86f8-891a035bab36 ==============================
[0m01:24:17.004462 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:24:17.005196 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --models staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:24:17.005573 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m01:24:17.006145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C606FD0>]}
[0m01:24:19.978186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C015B350>]}
[0m01:24:20.038216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11B9050>]}
[0m01:24:20.038834 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:24:20.624022 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:24:20.624889 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:24:20.625406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11ED040>]}
[0m01:24:22.539818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:24:22.544909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C17EA510>]}
[0m01:24:22.596358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:24:22.609045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:24:22.645304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C1660120>]}
[0m01:24:22.645717 [info ] [MainThread]: Found 1 model, 496 macros
[0m01:24:22.646225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C18304D0>]}
[0m01:24:22.648019 [info ] [MainThread]: 
[0m01:24:22.648513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:24:22.648948 [info ] [MainThread]: 
[0m01:24:22.650713 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:24:22.651942 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:24:22.652256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:24.183260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_stg)
[0m01:24:24.184079 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_stg"
"
[0m01:24:24.192390 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_stg"} */
create schema if not exists `e2e-dbt-project`.`stg_stg`
  
[0m01:24:24.192847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:26.314657 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b662cf0a-ba8b-4da5-ad0c-ce48aa3ba483&page=queryresults
[0m01:24:27.469238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_stg'
[0m01:24:27.469572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:28.829402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C15CBEE0>]}
[0m01:24:28.829842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:28.845852 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:24:28.846372 [info ] [Thread-1 (]: 1 of 1 START sql view model stg_stg.stg_sessions ............................... [RUN]
[0m01:24:28.847074 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:24:28.847405 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:24:28.854205 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:24:28.856635 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:24:28.884137 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:24:28.885735 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;;


[0m01:24:28.886150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:24:30.308885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:010320ae-27c2-49b5-9934-67612b748866&page=queryresults
[0m01:24:30.309358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:010320ae-27c2-49b5-9934-67612b748866&page=queryresults
[0m01:24:30.394860 [debug] [Thread-1 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.397137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859BA18190>]}
[0m01:24:30.397757 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model stg_stg.stg_sessions ...................... [[31mERROR[0m in 1.55s]
[0m01:24:30.398620 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:24:30.399173 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m01:24:30.401185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:30.402755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:30.403035 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_stg' was properly closed.
[0m01:24:30.403299 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_stg' was properly closed.
[0m01:24:30.403557 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:24:30.404111 [info ] [MainThread]: 
[0m01:24:30.404662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m01:24:30.406497 [debug] [MainThread]: Command end result
[0m01:24:30.538786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:24:30.540809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:24:30.546308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:24:30.546578 [info ] [MainThread]: 
[0m01:24:30.547139 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:24:30.547634 [info ] [MainThread]: 
[0m01:24:30.549340 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m01:24:30.550069 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.550986 [info ] [MainThread]: 
[0m01:24:30.551556 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.553506 [info ] [MainThread]: 
[0m01:24:30.554437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:24:30.555755 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:24:30.557297 [debug] [MainThread]: Command `dbt run` failed at 01:24:30.557180 after 13.73 seconds
[0m01:24:30.557630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11CF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859BA26150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C7804B0>]}
[0m01:24:30.557950 [debug] [MainThread]: Flushing usage events
[0m01:24:32.430228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:33.123070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554D6A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E6EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E6EB9D0>]}


============================== 01:29:33.127364 | 481ea315-0bbf-4814-82d2-c8fcfcb18970 ==============================
[0m01:29:33.127364 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:29:33.128053 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:29:36.062698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554D9FF6F0>]}
[0m01:29:36.125013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557213B350>]}
[0m01:29:36.125630 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:29:36.705985 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:29:36.781405 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:29:36.781947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573768550>]}
[0m01:29:37.761128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:29:37.765778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255735D65D0>]}
[0m01:29:37.822660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:29:37.824725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:29:37.851968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573879C50>]}
[0m01:29:37.852380 [info ] [MainThread]: Found 1 model, 496 macros
[0m01:29:37.852911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255736A3C70>]}
[0m01:29:37.854235 [info ] [MainThread]: 
[0m01:29:37.854769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:29:37.855718 [info ] [MainThread]: 
[0m01:29:37.859602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:29:37.860591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:29:37.860903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:39.320690 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:29:39.321055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:40.712193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557388A510>]}
[0m01:29:40.712626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:40.718810 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:29:40.719419 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions ................................... [RUN]
[0m01:29:40.720201 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:29:40.720664 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:29:40.727980 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:29:40.728939 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:29:40.756959 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:29:40.757859 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m01:29:40.758259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:29:42.552176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dba2bc15-2e45-468c-b7ae-c44eacaec7fc&page=queryresults
[0m01:29:43.343691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557395DA70>]}
[0m01:29:43.344324 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions .............................. [[32mCREATE VIEW (0 processed)[0m in 2.62s]
[0m01:29:43.345153 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:29:43.346823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:43.348368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:43.348649 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:29:43.348911 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:29:43.349170 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:29:43.349459 [info ] [MainThread]: 
[0m01:29:43.349961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m01:29:43.350825 [debug] [MainThread]: Command end result
[0m01:29:43.369716 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:29:43.371710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:29:43.377487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:29:43.377789 [info ] [MainThread]: 
[0m01:29:43.378577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:29:43.379739 [info ] [MainThread]: 
[0m01:29:43.381057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:29:43.382191 [debug] [MainThread]: Command `dbt run` succeeded at 01:29:43.382082 after 10.42 seconds
[0m01:29:43.382600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255738E27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573603770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573832BD0>]}
[0m01:29:43.382915 [debug] [MainThread]: Flushing usage events
[0m01:29:45.303895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:10.929020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8538502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85489BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85489B9D0>]}


============================== 01:35:10.933253 | b4451d18-9dc4-4afb-97ea-5e87d6bedd78 ==============================
[0m01:35:10.933253 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:35:10.933911 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:35:13.838965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D853BAF6F0>]}
[0m01:35:13.898149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8782DB350>]}
[0m01:35:13.898764 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:35:14.482382 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:35:14.546370 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:35:14.546987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879908550>]}
[0m01:35:15.717271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:35:15.721827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87985A210>]}
[0m01:35:15.902154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:15.904264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:15.947819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87949E0B0>]}
[0m01:35:15.948473 [info ] [MainThread]: Found 1 model, 4 data tests, 496 macros
[0m01:35:15.949157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879ACA750>]}
[0m01:35:15.950866 [info ] [MainThread]: 
[0m01:35:15.951377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:35:15.951859 [info ] [MainThread]: 
[0m01:35:15.953561 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:15.954624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:35:15.954919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:17.450060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87992CC50>]}
[0m01:35:17.450492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:17.456703 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.457838 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.457317 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:35:17.458828 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:35:17.459149 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.470056 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.471182 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.477945 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:35:17.458248 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sessions_visit_id ................................. [RUN]
[0m01:35:17.478470 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:35:17.479911 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c'
[0m01:35:17.480732 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:35:17.481152 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.479084 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:35:17.481743 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.487280 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:35:17.487778 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.488272 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:35:17.492116 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:35:17.511503 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:35:17.512076 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.515592 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:35:17.516938 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.519427 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:35:17.520312 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.520797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:35:17.521333 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.523429 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:35:17.524178 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.526445 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:35:17.554085 [debug] [Thread-4 (]: On test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`stg`.`stg_sessions`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:35:17.554527 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:35:17.554962 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.555343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:35:17.555834 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.556218 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:35:19.799858 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84b60964-c6f0-43cb-8a35-ab6b0e4acbb4&page=queryresults
[0m01:35:19.809492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:16c0009d-5b6f-473e-a52d-4af729c3ac65&page=queryresults
[0m01:35:19.829526 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:113966da-ff41-4638-80f4-0d8daddca8c1&page=queryresults
[0m01:35:19.859032 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8a780124-b9a1-473e-a46e-e23ecacb6aa0&page=queryresults
[0m01:35:21.206790 [error] [Thread-4 (]: 4 of 4 FAIL 47 unique_stg_sessions_visit_id .................................... [[31mFAIL 47[0m in 3.73s]
[0m01:35:21.207612 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:21.245108 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.79s]
[0m01:35:21.246017 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:21.253284 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.77s]
[0m01:35:21.254126 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:21.263396 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.78s]
[0m01:35:21.264255 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:21.266010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:35:21.267480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:21.267745 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:35:21.267995 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:35:21.268240 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c' was properly closed.
[0m01:35:21.268488 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:35:21.268732 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:35:21.269012 [info ] [MainThread]: 
[0m01:35:21.269491 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m01:35:21.270955 [debug] [MainThread]: Command end result
[0m01:35:21.292578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:21.294660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:21.300490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:35:21.300756 [info ] [MainThread]: 
[0m01:35:21.301276 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:35:21.301808 [info ] [MainThread]: 
[0m01:35:21.302969 [error] [MainThread]: [31mFailure in test unique_stg_sessions_visit_id (models\staging\stg_sessions.yml)[0m
[0m01:35:21.304299 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m01:35:21.304929 [info ] [MainThread]: 
[0m01:35:21.305824 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\unique_stg_sessions_visit_id.sql
[0m01:35:21.306264 [info ] [MainThread]: 
[0m01:35:21.307559 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:35:21.309111 [debug] [MainThread]: Command `dbt test` failed at 01:35:21.308993 after 10.54 seconds
[0m01:35:21.309452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879AD54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8797DA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8797DACB0>]}
[0m01:35:21.309774 [debug] [MainThread]: Flushing usage events
[0m01:35:24.794101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:07.243935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023924C202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023925C63ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023925C639D0>]}


============================== 01:39:07.248428 | de180b3d-dd87-46fb-96ae-a2017d459646 ==============================
[0m01:39:07.248428 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:07.249120 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:07.398192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de180b3d-dd87-46fb-96ae-a2017d459646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023924F7F6F0>]}
[0m01:39:07.436963 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-84y3m91y'
[0m01:39:07.437337 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m01:39:07.451760 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m01:39:07.453468 [debug] [MainThread]: Command `dbt deps` failed at 01:39:07.453345 after 0.37 seconds
[0m01:39:07.453798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926ED85A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926ED86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926E5D550>]}
[0m01:39:07.454186 [debug] [MainThread]: Flushing usage events
[0m01:39:08.708521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:46.488258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2BA402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2CA7FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2CA7F9D0>]}


============================== 01:41:46.492557 | 32fdca99-578a-4661-997b-3c79e53b6941 ==============================
[0m01:41:46.492557 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:41:46.493252 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:41:46.634588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32fdca99-578a-4661-997b-3c79e53b6941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2BD9F6F0>]}
[0m01:41:46.666037 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-g6umd5z_'
[0m01:41:46.666521 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:41:48.178870 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:41:48.180291 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:41:48.679528 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:41:48.692108 [info ] [MainThread]: Updating lock file in file path: C:\Projects\ga_retail_project/package-lock.yml
[0m01:41:48.700835 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-v3yz5_sn'
[0m01:41:48.703668 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:41:50.283885 [info ] [MainThread]: Installed from version 1.1.1
[0m01:41:50.284434 [info ] [MainThread]: Updated version available: 1.3.0
[0m01:41:50.285055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '32fdca99-578a-4661-997b-3c79e53b6941', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C97E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C97D9D0>]}
[0m01:41:50.285410 [info ] [MainThread]: 
[0m01:41:50.287457 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:41:50.289672 [debug] [MainThread]: Command `dbt deps` succeeded at 01:41:50.289551 after 3.97 seconds
[0m01:41:50.290011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2DCCD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2DC707D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C25B890>]}
[0m01:41:50.290347 [debug] [MainThread]: Flushing usage events
[0m01:41:53.023105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:42:10.977664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C24F02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C353BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C353B9D0>]}


============================== 01:42:10.981908 | 737f83a6-b995-477d-a192-f8d2e8c05566 ==============================
[0m01:42:10.981908 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:42:10.982636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:42:13.986317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C28536F0>]}
[0m01:42:14.054628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E6F6B350>]}
[0m01:42:14.055240 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:42:14.666280 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:42:14.753280 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:42:14.753900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E6FF8850>]}
[0m01:42:16.506127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:42:16.511138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E702DF40>]}
[0m01:42:16.581522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:16.583719 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:16.622184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E812B150>]}
[0m01:42:16.622591 [info ] [MainThread]: Found 1 model, 4 data tests, 610 macros
[0m01:42:16.623161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E85E3E10>]}
[0m01:42:16.624886 [info ] [MainThread]: 
[0m01:42:16.626127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:42:16.626961 [info ] [MainThread]: 
[0m01:42:16.627719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:42:16.628757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:42:16.629043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:18.172630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E86A9850>]}
[0m01:42:18.173097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:42:18.180196 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.180791 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.181165 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.181523 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.181900 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sessions_visit_id ................................. [RUN]
[0m01:42:18.182412 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:42:18.184507 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c'
[0m01:42:18.185386 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:42:18.183064 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:42:18.186528 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.187275 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.183672 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:42:18.188173 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:42:18.203542 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:42:18.211491 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:42:18.212045 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:42:18.212466 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.213150 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.216441 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:42:18.219990 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:42:18.220360 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.240478 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:42:18.241163 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.244724 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:42:18.245338 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.247370 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:42:18.247909 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.250162 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:42:18.250778 [debug] [Thread-4 (]: On test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`stg`.`stg_sessions`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:18.251196 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:42:18.277085 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.277948 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:42:18.278450 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.278810 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:42:18.303953 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.304355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:42:20.570640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1dae1ab6-af2d-4119-97cd-d54ac9c53822&page=queryresults
[0m01:42:20.572173 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:215df39c-2c11-4e4a-b993-0db786c2e68f&page=queryresults
[0m01:42:20.581243 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6c31f82b-5660-4c6d-8583-abb557e07633&page=queryresults
[0m01:42:20.581913 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ead7c366-5502-43ae-bde8-a89dfc6814bd&page=queryresults
[0m01:42:21.997603 [error] [Thread-4 (]: 4 of 4 FAIL 47 unique_stg_sessions_visit_id .................................... [[31mFAIL 47[0m in 3.81s]
[0m01:42:21.998578 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:22.005046 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.79s]
[0m01:42:22.005938 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:22.025663 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.84s]
[0m01:42:22.026598 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:22.084576 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.90s]
[0m01:42:22.085513 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:22.087224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:42:22.088851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:22.089133 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:42:22.089389 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c' was properly closed.
[0m01:42:22.089669 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:42:22.089983 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:42:22.090228 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:42:22.090515 [info ] [MainThread]: 
[0m01:42:22.091156 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m01:42:22.092970 [debug] [MainThread]: Command end result
[0m01:42:22.122123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:22.124185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:22.130208 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:42:22.130487 [info ] [MainThread]: 
[0m01:42:22.131007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:42:22.131548 [info ] [MainThread]: 
[0m01:42:22.133106 [error] [MainThread]: [31mFailure in test unique_stg_sessions_visit_id (models\staging\stg_sessions.yml)[0m
[0m01:42:22.133900 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m01:42:22.134742 [info ] [MainThread]: 
[0m01:42:22.137486 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\unique_stg_sessions_visit_id.sql
[0m01:42:22.138001 [info ] [MainThread]: 
[0m01:42:22.138917 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:42:22.140665 [debug] [MainThread]: Command `dbt test` failed at 01:42:22.140476 after 11.29 seconds
[0m01:42:22.141109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E88EF330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E8753B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E8753D90>]}
[0m01:42:22.141480 [debug] [MainThread]: Flushing usage events
[0m01:42:23.153387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:21.048466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335ECA02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335FCEBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335FCEB9D0>]}


============================== 01:43:21.052818 | 2871dfca-cb37-4e22-bce6-12ed5b8c9ce5 ==============================
[0m01:43:21.052818 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:43:21.053523 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:43:24.017564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335EFFF6F0>]}
[0m01:43:24.093831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330377B350>]}
[0m01:43:24.094471 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:43:24.650932 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:43:24.830798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:43:24.831416 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m01:43:25.171242 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:43:25.171959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304E45350>]}
[0m01:43:25.235895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:43:25.240429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304CC34D0>]}
[0m01:43:25.310140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:43:25.312260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:43:25.349866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305109E10>]}
[0m01:43:25.350264 [info ] [MainThread]: Found 1 model, 4 data tests, 610 macros
[0m01:43:25.350806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305016D00>]}
[0m01:43:25.352256 [info ] [MainThread]: 
[0m01:43:25.352757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:43:25.353273 [info ] [MainThread]: 
[0m01:43:25.356184 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:25.357238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:43:25.357764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:26.750009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304FC5FD0>]}
[0m01:43:26.750408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:26.756564 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.757537 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.758274 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.757027 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m01:43:26.759119 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.760860 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m01:43:26.759581 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:43:26.762433 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.763189 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:43:26.760132 [info ] [Thread-4 (]: 4 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:43:26.771970 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:43:26.761848 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:43:26.772600 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.773112 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:43:26.773881 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:43:26.779835 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.783496 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:43:26.783978 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.787873 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:43:26.788255 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.792217 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:43:26.811858 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:43:26.812879 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.814948 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:43:26.815345 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.817324 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:43:26.818117 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.820303 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:43:26.821456 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.821939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:43:26.822622 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.823103 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:43:26.823505 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m01:43:26.823966 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.824737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:26.825305 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:43:29.119908 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:31b456bf-861f-4827-848d-9173bf6f0260&page=queryresults
[0m01:43:29.169151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c16f831c-b966-4f7c-899a-d8309d8068d0&page=queryresults
[0m01:43:29.199748 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0d8298b3-4572-44d6-8a38-17ababc313ae&page=queryresults
[0m01:43:29.240309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b125e2d9-dc26-4a0d-8270-4e4578f84a1f&page=queryresults
[0m01:43:30.547940 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.78s]
[0m01:43:30.548829 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:30.553141 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.78s]
[0m01:43:30.554084 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:30.556880 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.80s]
[0m01:43:30.557825 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:30.583622 [info ] [Thread-4 (]: 4 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.81s]
[0m01:43:30.584459 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:30.586015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:30.587570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:30.587853 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:43:30.588126 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m01:43:30.588393 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:43:30.588654 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:43:30.588921 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:43:30.589259 [info ] [MainThread]: 
[0m01:43:30.589743 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m01:43:30.591393 [debug] [MainThread]: Command end result
[0m01:43:30.615953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:43:30.618163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:43:30.624841 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:43:30.625441 [info ] [MainThread]: 
[0m01:43:30.626258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:43:30.627088 [info ] [MainThread]: 
[0m01:43:30.628816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:43:30.629588 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:43:30.630918 [debug] [MainThread]: Command `dbt test` succeeded at 01:43:30.630801 after 9.74 seconds
[0m01:43:30.631249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304FD3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305175810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233051759F0>]}
[0m01:43:30.631578 [debug] [MainThread]: Flushing usage events
[0m01:43:32.563305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:26.488652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD4502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE49BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE49B9D0>]}


============================== 18:14:26.496217 | 733ff81e-8c04-40ed-92cd-e3efba5aed4f ==============================
[0m18:14:26.496217 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:14:26.496968 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:14:32.980709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD7AF6F0>]}
[0m18:14:33.044000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA204B350>]}
[0m18:14:33.044628 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:14:33.844733 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:14:35.253595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:35.254228 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:14:35.587141 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m18:14:35.587797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3715450>]}
[0m18:14:35.664801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:14:35.669760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3591C70>]}
[0m18:14:35.746745 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:14:35.759134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:14:35.808781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA39DA190>]}
[0m18:14:35.809383 [info ] [MainThread]: Found 1 model, 6 data tests, 610 macros
[0m18:14:35.809948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A89640>]}
[0m18:14:35.811611 [info ] [MainThread]: 
[0m18:14:35.812030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:35.812677 [info ] [MainThread]: 
[0m18:14:35.814309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:35.815801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:14:35.816185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:37.482500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA38C6150>]}
[0m18:14:37.483071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:37.493436 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.494820 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.494168 [info ] [Thread-4 (]: 4 of 6 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:14:37.495973 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:14:37.496342 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.506484 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:14:37.507215 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.495270 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [RUN]
[0m18:14:37.508714 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91'
[0m18:14:37.509473 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.515286 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m18:14:37.515997 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.507734 [info ] [Thread-2 (]: 2 of 6 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:14:37.517509 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:14:37.517830 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.521328 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:14:37.522112 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.516660 [info ] [Thread-3 (]: 3 of 6 START test not_null_stg_sessions_revenue_usd ............................ [RUN]
[0m18:14:37.531138 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636'
[0m18:14:37.544019 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:14:37.544622 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.545112 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.549737 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"
[0m18:14:37.550630 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.553551 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m18:14:37.556342 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:14:37.557089 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:14:37.558015 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:14:37.558607 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.564087 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"
[0m18:14:37.564887 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m18:14:37.565334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:37.616810 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:14:37.617284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:14:37.619175 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from `e2e-dbt-project`.`stg`.`stg_sessions`
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m18:14:37.645465 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:14:39.826821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d12c3122-8982-4c06-a290-19fe7880b3ce&page=queryresults
[0m18:14:39.827513 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d12c3122-8982-4c06-a290-19fe7880b3ce&page=queryresults
[0m18:14:39.945475 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:39.946039 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.44s]
[0m18:14:39.946852 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:39.947237 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.948087 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql.
[0m18:14:39.947588 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:14:39.949230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m18:14:39.949590 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.955495 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:14:39.956304 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.958174 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:14:39.959026 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:14:39.959399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:39.985588 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d0e729a8-600d-49b1-a405-11206c71ce69&page=queryresults
[0m18:14:39.997397 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a87cda1-fa9b-4461-bb7a-e07075e3a2e9&page=queryresults
[0m18:14:39.998452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef559f40-b2dc-4249-bd05-63c40a5e21c4&page=queryresults
[0m18:14:41.577381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eb8f55ab-ed2b-4f7d-b997-b1ea28d4f7d4&page=queryresults
[0m18:14:43.355841 [error] [Thread-3 (]: 3 of 6 FAIL 2513 not_null_stg_sessions_revenue_usd ............................. [[31mFAIL 2513[0m in 5.82s]
[0m18:14:43.356783 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:43.357144 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.357468 [info ] [Thread-3 (]: 6 of 6 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:14:43.358088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:14:43.358456 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.362156 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:14:43.363001 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.365428 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:14:43.366153 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:14:43.366550 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:43.413419 [info ] [Thread-2 (]: 2 of 6 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 5.90s]
[0m18:14:43.414716 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:43.417498 [info ] [Thread-4 (]: 4 of 6 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 5.92s]
[0m18:14:43.418357 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:43.422276 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.47s]
[0m18:14:43.423283 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:45.091751 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c3f9120-0882-4188-a401-43af1fad5cf7&page=queryresults
[0m18:14:46.605513 [info ] [Thread-3 (]: 6 of 6 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.25s]
[0m18:14:46.606467 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:46.608017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:46.610394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:46.610800 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:14:46.611070 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:14:46.611327 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:14:46.611581 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:14:46.611835 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:14:46.612136 [info ] [MainThread]: 
[0m18:14:46.613070 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m18:14:46.616187 [debug] [MainThread]: Command end result
[0m18:14:46.656341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:14:46.659353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:14:46.667541 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:14:46.667911 [info ] [MainThread]: 
[0m18:14:46.668551 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:14:46.669104 [info ] [MainThread]: 
[0m18:14:46.678119 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)[0m
[0m18:14:46.678720 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:46.679789 [info ] [MainThread]: 
[0m18:14:46.680314 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:46.682449 [info ] [MainThread]: 
[0m18:14:46.683040 [error] [MainThread]: [31mFailure in test not_null_stg_sessions_revenue_usd (models\staging\stg_sessions.yml)[0m
[0m18:14:46.684208 [error] [MainThread]:   Got 2513 results, configured to fail if != 0
[0m18:14:46.684691 [info ] [MainThread]: 
[0m18:14:46.685836 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\not_null_stg_sessions_revenue_usd.sql
[0m18:14:46.686388 [info ] [MainThread]: 
[0m18:14:46.689158 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m18:14:46.689967 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:46.692847 [debug] [MainThread]: Command `dbt test` failed at 18:14:46.692730 after 20.41 seconds
[0m18:14:46.693242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA38A9230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A665D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A66710>]}
[0m18:14:46.693592 [debug] [MainThread]: Flushing usage events
[0m18:14:48.714970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:58.528189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B10D302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B11D7BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B11D7B9D0>]}


============================== 18:30:58.532536 | 8b18ea0c-e301-41a4-8db5-156dbe6ecad6 ==============================
[0m18:30:58.532536 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:30:58.533189 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m18:31:01.634898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1108F6F0>]}
[0m18:31:01.696090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B357AB350>]}
[0m18:31:01.696695 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:31:02.294802 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:31:02.475288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:02.475932 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:31:02.826229 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m18:31:02.826945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B36E7DC50>]}
[0m18:31:02.888281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:31:02.893045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B36CBDC70>]}
[0m18:31:02.960534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:31:02.962608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:31:02.996235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3713CAD0>]}
[0m18:31:02.996635 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m18:31:02.997188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371F9570>]}
[0m18:31:02.999216 [info ] [MainThread]: 
[0m18:31:02.999829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:31:03.000841 [info ] [MainThread]: 
[0m18:31:03.002706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:03.003866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:31:03.004378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.576588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B37056150>]}
[0m18:31:04.577029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:04.583178 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.584134 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.584641 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.583608 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:31:04.585188 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.585568 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:31:04.586863 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m18:31:04.586068 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0  [RUN]
[0m18:31:04.588163 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:31:04.588885 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.589559 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8'
[0m18:31:04.587389 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:31:04.590131 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.601095 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:31:04.601578 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.602085 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:31:04.606044 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:31:04.613406 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.617856 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"
[0m18:31:04.621660 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:31:04.622522 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.642360 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:31:04.643584 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.646425 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:31:04.646920 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.648916 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:31:04.649644 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.651884 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"
[0m18:31:04.652537 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:04.652997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:31:04.653709 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:31:04.654068 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:31:04.654651 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:31:04.655014 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:04.655431 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd revenue_usd is null OR revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m18:31:04.655801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:06.765844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8bb0a1d1-ca89-4bf3-bd08-19c88638a3f0&page=queryresults
[0m18:31:06.766369 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8bb0a1d1-ca89-4bf3-bd08-19c88638a3f0&page=queryresults
[0m18:31:06.776354 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:06.776889 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0  [[31mERROR[0m in 2.19s]
[0m18:31:06.777785 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:06.778581 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.779304 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql.
[0m18:31:06.779742 [info ] [Thread-1 (]: 5 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:31:06.781610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:31:06.782368 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.790451 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:31:06.791378 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.793438 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:31:06.794288 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:06.795098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:06.905565 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e10fa8f4-8dc2-43af-bf3a-c3a2e4682d6f&page=queryresults
[0m18:31:07.096180 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:997ecdc5-b346-4e49-8272-7e035c364dcf&page=queryresults
[0m18:31:07.097676 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84713ec1-98ce-4a93-ab94-4ffd6c7fdfd4&page=queryresults
[0m18:31:08.425432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b4f6a032-e5e6-4ead-98a0-ecc8b1ea73a4&page=queryresults
[0m18:31:08.501810 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.91s]
[0m18:31:08.506241 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:08.509286 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.92s]
[0m18:31:08.510814 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:08.582327 [info ] [Thread-2 (]: 2 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.98s]
[0m18:31:08.583612 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:09.801186 [info ] [Thread-1 (]: 5 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.02s]
[0m18:31:09.802090 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:09.803858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:09.805306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:09.805574 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:31:09.805830 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:31:09.806075 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:31:09.806365 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:31:09.806615 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:31:09.806902 [info ] [MainThread]: 
[0m18:31:09.807369 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m18:31:09.808936 [debug] [MainThread]: Command end result
[0m18:31:09.832543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:31:09.834700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:31:09.840877 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:31:09.841160 [info ] [MainThread]: 
[0m18:31:09.841706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:09.842250 [info ] [MainThread]: 
[0m18:31:09.843341 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)[0m
[0m18:31:09.843908 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:09.845328 [info ] [MainThread]: 
[0m18:31:09.847094 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:09.847934 [info ] [MainThread]: 
[0m18:31:09.848447 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:31:09.854114 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:31:09.857159 [debug] [MainThread]: Command `dbt test` failed at 18:31:09.857038 after 11.47 seconds
[0m18:31:09.857493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3700DC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371D5DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371D5D10>]}
[0m18:31:09.857861 [debug] [MainThread]: Flushing usage events
[0m18:31:10.919964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:46.768827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD336402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3468BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3468B9D0>]}


============================== 18:45:46.773239 | e8d69b3d-7fd4-4e03-8d59-713074d895c6 ==============================
[0m18:45:46.773239 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:45:46.773938 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:45:51.922565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3399F6F0>]}
[0m18:45:51.985772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD580CB350>]}
[0m18:45:51.986454 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:45:52.655586 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:45:53.317833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:53.318507 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:45:53.727970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:45:53.732618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59799050>]}
[0m18:45:53.809828 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:45:53.813027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:45:53.851375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59923110>]}
[0m18:45:53.851793 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m18:45:53.852329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59A68AD0>]}
[0m18:45:53.853834 [info ] [MainThread]: 
[0m18:45:53.854336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:53.854808 [info ] [MainThread]: 
[0m18:45:53.856428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:45:53.857455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:45:53.857746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:55.529306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59B19980>]}
[0m18:45:55.529763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:55.536242 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.536925 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.537359 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.538181 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.537772 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:45:55.538874 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:45:55.539438 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:45:55.540644 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m18:45:55.541321 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:45:55.540006 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0  [RUN]
[0m18:45:55.541975 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:45:55.542391 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.543036 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.543572 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1'
[0m18:45:55.543984 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.559015 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:45:55.561982 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:45:55.562460 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.566642 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:45:55.571149 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"
[0m18:45:55.572150 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.592580 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:45:55.593485 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.597079 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:45:55.597644 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.599785 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"
[0m18:45:55.600478 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.602844 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:45:55.603961 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:45:55.604555 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:55.605081 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:45:55.605513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:45:55.605926 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:45:55.606384 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd coalesce(revenue_usd, 0) >= 0)


  
  
      
    ) dbt_internal_test
[0m18:45:55.634541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:45:55.661216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:45:57.859680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e859a363-23dc-4edd-88ac-84530b00e5f3&page=queryresults
[0m18:45:57.860157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e859a363-23dc-4edd-88ac-84530b00e5f3&page=queryresults
[0m18:45:57.961055 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:45:57.961620 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0  [[31mERROR[0m in 2.42s]
[0m18:45:57.962498 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:57.962916 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.963929 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql.
[0m18:45:57.963328 [info ] [Thread-1 (]: 5 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:45:57.965258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:45:57.965618 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.971618 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:45:57.972431 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.974300 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:45:57.975002 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:45:57.975368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:58.158482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d45c9eb3-f405-44e9-b000-97a2e89d7003&page=queryresults
[0m18:45:58.179392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92488992-9e52-43f8-9dc1-24db799b2966&page=queryresults
[0m18:45:58.180826 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0378fcc0-9450-4da1-aa0e-d9be3cfb19b4&page=queryresults
[0m18:45:59.661644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:47c58602-bf07-4767-a1f7-8ffa4eb79d19&page=queryresults
[0m18:46:00.477795 [info ] [Thread-2 (]: 2 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.94s]
[0m18:46:00.481362 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:46:00.480591 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 4.94s]
[0m18:46:00.482401 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:46:00.503806 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 4.96s]
[0m18:46:00.505438 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:46:01.134796 [info ] [Thread-1 (]: 5 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.17s]
[0m18:46:01.135948 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:46:01.137866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:01.139395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:01.139758 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:46:01.140050 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:46:01.140325 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:46:01.140598 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:46:01.140868 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:46:01.141244 [info ] [MainThread]: 
[0m18:46:01.141971 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m18:46:01.145283 [debug] [MainThread]: Command end result
[0m18:46:01.172970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:46:01.175416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:46:01.181995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:46:01.182335 [info ] [MainThread]: 
[0m18:46:01.182880 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:46:01.183730 [info ] [MainThread]: 
[0m18:46:01.184930 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)[0m
[0m18:46:01.185544 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:46:01.186433 [info ] [MainThread]: 
[0m18:46:01.187081 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:46:01.188745 [info ] [MainThread]: 
[0m18:46:01.189549 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:46:01.190748 [debug] [MainThread]: Command `dbt test` failed at 18:46:01.190636 after 14.60 seconds
[0m18:46:01.191101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD34654650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59930AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59933330>]}
[0m18:46:01.191436 [debug] [MainThread]: Flushing usage events
[0m18:46:02.503567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:47.466304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201620502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002016309BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002016309B9D0>]}


============================== 19:05:47.470734 | c3937411-edce-4599-ac05-ed9072195dff ==============================
[0m19:05:47.470734 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:05:47.471613 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions stg_sessions_revenue_nonnegative', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m19:05:50.547665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201623AF6F0>]}
[0m19:05:50.610299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020106B4B350>]}
[0m19:05:50.610929 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:05:51.193081 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:05:51.414016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:05:51.414497 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_sessions_revenue_nonnegative.sql
[0m19:05:51.415011 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m19:05:51.882286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m19:05:51.887144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010821E650>]}
[0m19:05:51.964982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:05:51.967067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:05:52.005023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201085D1130>]}
[0m19:05:52.005447 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m19:05:52.006065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010857A6D0>]}
[0m19:05:52.007852 [info ] [MainThread]: 
[0m19:05:52.008534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:52.009083 [info ] [MainThread]: 
[0m19:05:52.010690 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:52.011941 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m19:05:52.012304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:53.550057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020108641D90>]}
[0m19:05:53.550503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:53.556414 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.557298 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.558082 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.556877 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m19:05:53.558803 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.559259 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m19:05:53.560546 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m19:05:53.561884 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m19:05:53.559745 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m19:05:53.562593 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.563199 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.563668 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m19:05:53.561084 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m19:05:53.572023 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m19:05:53.580730 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m19:05:53.581199 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.581706 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m19:05:53.585413 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m19:05:53.586018 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.589652 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m19:05:53.590137 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.613317 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m19:05:53.614250 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.618360 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m19:05:53.618835 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.620784 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m19:05:53.621483 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.623680 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m19:05:53.624648 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.625340 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m19:05:53.631822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:05:53.632569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:53.633020 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.633531 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.634274 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:05:53.634835 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:05:55.910568 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bb2838a1-b557-4789-8bea-2bcb5c101e5f&page=queryresults
[0m19:05:55.911280 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1208734b-137c-485c-a70e-10fd22cb5c0e&page=queryresults
[0m19:05:55.919721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6310cf1f-37ae-430c-92bb-0baee2976336&page=queryresults
[0m19:05:56.130871 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3eb35db7-792a-4580-b79d-a3efa086d3d6&page=queryresults
[0m19:05:57.357206 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.79s]
[0m19:05:57.358138 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:57.358863 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.359416 [info ] [Thread-3 (]: 5 of 5 START test stg_sessions_revenue_nonnegative ............................. [RUN]
[0m19:05:57.359981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m19:05:57.360439 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.362749 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m19:05:57.363891 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.366583 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m19:05:57.367588 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m19:05:57.367951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:05:57.395656 [info ] [Thread-1 (]: 1 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.84s]
[0m19:05:57.397109 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:57.414389 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.85s]
[0m19:05:57.415333 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:57.664016 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 4.08s]
[0m19:05:57.664967 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:59.064001 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5ebd700d-bcdc-440e-988c-de5c7cd4aff8&page=queryresults
[0m19:06:00.497346 [info ] [Thread-3 (]: 5 of 5 PASS stg_sessions_revenue_nonnegative ................................... [[32mPASS[0m in 3.14s]
[0m19:06:00.498348 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:06:00.500215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:00.502044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:00.502413 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m19:06:00.502796 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m19:06:00.503076 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m19:06:00.503394 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m19:06:00.503836 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m19:06:00.504130 [info ] [MainThread]: 
[0m19:06:00.504624 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m19:06:00.506323 [debug] [MainThread]: Command end result
[0m19:06:00.530119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:06:00.532243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:06:00.538899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m19:06:00.539501 [info ] [MainThread]: 
[0m19:06:00.540146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:00.540929 [info ] [MainThread]: 
[0m19:06:00.542084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:06:00.543923 [debug] [MainThread]: Command `dbt test` succeeded at 19:06:00.543810 after 13.20 seconds
[0m19:06:00.544320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020163064650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010863D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020108B20310>]}
[0m19:06:00.544645 [debug] [MainThread]: Flushing usage events
[0m19:06:01.756099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:34.576254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEF8E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF092BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF092B9D0>]}


============================== 00:45:34.589047 | f8bdb259-df50-4a0f-aeb8-9445e5712345 ==============================
[0m00:45:34.589047 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:45:34.591947 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:45:41.877346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEFC3F6F0>]}
[0m00:45:41.942868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA9603B350>]}
[0m00:45:41.943476 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:45:42.745840 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:45:42.852086 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:45:42.852584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA97099F50>]}
[0m00:45:45.600119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:45:45.604568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA970CBF20>]}
[0m00:45:45.682551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:45:45.684955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:45:45.737567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA972699B0>]}
[0m00:45:45.737964 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m00:45:45.738350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA97727C70>]}
[0m00:45:45.739662 [info ] [MainThread]: 
[0m00:45:45.740038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:45:45.740376 [info ] [MainThread]: 
[0m00:45:45.740846 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:45:45.741672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:45:45.742069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:45.742415 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json''
[0m00:45:45.743892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:45.744376 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json''
[0m00:45:45.745015 [info ] [MainThread]: 
[0m00:45:45.745428 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m00:45:45.745909 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json'
[0m00:45:45.746916 [debug] [MainThread]: Command `dbt run` failed at 00:45:45.746816 after 11.35 seconds
[0m00:45:45.747222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF08F4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA975B6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA975B6830>]}
[0m00:45:45.747532 [debug] [MainThread]: Flushing usage events
[0m00:45:48.029304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:43.346211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FC602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024690CABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024690CAB9D0>]}


============================== 00:47:43.350571 | 8c46ff46-bfbe-4dc9-aa41-5f632ce32596 ==============================
[0m00:47:43.350571 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:47:43.351312 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m00:47:46.371360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FFBF6F0>]}
[0m00:47:46.431654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B475B350>]}
[0m00:47:46.432240 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:47:47.045607 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:47:47.221172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:47.221486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:47.226136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:47:47.265053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B47EB750>]}
[0m00:47:47.347796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:47:47.350509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:47:47.378829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B48219A0>]}
[0m00:47:47.379236 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m00:47:47.379623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B591ECF0>]}
[0m00:47:47.380944 [info ] [MainThread]: 
[0m00:47:47.381322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:47.381659 [info ] [MainThread]: 
[0m00:47:47.382138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:47:47.383153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:47:47.383626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:48.973536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:47:48.973968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:50.364116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B5E731E0>]}
[0m00:47:50.364518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:50.379358 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m00:47:50.380152 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions ................................... [RUN]
[0m00:47:50.381089 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m00:47:50.381687 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m00:47:50.394475 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m00:47:50.395442 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m00:47:50.423175 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m00:47:50.424583 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m00:47:50.425156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:47:52.134149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a6d68210-9d3b-4536-80ad-8df6ebd6cd8e&page=queryresults
[0m00:47:54.706008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B5F053D0>]}
[0m00:47:54.706596 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions .............................. [[32mCREATE VIEW (0 processed)[0m in 4.32s]
[0m00:47:54.707348 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m00:47:54.708758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:54.710144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:54.710404 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:47:54.710708 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:47:54.710940 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m00:47:54.711203 [info ] [MainThread]: 
[0m00:47:54.711558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m00:47:54.712215 [debug] [MainThread]: Command end result
[0m00:47:54.736282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:47:54.738389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:47:54.743772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:47:54.744140 [info ] [MainThread]: 
[0m00:47:54.744548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:54.744894 [info ] [MainThread]: 
[0m00:47:54.745299 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:47:54.746145 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:54.746046 after 11.56 seconds
[0m00:47:54.746447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B642CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FF9ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FF9BF70>]}
[0m00:47:54.746752 [debug] [MainThread]: Flushing usage events
[0m00:47:57.518482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:31.933525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9BF702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9CFBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9CFBB9D0>]}


============================== 00:50:31.937814 | a14a0c43-7a6b-4642-aa62-95476ddd455d ==============================
[0m00:50:31.937814 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:50:31.938623 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions_with_fx', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:50:35.266048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9C2CF6F0>]}
[0m00:50:35.328328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC09FB350>]}
[0m00:50:35.328936 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:50:35.958902 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:50:36.152561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:50:36.153033 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:50:36.425541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:50:36.430086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC20BC850>]}
[0m00:50:36.516266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:50:36.518749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:50:36.548684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC0ABD9A0>]}
[0m00:50:36.549109 [info ] [MainThread]: Found 2 models, 5 data tests, 610 macros
[0m00:50:36.549513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC21D34D0>]}
[0m00:50:36.551280 [info ] [MainThread]: 
[0m00:50:36.551801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:50:36.552163 [info ] [MainThread]: 
[0m00:50:36.552671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:50:36.553940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:50:36.554398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:38.037089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:50:38.037475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:39.393454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC21B9300>]}
[0m00:50:39.393880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:50:39.398610 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.399248 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions_with_fx ........................... [RUN]
[0m00:50:39.400024 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m00:50:39.400860 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.408173 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m00:50:39.416800 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.444153 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m00:50:39.445531 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m00:50:39.446014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:50:41.233615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:08c3f55b-0065-4859-8efe-d1e3b9f98948&page=queryresults
[0m00:50:41.890650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC22C4C50>]}
[0m00:50:41.891228 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions_with_fx ...................... [[32mCREATE VIEW (0 processed)[0m in 2.49s]
[0m00:50:41.891951 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:41.893520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:50:41.894936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:41.895211 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:50:41.895493 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:50:41.895740 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m00:50:41.896018 [info ] [MainThread]: 
[0m00:50:41.896400 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m00:50:41.897088 [debug] [MainThread]: Command end result
[0m00:50:41.923852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:50:41.925960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:50:41.931418 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:50:41.931729 [info ] [MainThread]: 
[0m00:50:41.932316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:50:41.932864 [info ] [MainThread]: 
[0m00:50:41.933247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:50:41.934258 [debug] [MainThread]: Command `dbt run` succeeded at 00:50:41.934153 after 10.17 seconds
[0m00:50:41.934605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC2659860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC2298370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9C2ABF70>]}
[0m00:50:41.934921 [debug] [MainThread]: Flushing usage events
[0m00:50:43.826099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:56.581776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF13B902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BDB9D0>]}


============================== 00:51:56.586050 | 3a00790a-1f8c-41a7-9a52-171b810b61c1 ==============================
[0m00:51:56.586050 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:51:56.586697 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_sessions_with_fx_local_nonnegative', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m00:51:59.830654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF13EF36F0>]}
[0m00:51:59.894950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF3862B350>]}
[0m00:51:59.895552 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:52:00.551007 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:52:00.722175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:52:00.722631 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_sessions_with_fx_local_nonnegative.sql
[0m00:52:00.880335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:52:00.884874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39CF8B50>]}
[0m00:52:00.974585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:52:00.976899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:52:01.024417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E77A70>]}
[0m00:52:01.024824 [info ] [MainThread]: Found 2 models, 6 data tests, 610 macros
[0m00:52:01.025218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39EC9630>]}
[0m00:52:01.026583 [info ] [MainThread]: 
[0m00:52:01.026976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:52:01.027322 [info ] [MainThread]: 
[0m00:52:01.027800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:52:01.031666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:52:01.032017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:02.447537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39ED1640>]}
[0m00:52:02.447938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:02.453247 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.453897 [info ] [Thread-1 (]: 1 of 1 START test stg_sessions_with_fx_local_nonnegative ....................... [RUN]
[0m00:52:02.454625 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative'
[0m00:52:02.455118 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.462002 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m00:52:02.463097 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.486113 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m00:52:02.487212 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m00:52:02.487702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:52:04.366604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:39c5e8c0-22e8-4ea3-9cc8-b09c2ee56492&page=queryresults
[0m00:52:06.254410 [info ] [Thread-1 (]: 1 of 1 PASS stg_sessions_with_fx_local_nonnegative ............................. [[32mPASS[0m in 3.80s]
[0m00:52:06.255334 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:06.257140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:52:06.258752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:06.259041 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:52:06.259279 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m00:52:06.259539 [info ] [MainThread]: 
[0m00:52:06.259898 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m00:52:06.260557 [debug] [MainThread]: Command end result
[0m00:52:06.285351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:52:06.287502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:52:06.293490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:52:06.293788 [info ] [MainThread]: 
[0m00:52:06.294289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:06.294727 [info ] [MainThread]: 
[0m00:52:06.295125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:52:06.296009 [debug] [MainThread]: Command `dbt test` succeeded at 00:52:06.295909 after 9.85 seconds
[0m00:52:06.296324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E71910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E72BA0>]}
[0m00:52:06.296693 [debug] [MainThread]: Flushing usage events
[0m00:52:07.550457 [debug] [MainThread]: An error was encountered while trying to flush usage events
