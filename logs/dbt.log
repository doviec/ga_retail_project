[0m01:19:04.180463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D65D302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66D73ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D66D739D0>]}


============================== 01:19:04.184943 | 75b150c7-78ca-4585-8cba-b797e5672011 ==============================
[0m01:19:04.184943 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:04.185646 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:19:04.212765 [info ] [MainThread]: dbt version: 1.10.9
[0m01:19:04.213335 [info ] [MainThread]: python version: 3.13.6
[0m01:19:04.213882 [info ] [MainThread]: python path: c:\Projects\ga_retail_project\.venv\Scripts\python.exe
[0m01:19:04.215225 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m01:19:07.068739 [info ] [MainThread]: Using profiles dir at C:\Users\dovie\.dbt
[0m01:19:07.069310 [info ] [MainThread]: Using profiles.yml file at C:\Users\dovie\.dbt\profiles.yml
[0m01:19:07.070045 [info ] [MainThread]: Using dbt_project.yml file at C:\Projects\ga_retail_project\dbt_project.yml
[0m01:19:07.070524 [info ] [MainThread]: adapter type: bigquery
[0m01:19:07.071750 [info ] [MainThread]: adapter version: 1.10.1
[0m01:19:07.173896 [info ] [MainThread]: Configuration:
[0m01:19:07.174421 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:07.175043 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:07.177438 [info ] [MainThread]: Required dependencies:
[0m01:19:07.177951 [debug] [MainThread]: Executing "git --help"
[0m01:19:07.204842 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:07.205327 [debug] [MainThread]: STDERR: "b''"
[0m01:19:07.205662 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:07.206205 [info ] [MainThread]: Connection:
[0m01:19:07.207286 [info ] [MainThread]:   method: service-account
[0m01:19:07.209220 [info ] [MainThread]:   database: e2e-dbt-project
[0m01:19:07.209666 [info ] [MainThread]:   execution_project: e2e-dbt-project
[0m01:19:07.210578 [info ] [MainThread]:   schema: stg
[0m01:19:07.211099 [info ] [MainThread]:   location: US
[0m01:19:07.211896 [info ] [MainThread]:   priority: None
[0m01:19:07.212426 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:19:07.213457 [info ] [MainThread]:   impersonate_service_account: None
[0m01:19:07.213907 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:19:07.214806 [info ] [MainThread]:   job_retries: 1
[0m01:19:07.215261 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:19:07.216063 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:19:07.217820 [info ] [MainThread]:   timeout_seconds: 300
[0m01:19:07.218264 [info ] [MainThread]:   client_id: None
[0m01:19:07.219954 [info ] [MainThread]:   token_uri: None
[0m01:19:07.220401 [info ] [MainThread]:   compute_region: None
[0m01:19:07.221305 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:19:07.221914 [info ] [MainThread]:   gcs_bucket: None
[0m01:19:07.222805 [info ] [MainThread]:   dataproc_batch: None
[0m01:19:07.224981 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:19:07.825474 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:19:07.825875 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:07.826179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:09.726808 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8e641c8-cc9d-42b5-88f7-7832a4896090&page=queryresults
[0m01:19:10.429976 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:10.430865 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:10.432941 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:10.432702 after 6.42 seconds
[0m01:19:10.433496 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:10.434027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BA06650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0BB70DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D0B88A030>]}
[0m01:19:10.434580 [debug] [MainThread]: Flushing usage events
[0m01:19:11.970060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:24:16.999962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859B6E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C72BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C72B9D0>]}


============================== 01:24:17.004462 | 6709a55e-22cb-4ba3-86f8-891a035bab36 ==============================
[0m01:24:17.004462 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:24:17.005196 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --models staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:24:17.005573 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m01:24:17.006145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C606FD0>]}
[0m01:24:19.978186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C015B350>]}
[0m01:24:20.038216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11B9050>]}
[0m01:24:20.038834 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:24:20.624022 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:24:20.624889 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:24:20.625406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11ED040>]}
[0m01:24:22.539818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:24:22.544909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C17EA510>]}
[0m01:24:22.596358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:24:22.609045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:24:22.645304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C1660120>]}
[0m01:24:22.645717 [info ] [MainThread]: Found 1 model, 496 macros
[0m01:24:22.646225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C18304D0>]}
[0m01:24:22.648019 [info ] [MainThread]: 
[0m01:24:22.648513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:24:22.648948 [info ] [MainThread]: 
[0m01:24:22.650713 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:24:22.651942 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:24:22.652256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:24.183260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_stg)
[0m01:24:24.184079 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_stg"
"
[0m01:24:24.192390 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_stg"} */
create schema if not exists `e2e-dbt-project`.`stg_stg`
  
[0m01:24:24.192847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:26.314657 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b662cf0a-ba8b-4da5-ad0c-ce48aa3ba483&page=queryresults
[0m01:24:27.469238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_stg'
[0m01:24:27.469572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:28.829402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C15CBEE0>]}
[0m01:24:28.829842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:28.845852 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:24:28.846372 [info ] [Thread-1 (]: 1 of 1 START sql view model stg_stg.stg_sessions ............................... [RUN]
[0m01:24:28.847074 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:24:28.847405 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:24:28.854205 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:24:28.856635 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:24:28.884137 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:24:28.885735 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;;


[0m01:24:28.886150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:24:30.308885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:010320ae-27c2-49b5-9934-67612b748866&page=queryresults
[0m01:24:30.309358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:010320ae-27c2-49b5-9934-67612b748866&page=queryresults
[0m01:24:30.394860 [debug] [Thread-1 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.397137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6709a55e-22cb-4ba3-86f8-891a035bab36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859BA18190>]}
[0m01:24:30.397757 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model stg_stg.stg_sessions ...................... [[31mERROR[0m in 1.55s]
[0m01:24:30.398620 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:24:30.399173 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m01:24:30.401185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:30.402755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:30.403035 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_stg' was properly closed.
[0m01:24:30.403299 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_stg' was properly closed.
[0m01:24:30.403557 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:24:30.404111 [info ] [MainThread]: 
[0m01:24:30.404662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m01:24:30.406497 [debug] [MainThread]: Command end result
[0m01:24:30.538786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:24:30.540809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:24:30.546308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:24:30.546578 [info ] [MainThread]: 
[0m01:24:30.547139 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:24:30.547634 [info ] [MainThread]: 
[0m01:24:30.549340 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m01:24:30.550069 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Syntax error: Unexpected ";" at [20:22]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.550986 [info ] [MainThread]: 
[0m01:24:30.551556 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m01:24:30.553506 [info ] [MainThread]: 
[0m01:24:30.554437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:24:30.555755 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:24:30.557297 [debug] [MainThread]: Command `dbt run` failed at 01:24:30.557180 after 13.73 seconds
[0m01:24:30.557630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C11CF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859BA26150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859C7804B0>]}
[0m01:24:30.557950 [debug] [MainThread]: Flushing usage events
[0m01:24:32.430228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:33.123070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554D6A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E6EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554E6EB9D0>]}


============================== 01:29:33.127364 | 481ea315-0bbf-4814-82d2-c8fcfcb18970 ==============================
[0m01:29:33.127364 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:29:33.128053 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:29:36.062698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002554D9FF6F0>]}
[0m01:29:36.125013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557213B350>]}
[0m01:29:36.125630 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:29:36.705985 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:29:36.781405 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:29:36.781947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573768550>]}
[0m01:29:37.761128 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:29:37.765778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255735D65D0>]}
[0m01:29:37.822660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:29:37.824725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:29:37.851968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573879C50>]}
[0m01:29:37.852380 [info ] [MainThread]: Found 1 model, 496 macros
[0m01:29:37.852911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255736A3C70>]}
[0m01:29:37.854235 [info ] [MainThread]: 
[0m01:29:37.854769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:29:37.855718 [info ] [MainThread]: 
[0m01:29:37.859602 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:29:37.860591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:29:37.860903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:39.320690 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:29:39.321055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:29:40.712193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557388A510>]}
[0m01:29:40.712626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:29:40.718810 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:29:40.719419 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions ................................... [RUN]
[0m01:29:40.720201 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:29:40.720664 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:29:40.727980 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:29:40.728939 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:29:40.756959 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:29:40.757859 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m01:29:40.758259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:29:42.552176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dba2bc15-2e45-468c-b7ae-c44eacaec7fc&page=queryresults
[0m01:29:43.343691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '481ea315-0bbf-4814-82d2-c8fcfcb18970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557395DA70>]}
[0m01:29:43.344324 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions .............................. [[32mCREATE VIEW (0 processed)[0m in 2.62s]
[0m01:29:43.345153 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:29:43.346823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:29:43.348368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:29:43.348649 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:29:43.348911 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:29:43.349170 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:29:43.349459 [info ] [MainThread]: 
[0m01:29:43.349961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m01:29:43.350825 [debug] [MainThread]: Command end result
[0m01:29:43.369716 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:29:43.371710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:29:43.377487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:29:43.377789 [info ] [MainThread]: 
[0m01:29:43.378577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:29:43.379739 [info ] [MainThread]: 
[0m01:29:43.381057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:29:43.382191 [debug] [MainThread]: Command `dbt run` succeeded at 01:29:43.382082 after 10.42 seconds
[0m01:29:43.382600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255738E27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573603770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025573832BD0>]}
[0m01:29:43.382915 [debug] [MainThread]: Flushing usage events
[0m01:29:45.303895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:10.929020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8538502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85489BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D85489B9D0>]}


============================== 01:35:10.933253 | b4451d18-9dc4-4afb-97ea-5e87d6bedd78 ==============================
[0m01:35:10.933253 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:35:10.933911 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:35:13.838965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D853BAF6F0>]}
[0m01:35:13.898149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8782DB350>]}
[0m01:35:13.898764 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:35:14.482382 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:35:14.546370 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:35:14.546987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879908550>]}
[0m01:35:15.717271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:35:15.721827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87985A210>]}
[0m01:35:15.902154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:15.904264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:15.947819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87949E0B0>]}
[0m01:35:15.948473 [info ] [MainThread]: Found 1 model, 4 data tests, 496 macros
[0m01:35:15.949157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879ACA750>]}
[0m01:35:15.950866 [info ] [MainThread]: 
[0m01:35:15.951377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:35:15.951859 [info ] [MainThread]: 
[0m01:35:15.953561 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:15.954624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:35:15.954919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:17.450060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4451d18-9dc4-4afb-97ea-5e87d6bedd78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D87992CC50>]}
[0m01:35:17.450492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:17.456703 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.457838 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.457317 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:35:17.458828 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:35:17.459149 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.470056 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.471182 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.477945 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:35:17.458248 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sessions_visit_id ................................. [RUN]
[0m01:35:17.478470 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:35:17.479911 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c'
[0m01:35:17.480732 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:35:17.481152 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.479084 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:35:17.481743 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.487280 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:35:17.487778 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:17.488272 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:35:17.492116 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:35:17.511503 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:35:17.512076 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.515592 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:35:17.516938 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:17.519427 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:35:17.520312 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.520797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:35:17.521333 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:17.523429 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:35:17.524178 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:17.526445 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:35:17.554085 [debug] [Thread-4 (]: On test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`stg`.`stg_sessions`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:35:17.554527 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:35:17.554962 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.555343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:35:17.555834 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:35:17.556218 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:35:19.799858 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84b60964-c6f0-43cb-8a35-ab6b0e4acbb4&page=queryresults
[0m01:35:19.809492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:16c0009d-5b6f-473e-a52d-4af729c3ac65&page=queryresults
[0m01:35:19.829526 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:113966da-ff41-4638-80f4-0d8daddca8c1&page=queryresults
[0m01:35:19.859032 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8a780124-b9a1-473e-a46e-e23ecacb6aa0&page=queryresults
[0m01:35:21.206790 [error] [Thread-4 (]: 4 of 4 FAIL 47 unique_stg_sessions_visit_id .................................... [[31mFAIL 47[0m in 3.73s]
[0m01:35:21.207612 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:35:21.245108 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.79s]
[0m01:35:21.246017 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:35:21.253284 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.77s]
[0m01:35:21.254126 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:35:21.263396 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.78s]
[0m01:35:21.264255 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:35:21.266010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:35:21.267480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:21.267745 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:35:21.267995 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:35:21.268240 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c' was properly closed.
[0m01:35:21.268488 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:35:21.268732 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:35:21.269012 [info ] [MainThread]: 
[0m01:35:21.269491 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m01:35:21.270955 [debug] [MainThread]: Command end result
[0m01:35:21.292578 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:21.294660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:21.300490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:35:21.300756 [info ] [MainThread]: 
[0m01:35:21.301276 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:35:21.301808 [info ] [MainThread]: 
[0m01:35:21.302969 [error] [MainThread]: [31mFailure in test unique_stg_sessions_visit_id (models\staging\stg_sessions.yml)[0m
[0m01:35:21.304299 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m01:35:21.304929 [info ] [MainThread]: 
[0m01:35:21.305824 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\unique_stg_sessions_visit_id.sql
[0m01:35:21.306264 [info ] [MainThread]: 
[0m01:35:21.307559 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:35:21.309111 [debug] [MainThread]: Command `dbt test` failed at 01:35:21.308993 after 10.54 seconds
[0m01:35:21.309452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D879AD54F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8797DA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8797DACB0>]}
[0m01:35:21.309774 [debug] [MainThread]: Flushing usage events
[0m01:35:24.794101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:07.243935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023924C202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023925C63ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023925C639D0>]}


============================== 01:39:07.248428 | de180b3d-dd87-46fb-96ae-a2017d459646 ==============================
[0m01:39:07.248428 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:07.249120 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:07.398192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de180b3d-dd87-46fb-96ae-a2017d459646', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023924F7F6F0>]}
[0m01:39:07.436963 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-84y3m91y'
[0m01:39:07.437337 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m01:39:07.451760 [error] [MainThread]: Traceback (most recent call last):
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "c:\Projects\ga_retail_project\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m01:39:07.453468 [debug] [MainThread]: Command `dbt deps` failed at 01:39:07.453345 after 0.37 seconds
[0m01:39:07.453798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926ED85A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926ED86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023926E5D550>]}
[0m01:39:07.454186 [debug] [MainThread]: Flushing usage events
[0m01:39:08.708521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:46.488258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2BA402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2CA7FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2CA7F9D0>]}


============================== 01:41:46.492557 | 32fdca99-578a-4661-997b-3c79e53b6941 ==============================
[0m01:41:46.492557 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:41:46.493252 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:41:46.634588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32fdca99-578a-4661-997b-3c79e53b6941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2BD9F6F0>]}
[0m01:41:46.666037 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-g6umd5z_'
[0m01:41:46.666521 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:41:48.178870 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:41:48.180291 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:41:48.679528 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:41:48.692108 [info ] [MainThread]: Updating lock file in file path: C:\Projects\ga_retail_project/package-lock.yml
[0m01:41:48.700835 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-v3yz5_sn'
[0m01:41:48.703668 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:41:50.283885 [info ] [MainThread]: Installed from version 1.1.1
[0m01:41:50.284434 [info ] [MainThread]: Updated version available: 1.3.0
[0m01:41:50.285055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '32fdca99-578a-4661-997b-3c79e53b6941', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C97E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C97D9D0>]}
[0m01:41:50.285410 [info ] [MainThread]: 
[0m01:41:50.287457 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:41:50.289672 [debug] [MainThread]: Command `dbt deps` succeeded at 01:41:50.289551 after 3.97 seconds
[0m01:41:50.290011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2DCCD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2DC707D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C25B890>]}
[0m01:41:50.290347 [debug] [MainThread]: Flushing usage events
[0m01:41:53.023105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:42:10.977664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C24F02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C353BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C353B9D0>]}


============================== 01:42:10.981908 | 737f83a6-b995-477d-a192-f8d2e8c05566 ==============================
[0m01:42:10.981908 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:42:10.982636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:42:13.986317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C28536F0>]}
[0m01:42:14.054628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E6F6B350>]}
[0m01:42:14.055240 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:42:14.666280 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:42:14.753280 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:42:14.753900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E6FF8850>]}
[0m01:42:16.506127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:42:16.511138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E702DF40>]}
[0m01:42:16.581522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:16.583719 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:16.622184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E812B150>]}
[0m01:42:16.622591 [info ] [MainThread]: Found 1 model, 4 data tests, 610 macros
[0m01:42:16.623161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E85E3E10>]}
[0m01:42:16.624886 [info ] [MainThread]: 
[0m01:42:16.626127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:42:16.626961 [info ] [MainThread]: 
[0m01:42:16.627719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:42:16.628757 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:42:16.629043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:18.172630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737f83a6-b995-477d-a192-f8d2e8c05566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E86A9850>]}
[0m01:42:18.173097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:42:18.180196 [debug] [Thread-4 (]: Began running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.180791 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.181165 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.181523 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.181900 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sessions_visit_id ................................. [RUN]
[0m01:42:18.182412 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:42:18.184507 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c'
[0m01:42:18.185386 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:42:18.183064 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:42:18.186528 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.187275 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.183672 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:42:18.188173 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:42:18.203542 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:42:18.211491 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:42:18.212045 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:42:18.212466 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.213150 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.216441 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:42:18.219990 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:42:18.220360 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:18.240478 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"
[0m01:42:18.241163 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:18.244724 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:42:18.245338 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:18.247370 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:42:18.247909 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:18.250162 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:42:18.250778 [debug] [Thread-4 (]: On test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select visit_id as unique_field
  from `e2e-dbt-project`.`stg`.`stg_sessions`
  where visit_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:18.251196 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:42:18.277085 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.277948 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:42:18.278450 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.278810 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:42:18.303953 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:18.304355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:42:20.570640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1dae1ab6-af2d-4119-97cd-d54ac9c53822&page=queryresults
[0m01:42:20.572173 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:215df39c-2c11-4e4a-b993-0db786c2e68f&page=queryresults
[0m01:42:20.581243 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6c31f82b-5660-4c6d-8583-abb557e07633&page=queryresults
[0m01:42:20.581913 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ead7c366-5502-43ae-bde8-a89dfc6814bd&page=queryresults
[0m01:42:21.997603 [error] [Thread-4 (]: 4 of 4 FAIL 47 unique_stg_sessions_visit_id .................................... [[31mFAIL 47[0m in 3.81s]
[0m01:42:21.998578 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c
[0m01:42:22.005046 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.79s]
[0m01:42:22.005938 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:42:22.025663 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.84s]
[0m01:42:22.026598 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:42:22.084576 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.90s]
[0m01:42:22.085513 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:42:22.087224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:42:22.088851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:22.089133 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:42:22.089389 [debug] [MainThread]: Connection 'test.ga_retail_project.unique_stg_sessions_visit_id.798cd6fd8c' was properly closed.
[0m01:42:22.089669 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:42:22.089983 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:42:22.090228 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:42:22.090515 [info ] [MainThread]: 
[0m01:42:22.091156 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m01:42:22.092970 [debug] [MainThread]: Command end result
[0m01:42:22.122123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:42:22.124185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:42:22.130208 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:42:22.130487 [info ] [MainThread]: 
[0m01:42:22.131007 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:42:22.131548 [info ] [MainThread]: 
[0m01:42:22.133106 [error] [MainThread]: [31mFailure in test unique_stg_sessions_visit_id (models\staging\stg_sessions.yml)[0m
[0m01:42:22.133900 [error] [MainThread]:   Got 47 results, configured to fail if != 0
[0m01:42:22.134742 [info ] [MainThread]: 
[0m01:42:22.137486 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\unique_stg_sessions_visit_id.sql
[0m01:42:22.138001 [info ] [MainThread]: 
[0m01:42:22.138917 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:42:22.140665 [debug] [MainThread]: Command `dbt test` failed at 01:42:22.140476 after 11.29 seconds
[0m01:42:22.141109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E88EF330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E8753B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213E8753D90>]}
[0m01:42:22.141480 [debug] [MainThread]: Flushing usage events
[0m01:42:23.153387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:21.048466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335ECA02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335FCEBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335FCEB9D0>]}


============================== 01:43:21.052818 | 2871dfca-cb37-4e22-bce6-12ed5b8c9ce5 ==============================
[0m01:43:21.052818 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:43:21.053523 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:43:24.017564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335EFFF6F0>]}
[0m01:43:24.093831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330377B350>]}
[0m01:43:24.094471 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:43:24.650932 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:43:24.830798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:43:24.831416 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m01:43:25.171242 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:43:25.171959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304E45350>]}
[0m01:43:25.235895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:43:25.240429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304CC34D0>]}
[0m01:43:25.310140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:43:25.312260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:43:25.349866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305109E10>]}
[0m01:43:25.350264 [info ] [MainThread]: Found 1 model, 4 data tests, 610 macros
[0m01:43:25.350806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305016D00>]}
[0m01:43:25.352256 [info ] [MainThread]: 
[0m01:43:25.352757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:43:25.353273 [info ] [MainThread]: 
[0m01:43:25.356184 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:25.357238 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:43:25.357764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:26.750009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2871dfca-cb37-4e22-bce6-12ed5b8c9ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304FC5FD0>]}
[0m01:43:26.750408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:26.756564 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.757537 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.758274 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.757027 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m01:43:26.759119 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.760860 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m01:43:26.759581 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m01:43:26.762433 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.763189 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m01:43:26.760132 [info ] [Thread-4 (]: 4 of 4 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m01:43:26.771970 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:43:26.761848 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m01:43:26.772600 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.773112 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m01:43:26.773881 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m01:43:26.779835 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.783496 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:43:26.783978 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.787873 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:43:26.788255 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:26.792217 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:43:26.811858 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m01:43:26.812879 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:26.814948 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m01:43:26.815345 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:26.817324 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m01:43:26.818117 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:26.820303 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m01:43:26.821456 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.821939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:43:26.822622 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.823103 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:43:26.823505 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m01:43:26.823966 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:43:26.824737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:26.825305 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:43:29.119908 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:31b456bf-861f-4827-848d-9173bf6f0260&page=queryresults
[0m01:43:29.169151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c16f831c-b966-4f7c-899a-d8309d8068d0&page=queryresults
[0m01:43:29.199748 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0d8298b3-4572-44d6-8a38-17ababc313ae&page=queryresults
[0m01:43:29.240309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b125e2d9-dc26-4a0d-8270-4e4578f84a1f&page=queryresults
[0m01:43:30.547940 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.78s]
[0m01:43:30.548829 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m01:43:30.553141 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.78s]
[0m01:43:30.554084 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m01:43:30.556880 [info ] [Thread-1 (]: 1 of 4 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.80s]
[0m01:43:30.557825 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m01:43:30.583622 [info ] [Thread-4 (]: 4 of 4 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.81s]
[0m01:43:30.584459 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m01:43:30.586015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:30.587570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:30.587853 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:43:30.588126 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m01:43:30.588393 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m01:43:30.588654 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m01:43:30.588921 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m01:43:30.589259 [info ] [MainThread]: 
[0m01:43:30.589743 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m01:43:30.591393 [debug] [MainThread]: Command end result
[0m01:43:30.615953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:43:30.618163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:43:30.624841 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:43:30.625441 [info ] [MainThread]: 
[0m01:43:30.626258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:43:30.627088 [info ] [MainThread]: 
[0m01:43:30.628816 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:43:30.629588 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:43:30.630918 [debug] [MainThread]: Command `dbt test` succeeded at 01:43:30.630801 after 9.74 seconds
[0m01:43:30.631249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023304FD3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023305175810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233051759F0>]}
[0m01:43:30.631578 [debug] [MainThread]: Flushing usage events
[0m01:43:32.563305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:26.488652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD4502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE49BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFE49B9D0>]}


============================== 18:14:26.496217 | 733ff81e-8c04-40ed-92cd-e3efba5aed4f ==============================
[0m18:14:26.496217 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:14:26.496968 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:14:32.980709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFD7AF6F0>]}
[0m18:14:33.044000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA204B350>]}
[0m18:14:33.044628 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:14:33.844733 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:14:35.253595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:35.254228 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:14:35.587141 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m18:14:35.587797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3715450>]}
[0m18:14:35.664801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:14:35.669760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3591C70>]}
[0m18:14:35.746745 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:14:35.759134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:14:35.808781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA39DA190>]}
[0m18:14:35.809383 [info ] [MainThread]: Found 1 model, 6 data tests, 610 macros
[0m18:14:35.809948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A89640>]}
[0m18:14:35.811611 [info ] [MainThread]: 
[0m18:14:35.812030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:35.812677 [info ] [MainThread]: 
[0m18:14:35.814309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:14:35.815801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:14:35.816185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:37.482500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '733ff81e-8c04-40ed-92cd-e3efba5aed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA38C6150>]}
[0m18:14:37.483071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:37.493436 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.494820 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.494168 [info ] [Thread-4 (]: 4 of 6 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:14:37.495973 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:14:37.496342 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.506484 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:14:37.507215 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.495270 [info ] [Thread-1 (]: 1 of 6 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [RUN]
[0m18:14:37.508714 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91'
[0m18:14:37.509473 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.515286 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m18:14:37.515997 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.507734 [info ] [Thread-2 (]: 2 of 6 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:14:37.517509 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:14:37.517830 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.521328 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:14:37.522112 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:37.516660 [info ] [Thread-3 (]: 3 of 6 START test not_null_stg_sessions_revenue_usd ............................ [RUN]
[0m18:14:37.531138 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636'
[0m18:14:37.544019 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:14:37.544622 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.545112 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:37.549737 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"
[0m18:14:37.550630 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:37.553551 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"
[0m18:14:37.556342 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:14:37.557089 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:14:37.558015 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:14:37.558607 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:37.564087 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"
[0m18:14:37.564887 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m18:14:37.565334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:37.616810 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:14:37.617284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:14:37.619175 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_usd
from `e2e-dbt-project`.`stg`.`stg_sessions`
where revenue_usd is null



  
  
      
    ) dbt_internal_test
[0m18:14:37.645465 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:14:39.826821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d12c3122-8982-4c06-a290-19fe7880b3ce&page=queryresults
[0m18:14:39.827513 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d12c3122-8982-4c06-a290-19fe7880b3ce&page=queryresults
[0m18:14:39.945475 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:39.946039 [error] [Thread-1 (]: 1 of 6 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0  [[31mERROR[0m in 2.44s]
[0m18:14:39.946852 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91
[0m18:14:39.947237 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.948087 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql.
[0m18:14:39.947588 [info ] [Thread-1 (]: 5 of 6 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:14:39.949230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0.dd910c0b91, now test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667)
[0m18:14:39.949590 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.955495 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:14:39.956304 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:39.958174 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:14:39.959026 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:14:39.959399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:39.985588 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d0e729a8-600d-49b1-a405-11206c71ce69&page=queryresults
[0m18:14:39.997397 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2a87cda1-fa9b-4461-bb7a-e07075e3a2e9&page=queryresults
[0m18:14:39.998452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ef559f40-b2dc-4249-bd05-63c40a5e21c4&page=queryresults
[0m18:14:41.577381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eb8f55ab-ed2b-4f7d-b997-b1ea28d4f7d4&page=queryresults
[0m18:14:43.355841 [error] [Thread-3 (]: 3 of 6 FAIL 2513 not_null_stg_sessions_revenue_usd ............................. [[31mFAIL 2513[0m in 5.82s]
[0m18:14:43.356783 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636
[0m18:14:43.357144 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.357468 [info ] [Thread-3 (]: 6 of 6 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:14:43.358088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_revenue_usd.de3877c636, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:14:43.358456 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.362156 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:14:43.363001 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:43.365428 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:14:43.366153 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:14:43.366550 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:43.413419 [info ] [Thread-2 (]: 2 of 6 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 5.90s]
[0m18:14:43.414716 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:14:43.417498 [info ] [Thread-4 (]: 4 of 6 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 5.92s]
[0m18:14:43.418357 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:14:43.422276 [info ] [Thread-1 (]: 5 of 6 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.47s]
[0m18:14:43.423283 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:14:45.091751 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5c3f9120-0882-4188-a401-43af1fad5cf7&page=queryresults
[0m18:14:46.605513 [info ] [Thread-3 (]: 6 of 6 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.25s]
[0m18:14:46.606467 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:14:46.608017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:46.610394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:46.610800 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:14:46.611070 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:14:46.611327 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:14:46.611581 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:14:46.611835 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:14:46.612136 [info ] [MainThread]: 
[0m18:14:46.613070 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m18:14:46.616187 [debug] [MainThread]: Command end result
[0m18:14:46.656341 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:14:46.659353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:14:46.667541 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:14:46.667911 [info ] [MainThread]: 
[0m18:14:46.668551 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:14:46.669104 [info ] [MainThread]: 
[0m18:14:46.678119 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)[0m
[0m18:14:46.678720 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:46.679789 [info ] [MainThread]: 
[0m18:14:46.680314 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bb669ce636b34cd3cf66637551a23fc2.sql
[0m18:14:46.682449 [info ] [MainThread]: 
[0m18:14:46.683040 [error] [MainThread]: [31mFailure in test not_null_stg_sessions_revenue_usd (models\staging\stg_sessions.yml)[0m
[0m18:14:46.684208 [error] [MainThread]:   Got 2513 results, configured to fail if != 0
[0m18:14:46.684691 [info ] [MainThread]: 
[0m18:14:46.685836 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\not_null_stg_sessions_revenue_usd.sql
[0m18:14:46.686388 [info ] [MainThread]: 
[0m18:14:46.689158 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m18:14:46.689967 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:14:46.692847 [debug] [MainThread]: Command `dbt test` failed at 18:14:46.692730 after 20.41 seconds
[0m18:14:46.693242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA38A9230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A665D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEA3A66710>]}
[0m18:14:46.693592 [debug] [MainThread]: Flushing usage events
[0m18:14:48.714970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:58.528189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B10D302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B11D7BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B11D7B9D0>]}


============================== 18:30:58.532536 | 8b18ea0c-e301-41a4-8db5-156dbe6ecad6 ==============================
[0m18:30:58.532536 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:30:58.533189 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m18:31:01.634898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1108F6F0>]}
[0m18:31:01.696090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B357AB350>]}
[0m18:31:01.696695 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:31:02.294802 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:31:02.475288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:02.475932 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:31:02.826229 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m18:31:02.826945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B36E7DC50>]}
[0m18:31:02.888281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:31:02.893045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B36CBDC70>]}
[0m18:31:02.960534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:31:02.962608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:31:02.996235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3713CAD0>]}
[0m18:31:02.996635 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m18:31:02.997188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371F9570>]}
[0m18:31:02.999216 [info ] [MainThread]: 
[0m18:31:02.999829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:31:03.000841 [info ] [MainThread]: 
[0m18:31:03.002706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:03.003866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:31:03.004378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:04.576588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b18ea0c-e301-41a4-8db5-156dbe6ecad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B37056150>]}
[0m18:31:04.577029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:04.583178 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.584134 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.584641 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.583608 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:31:04.585188 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.585568 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:31:04.586863 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m18:31:04.586068 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0  [RUN]
[0m18:31:04.588163 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:31:04.588885 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.589559 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8'
[0m18:31:04.587389 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:31:04.590131 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.601095 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:31:04.601578 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.602085 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:31:04.606044 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:31:04.613406 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.617856 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"
[0m18:31:04.621660 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:31:04.622522 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:04.642360 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:31:04.643584 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:04.646425 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:31:04.646920 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:04.648916 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:31:04.649644 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:04.651884 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"
[0m18:31:04.652537 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:04.652997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:31:04.653709 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:31:04.654068 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:31:04.654651 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:31:04.655014 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:31:04.655431 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd revenue_usd is null OR revenue_usd >= 0)


  
  
      
    ) dbt_internal_test
[0m18:31:04.655801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:06.765844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8bb0a1d1-ca89-4bf3-bd08-19c88638a3f0&page=queryresults
[0m18:31:06.766369 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8bb0a1d1-ca89-4bf3-bd08-19c88638a3f0&page=queryresults
[0m18:31:06.776354 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:06.776889 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0  [[31mERROR[0m in 2.19s]
[0m18:31:06.777785 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8
[0m18:31:06.778581 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.779304 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql.
[0m18:31:06.779742 [info ] [Thread-1 (]: 5 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:31:06.781610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0.4a50597cd8, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:31:06.782368 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.790451 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:31:06.791378 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:06.793438 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:31:06.794288 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:31:06.795098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:06.905565 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e10fa8f4-8dc2-43af-bf3a-c3a2e4682d6f&page=queryresults
[0m18:31:07.096180 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:997ecdc5-b346-4e49-8272-7e035c364dcf&page=queryresults
[0m18:31:07.097676 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:84713ec1-98ce-4a93-ab94-4ffd6c7fdfd4&page=queryresults
[0m18:31:08.425432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b4f6a032-e5e6-4ead-98a0-ecc8b1ea73a4&page=queryresults
[0m18:31:08.501810 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.91s]
[0m18:31:08.506241 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:31:08.509286 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.92s]
[0m18:31:08.510814 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:31:08.582327 [info ] [Thread-2 (]: 2 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.98s]
[0m18:31:08.583612 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:31:09.801186 [info ] [Thread-1 (]: 5 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.02s]
[0m18:31:09.802090 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:31:09.803858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:09.805306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:09.805574 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:31:09.805830 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:31:09.806075 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:31:09.806365 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:31:09.806615 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:31:09.806902 [info ] [MainThread]: 
[0m18:31:09.807369 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m18:31:09.808936 [debug] [MainThread]: Command end result
[0m18:31:09.832543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:31:09.834700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:31:09.840877 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:31:09.841160 [info ] [MainThread]: 
[0m18:31:09.841706 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:09.842250 [info ] [MainThread]: 
[0m18:31:09.843341 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)[0m
[0m18:31:09.843908 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__revenue_usd_is_null_OR_revenue_usd_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:09.845328 [info ] [MainThread]: 
[0m18:31:09.847094 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_bf7f7627b305e9c7bb336c15cb079216.sql
[0m18:31:09.847934 [info ] [MainThread]: 
[0m18:31:09.848447 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:31:09.854114 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:31:09.857159 [debug] [MainThread]: Command `dbt test` failed at 18:31:09.857038 after 11.47 seconds
[0m18:31:09.857493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3700DC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371D5DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B371D5D10>]}
[0m18:31:09.857861 [debug] [MainThread]: Flushing usage events
[0m18:31:10.919964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:46.768827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD336402F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3468BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3468B9D0>]}


============================== 18:45:46.773239 | e8d69b3d-7fd4-4e03-8d59-713074d895c6 ==============================
[0m18:45:46.773239 [info ] [MainThread]: Running with dbt=1.10.9
[0m18:45:46.773938 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:45:51.922565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD3399F6F0>]}
[0m18:45:51.985772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD580CB350>]}
[0m18:45:51.986454 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:45:52.655586 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m18:45:53.317833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:53.318507 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m18:45:53.727970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m18:45:53.732618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59799050>]}
[0m18:45:53.809828 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:45:53.813027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:45:53.851375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59923110>]}
[0m18:45:53.851793 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m18:45:53.852329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59A68AD0>]}
[0m18:45:53.853834 [info ] [MainThread]: 
[0m18:45:53.854336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:53.854808 [info ] [MainThread]: 
[0m18:45:53.856428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:45:53.857455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m18:45:53.857746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:55.529306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8d69b3d-7fd4-4e03-8d59-713074d895c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59B19980>]}
[0m18:45:55.529763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:55.536242 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.536925 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.537359 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.538181 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.537772 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m18:45:55.538874 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m18:45:55.539438 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m18:45:55.540644 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m18:45:55.541321 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m18:45:55.540006 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0  [RUN]
[0m18:45:55.541975 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m18:45:55.542391 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.543036 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.543572 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1'
[0m18:45:55.543984 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.559015 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:45:55.561982 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:45:55.562460 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.566642 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:45:55.571149 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"
[0m18:45:55.572150 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:45:55.592580 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m18:45:55.593485 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:45:55.597079 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m18:45:55.597644 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:55.599785 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"
[0m18:45:55.600478 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:45:55.602844 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m18:45:55.603961 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m18:45:55.604555 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:45:55.605081 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:45:55.605513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:45:55.605926 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m18:45:55.606384 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`stg`.`stg_sessions`

where not(revenue_usd coalesce(revenue_usd, 0) >= 0)


  
  
      
    ) dbt_internal_test
[0m18:45:55.634541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:45:55.661216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:45:57.859680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e859a363-23dc-4edd-88ac-84530b00e5f3&page=queryresults
[0m18:45:57.860157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:e859a363-23dc-4edd-88ac-84530b00e5f3&page=queryresults
[0m18:45:57.961055 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:45:57.961620 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0  [[31mERROR[0m in 2.42s]
[0m18:45:57.962498 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1
[0m18:45:57.962916 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.963929 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql.
[0m18:45:57.963328 [info ] [Thread-1 (]: 5 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m18:45:57.965258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0.fb03e0a5c1, now test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94)
[0m18:45:57.965618 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.971618 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:45:57.972431 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:45:57.974300 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m18:45:57.975002 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m18:45:57.975368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:58.158482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:d45c9eb3-f405-44e9-b000-97a2e89d7003&page=queryresults
[0m18:45:58.179392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92488992-9e52-43f8-9dc1-24db799b2966&page=queryresults
[0m18:45:58.180826 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0378fcc0-9450-4da1-aa0e-d9be3cfb19b4&page=queryresults
[0m18:45:59.661644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:47c58602-bf07-4767-a1f7-8ffa4eb79d19&page=queryresults
[0m18:46:00.477795 [info ] [Thread-2 (]: 2 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 4.94s]
[0m18:46:00.481362 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m18:46:00.480591 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 4.94s]
[0m18:46:00.482401 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m18:46:00.503806 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 4.96s]
[0m18:46:00.505438 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m18:46:01.134796 [info ] [Thread-1 (]: 5 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 3.17s]
[0m18:46:01.135948 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m18:46:01.137866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:01.139395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:01.139758 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m18:46:01.140050 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667' was properly closed.
[0m18:46:01.140325 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m18:46:01.140598 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m18:46:01.140868 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m18:46:01.141244 [info ] [MainThread]: 
[0m18:46:01.141971 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m18:46:01.145283 [debug] [MainThread]: Command end result
[0m18:46:01.172970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m18:46:01.175416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m18:46:01.181995 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m18:46:01.182335 [info ] [MainThread]: 
[0m18:46:01.182880 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:46:01.183730 [info ] [MainThread]: 
[0m18:46:01.184930 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)[0m
[0m18:46:01.185544 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd__coalesce_revenue_usd_0_0 (models\staging\stg_sessions.yml)
  Syntax error: Expected "," but got identifier "coalesce" at [18:23]
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:46:01.186433 [info ] [MainThread]: 
[0m18:46:01.187081 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.yml\dbt_utils_expression_is_true_s_c3e77248b4108ae6ea73325accf566b2.sql
[0m18:46:01.188745 [info ] [MainThread]: 
[0m18:46:01.189549 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:46:01.190748 [debug] [MainThread]: Command `dbt test` failed at 18:46:01.190636 after 14.60 seconds
[0m18:46:01.191101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD34654650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59930AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD59933330>]}
[0m18:46:01.191436 [debug] [MainThread]: Flushing usage events
[0m18:46:02.503567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:47.466304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201620502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002016309BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002016309B9D0>]}


============================== 19:05:47.470734 | c3937411-edce-4599-ac05-ed9072195dff ==============================
[0m19:05:47.470734 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:05:47.471613 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select staging.stg_sessions stg_sessions_revenue_nonnegative', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m19:05:50.547665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201623AF6F0>]}
[0m19:05:50.610299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020106B4B350>]}
[0m19:05:50.610929 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:05:51.193081 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:05:51.414016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:05:51.414497 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_sessions_revenue_nonnegative.sql
[0m19:05:51.415011 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.yml
[0m19:05:51.882286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m19:05:51.887144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010821E650>]}
[0m19:05:51.964982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:05:51.967067 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:05:52.005023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201085D1130>]}
[0m19:05:52.005447 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m19:05:52.006065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010857A6D0>]}
[0m19:05:52.007852 [info ] [MainThread]: 
[0m19:05:52.008534 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:52.009083 [info ] [MainThread]: 
[0m19:05:52.010690 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:52.011941 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m19:05:52.012304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:53.550057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3937411-edce-4599-ac05-ed9072195dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020108641D90>]}
[0m19:05:53.550503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:53.556414 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.557298 [debug] [Thread-2 (]: Began running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.558082 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.556877 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [RUN]
[0m19:05:53.558803 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.559259 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_sessions_session_date ........................... [RUN]
[0m19:05:53.560546 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60'
[0m19:05:53.561884 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e'
[0m19:05:53.559745 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_sessions_visit_id ............................... [RUN]
[0m19:05:53.562593 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.563199 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.563668 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667'
[0m19:05:53.561084 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_sessions_visitor_id ............................. [RUN]
[0m19:05:53.572023 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m19:05:53.580730 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m19:05:53.581199 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.581706 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94'
[0m19:05:53.585413 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m19:05:53.586018 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.589652 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m19:05:53.590137 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:53.613317 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"
[0m19:05:53.614250 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:53.618360 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"
[0m19:05:53.618835 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:53.620784 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"
[0m19:05:53.621483 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:53.623680 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"
[0m19:05:53.624648 [debug] [Thread-2 (]: On test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`stg`.`stg_sessions`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.625340 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        visitor_id, visit_id
    from `e2e-dbt-project`.`stg`.`stg_sessions`
    group by visitor_id, visit_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m19:05:53.631822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:05:53.632569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:53.633020 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.633531 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`stg`.`stg_sessions`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m19:05:53.634274 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:05:53.634835 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:05:55.910568 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:bb2838a1-b557-4789-8bea-2bcb5c101e5f&page=queryresults
[0m19:05:55.911280 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1208734b-137c-485c-a70e-10fd22cb5c0e&page=queryresults
[0m19:05:55.919721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6310cf1f-37ae-430c-92bb-0baee2976336&page=queryresults
[0m19:05:56.130871 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:3eb35db7-792a-4580-b79d-a3efa086d3d6&page=queryresults
[0m19:05:57.357206 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_sessions_visit_id ..................................... [[32mPASS[0m in 3.79s]
[0m19:05:57.358138 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667
[0m19:05:57.358863 [debug] [Thread-3 (]: Began running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.359416 [info ] [Thread-3 (]: 5 of 5 START test stg_sessions_revenue_nonnegative ............................. [RUN]
[0m19:05:57.359981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.not_null_stg_sessions_visit_id.d583281667, now test.ga_retail_project.stg_sessions_revenue_nonnegative)
[0m19:05:57.360439 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.362749 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m19:05:57.363891 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:05:57.366583 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_revenue_nonnegative"
[0m19:05:57.367588 [debug] [Thread-3 (]: On test.ga_retail_project.stg_sessions_revenue_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_revenue_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any session has a negative revenue (NULLs are allowed)
select *
from `e2e-dbt-project`.`stg`.`stg_sessions`
where revenue_usd is not null
  and revenue_usd < 0
  
  
      
    ) dbt_internal_test
[0m19:05:57.367951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:05:57.395656 [info ] [Thread-1 (]: 1 of 5 PASS dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id  [[32mPASS[0m in 3.84s]
[0m19:05:57.397109 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60
[0m19:05:57.414389 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_sessions_session_date ................................. [[32mPASS[0m in 3.85s]
[0m19:05:57.415333 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e
[0m19:05:57.664016 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_sessions_visitor_id ................................... [[32mPASS[0m in 4.08s]
[0m19:05:57.664967 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94
[0m19:05:59.064001 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5ebd700d-bcdc-440e-988c-de5c7cd4aff8&page=queryresults
[0m19:06:00.497346 [info ] [Thread-3 (]: 5 of 5 PASS stg_sessions_revenue_nonnegative ................................... [[32mPASS[0m in 3.14s]
[0m19:06:00.498348 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.stg_sessions_revenue_nonnegative
[0m19:06:00.500215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:00.502044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:00.502413 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m19:06:00.502796 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_unique_combination_of_columns_stg_sessions_visitor_id__visit_id.89e999fa60' was properly closed.
[0m19:06:00.503076 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_session_date.3ab07e6f1e' was properly closed.
[0m19:06:00.503394 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_revenue_nonnegative' was properly closed.
[0m19:06:00.503836 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_stg_sessions_visitor_id.1fa5d38e94' was properly closed.
[0m19:06:00.504130 [info ] [MainThread]: 
[0m19:06:00.504624 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m19:06:00.506323 [debug] [MainThread]: Command end result
[0m19:06:00.530119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:06:00.532243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:06:00.538899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m19:06:00.539501 [info ] [MainThread]: 
[0m19:06:00.540146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:00.540929 [info ] [MainThread]: 
[0m19:06:00.542084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m19:06:00.543923 [debug] [MainThread]: Command `dbt test` succeeded at 19:06:00.543810 after 13.20 seconds
[0m19:06:00.544320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020163064650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010863D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020108B20310>]}
[0m19:06:00.544645 [debug] [MainThread]: Flushing usage events
[0m19:06:01.756099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:34.576254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEF8E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF092BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF092B9D0>]}


============================== 00:45:34.589047 | f8bdb259-df50-4a0f-aeb8-9445e5712345 ==============================
[0m00:45:34.589047 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:45:34.591947 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m00:45:41.877346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEFC3F6F0>]}
[0m00:45:41.942868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA9603B350>]}
[0m00:45:41.943476 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:45:42.745840 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:45:42.852086 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:45:42.852584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA97099F50>]}
[0m00:45:45.600119 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:45:45.604568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA970CBF20>]}
[0m00:45:45.682551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:45:45.684955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:45:45.737567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA972699B0>]}
[0m00:45:45.737964 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m00:45:45.738350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8bdb259-df50-4a0f-aeb8-9445e5712345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA97727C70>]}
[0m00:45:45.739662 [info ] [MainThread]: 
[0m00:45:45.740038 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:45:45.740376 [info ] [MainThread]: 
[0m00:45:45.740846 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:45:45.741672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:45:45.742069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:45.742415 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json''
[0m00:45:45.743892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:45.744376 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json''
[0m00:45:45.745015 [info ] [MainThread]: 
[0m00:45:45.745428 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.00 seconds (0.00s).
[0m00:45:45.745909 [error] [MainThread]: Encountered an error:
Database Error
  [Errno 2] No such file or directory: 'C:\\Projects\\Keys\\e2e-dbt-project-c1b375c41288.json'
[0m00:45:45.746916 [debug] [MainThread]: Command `dbt run` failed at 00:45:45.746816 after 11.35 seconds
[0m00:45:45.747222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF08F4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA975B6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA975B6830>]}
[0m00:45:45.747532 [debug] [MainThread]: Flushing usage events
[0m00:45:48.029304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:43.346211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FC602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024690CABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024690CAB9D0>]}


============================== 00:47:43.350571 | 8c46ff46-bfbe-4dc9-aa41-5f632ce32596 ==============================
[0m00:47:43.350571 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:47:43.351312 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m00:47:46.371360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FFBF6F0>]}
[0m00:47:46.431654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B475B350>]}
[0m00:47:46.432240 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:47:47.045607 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:47:47.221172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:47:47.221486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:47:47.226136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:47:47.265053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B47EB750>]}
[0m00:47:47.347796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:47:47.350509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:47:47.378829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B48219A0>]}
[0m00:47:47.379236 [info ] [MainThread]: Found 1 model, 5 data tests, 610 macros
[0m00:47:47.379623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B591ECF0>]}
[0m00:47:47.380944 [info ] [MainThread]: 
[0m00:47:47.381322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:47.381659 [info ] [MainThread]: 
[0m00:47:47.382138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:47:47.383153 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:47:47.383626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:48.973536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:47:48.973968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:50.364116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B5E731E0>]}
[0m00:47:50.364518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:50.379358 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions
[0m00:47:50.380152 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions ................................... [RUN]
[0m00:47:50.381089 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m00:47:50.381687 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m00:47:50.394475 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m00:47:50.395442 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions
[0m00:47:50.423175 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m00:47:50.424583 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m00:47:50.425156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:47:52.134149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a6d68210-9d3b-4536-80ad-8df6ebd6cd8e&page=queryresults
[0m00:47:54.706008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c46ff46-bfbe-4dc9-aa41-5f632ce32596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B5F053D0>]}
[0m00:47:54.706596 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions .............................. [[32mCREATE VIEW (0 processed)[0m in 4.32s]
[0m00:47:54.707348 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions
[0m00:47:54.708758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:54.710144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:54.710404 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:47:54.710708 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:47:54.710940 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m00:47:54.711203 [info ] [MainThread]: 
[0m00:47:54.711558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m00:47:54.712215 [debug] [MainThread]: Command end result
[0m00:47:54.736282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:47:54.738389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:47:54.743772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:47:54.744140 [info ] [MainThread]: 
[0m00:47:54.744548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:54.744894 [info ] [MainThread]: 
[0m00:47:54.745299 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:47:54.746145 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:54.746046 after 11.56 seconds
[0m00:47:54.746447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246B642CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FF9ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002468FF9BF70>]}
[0m00:47:54.746752 [debug] [MainThread]: Flushing usage events
[0m00:47:57.518482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:31.933525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9BF702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9CFBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9CFBB9D0>]}


============================== 00:50:31.937814 | a14a0c43-7a6b-4642-aa62-95476ddd455d ==============================
[0m00:50:31.937814 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:50:31.938623 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions_with_fx', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:50:35.266048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9C2CF6F0>]}
[0m00:50:35.328328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC09FB350>]}
[0m00:50:35.328936 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:50:35.958902 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:50:36.152561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:50:36.153033 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:50:36.425541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:50:36.430086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC20BC850>]}
[0m00:50:36.516266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:50:36.518749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:50:36.548684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC0ABD9A0>]}
[0m00:50:36.549109 [info ] [MainThread]: Found 2 models, 5 data tests, 610 macros
[0m00:50:36.549513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC21D34D0>]}
[0m00:50:36.551280 [info ] [MainThread]: 
[0m00:50:36.551801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:50:36.552163 [info ] [MainThread]: 
[0m00:50:36.552671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:50:36.553940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:50:36.554398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:38.037089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:50:38.037475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:39.393454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC21B9300>]}
[0m00:50:39.393880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:50:39.398610 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.399248 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions_with_fx ........................... [RUN]
[0m00:50:39.400024 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m00:50:39.400860 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.408173 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m00:50:39.416800 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:39.444153 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m00:50:39.445531 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m00:50:39.446014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:50:41.233615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:08c3f55b-0065-4859-8efe-d1e3b9f98948&page=queryresults
[0m00:50:41.890650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14a0c43-7a6b-4642-aa62-95476ddd455d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC22C4C50>]}
[0m00:50:41.891228 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions_with_fx ...................... [[32mCREATE VIEW (0 processed)[0m in 2.49s]
[0m00:50:41.891951 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m00:50:41.893520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:50:41.894936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:50:41.895211 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:50:41.895493 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:50:41.895740 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m00:50:41.896018 [info ] [MainThread]: 
[0m00:50:41.896400 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m00:50:41.897088 [debug] [MainThread]: Command end result
[0m00:50:41.923852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:50:41.925960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:50:41.931418 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:50:41.931729 [info ] [MainThread]: 
[0m00:50:41.932316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:50:41.932864 [info ] [MainThread]: 
[0m00:50:41.933247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:50:41.934258 [debug] [MainThread]: Command `dbt run` succeeded at 00:50:41.934153 after 10.17 seconds
[0m00:50:41.934605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC2659860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC2298370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F9C2ABF70>]}
[0m00:50:41.934921 [debug] [MainThread]: Flushing usage events
[0m00:50:43.826099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:56.581776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF13B902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BDB9D0>]}


============================== 00:51:56.586050 | 3a00790a-1f8c-41a7-9a52-171b810b61c1 ==============================
[0m00:51:56.586050 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:51:56.586697 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_sessions_with_fx_local_nonnegative', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m00:51:59.830654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF13EF36F0>]}
[0m00:51:59.894950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF3862B350>]}
[0m00:51:59.895552 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:52:00.551007 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:52:00.722175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:52:00.722631 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_sessions_with_fx_local_nonnegative.sql
[0m00:52:00.880335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m00:52:00.884874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39CF8B50>]}
[0m00:52:00.974585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:52:00.976899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:52:01.024417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E77A70>]}
[0m00:52:01.024824 [info ] [MainThread]: Found 2 models, 6 data tests, 610 macros
[0m00:52:01.025218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39EC9630>]}
[0m00:52:01.026583 [info ] [MainThread]: 
[0m00:52:01.026976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:52:01.027322 [info ] [MainThread]: 
[0m00:52:01.027800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:52:01.031666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m00:52:01.032017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:02.447537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a00790a-1f8c-41a7-9a52-171b810b61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39ED1640>]}
[0m00:52:02.447938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:02.453247 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.453897 [info ] [Thread-1 (]: 1 of 1 START test stg_sessions_with_fx_local_nonnegative ....................... [RUN]
[0m00:52:02.454625 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative'
[0m00:52:02.455118 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.462002 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m00:52:02.463097 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:02.486113 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"
[0m00:52:02.487212 [debug] [Thread-1 (]: On test.ga_retail_project.stg_sessions_with_fx_local_nonnegative: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_sessions_with_fx_local_nonnegative"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any computed local revenue is negative (NULLs are fine)
select *
from `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
where revenue_local < 0
  
  
      
    ) dbt_internal_test
[0m00:52:02.487702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:52:04.366604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:39c5e8c0-22e8-4ea3-9cc8-b09c2ee56492&page=queryresults
[0m00:52:06.254410 [info ] [Thread-1 (]: 1 of 1 PASS stg_sessions_with_fx_local_nonnegative ............................. [[32mPASS[0m in 3.80s]
[0m00:52:06.255334 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_sessions_with_fx_local_nonnegative
[0m00:52:06.257140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:52:06.258752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:06.259041 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m00:52:06.259279 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_sessions_with_fx_local_nonnegative' was properly closed.
[0m00:52:06.259539 [info ] [MainThread]: 
[0m00:52:06.259898 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m00:52:06.260557 [debug] [MainThread]: Command end result
[0m00:52:06.285351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:52:06.287502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:52:06.293490 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:52:06.293788 [info ] [MainThread]: 
[0m00:52:06.294289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:06.294727 [info ] [MainThread]: 
[0m00:52:06.295125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:52:06.296009 [debug] [MainThread]: Command `dbt test` succeeded at 00:52:06.295909 after 9.85 seconds
[0m00:52:06.296324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14BB0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E71910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF39E72BA0>]}
[0m00:52:06.296693 [debug] [MainThread]: Flushing usage events
[0m00:52:07.550457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:26.565325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E230902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E240DBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E240DB9D0>]}


============================== 01:08:26.569643 | 3df9123c-d8ab-4b4a-96e2-2ed117d96da1 ==============================
[0m01:08:26.569643 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:08:26.570363 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select staging.stg_sessions_with_fx', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:08:29.667180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E233EF6F0>]}
[0m01:08:29.728449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E47B1B350>]}
[0m01:08:29.729100 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:08:30.398817 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:08:30.584676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:08:30.585003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:08:30.590262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:08:30.625662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E48B7B850>]}
[0m01:08:30.709373 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:08:30.711671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:08:30.739065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E48BA99A0>]}
[0m01:08:30.739512 [info ] [MainThread]: Found 2 models, 6 data tests, 610 macros
[0m01:08:30.739941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E4928C670>]}
[0m01:08:30.741311 [info ] [MainThread]: 
[0m01:08:30.741745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:08:30.742096 [info ] [MainThread]: 
[0m01:08:30.742614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:08:30.743451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:08:30.743803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:32.335158 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:08:32.335545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:33.732854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E47B1FE10>]}
[0m01:08:33.733417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:33.738693 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:33.739631 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_sessions_with_fx ........................... [RUN]
[0m01:08:33.740659 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:08:33.741238 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:33.754127 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:08:33.755943 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:33.782478 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:08:33.783577 [debug] [Thread-1 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m01:08:33.784089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:08:35.531348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c49c5a82-ab9f-407c-ad28-3de5efc3ebf6&page=queryresults
[0m01:08:36.209401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df9123c-d8ab-4b4a-96e2-2ed117d96da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E492C5610>]}
[0m01:08:36.209970 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_sessions_with_fx ...................... [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m01:08:36.210604 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:08:36.212185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:36.213578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:36.213844 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:08:36.214087 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:08:36.214327 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:08:36.214596 [info ] [MainThread]: 
[0m01:08:36.214956 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m01:08:36.215622 [debug] [MainThread]: Command end result
[0m01:08:36.239817 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:08:36.242010 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:08:36.247278 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:08:36.247659 [info ] [MainThread]: 
[0m01:08:36.248081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:36.248628 [info ] [MainThread]: 
[0m01:08:36.249223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:08:36.250447 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:36.250342 after 9.85 seconds
[0m01:08:36.250766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E497F0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E233CADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E233CBF70>]}
[0m01:08:36.251078 [debug] [MainThread]: Flushing usage events
[0m01:08:38.194105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:22.189127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FDB202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FEB6BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FEB6B9D0>]}


============================== 01:27:22.193438 | 1d6b7be0-cd3f-4925-8f31-13bb3d840028 ==============================
[0m01:27:22.193438 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:27:22.194128 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select staging.stg_hits_products', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:27:25.371034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FDE7F6F0>]}
[0m01:27:25.431912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A269B350>]}
[0m01:27:25.432509 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:27:26.086908 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:27:26.297442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:27:26.297898 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\stg_hits_products.sql
[0m01:27:26.535172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:27:26.540232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3D70C50>]}
[0m01:27:26.619915 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:26.622201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:26.649355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A27599A0>]}
[0m01:27:26.649768 [info ] [MainThread]: Found 3 models, 6 data tests, 610 macros
[0m01:27:26.650153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3EAAEB0>]}
[0m01:27:26.651553 [info ] [MainThread]: 
[0m01:27:26.651927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:27:26.652334 [info ] [MainThread]: 
[0m01:27:26.652875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:26.653712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:27:26.654069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:28.293988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:27:28.294369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:29.643532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3E45300>]}
[0m01:27:29.643978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:29.648981 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:27:29.649820 [info ] [Thread-1 (]: 1 of 1 START sql view model stg.stg_hits_products .............................. [RUN]
[0m01:27:29.650731 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:27:29.651058 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:27:29.657092 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:27:29.658602 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:27:29.686800 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:27:29.687944 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`stg`.`stg_hits_products`
  OPTIONS()
  as WITH raw AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)              AS hit_date,
    fullVisitorId                           AS visitor_id,
    visitId                                 AS visit_id,
    hits.transaction.transactionId          AS transaction_id,
    p.productSKU                            AS product_sku,
    p.v2ProductName                         AS product_name,
    p.v2ProductCategory                     AS product_category,
    p.productQuantity                       AS product_quantity,
    p.productPrice / 1e6                    AS product_price_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       UNNEST(hits) AS hits,
       UNNEST(hits.product) AS p
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
    AND p.productSKU IS NOT NULL
)
SELECT *
FROM raw;


[0m01:27:29.688537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:27:31.481814 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:00c9cf1d-9ceb-4842-a942-6e80f5047c93&page=queryresults
[0m01:27:32.167036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6b7be0-cd3f-4925-8f31-13bb3d840028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3F56690>]}
[0m01:27:32.167624 [info ] [Thread-1 (]: 1 of 1 OK created sql view model stg.stg_hits_products ......................... [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m01:27:32.168344 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:27:32.169697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:32.171384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:32.171673 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:27:32.171918 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:27:32.172332 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:27:32.172752 [info ] [MainThread]: 
[0m01:27:32.173135 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m01:27:32.173818 [debug] [MainThread]: Command end result
[0m01:27:32.200269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:32.203003 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:32.208694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:27:32.209379 [info ] [MainThread]: 
[0m01:27:32.209881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:32.210580 [info ] [MainThread]: 
[0m01:27:32.211236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:27:32.212193 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:32.212088 after 10.15 seconds
[0m01:27:32.212513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3B67E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A3F42AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247FDE5BF70>]}
[0m01:27:32.212828 [debug] [MainThread]: Flushing usage events
[0m01:27:34.284521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:04.179835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ABB602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ACBABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ACBAB9D0>]}


============================== 01:30:04.184161 | 3465f166-9d53-44b4-8206-b5e1f8374956 ==============================
[0m01:30:04.184161 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:30:04.184852 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select stg_hits_products_quality', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:30:07.161437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ABEBF6F0>]}
[0m01:30:07.221624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D05DB350>]}
[0m01:30:07.222225 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:30:07.860559 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:30:08.041013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:30:08.041473 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://tests\stg_hits_products_quality.sql
[0m01:30:08.211590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ga_retail_project.mart
[0m01:30:08.216089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1B35050>]}
[0m01:30:08.309356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:30:08.312249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:30:08.352232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E2FA70>]}
[0m01:30:08.352833 [info ] [MainThread]: Found 3 models, 7 data tests, 610 macros
[0m01:30:08.353237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E81470>]}
[0m01:30:08.354605 [info ] [MainThread]: 
[0m01:30:08.354999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:30:08.355354 [info ] [MainThread]: 
[0m01:30:08.355849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:30:08.361760 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:30:08.362172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:09.813233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3465f166-9d53-44b4-8206-b5e1f8374956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E88EF0>]}
[0m01:30:09.813634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:09.818628 [debug] [Thread-1 (]: Began running node test.ga_retail_project.stg_hits_products_quality
[0m01:30:09.818976 [info ] [Thread-1 (]: 1 of 1 START test stg_hits_products_quality .................................... [RUN]
[0m01:30:09.819823 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.stg_hits_products_quality'
[0m01:30:09.820137 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.stg_hits_products_quality
[0m01:30:09.828127 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.stg_hits_products_quality"
[0m01:30:09.829547 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.stg_hits_products_quality
[0m01:30:09.855097 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.stg_hits_products_quality"
[0m01:30:09.856494 [debug] [Thread-1 (]: On test.ga_retail_project.stg_hits_products_quality: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.stg_hits_products_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if product quantity is negative
select *
from `e2e-dbt-project`.`stg`.`stg_hits_products`
where product_quantity < 0

UNION ALL

-- Fail if product price is negative
select *
from `e2e-dbt-project`.`stg`.`stg_hits_products`
where product_price_usd < 0
  
  
      
    ) dbt_internal_test
[0m01:30:09.856878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:30:11.712736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc8f5eb2-f999-494e-b25c-15bfdcf9721e&page=queryresults
[0m01:30:13.289050 [info ] [Thread-1 (]: 1 of 1 PASS stg_hits_products_quality .......................................... [[32mPASS[0m in 3.47s]
[0m01:30:13.289945 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.stg_hits_products_quality
[0m01:30:13.291451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:13.293137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:13.293419 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:30:13.293670 [debug] [MainThread]: Connection 'test.ga_retail_project.stg_hits_products_quality' was properly closed.
[0m01:30:13.293945 [info ] [MainThread]: 
[0m01:30:13.294326 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m01:30:13.295022 [debug] [MainThread]: Command end result
[0m01:30:13.318967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:30:13.321119 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:30:13.327597 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:30:13.327930 [info ] [MainThread]: 
[0m01:30:13.328340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:13.328692 [info ] [MainThread]: 
[0m01:30:13.329065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:30:13.329930 [debug] [MainThread]: Command `dbt test` succeeded at 01:30:13.329831 after 9.32 seconds
[0m01:30:13.330241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183ACB80590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E2AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183D1E2ABA0>]}
[0m01:30:13.330553 [debug] [MainThread]: Flushing usage events
[0m01:30:16.247043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:46.963290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ACCF02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ADD3BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1ADD3B9D0>]}


============================== 01:35:46.967277 | 150383de-d435-49d6-af10-ad801a98cf9c ==============================
[0m01:35:46.967277 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:35:46.967966 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:35:50.035934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AD04F6F0>]}
[0m01:35:50.096822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D176B350>]}
[0m01:35:50.097392 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:35:50.707874 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:35:50.893876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:35:50.894471 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\fct_sales_item.sql
[0m01:35:51.135037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D2DE1050>]}
[0m01:35:51.212943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:35:51.215319 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:35:51.244543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D27FD9A0>]}
[0m01:35:51.244968 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m01:35:51.245390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D2F96F90>]}
[0m01:35:51.246766 [info ] [MainThread]: 
[0m01:35:51.247150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:35:51.247486 [info ] [MainThread]: 
[0m01:35:51.247955 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:35:51.248792 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:35:51.249192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:52.797964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_mart)
[0m01:35:52.798470 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_mart"
"
[0m01:35:52.806634 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_mart"} */
create schema if not exists `e2e-dbt-project`.`stg_mart`
  
[0m01:35:52.807021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:54.595898 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8214e342-e219-416d-8ab8-5f9d5f0b5089&page=queryresults
[0m01:35:55.713176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_mart'
[0m01:35:55.713666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:55.714039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m01:35:55.714485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:57.442262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D2F29230>]}
[0m01:35:57.442882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:57.449714 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:35:57.450668 [info ] [Thread-1 (]: 1 of 1 START sql table model stg_mart.fct_sales_item ........................... [RUN]
[0m01:35:57.451742 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:35:57.452407 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:35:57.465131 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:35:57.466560 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:35:57.502106 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:35:57.503804 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`stg_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:35:57.504474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:35:59.511364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fa0bed8f-b5f4-4a9e-84ba-5ab4e95e2704&page=queryresults
[0m01:36:05.434297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '150383de-d435-49d6-af10-ad801a98cf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D3026A50>]}
[0m01:36:05.434882 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stg_mart.fct_sales_item ...................... [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 7.98s]
[0m01:36:05.435750 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:36:05.437542 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:05.439065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:05.439353 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_mart' was properly closed.
[0m01:36:05.439597 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_mart' was properly closed.
[0m01:36:05.439827 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m01:36:05.440059 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:36:05.440321 [info ] [MainThread]: 
[0m01:36:05.440679 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m01:36:05.441340 [debug] [MainThread]: Command end result
[0m01:36:05.467608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:36:05.469718 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:36:05.474948 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:36:05.475250 [info ] [MainThread]: 
[0m01:36:05.475680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:36:05.476044 [info ] [MainThread]: 
[0m01:36:05.476554 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:36:05.477586 [debug] [MainThread]: Command `dbt run` succeeded at 01:36:05.477483 after 18.68 seconds
[0m01:36:05.477909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D3669E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1D35F6FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1AD02BF70>]}
[0m01:36:05.487145 [debug] [MainThread]: Flushing usage events
[0m01:36:06.769445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:50:20.407626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC39B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC49CEAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC49CF110>]}


============================== 01:50:20.411985 | e86f0aef-d220-4807-baf0-569308bf192f ==============================
[0m01:50:20.411985 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:50:20.412694 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item --target mart', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:50:20.415203 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 15
    ------------------------------
    12 |       location: US
    13 |       maximum_bytes_billed: 1000000000   # 1 GB safety cap
    14 | 
    15 |      mart:                     # marts target
    16 |       type: bigquery
    17 |       method: service-account
    18 |       project: e2e-dbt-project
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 15, column 6
  
[0m01:50:20.416285 [debug] [MainThread]: Command `dbt run` failed at 01:50:20.416171 after 0.13 seconds
[0m01:50:20.416615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC48D4D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC48F16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC48ECD10>]}
[0m01:50:20.416971 [debug] [MainThread]: Flushing usage events
[0m01:50:21.707222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:52:15.767546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540BB902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540CBDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540CBDB9D0>]}


============================== 01:52:15.771944 | e9433c92-e95f-451f-b00a-917ba80187a8 ==============================
[0m01:52:15.771944 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:52:15.772636 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item --target mart', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m01:52:20.102967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001540BEEF6F0>]}
[0m01:52:20.185277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543060B9B0>]}
[0m01:52:20.185888 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:52:20.974514 [debug] [MainThread]: checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101, vars: {}, profile: , target: mart, version: 1.10.9
[0m01:52:21.102762 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:52:21.103314 [debug] [MainThread]: previous checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101, current checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23
[0m01:52:21.103862 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:52:21.104479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543166A150>]}
[0m01:52:23.120442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431CC8410>]}
[0m01:52:23.250293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:23.253810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:23.289357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431D46270>]}
[0m01:52:23.289786 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m01:52:23.290252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431CE01F0>]}
[0m01:52:23.292364 [info ] [MainThread]: 
[0m01:52:23.292828 [info ] [MainThread]: Concurrency: 1 threads (target='mart')
[0m01:52:23.293184 [info ] [MainThread]: 
[0m01:52:23.293968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:52:23.295023 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:52:23.295573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:24.992843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_mart_mart)
[0m01:52:24.993354 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "mart_mart"
"
[0m01:52:25.002127 [debug] [ThreadPool]: On create_e2e-dbt-project_mart_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "mart", "connection_name": "create_e2e-dbt-project_mart_mart"} */
create schema if not exists `e2e-dbt-project`.`mart_mart`
  
[0m01:52:25.002535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:26.712484 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:eba8ea3d-5b14-4d53-a925-d3438ac1a9e3&page=queryresults
[0m01:52:27.810995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_mart_mart'
[0m01:52:27.811422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:29.306920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project_mart_mart, now list_e2e-dbt-project_mart)
[0m01:52:29.307312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:30.768559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431ED1850>]}
[0m01:52:30.769301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:30.776069 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:52:30.776944 [info ] [Thread-1 (]: 1 of 1 START sql table model mart_mart.fct_sales_item .......................... [RUN]
[0m01:52:30.778265 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:52:30.778950 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:52:30.792538 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:52:30.794141 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:52:30.844604 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:52:30.845710 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "mart", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`mart_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`mart`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`mart`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:52:30.846376 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:32.611000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ad53dd6a-25da-4e8d-8c41-5a0bd4838289&page=queryresults
[0m01:52:32.611584 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ad53dd6a-25da-4e8d-8c41-5a0bd4838289&page=queryresults
[0m01:52:32.722491 [debug] [Thread-1 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:52:32.724456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9433c92-e95f-451f-b00a-917ba80187a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543251DF40>]}
[0m01:52:32.725029 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart_mart.fct_sales_item ................. [[31mERROR[0m in 1.95s]
[0m01:52:32.725761 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:52:32.726291 [debug] [Thread-4 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m01:52:32.727886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:32.729340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:32.729616 [debug] [MainThread]: Connection 'create_e2e-dbt-project_mart_mart' was properly closed.
[0m01:52:32.730038 [debug] [MainThread]: Connection 'list_e2e-dbt-project_mart' was properly closed.
[0m01:52:32.730320 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:52:32.730635 [info ] [MainThread]: 
[0m01:52:32.731178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m01:52:32.731996 [debug] [MainThread]: Command end result
[0m01:52:32.765403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:32.767883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:32.773245 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:52:32.773549 [info ] [MainThread]: 
[0m01:52:32.773977 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:52:32.774396 [info ] [MainThread]: 
[0m01:52:32.774825 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m01:52:32.775248 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:52:32.775606 [info ] [MainThread]: 
[0m01:52:32.776010 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:52:32.776359 [info ] [MainThread]: 
[0m01:52:32.776739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:52:32.777625 [debug] [MainThread]: Command `dbt run` failed at 01:52:32.777523 after 17.19 seconds
[0m01:52:32.777953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431BBC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001543264FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015431B69B50>]}
[0m01:52:32.778269 [debug] [MainThread]: Flushing usage events
[0m01:52:35.661606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:16.305100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A30602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A40A3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A40A39D0>]}


============================== 01:54:16.309403 | 8525fd67-18fa-4245-b921-0c469509799d ==============================
[0m01:54:16.309403 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:54:16.310091 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug --target mart', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:54:16.336112 [info ] [MainThread]: dbt version: 1.10.9
[0m01:54:16.336633 [info ] [MainThread]: python version: 3.13.6
[0m01:54:16.337166 [info ] [MainThread]: python path: c:\Projects\ga_retail_project\.venv\Scripts\python.exe
[0m01:54:16.337573 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m01:54:19.254098 [info ] [MainThread]: Using profiles dir at C:\Users\dovie\.dbt
[0m01:54:19.254547 [info ] [MainThread]: Using profiles.yml file at C:\Users\dovie\.dbt\profiles.yml
[0m01:54:19.254893 [info ] [MainThread]: Using dbt_project.yml file at C:\Projects\ga_retail_project\dbt_project.yml
[0m01:54:19.255307 [info ] [MainThread]: adapter type: bigquery
[0m01:54:19.255643 [info ] [MainThread]: adapter version: 1.10.1
[0m01:54:19.361335 [info ] [MainThread]: Configuration:
[0m01:54:19.361795 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:54:19.362148 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:54:19.362492 [info ] [MainThread]: Required dependencies:
[0m01:54:19.362849 [debug] [MainThread]: Executing "git --help"
[0m01:54:19.411495 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:54:19.411901 [debug] [MainThread]: STDERR: "b''"
[0m01:54:19.412263 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:54:19.412675 [info ] [MainThread]: Connection:
[0m01:54:19.413058 [info ] [MainThread]:   method: service-account
[0m01:54:19.413456 [info ] [MainThread]:   database: e2e-dbt-project
[0m01:54:19.413985 [info ] [MainThread]:   execution_project: e2e-dbt-project
[0m01:54:19.414388 [info ] [MainThread]:   schema: mart
[0m01:54:19.414743 [info ] [MainThread]:   location: US
[0m01:54:19.415090 [info ] [MainThread]:   priority: None
[0m01:54:19.415434 [info ] [MainThread]:   maximum_bytes_billed: 1000000000
[0m01:54:19.415773 [info ] [MainThread]:   impersonate_service_account: None
[0m01:54:19.416114 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:54:19.416486 [info ] [MainThread]:   job_retries: 1
[0m01:54:19.416836 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:54:19.417174 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m01:54:19.417511 [info ] [MainThread]:   timeout_seconds: None
[0m01:54:19.417845 [info ] [MainThread]:   client_id: None
[0m01:54:19.418180 [info ] [MainThread]:   token_uri: None
[0m01:54:19.418514 [info ] [MainThread]:   compute_region: None
[0m01:54:19.418847 [info ] [MainThread]:   dataproc_cluster_name: None
[0m01:54:19.419182 [info ] [MainThread]:   gcs_bucket: None
[0m01:54:19.419515 [info ] [MainThread]:   dataproc_batch: None
[0m01:54:19.420030 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:54:20.039683 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:54:20.040020 [debug] [MainThread]: On debug: select 1 as id
[0m01:54:20.040302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:21.758863 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d99860c-7666-404b-9c26-6a5d33d8acdc&page=queryresults
[0m01:54:22.410574 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:54:22.411166 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:54:22.412242 [debug] [MainThread]: Command `dbt debug` succeeded at 01:54:22.412120 after 6.28 seconds
[0m01:54:22.412558 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:54:22.412901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A33BC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C8D595B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C7BAE250>]}
[0m01:54:22.413340 [debug] [MainThread]: Flushing usage events
[0m01:54:23.760034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:33.716505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547C8502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547D89BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547D89B9D0>]}


============================== 01:54:33.720927 | 67bcddbc-2bf0-4857-b776-6a2012572c2a ==============================
[0m01:54:33.720927 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:54:33.721595 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item --target mart', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:54:36.749595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002547CBAF6F0>]}
[0m01:54:36.823214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254213AB9B0>]}
[0m01:54:36.823808 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:54:37.444353 [debug] [MainThread]: checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101, vars: {}, profile: , target: mart, version: 1.10.9
[0m01:54:37.622960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:54:37.623285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:54:37.665347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422624050>]}
[0m01:54:37.748669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:54:37.751363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:54:37.781161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542146D6D0>]}
[0m01:54:37.781669 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m01:54:37.782066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B244B0>]}
[0m01:54:37.783584 [info ] [MainThread]: 
[0m01:54:37.783978 [info ] [MainThread]: Concurrency: 1 threads (target='mart')
[0m01:54:37.784360 [info ] [MainThread]: 
[0m01:54:37.784850 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:54:37.785702 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:54:37.786051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:39.252054 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_mart_mart'
[0m01:54:39.252441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:40.600578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project_mart_mart, now list_e2e-dbt-project_mart)
[0m01:54:40.600932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:54:41.987550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254213AFEE0>]}
[0m01:54:41.988423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:41.992585 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:54:41.993021 [info ] [Thread-1 (]: 1 of 1 START sql table model mart_mart.fct_sales_item .......................... [RUN]
[0m01:54:41.994030 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:54:41.994710 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:54:42.008849 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:54:42.010596 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:54:42.054177 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:54:42.055489 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "mart", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`mart_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`mart`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`mart`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:54:42.055958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:54:43.921093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:172c1236-e1b1-409a-9a2a-d0a392310479&page=queryresults
[0m01:54:43.921607 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:172c1236-e1b1-409a-9a2a-d0a392310479&page=queryresults
[0m01:54:43.930273 [debug] [Thread-1 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:54:43.932808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67bcddbc-2bf0-4857-b776-6a2012572c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B3CA10>]}
[0m01:54:43.933440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart_mart.fct_sales_item ................. [[31mERROR[0m in 1.94s]
[0m01:54:43.934160 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:54:43.934806 [debug] [Thread-4 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m01:54:43.936985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:43.939329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:43.939775 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:54:43.940205 [debug] [MainThread]: Connection 'list_e2e-dbt-project_mart' was properly closed.
[0m01:54:43.940634 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:54:43.941105 [info ] [MainThread]: 
[0m01:54:43.941699 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m01:54:43.942824 [debug] [MainThread]: Command end result
[0m01:54:43.970010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:54:43.972133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:54:43.977447 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:54:43.977826 [info ] [MainThread]: 
[0m01:54:43.978314 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:54:43.978755 [info ] [MainThread]: 
[0m01:54:43.979249 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m01:54:43.980095 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Table e2e-dbt-project:mart.stg_hits_products was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:54:43.980782 [info ] [MainThread]: 
[0m01:54:43.981382 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m01:54:43.981809 [info ] [MainThread]: 
[0m01:54:43.982233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:54:43.983150 [debug] [MainThread]: Command `dbt run` failed at 01:54:43.983046 after 10.39 seconds
[0m01:54:43.983492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002542291ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B8E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025422B8E5D0>]}
[0m01:54:43.983829 [debug] [MainThread]: Flushing usage events
[0m01:54:44.991288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:06:41.635413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218EF5702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F05BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F05BB9D0>]}


============================== 02:06:41.641581 | 8fdec8f7-7930-4b93-a03c-b4360e458a95 ==============================
[0m02:06:41.641581 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:06:41.642507 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m02:06:46.193421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218EF8CF6F0>]}
[0m02:06:46.295437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218941AB350>]}
[0m02:06:46.296325 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:06:47.308054 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:06:47.453491 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:06:47.454235 [debug] [MainThread]: previous checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, current checksum: d552cc07cb0a4116664dfd8f153c22e0fe60360a23d819bcfe6b522658608101
[0m02:06:47.454664 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:06:47.455408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189423A150>]}
[0m02:06:49.964070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021895868410>]}
[0m02:06:50.097668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:06:50.101463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:06:50.142769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218958E2270>]}
[0m02:06:50.143396 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m02:06:50.144052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189587C1F0>]}
[0m02:06:50.146167 [info ] [MainThread]: 
[0m02:06:50.146784 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:06:50.147341 [info ] [MainThread]: 
[0m02:06:50.148105 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:06:50.149491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:06:50.150162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:52.214838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_stg_mart)
[0m02:06:52.215598 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "stg_mart"
"
[0m02:06:52.228567 [debug] [ThreadPool]: On create_e2e-dbt-project_stg_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_stg_mart"} */
create schema if not exists `e2e-dbt-project`.`stg_mart`
  
[0m02:06:52.229139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:54.383521 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4e0eff6e-a526-4d81-95e6-57ad1e1f59fc&page=queryresults
[0m02:06:55.328960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg_mart'
[0m02:06:55.330015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_stg'
[0m02:06:55.330470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:55.331001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:58.021499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021895A65850>]}
[0m02:06:58.022270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:58.030421 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:06:58.031569 [info ] [Thread-1 (]: 1 of 1 START sql table model stg_mart.fct_sales_item ........................... [RUN]
[0m02:06:58.033034 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:06:58.034039 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:06:58.055353 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:06:58.057450 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:06:58.153353 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:06:58.155264 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`stg_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m02:06:58.156542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:07:00.911216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6b102357-92fc-476b-876c-3bc023a15a43&page=queryresults
[0m02:07:04.279034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fdec8f7-7930-4b93-a03c-b4360e458a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002189611DB20>]}
[0m02:07:04.279959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stg_mart.fct_sales_item ...................... [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 6.24s]
[0m02:07:04.281100 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:07:04.283150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:04.285829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:04.286267 [debug] [MainThread]: Connection 'create_e2e-dbt-project_stg_mart' was properly closed.
[0m02:07:04.286671 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg_mart' was properly closed.
[0m02:07:04.287063 [debug] [MainThread]: Connection 'list_e2e-dbt-project_stg' was properly closed.
[0m02:07:04.287461 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:07:04.287904 [info ] [MainThread]: 
[0m02:07:04.288514 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.14 seconds (14.14s).
[0m02:07:04.289644 [debug] [MainThread]: Command end result
[0m02:07:04.328671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:07:04.332446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:07:04.341452 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:07:04.342221 [info ] [MainThread]: 
[0m02:07:04.343240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:07:04.344099 [info ] [MainThread]: 
[0m02:07:04.345102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:07:04.347275 [debug] [MainThread]: Command `dbt run` succeeded at 02:07:04.347055 after 22.98 seconds
[0m02:07:04.348150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218959676B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218959B2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218ED33B650>]}
[0m02:07:04.349002 [debug] [MainThread]: Flushing usage events
[0m02:07:05.844949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:49.421083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C5002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D54BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D54B9D0>]}


============================== 02:19:49.427556 | e4dc1f72-4986-4689-81b9-3b8de6c3df80 ==============================
[0m02:19:49.427556 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:19:49.428511 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m02:19:54.167791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8C85F6F0>]}
[0m02:19:54.267669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB0F8B350>]}
[0m02:19:54.268605 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:19:55.364965 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:19:55.536750 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:19:55.537598 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:19:55.538380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB1FEA150>]}
[0m02:19:58.112480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB2648410>]}
[0m02:19:58.245002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:19:58.248610 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:19:58.290032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB26C6270>]}
[0m02:19:58.290660 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m02:19:58.291287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB265C120>]}
[0m02:19:58.293740 [info ] [MainThread]: 
[0m02:19:58.294363 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:19:58.294926 [info ] [MainThread]: 
[0m02:19:58.295739 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:19:58.301490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:19:58.302253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:58.303365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:19:58.304192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:00.865969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m02:20:00.866701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_mart)
[0m02:20:00.867489 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m02:20:00.868199 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_mart"
"
[0m02:20:00.885545 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_mart"} */
create schema if not exists `e2e-dbt-project`.`analytics_mart`
  
[0m02:20:00.890632 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m02:20:00.891214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:00.891800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:03.505036 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c6405488-abf1-494e-bc1d-c7b586eb6462&page=queryresults
[0m02:20:03.586477 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4741598e-ba5e-4ac0-981d-cb259d2aead0&page=queryresults
[0m02:20:04.709028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:20:04.709774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:04.710524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:20:04.711244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:07.356580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB2860B90>]}
[0m02:20:07.357293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:07.367297 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:20:07.368193 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:20:07.368979 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:20:07.370402 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:20:07.371589 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:20:07.372526 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:20:07.373400 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:20:07.374117 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:20:07.385311 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:20:07.389165 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:20:07.391764 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:20:07.392594 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:20:07.443510 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:20:07.444167 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:20:07.446261 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m02:20:07.447385 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as WITH raw AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)              AS hit_date,
    fullVisitorId                           AS visitor_id,
    visitId                                 AS visit_id,
    hits.transaction.transactionId          AS transaction_id,
    p.productSKU                            AS product_sku,
    p.v2ProductName                         AS product_name,
    p.v2ProductCategory                     AS product_category,
    p.productQuantity                       AS product_quantity,
    p.productPrice / 1e6                    AS product_price_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       UNNEST(hits) AS hits,
       UNNEST(hits.product) AS p
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
    AND p.productSKU IS NOT NULL
)
SELECT *
FROM raw;


[0m02:20:07.448398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:20:07.449154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:20:10.123055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b8fa09d1-8003-45ce-b6dc-81c717bbcb03&page=queryresults
[0m02:20:10.162355 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:745c5ac3-e897-44c9-9fdf-89f7cb2c8d9e&page=queryresults
[0m02:20:10.669653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB287AA40>]}
[0m02:20:10.670604 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m02:20:10.671766 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:20:10.747512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB207B4D0>]}
[0m02:20:10.748393 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 3.38s]
[0m02:20:10.749517 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:20:10.750459 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:10.751240 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:20:10.752364 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:20:10.752927 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:10.756852 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:20:10.758199 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:10.762442 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:20:10.763980 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m02:20:10.764741 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:20:13.126369 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:48659b0e-61e7-4f22-9648-30d5ba6f76e3&page=queryresults
[0m02:20:13.691512 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC8D51A2D0>]}
[0m02:20:13.692381 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.94s]
[0m02:20:13.693513 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:20:13.694462 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:20:13.695234 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m02:20:13.696189 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:20:13.696727 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:20:13.700896 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:20:13.702329 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:20:13.746937 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:20:13.748658 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m02:20:13.749424 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:20:16.139111 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d116551-a8af-4355-89f1-2944c5337e6c&page=queryresults
[0m02:20:19.686026 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4dc1f72-4986-4689-81b9-3b8de6c3df80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB301F2A0>]}
[0m02:20:19.686944 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.99s]
[0m02:20:19.688062 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:20:19.690125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:19.692999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:19.693479 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:20:19.693885 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:20:19.694277 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:20:19.694667 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:20:19.695055 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:20:19.695449 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:20:19.695898 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m02:20:19.696295 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:20:19.696805 [info ] [MainThread]: 
[0m02:20:19.697426 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 21.40 seconds (21.40s).
[0m02:20:19.699253 [debug] [MainThread]: Command end result
[0m02:20:19.740151 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:20:19.743496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:20:19.752598 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:20:19.753143 [info ] [MainThread]: 
[0m02:20:19.754043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:19.754929 [info ] [MainThread]: 
[0m02:20:19.755869 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:20:19.758030 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:19.757808 after 30.61 seconds
[0m02:20:19.758925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB30291F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB3028530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB3029790>]}
[0m02:20:19.759789 [debug] [MainThread]: Flushing usage events
[0m02:20:21.353501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:26:40.796517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4935F02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49463BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49463B9D0>]}


============================== 02:26:40.800894 | 3e6d3213-74d0-40b8-b59c-59b09f5cbe64 ==============================
[0m02:26:40.800894 [info ] [MainThread]: Running with dbt=1.10.9
[0m02:26:40.801591 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m02:26:43.681745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49394F6F0>]}
[0m02:26:43.741758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B806B350>]}
[0m02:26:43.742349 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m02:26:44.385075 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m02:26:44.561086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:26:44.561441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:26:44.600717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B92E4050>]}
[0m02:26:44.681658 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:26:44.683922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:26:44.712729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B8129F40>]}
[0m02:26:44.713114 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m02:26:44.713522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B97E84B0>]}
[0m02:26:44.715131 [info ] [MainThread]: 
[0m02:26:44.715498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:26:44.715825 [info ] [MainThread]: 
[0m02:26:44.716285 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:26:44.721434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:26:44.721956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:44.722336 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m02:26:44.722815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:46.558182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m02:26:46.558662 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m02:26:46.568171 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m02:26:46.568549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:26:48.182542 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c1f6df16-8fd8-43ef-97a2-c99b5f30e4eb&page=queryresults
[0m02:26:49.293244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m02:26:49.293729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:49.294103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m02:26:49.294547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:26:50.967137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B979F5F0>]}
[0m02:26:50.967831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:26:50.974518 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m02:26:50.975258 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m02:26:50.976111 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m02:26:50.977789 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m02:26:50.976818 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m02:26:50.978618 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m02:26:50.979445 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m02:26:50.985207 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m02:26:50.985634 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m02:26:50.989220 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m02:26:50.990360 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m02:26:51.000810 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m02:26:51.014951 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m02:26:51.018418 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m02:26:51.019687 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as WITH source AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)                  AS session_date,
	geoNetwork.country                         as country,
    fullVisitorId                               AS visitor_id,
    visitId                                     AS visit_id,
    trafficSource.source                        AS traffic_source,
    trafficSource.medium                        AS traffic_medium,
    trafficSource.campaign                      AS traffic_campaign,
    totals.visits                               AS visits,
    totals.transactions                         AS transactions,
    SAFE_DIVIDE(totals.transactionRevenue, 1e6) AS revenue_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
)
SELECT * FROM source;


[0m02:26:51.020476 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as WITH raw AS (
  SELECT
    PARSE_DATE('%Y%m%d', date)              AS hit_date,
    fullVisitorId                           AS visitor_id,
    visitId                                 AS visit_id,
    hits.transaction.transactionId          AS transaction_id,
    p.productSKU                            AS product_sku,
    p.v2ProductName                         AS product_name,
    p.v2ProductCategory                     AS product_category,
    p.productQuantity                       AS product_quantity,
    p.productPrice / 1e6                    AS product_price_usd
  FROM `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
       UNNEST(hits) AS hits,
       UNNEST(hits.product) AS p
  WHERE _TABLE_SUFFIX BETWEEN '20170801' AND '20170831'
    AND p.productSKU IS NOT NULL
)
SELECT *
FROM raw;


[0m02:26:51.021116 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:26:51.021573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:26:53.087160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dccef246-aa58-4b4b-b584-973f1134f5a0&page=queryresults
[0m02:26:53.106943 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:cf6d5878-42b2-4668-967e-1bfa1ad52a23&page=queryresults
[0m02:26:53.644566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B98062D0>]}
[0m02:26:53.645163 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.67s]
[0m02:26:53.645964 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m02:26:53.700839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B9E214F0>]}
[0m02:26:53.701384 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.72s]
[0m02:26:53.702200 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m02:26:53.703110 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:53.704013 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m02:26:53.704686 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m02:26:53.705002 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:53.709126 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:26:53.710343 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:53.714497 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m02:26:53.715760 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as WITH base AS (
  SELECT *
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy AS (
  SELECT country, currency
  FROM `e2e-dbt-project.ext.country_currency`
),
fx AS (
  SELECT rate_date, currency, rate_to_usd
  FROM `e2e-dbt-project.ext.fx_rates`
)
SELECT
  b.session_date,
  b.visitor_id,
  b.visit_id,
  b.country,
  b.traffic_source,
  b.traffic_medium,
  b.traffic_campaign,
  b.visits,
  b.transactions,
  b.revenue_usd,
  c.currency,
  CASE
    WHEN b.revenue_usd IS NULL THEN NULL
    WHEN c.currency = 'USD' THEN b.revenue_usd
    ELSE b.revenue_usd / NULLIF(f.rate_to_usd, 0)
  END AS revenue_local
FROM base b
LEFT JOIN ccy c
  ON c.country = b.country
LEFT JOIN fx f
  ON f.rate_date = b.session_date AND f.currency = c.currency;


[0m02:26:53.716438 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:26:55.459967 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:63f5c0a0-6aca-4c5c-ab5c-a7757f52b3fb&page=queryresults
[0m02:26:55.983359 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B9EB3CF0>]}
[0m02:26:55.983896 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.28s]
[0m02:26:55.984704 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m02:26:55.985440 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m02:26:55.985848 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m02:26:55.986354 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m02:26:55.986662 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m02:26:55.992183 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m02:26:55.993714 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m02:26:56.010711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:26:57.398424 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m02:26:57.399447 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m02:26:58.363190 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9b59ba5e-97e8-45a6-8176-d6ad1a8543d4&page=queryresults
[0m02:27:01.350523 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e6d3213-74d0-40b8-b59c-59b09f5cbe64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B9D68D50>]}
[0m02:27:01.351073 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.36s]
[0m02:27:01.351900 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m02:27:01.353745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:27:01.355405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:27:01.355728 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m02:27:01.355997 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:27:01.356226 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m02:27:01.356455 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m02:27:01.356681 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m02:27:01.356907 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m02:27:01.357138 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m02:27:01.357363 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m02:27:01.357664 [info ] [MainThread]: 
[0m02:27:01.358028 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 16.64 seconds (16.64s).
[0m02:27:01.359108 [debug] [MainThread]: Command end result
[0m02:27:01.389065 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m02:27:01.391414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m02:27:01.397077 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m02:27:01.397383 [info ] [MainThread]: 
[0m02:27:01.397791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:27:01.398214 [info ] [MainThread]: 
[0m02:27:01.398592 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m02:27:01.399470 [debug] [MainThread]: Command `dbt run` succeeded at 02:27:01.399369 after 20.77 seconds
[0m02:27:01.399790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4946904B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D48DEF83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49450FD70>]}
[0m02:27:01.400108 [debug] [MainThread]: Flushing usage events
[0m02:27:03.227232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:06.352091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C9BB02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CABFBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211CABFB9D0>]}


============================== 19:52:06.359360 | bee06f01-15ee-4099-8366-43945b798df9 ==============================
[0m19:52:06.359360 [info ] [MainThread]: Running with dbt=1.10.9
[0m19:52:06.360461 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:52:16.902730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C9F0F6F0>]}
[0m19:52:16.990632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EE63B350>]}
[0m19:52:16.991314 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:52:18.116759 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m19:52:20.491479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:20.491922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:20.548907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EF8B8050>]}
[0m19:52:20.656269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:52:20.680481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:52:20.791897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EF6CDF40>]}
[0m19:52:20.792541 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m19:52:20.793109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFDB04B0>]}
[0m19:52:20.795333 [info ] [MainThread]: 
[0m19:52:20.795852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:52:20.796303 [info ] [MainThread]: 
[0m19:52:20.796956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:52:20.798161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m19:52:20.798662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:22.817899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m19:52:22.820657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:22.822933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m19:52:22.824909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:24.932546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EE63FE10>]}
[0m19:52:24.933341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:24.943501 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m19:52:24.944518 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m19:52:24.945695 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m19:52:24.946464 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m19:52:24.960937 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m19:52:24.962874 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m19:52:24.981453 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:26.724967 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m19:52:26.726685 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m19:52:27.842983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aa62697d-414e-432c-915f-146b96c5a01a&page=queryresults
[0m19:52:33.734685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee06f01-15ee-4099-8366-43945b798df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFD79F10>]}
[0m19:52:33.735791 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 8.79s]
[0m19:52:33.737093 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m19:52:33.738809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:33.740982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:33.741359 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m19:52:33.741694 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m19:52:33.742030 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m19:52:33.742367 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m19:52:33.743188 [info ] [MainThread]: 
[0m19:52:33.743765 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.95 seconds (12.95s).
[0m19:52:33.744692 [debug] [MainThread]: Command end result
[0m19:52:33.777112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m19:52:33.779652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m19:52:33.786866 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m19:52:33.787529 [info ] [MainThread]: 
[0m19:52:33.788171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:33.788610 [info ] [MainThread]: 
[0m19:52:33.789069 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:52:33.790213 [debug] [MainThread]: Command `dbt run` succeeded at 19:52:33.790082 after 27.65 seconds
[0m19:52:33.790609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFE1CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EFD7F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C9EEBF70>]}
[0m19:52:33.791005 [debug] [MainThread]: Flushing usage events
[0m19:52:35.871597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:24.365661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4657702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4667BBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4667BB9D0>]}


============================== 20:00:24.370950 | a0a5c7f9-63f6-4702-a297-943ad17ac2d0 ==============================
[0m20:00:24.370950 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:00:24.371750 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select mart.fct_sales_item --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:00:27.787641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E465ACF6F0>]}
[0m20:00:27.855171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A2EB350>]}
[0m20:00:27.855797 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:00:28.691328 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:00:28.896084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:28.896431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:28.944345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40B564050>]}
[0m20:00:29.049243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:00:29.051906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:00:29.085378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A3A9F40>]}
[0m20:00:29.085917 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:00:29.086391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BA644B0>]}
[0m20:00:29.088369 [info ] [MainThread]: 
[0m20:00:29.088880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:29.089304 [info ] [MainThread]: 
[0m20:00:29.089895 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:29.090915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m20:00:29.091339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:30.977591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m20:00:30.979732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:30.981282 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m20:00:30.982637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:33.043739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40A2EFE10>]}
[0m20:00:33.044648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:33.053713 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m20:00:33.054538 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m20:00:33.055498 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m20:00:33.055969 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m20:00:33.067668 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m20:00:33.069243 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m20:00:33.086679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:34.630025 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m20:00:34.631205 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m20:00:35.682826 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ce30d1c0-1aea-4a10-813b-b2aa414bd45c&page=queryresults
[0m20:00:39.052671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0a5c7f9-63f6-4702-a297-943ad17ac2d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BA1DF10>]}
[0m20:00:39.053502 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 6.00s]
[0m20:00:39.054969 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m20:00:39.056770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:39.058621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:39.058957 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m20:00:39.059268 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m20:00:39.059581 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m20:00:39.059963 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m20:00:39.060300 [info ] [MainThread]: 
[0m20:00:39.060776 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m20:00:39.061663 [debug] [MainThread]: Command end result
[0m20:00:39.098601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:00:39.101220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:00:39.108224 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m20:00:39.108602 [info ] [MainThread]: 
[0m20:00:39.109293 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:39.109887 [info ] [MainThread]: 
[0m20:00:39.110415 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:00:39.111586 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:39.111461 after 14.93 seconds
[0m20:00:39.112015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BAD4EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40BA2F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E465AABF70>]}
[0m20:00:39.112409 [debug] [MainThread]: Flushing usage events
[0m20:00:41.378195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:43.828110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D855D502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D856D9BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D856D9B9D0>]}


============================== 20:10:43.833197 | 3a87c50f-0490-4c0a-b432-9268b8860846 ==============================
[0m20:10:43.833197 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:10:43.833964 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt ls --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m20:10:48.113272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D8560AF6F0>]}
[0m20:10:48.194007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87A7C7240>]}
[0m20:10:48.194747 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:10:48.991720 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:10:49.200702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:10:49.201380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:10:49.258753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BA44750>]}
[0m20:10:49.402631 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:10:49.407211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:10:49.454963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87A897E30>]}
[0m20:10:49.455509 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:10:49.456011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a87c50f-0490-4c0a-b432-9268b8860846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BE27BD0>]}
[0m20:10:49.457015 [info ] [MainThread]: ga_retail_project.mart.fct_sales_item
[0m20:10:49.459253 [debug] [MainThread]: Command `dbt ls` succeeded at 20:10:49.459063 after 5.84 seconds
[0m20:10:49.459715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BE6F6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D856D64650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D87BE7DE50>]}
[0m20:10:49.460138 [debug] [MainThread]: Flushing usage events
[0m20:10:50.950527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:55.222911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA6EB02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA7EFBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA7EFB9D0>]}


============================== 20:21:55.228077 | 65613caa-3485-4d32-953d-1aa343e99bdd ==============================
[0m20:21:55.228077 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:21:55.228805 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:21:59.793153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA720F6F0>]}
[0m20:21:59.878054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECB93B350>]}
[0m20:21:59.878827 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:22:00.829501 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:22:01.101186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:22:01.101576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:22:01.164121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECCBB4050>]}
[0m20:22:01.295819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:22:01.298700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:22:01.346136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECB9FDF40>]}
[0m20:22:01.346732 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:22:01.347289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECD0AC4B0>]}
[0m20:22:01.349835 [info ] [MainThread]: 
[0m20:22:01.350696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:22:01.351451 [info ] [MainThread]: 
[0m20:22:01.352372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:01.353624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m20:22:01.354095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:03.210251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_mart)
[0m20:22:03.211789 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_mart"
"
[0m20:22:03.231431 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_mart"} */
create schema if not exists `e2e-dbt-project`.`analytics_mart`
  
[0m20:22:03.232172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:05.648331 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:46489948-2187-48bc-a102-d922ec44a463&page=queryresults
[0m20:22:06.895854 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m20:22:06.896470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:06.896950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m20:22:06.897511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:09.163279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECCFDA750>]}
[0m20:22:09.164331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:09.174471 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m20:22:09.175297 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m20:22:09.176279 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m20:22:09.176902 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m20:22:09.188592 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m20:22:09.190085 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m20:22:09.250688 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m20:22:09.252182 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m20:22:09.252898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:22:11.134139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92f75740-c633-437b-9ada-f05588276fdd&page=queryresults
[0m20:22:11.135025 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:92f75740-c633-437b-9ada-f05588276fdd&page=queryresults
[0m20:22:11.291858 [debug] [Thread-1 (]: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Dataset e2e-dbt-project:analytics_stg was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m20:22:11.295033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65613caa-3485-4d32-953d-1aa343e99bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECD5B9D90>]}
[0m20:22:11.295939 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics_mart.fct_sales_item ............ [[31mERROR[0m in 2.12s]
[0m20:22:11.296939 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m20:22:11.297817 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.fct_sales_item' to be skipped because of status 'error'.  Reason: Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Dataset e2e-dbt-project:analytics_stg was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql.
[0m20:22:11.300372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:11.302572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:11.303001 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_mart' was properly closed.
[0m20:22:11.303373 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m20:22:11.303719 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m20:22:11.304059 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m20:22:11.304462 [info ] [MainThread]: 
[0m20:22:11.304965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.95 seconds (9.95s).
[0m20:22:11.305930 [debug] [MainThread]: Command end result
[0m20:22:11.351965 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:22:11.354873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:22:11.363438 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m20:22:11.363943 [info ] [MainThread]: 
[0m20:22:11.364648 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:22:11.365202 [info ] [MainThread]: 
[0m20:22:11.365825 [error] [MainThread]: [31mFailure in model fct_sales_item (models\mart\fct_sales_item.sql)[0m
[0m20:22:11.366441 [error] [MainThread]:   Database Error in model fct_sales_item (models\mart\fct_sales_item.sql)
  Not found: Dataset e2e-dbt-project:analytics_stg was not found in location US
  compiled code at target\run\ga_retail_project\models\mart\fct_sales_item.sql
[0m20:22:11.366971 [info ] [MainThread]: 
[0m20:22:11.367581 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\fct_sales_item.sql
[0m20:22:11.368098 [info ] [MainThread]: 
[0m20:22:11.368644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:22:11.369880 [debug] [MainThread]: Command `dbt run` failed at 20:22:11.369745 after 16.39 seconds
[0m20:22:11.370313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECCEBF280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EA5702FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ECD6BC870>]}
[0m20:22:11.370747 [debug] [MainThread]: Flushing usage events
[0m20:22:13.525531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:20.114346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023253B802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023254BCBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023254BCB9D0>]}


============================== 20:23:20.119706 | 0f080b75-4ce6-47bb-af4b-d10dbcf83d08 ==============================
[0m20:23:20.119706 [info ] [MainThread]: Running with dbt=1.10.9
[0m20:23:20.120465 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select mart.fct_sales_item.sql --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m20:23:24.538603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023253EDF6F0>]}
[0m20:23:24.623994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002327860B350>]}
[0m20:23:24.624858 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:23:25.631380 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m20:23:25.876417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:25.876827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:25.930447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023279884050>]}
[0m20:23:26.074368 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:23:26.078729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:23:26.119591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232786C9F40>]}
[0m20:23:26.120138 [info ] [MainThread]: Found 4 models, 7 data tests, 610 macros
[0m20:23:26.120651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f080b75-4ce6-47bb-af4b-d10dbcf83d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023279D804B0>]}
[0m20:23:26.121611 [warn ] [MainThread]: The selection criterion 'mart.fct_sales_item.sql' does not match any enabled nodes
[0m20:23:26.123532 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:23:26.126892 [debug] [MainThread]: Command end result
[0m20:23:26.168859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m20:23:26.171861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m20:23:26.176042 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m20:23:26.178050 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:26.177812 after 6.23 seconds
[0m20:23:26.178739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232786F0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023254BA0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023279CBB410>]}
[0m20:23:26.179307 [debug] [MainThread]: Flushing usage events
[0m20:23:28.471191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:49:18.359508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029789C202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002978AC6BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002978AC6B9D0>]}


============================== 00:49:18.368736 | 03f43f4d-630a-4a63-93b8-92446033340a ==============================
[0m00:49:18.368736 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:49:18.369414 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m00:49:24.914321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03f43f4d-630a-4a63-93b8-92446033340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029789F7F6F0>]}
[0m00:49:24.977772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03f43f4d-630a-4a63-93b8-92446033340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AE6AB350>]}
[0m00:49:24.978433 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:49:25.762717 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:49:27.255271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m00:49:27.255827 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\sources.yml
[0m00:49:27.256210 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\staging_models.yml
[0m00:49:27.256895 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:49:27.257610 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m00:49:27.258181 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m00:49:27.689694 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:49:27.698779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '03f43f4d-630a-4a63-93b8-92446033340a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AF925650>]}
[0m00:49:27.746649 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named stg_sessions. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for stg_sessions in one of these files:
   - models\staging\stg_sessions.yml
  models\staging\staging_models.yml
[0m00:49:27.747849 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:49:27.748835 [debug] [MainThread]: Command `dbt run` failed at 00:49:27.748729 after 9.59 seconds
[0m00:49:27.749159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AFFB75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297AFFB76B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002978AC47E70>]}
[0m00:49:27.749476 [debug] [MainThread]: Flushing usage events
[0m00:49:29.378049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:53:51.970029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA8B602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA9BABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA9BAB9D0>]}


============================== 00:53:51.974236 | f2875b2a-6be5-42f6-afd2-3e82c5df8cfa ==============================
[0m00:53:51.974236 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:53:51.975162 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m00:53:55.162788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2875b2a-6be5-42f6-afd2-3e82c5df8cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA8EBF6F0>]}
[0m00:53:55.234811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2875b2a-6be5-42f6-afd2-3e82c5df8cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCD5EB350>]}
[0m00:53:55.235455 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:53:55.911042 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:53:56.111388 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m00:53:56.111941 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\staging_models.yml
[0m00:53:56.112348 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\sources.yml
[0m00:53:56.112821 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:53:56.113179 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m00:53:56.113485 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m00:53:56.471964 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:53:56.472484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2875b2a-6be5-42f6-afd2-3e82c5df8cfa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCE865250>]}
[0m00:53:56.491168 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd_0__revenue_usd (models\staging\staging_models.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'argument'
[0m00:53:56.492838 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:53:56.494876 [debug] [MainThread]: Command `dbt run` failed at 00:53:56.494696 after 4.71 seconds
[0m00:53:56.495510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCEECA990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CCEECAA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA9B87E70>]}
[0m00:53:56.496125 [debug] [MainThread]: Flushing usage events
[0m00:53:58.538727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:53.245222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B30E02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B412BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B412B9D0>]}


============================== 00:56:53.249778 | 6a00362b-0971-4ee1-b722-0139bdf957f9 ==============================
[0m00:56:53.249778 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:56:53.250446 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m00:56:56.458813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B34436F0>]}
[0m00:56:56.528172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D7B6B350>]}
[0m00:56:56.529107 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:56:57.217525 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:56:57.404221 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 3 files changed.
[0m00:56:57.404791 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\sources.yml
[0m00:56:57.405176 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\staging\staging_models.yml
[0m00:56:57.405649 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_hits_products.sql
[0m00:56:57.406004 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions_with_fx.sql
[0m00:56:57.406311 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\stg_sessions.sql
[0m00:56:57.844603 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:56:57.845122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D8DE5650>]}
[0m00:56:58.017215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D946FA70>]}
[0m00:56:58.128617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:56:58.143933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:56:58.203133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D9328050>]}
[0m00:56:58.203535 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 610 macros
[0m00:56:58.203961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D961BAD0>]}
[0m00:56:58.205747 [info ] [MainThread]: 
[0m00:56:58.206142 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:56:58.206491 [info ] [MainThread]: 
[0m00:56:58.206970 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:56:58.211675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:56:58.212086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:58.212894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m00:56:58.213336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:00.093288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m00:57:00.094025 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m00:57:00.104092 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m00:57:00.104485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:57:01.782781 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:8d835f2a-6323-46ed-8d81-6ce9ca907390&page=queryresults
[0m00:57:04.574784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m00:57:04.575376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:04.575846 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m00:57:04.576494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:06.348993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D9646810>]}
[0m00:57:06.349458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:57:06.365184 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m00:57:06.365602 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m00:57:06.366182 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m00:57:06.366966 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m00:57:06.367932 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m00:57:06.368632 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m00:57:06.369030 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m00:57:06.369577 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m00:57:06.378942 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m00:57:06.384000 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m00:57:06.385394 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m00:57:06.405903 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m00:57:06.415924 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m00:57:06.420564 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m00:57:06.422125 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m00:57:06.422928 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m00:57:06.423598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:57:06.423966 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:57:08.309909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f013a605-e83a-4d5a-adb8-696262578205&page=queryresults
[0m00:57:08.310422 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f013a605-e83a-4d5a-adb8-696262578205&page=queryresults
[0m00:57:08.368693 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0894f2c6-ecf5-4cd0-8f97-729bbee64c89&page=queryresults
[0m00:57:08.369177 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:0894f2c6-ecf5-4cd0-8f97-729bbee64c89&page=queryresults
[0m00:57:08.424069 [debug] [Thread-2 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m00:57:08.430035 [debug] [Thread-1 (]: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m00:57:08.431284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D9D09440>]}
[0m00:57:08.432189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a00362b-0971-4ee1-b722-0139bdf957f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B3418190>]}
[0m00:57:08.431880 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics_stg.stg_sessions ................ [[31mERROR[0m in 2.06s]
[0m00:57:08.433421 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m00:57:08.434243 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m00:57:08.432746 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics_stg.stg_hits_products ........... [[31mERROR[0m in 2.06s]
[0m00:57:08.435565 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m00:57:08.436319 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m00:57:08.437642 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_hits_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql.
[0m00:57:08.436837 [info ] [Thread-3 (]: 3 of 4 SKIP relation analytics_stg.stg_sessions_with_fx ........................ [[33mSKIP[0m]
[0m00:57:08.438458 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m00:57:08.439156 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m00:57:08.439537 [info ] [Thread-4 (]: 4 of 4 SKIP relation analytics_mart.fct_sales_item ............................. [[33mSKIP[0m]
[0m00:57:08.440011 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m00:57:08.441419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:57:08.444387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:08.444936 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m00:57:08.445439 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:57:08.446353 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m00:57:08.446771 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m00:57:08.447030 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m00:57:08.447280 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m00:57:08.447616 [info ] [MainThread]: 
[0m00:57:08.448018 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m00:57:08.448899 [debug] [MainThread]: Command end result
[0m00:57:08.478303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m00:57:08.480622 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m00:57:08.486006 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m00:57:08.486324 [info ] [MainThread]: 
[0m00:57:08.486742 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:57:08.487147 [info ] [MainThread]: 
[0m00:57:08.487581 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m00:57:08.488007 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m00:57:08.488363 [info ] [MainThread]: 
[0m00:57:08.488766 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m00:57:08.489120 [info ] [MainThread]: 
[0m00:57:08.489535 [error] [MainThread]: [31mFailure in model stg_hits_products (models\staging\stg_hits_products.sql)[0m
[0m00:57:08.489954 [error] [MainThread]:   Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m00:57:08.490310 [info ] [MainThread]: 
[0m00:57:08.490714 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_hits_products.sql
[0m00:57:08.491067 [info ] [MainThread]: 
[0m00:57:08.491580 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m00:57:08.492624 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:57:08.493973 [debug] [MainThread]: Command `dbt run` failed at 00:57:08.493850 after 15.43 seconds
[0m00:57:08.494332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D94978D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194D96ACC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194B41804B0>]}
[0m00:57:08.494667 [debug] [MainThread]: Flushing usage events
[0m00:57:09.739986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:46.325588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A46B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A56F7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A56F79D0>]}


============================== 00:58:46.330627 | 5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a ==============================
[0m00:58:46.330627 [info ] [MainThread]: Running with dbt=1.10.9
[0m00:58:46.331272 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m00:58:49.694869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A4A0F6F0>]}
[0m00:58:49.761939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C912B350>]}
[0m00:58:49.762577 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m00:58:50.463588 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m00:58:50.685197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:58:50.686049 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\staging\staging_models.yml
[0m00:58:51.047049 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m00:58:51.047760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5efcdc3e-8574-46a5-8aa1-0abe61b5bd0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CA7AC450>]}
[0m00:58:51.065379 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_expression_is_true_stg_hits_products_product_price_usd_0__product_price_usd (models\staging\staging_models.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'argument'
[0m00:58:51.066006 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:58:51.067123 [debug] [MainThread]: Command `dbt run` failed at 00:58:51.067013 after 4.91 seconds
[0m00:58:51.067448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CA982F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203CA983020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A56D7E70>]}
[0m00:58:51.067787 [debug] [MainThread]: Flushing usage events
[0m00:58:52.383625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:00.945984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DBD902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCDC7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCDC79D0>]}


============================== 01:02:00.950205 | b4609e6a-8c8c-4d5a-90a0-29168ce6bc49 ==============================
[0m01:02:00.950205 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:02:00.950826 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:02:01.094182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4609e6a-8c8c-4d5a-90a0-29168ce6bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DC0EF6F0>]}
[0m01:02:01.174170 [debug] [MainThread]: Command `dbt clean` succeeded at 01:02:01.174056 after 0.40 seconds
[0m01:02:01.174508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCCDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCCD480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DE0B0650>]}
[0m01:02:01.174851 [debug] [MainThread]: Flushing usage events
[0m01:02:03.275792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:11.073369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78BAD02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CB0FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CB0F9D0>]}


============================== 01:02:11.077971 | 38fe4b7d-2edf-429e-ad1e-93a21cdf9222 ==============================
[0m01:02:11.077971 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:02:11.078700 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:02:11.223195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38fe4b7d-2edf-429e-ad1e-93a21cdf9222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78BE2F6F0>]}
[0m01:02:11.274924 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-p8eo85ti'
[0m01:02:11.275450 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:02:12.284673 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:02:12.285991 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:02:12.814417 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:02:12.824940 [info ] [MainThread]: Updating lock file in file path: C:\Projects\ga_retail_project/package-lock.yml
[0m01:02:12.834839 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-l5tq9roc'
[0m01:02:12.837696 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:02:13.968649 [info ] [MainThread]: Installed from version 1.3.0
[0m01:02:13.969118 [info ] [MainThread]: Up to date!
[0m01:02:13.969546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '38fe4b7d-2edf-429e-ad1e-93a21cdf9222', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CA0D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78CA0E360>]}
[0m01:02:13.971274 [debug] [MainThread]: Command `dbt deps` succeeded at 01:02:13.971160 after 3.02 seconds
[0m01:02:13.971598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DDC9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78C2EB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78DD734D0>]}
[0m01:02:13.971927 [debug] [MainThread]: Flushing usage events
[0m01:02:15.157554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:24.229534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D04B602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D05BABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D05BAB9D0>]}


============================== 01:02:24.233730 | dd4bcd40-4f59-4d13-96c0-83ac7fb39a93 ==============================
[0m01:02:24.233730 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:02:24.234370 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:02:27.482238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D04EBF6F0>]}
[0m01:02:27.545954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D295DB350>]}
[0m01:02:27.546601 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:02:28.213344 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:02:28.214456 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:02:28.214870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2A638850>]}
[0m01:02:29.934594 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m01:02:29.935120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd4bcd40-4f59-4d13-96c0-83ac7fb39a93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2AB9E210>]}
[0m01:02:29.951592 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_expression_is_true_stg_sessions_revenue_usd_0__revenue_usd (models\staging\staging_models.yml)
  macro 'dbt_macro__test_expression_is_true' takes no keyword argument 'argument'
[0m01:02:29.952203 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:02:29.953155 [debug] [MainThread]: Command `dbt run` failed at 01:02:29.953049 after 5.85 seconds
[0m01:02:29.953475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D05B87E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2AFACD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D2ABDE340>]}
[0m01:02:29.953788 [debug] [MainThread]: Flushing usage events
[0m01:02:31.022480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:45.180868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767B702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768BBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768BBB9D0>]}


============================== 01:04:45.185263 | 01cf8896-f7d6-41cd-951b-d3383868729c ==============================
[0m01:04:45.185263 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:04:45.185928 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:04:48.546821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767ECF6F0>]}
[0m01:04:48.610288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70C6EB350>]}
[0m01:04:48.610955 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:04:49.290431 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:04:49.291468 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:04:49.291885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70C778850>]}
[0m01:04:50.906777 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:04:50.907310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DCAFC50>]}
[0m01:04:51.200696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DF2A350>]}
[0m01:04:51.308114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:04:51.311262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:04:51.343182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DF4FC70>]}
[0m01:04:51.343652 [info ] [MainThread]: Found 4 models, 20 data tests, 3 sources, 612 macros
[0m01:04:51.344129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DD574D0>]}
[0m01:04:51.346523 [info ] [MainThread]: 
[0m01:04:51.346988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:04:51.347346 [info ] [MainThread]: 
[0m01:04:51.347845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:04:51.351715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:04:51.352245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:51.352642 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:04:51.353144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:53.329550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:04:53.330050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:53.330724 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:04:53.331135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:55.131159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70DD4F960>]}
[0m01:04:55.131910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:55.137945 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:04:55.139382 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:04:55.138884 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:04:55.140751 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:04:55.140151 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:04:55.141295 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:04:55.142325 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:04:55.150733 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:04:55.151266 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:04:55.156206 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:04:55.158776 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:04:55.191688 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:04:55.198371 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:04:55.201469 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:04:55.205188 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:04:55.205932 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:04:55.206615 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data`.`google_analytics_sample`.`ga_sessions`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:04:55.208832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:57.221459 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f601bb7d-d243-460c-8946-7e771b0beeb6&page=queryresults
[0m01:04:57.221967 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:f601bb7d-d243-460c-8946-7e771b0beeb6&page=queryresults
[0m01:04:57.232641 [debug] [Thread-2 (]: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:04:57.234814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767EA8190>]}
[0m01:04:57.235445 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model analytics_stg.stg_sessions ................ [[31mERROR[0m in 2.09s]
[0m01:04:57.236190 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:04:57.236881 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql.
[0m01:04:57.238345 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:04:57.238747 [info ] [Thread-3 (]: 3 of 4 SKIP relation analytics_stg.stg_sessions_with_fx ........................ [[33mSKIP[0m]
[0m01:04:57.239260 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:04:57.281391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:34697e29-e5dc-449e-8c62-45fc6fc0a835&page=queryresults
[0m01:04:57.282131 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:34697e29-e5dc-449e-8c62-45fc6fc0a835&page=queryresults
[0m01:04:57.289455 [debug] [Thread-1 (]: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:04:57.290037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01cf8896-f7d6-41cd-951b-d3383868729c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70D848C50>]}
[0m01:04:57.290598 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model analytics_stg.stg_hits_products ........... [[31mERROR[0m in 2.15s]
[0m01:04:57.291311 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:04:57.291962 [debug] [Thread-7 (]: Marking all children of 'model.ga_retail_project.stg_hits_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql.
[0m01:04:57.292969 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:04:57.293663 [info ] [Thread-4 (]: 4 of 4 SKIP relation analytics_mart.fct_sales_item ............................. [[33mSKIP[0m]
[0m01:04:57.294501 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:04:57.296531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:57.298440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:57.298882 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:04:57.299204 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:04:57.299462 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:04:57.299752 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:04:57.300015 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:04:57.300264 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:04:57.300596 [info ] [MainThread]: 
[0m01:04:57.301388 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m01:04:57.302411 [debug] [MainThread]: Command end result
[0m01:04:57.333609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:04:57.335996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:04:57.341633 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:04:57.341940 [info ] [MainThread]: 
[0m01:04:57.342431 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:04:57.342851 [info ] [MainThread]: 
[0m01:04:57.343334 [error] [MainThread]: [31mFailure in model stg_sessions (models\staging\stg_sessions.sql)[0m
[0m01:04:57.343790 [error] [MainThread]:   Database Error in model stg_sessions (models\staging\stg_sessions.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_sessions.sql
[0m01:04:57.344184 [info ] [MainThread]: 
[0m01:04:57.344637 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_sessions.sql
[0m01:04:57.345163 [info ] [MainThread]: 
[0m01:04:57.346087 [error] [MainThread]: [31mFailure in model stg_hits_products (models\staging\stg_hits_products.sql)[0m
[0m01:04:57.346915 [error] [MainThread]:   Database Error in model stg_hits_products (models\staging\stg_hits_products.sql)
  Not found: Table bigquery-public-data:google_analytics_sample.ga_sessions was not found in location US
  compiled code at target\run\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:04:57.347332 [info ] [MainThread]: 
[0m01:04:57.347764 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\staging\stg_hits_products.sql
[0m01:04:57.348126 [info ] [MainThread]: 
[0m01:04:57.348511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 NO-OP=0 TOTAL=4
[0m01:04:57.349067 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:04:57.350019 [debug] [MainThread]: Command `dbt run` failed at 01:04:57.349914 after 12.34 seconds
[0m01:04:57.350357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F768C244B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7624783D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F70D9042F0>]}
[0m01:04:57.350681 [debug] [MainThread]: Flushing usage events
[0m01:04:59.354735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:37.714884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC9BE02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAC17ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAC179D0>]}


============================== 01:19:37.719104 | 27b55ded-382f-4427-8145-d43226f6accd ==============================
[0m01:19:37.719104 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:37.719763 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:19:37.857784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b55ded-382f-4427-8145-d43226f6accd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCC9F436F0>]}
[0m01:19:37.936207 [debug] [MainThread]: Command `dbt clean` succeeded at 01:19:37.936095 after 0.39 seconds
[0m01:19:37.936537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAB1DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCAB1D480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCCBE20650>]}
[0m01:19:37.936871 [debug] [MainThread]: Flushing usage events
[0m01:19:39.226463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:47.701184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A550502F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56093ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A560939D0>]}


============================== 01:19:47.705354 | 1cddcd3e-2e97-4b8d-a23e-0c4dcd249fae ==============================
[0m01:19:47.705354 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:47.706013 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:19:47.845245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cddcd3e-2e97-4b8d-a23e-0c4dcd249fae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A553AF6F0>]}
[0m01:19:47.879566 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-4blhr2k5'
[0m01:19:47.880055 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:19:49.448157 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:19:49.449453 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:19:49.969820 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:19:49.973940 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:19:51.644257 [info ] [MainThread]: Installed from version 1.3.0
[0m01:19:51.644713 [info ] [MainThread]: Up to date!
[0m01:19:51.645175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1cddcd3e-2e97-4b8d-a23e-0c4dcd249fae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55F8D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55F8E360>]}
[0m01:19:51.647046 [debug] [MainThread]: Command `dbt deps` succeeded at 01:19:51.646921 after 4.06 seconds
[0m01:19:51.647441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A572AD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5586B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A572507D0>]}
[0m01:19:51.647812 [debug] [MainThread]: Flushing usage events
[0m01:19:52.661791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:58.469493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C023902F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C033DBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C033DB9D0>]}


============================== 01:19:58.473724 | 55c6937c-0ca7-4c61-8112-783f018c33fc ==============================
[0m01:19:58.473724 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:19:58.474469 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:20:01.381661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C026EF6F0>]}
[0m01:20:01.441751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C26E2B350>]}
[0m01:20:01.442340 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:20:02.095501 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:20:02.096484 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:20:02.096900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C26EB8850>]}
[0m01:20:03.610127 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.unique_combination_of_columns`.
Arguments to generic tests should be nested under the `arguments` property.`
[0m01:20:03.610631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C283EFB60>]}
[0m01:20:03.880455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C284467B0>]}
[0m01:20:03.977951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:20:03.989841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:20:04.020471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285F3EE0>]}
[0m01:20:04.020948 [info ] [MainThread]: Found 4 models, 17 data tests, 2 sources, 612 macros
[0m01:20:04.021365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285CF350>]}
[0m01:20:04.023180 [info ] [MainThread]: 
[0m01:20:04.023642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:20:04.024048 [info ] [MainThread]: 
[0m01:20:04.024539 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:04.029644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:20:04.030160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:04.030587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:20:04.031082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:05.821298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:20:05.821755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:05.822177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:20:05.822774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:07.542191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2847B280>]}
[0m01:20:07.542886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:07.549778 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:20:07.550290 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:20:07.550959 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:20:07.552592 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:20:07.551522 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:20:07.553191 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:20:07.553815 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:20:07.561811 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:20:07.562202 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:20:07.563922 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:20:07.566361 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:20:07.578663 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:20:07.600888 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:20:07.603251 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:20:07.606033 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:20:07.606872 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:20:07.607437 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:20:07.607877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:09.762965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c04b89e0-eedf-4207-b709-53d8ce64625a&page=queryresults
[0m01:20:09.763655 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:881d0ac7-6971-4f05-a6ea-cf8ec86e0ba6&page=queryresults
[0m01:20:10.427752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2843DEF0>]}
[0m01:20:10.428114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28D26960>]}
[0m01:20:10.428639 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.87s]
[0m01:20:10.429774 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:20:10.429110 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.87s]
[0m01:20:10.430578 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:20:10.431319 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:10.431726 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:20:10.432245 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:20:10.432563 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:10.435551 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:20:10.437050 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:10.440073 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:20:10.441327 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:20:10.441796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:20:12.186041 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9cada048-8cbb-49af-8b97-6d92a3604ca5&page=queryresults
[0m01:20:12.779895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285B5400>]}
[0m01:20:12.780575 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m01:20:12.781379 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:20:12.782206 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:20:12.782621 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:20:12.783328 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:20:12.783641 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:20:12.786271 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:20:12.787555 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:20:12.816066 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:20:12.817636 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:20:12.818209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:20:14.788981 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:60d056e6-b468-433c-835e-726a675c0c4b&page=queryresults
[0m01:20:17.815442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c6937c-0ca7-4c61-8112-783f018c33fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C285D7830>]}
[0m01:20:17.816014 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.03s]
[0m01:20:17.816879 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:20:17.818893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:17.820471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:17.820766 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:20:17.821004 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:20:17.821237 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:20:17.821470 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:20:17.821701 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:20:17.821930 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:20:17.822160 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:20:17.822395 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:20:17.822696 [info ] [MainThread]: 
[0m01:20:17.823066 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 13.80 seconds (13.80s).
[0m01:20:17.824154 [debug] [MainThread]: Command end result
[0m01:20:17.851762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:20:17.853921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:20:17.860017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:20:17.860322 [info ] [MainThread]: 
[0m01:20:17.860723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:17.861193 [info ] [MainThread]: 
[0m01:20:17.861559 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:20:17.862078 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:20:17.862948 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:17.862850 after 19.51 seconds
[0m01:20:17.863310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2881FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28EF3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C28EF38F0>]}
[0m01:20:17.863627 [debug] [MainThread]: Flushing usage events
[0m01:20:18.892713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:13.198137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015529F702F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AFA7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AFA79D0>]}


============================== 01:23:13.202317 | 44d87b2d-7b40-4994-87a1-a8324e4056fd ==============================
[0m01:23:13.202317 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:23:13.203020 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:23:13.343959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d87b2d-7b40-4994-87a1-a8324e4056fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552A2CF6F0>]}
[0m01:23:13.427218 [debug] [MainThread]: Command `dbt clean` succeeded at 01:23:13.427103 after 0.39 seconds
[0m01:23:13.427550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AEADD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552AEAD480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001552C1B0650>]}
[0m01:23:13.427882 [debug] [MainThread]: Flushing usage events
[0m01:23:17.150441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:28.426006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AD6002F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE637ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE6379D0>]}


============================== 01:23:28.430204 | 64f279e7-365d-4378-945f-0521127169d3 ==============================
[0m01:23:28.430204 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:23:28.430866 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:23:28.571955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f279e7-365d-4378-945f-0521127169d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AD95F6F0>]}
[0m01:23:28.606797 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-q6w_jo61'
[0m01:23:28.607176 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:23:30.255154 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:23:30.256475 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:23:30.877635 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:23:30.881722 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:23:31.659834 [info ] [MainThread]: Installed from version 1.3.0
[0m01:23:31.660513 [info ] [MainThread]: Up to date!
[0m01:23:31.661147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '64f279e7-365d-4378-945f-0521127169d3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE53D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AE53E360>]}
[0m01:23:31.663430 [debug] [MainThread]: Command `dbt deps` succeeded at 01:23:31.663268 after 3.36 seconds
[0m01:23:31.663914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AF83D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ADE1B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AF7F47D0>]}
[0m01:23:31.664418 [debug] [MainThread]: Flushing usage events
[0m01:23:32.728144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:23:38.434621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC24602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC34ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC34AB9D0>]}


============================== 01:23:38.439086 | 4719e6d2-bc9b-4979-81aa-d62fa60d6192 ==============================
[0m01:23:38.439086 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:23:38.439766 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:23:41.357641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC27C36F0>]}
[0m01:23:41.418040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE6EEB350>]}
[0m01:23:41.418632 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:23:42.072972 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:23:42.074013 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:23:42.074456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE6F78850>]}
[0m01:23:43.871990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE84AF3E0>]}
[0m01:23:43.967269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:23:43.970337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:23:43.999334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE86D09F0>]}
[0m01:23:43.999737 [info ] [MainThread]: Found 4 models, 17 data tests, 2 sources, 612 macros
[0m01:23:44.000130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE86B3A00>]}
[0m01:23:44.001902 [info ] [MainThread]: 
[0m01:23:44.002278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:23:44.002612 [info ] [MainThread]: 
[0m01:23:44.003147 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:23:44.006767 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:23:44.007240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:44.007618 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:23:44.008100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:45.789120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:23:45.789602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:45.789986 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:23:45.790443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:47.457430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8538AD0>]}
[0m01:23:47.457865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:47.463118 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:23:47.463629 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:23:47.464235 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:23:47.466132 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:23:47.466731 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:23:47.478198 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:23:47.465445 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:23:47.479126 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:23:47.479599 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:23:47.482763 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:23:47.485691 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:23:47.506554 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:23:47.517420 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:23:47.520046 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:23:47.523786 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:23:47.524754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:23:47.525586 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:23:47.552034 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:23:49.496920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:908d7177-79c9-4d4f-9e5a-7fca40b7832a&page=queryresults
[0m01:23:49.537520 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:889ffe41-d4a8-45da-b565-c79b19c3fa3a&page=queryresults
[0m01:23:50.178151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE867D440>]}
[0m01:23:50.179027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC26A4910>]}
[0m01:23:50.178721 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.71s]
[0m01:23:50.180234 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:23:50.179594 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.70s]
[0m01:23:50.181036 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:23:50.181754 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:50.182188 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:23:50.182725 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:23:50.183051 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:50.186042 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:23:50.195357 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:50.198327 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:23:50.199656 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:23:50.200166 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:23:52.730065 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9c35e6f0-795e-468a-93d3-625a9cb951b1&page=queryresults
[0m01:23:53.313999 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE807D250>]}
[0m01:23:53.314558 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 3.13s]
[0m01:23:53.315385 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:23:53.316086 [debug] [Thread-4 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:23:53.316500 [info ] [Thread-4 (]: 4 of 4 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:23:53.317149 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:23:53.317462 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:23:53.320065 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:23:53.321506 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:23:53.331216 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:23:54.700932 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:23:54.702402 [debug] [Thread-4 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      WITH sessions AS (
  SELECT
    visit_id,
    visitor_id,
    session_date,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    revenue_usd,
    revenue_local
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),
products AS (
  SELECT
    visit_id,
    visitor_id,
    hit_date,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd
  FROM `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)
SELECT
  p.transaction_id,
  p.visit_id,
  p.visitor_id,
  s.session_date,
  s.country,
  s.traffic_source,
  s.traffic_medium,
  s.traffic_campaign,
  p.product_sku,
  p.product_name,
  p.product_category,
  p.product_quantity,
  p.product_price_usd,
  -- item-level revenue in USD
  p.product_quantity * p.product_price_usd AS item_revenue_usd,
  -- scaled by FX: take session’s local multiplier
  CASE
    WHEN s.revenue_local IS NULL OR s.revenue_usd IS NULL THEN NULL
    ELSE (p.product_quantity * p.product_price_usd) * (s.revenue_local / s.revenue_usd)
  END AS item_revenue_local
FROM products p
LEFT JOIN sessions s
  USING (visit_id, visitor_id)
    );
  
[0m01:23:55.483511 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c11a93b8-c703-45e9-9ec7-026bbd051091&page=queryresults
[0m01:23:59.090883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4719e6d2-bc9b-4979-81aa-d62fa60d6192', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8F8A580>]}
[0m01:23:59.091448 [info ] [Thread-4 (]: 4 of 4 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (47.7k rows, 3.9 MiB processed)[0m in 5.77s]
[0m01:23:59.092276 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:23:59.093901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:23:59.095456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:59.095716 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:23:59.095958 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:23:59.096194 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:23:59.096485 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:23:59.096721 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:23:59.096955 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions' was properly closed.
[0m01:23:59.097188 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:23:59.097425 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:23:59.097731 [info ] [MainThread]: 
[0m01:23:59.098140 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 15.09 seconds (15.09s).
[0m01:23:59.100668 [debug] [MainThread]: Command end result
[0m01:23:59.137573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:23:59.139840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:23:59.145419 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:23:59.145761 [info ] [MainThread]: 
[0m01:23:59.146191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:59.146821 [info ] [MainThread]: 
[0m01:23:59.147519 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:23:59.149073 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:59.148926 after 20.83 seconds
[0m01:23:59.149609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE88E3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8FAF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE8FAF830>]}
[0m01:23:59.150457 [debug] [MainThread]: Flushing usage events
[0m01:24:00.198605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:06.010683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA19602F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA29ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA29AB9D0>]}


============================== 01:27:06.015271 | f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c ==============================
[0m01:27:06.015271 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:27:06.015931 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select int_sessions_enriched', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m01:27:08.976597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA1CBF6F0>]}
[0m01:27:09.035978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC640B350>]}
[0m01:27:09.036548 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:27:09.697497 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:27:09.910961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m01:27:09.911504 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\intermediate\intermediate_models.yml
[0m01:27:09.911826 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\intermediate\int_sessions_enriched.sql
[0m01:27:10.340110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7A9D250>]}
[0m01:27:10.435563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:10.437868 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:10.467355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC64CDF40>]}
[0m01:27:10.467796 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m01:27:10.468198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7C41E10>]}
[0m01:27:10.469704 [info ] [MainThread]: 
[0m01:27:10.470094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:27:10.470438 [info ] [MainThread]: 
[0m01:27:10.470962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:10.471830 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:27:10.472195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:12.027815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_int)
[0m01:27:12.028303 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_int"
"
[0m01:27:12.036158 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_int"} */
create schema if not exists `e2e-dbt-project`.`analytics_int`
  
[0m01:27:12.036492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:13.809024 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:aeae75e5-b93c-4786-a1db-12ef33211f97&page=queryresults
[0m01:27:14.643725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:27:14.644219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:14.644604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:27:14.645094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:14.646380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:27:14.648476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:16.604235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7E0EC30>]}
[0m01:27:16.604679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:16.609486 [debug] [Thread-1 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:27:16.609936 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:27:16.610704 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m01:27:16.611044 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:27:16.618885 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:27:16.620230 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:27:16.645318 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:27:16.646724 [debug] [Thread-1 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
  OPTIONS()
  as 

with sessions as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),

hits as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m01:27:16.647365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:27:18.614655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ab066982-b285-4912-992b-858e82936938&page=queryresults
[0m01:27:19.252787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f58e92b5-2fd0-49ff-a4e1-4ae5d44b838c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC8400D10>]}
[0m01:27:19.253389 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.64s]
[0m01:27:19.254327 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:27:19.255927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:19.257422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:19.257684 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_int' was properly closed.
[0m01:27:19.257925 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:27:19.258161 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:27:19.258395 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:27:19.258629 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m01:27:19.259208 [info ] [MainThread]: 
[0m01:27:19.260102 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m01:27:19.261309 [debug] [MainThread]: Command end result
[0m01:27:19.291697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:27:19.294433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:27:19.299718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:27:19.300030 [info ] [MainThread]: 
[0m01:27:19.300459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:19.300818 [info ] [MainThread]: 
[0m01:27:19.301194 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:27:19.302081 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:19.301980 after 13.43 seconds
[0m01:27:19.302401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC798F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9E874910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC7DF25D0>]}
[0m01:27:19.302720 [debug] [MainThread]: Flushing usage events
[0m01:27:21.375977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:40.333472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AB1202F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AC16BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AC16B9D0>]}


============================== 01:28:40.337647 | bae87e26-eb16-4188-ad73-690ce207e4a4 ==============================
[0m01:28:40.337647 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:28:40.338317 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --select int_sessions_enriched', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:28:43.338906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AB4836F0>]}
[0m01:28:43.402849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4CFBDB350>]}
[0m01:28:43.403479 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:28:44.050193 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:28:44.250392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:44.250710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:44.298868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D0C38B50>]}
[0m01:28:44.402106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:28:44.404675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:28:44.446830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D13B2B70>]}
[0m01:28:44.447237 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m01:28:44.447636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D13F2270>]}
[0m01:28:44.449251 [info ] [MainThread]: 
[0m01:28:44.449627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:28:44.449962 [info ] [MainThread]: 
[0m01:28:44.450502 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:44.454121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:28:44.454736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:44.455255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:28:44.455776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:44.456216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:28:44.456639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:46.319888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae87e26-eb16-4188-ad73-690ce207e4a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D1421CC0>]}
[0m01:28:46.320619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:46.328705 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:46.329216 [debug] [Thread-3 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:46.329797 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:46.330180 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:46.330522 [info ] [Thread-4 (]: 4 of 5 START test not_null_int_sessions_enriched_visit_id ...................... [RUN]
[0m01:28:46.330952 [info ] [Thread-3 (]: 3 of 5 START test not_null_int_sessions_enriched_session_date .................. [RUN]
[0m01:28:46.332931 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9'
[0m01:28:46.331631 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m01:28:46.332215 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [RUN]
[0m01:28:46.333983 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da'
[0m01:28:46.334664 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:46.335560 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0'
[0m01:28:46.336404 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e'
[0m01:28:46.337028 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:46.363136 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:46.368212 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m01:28:46.368643 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:46.373680 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m01:28:46.381633 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"
[0m01:28:46.386503 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"
[0m01:28:46.395806 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:46.420761 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"
[0m01:28:46.421326 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:46.421992 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:46.425690 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"
[0m01:28:46.426256 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:46.428886 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"
[0m01:28:46.431572 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"
[0m01:28:46.432843 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:28:46.433470 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:28:46.434035 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`

where not(revenue_usd revenue_usd >= 0 or revenue_usd is null)


  
  
      
    ) dbt_internal_test
[0m01:28:46.434900 [debug] [Thread-3 (]: On test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_date
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where session_date is null



  
  
      
    ) dbt_internal_test
[0m01:28:46.435411 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:28:46.435942 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m01:28:46.436383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:28:46.461499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:28:48.547007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b6a33791-d64d-46c2-8575-406f1a1af8db&page=queryresults
[0m01:28:48.547486 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b6a33791-d64d-46c2-8575-406f1a1af8db&page=queryresults
[0m01:28:48.565822 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c03c9f7e-f331-4c09-b801-2e547662cc64&page=queryresults
[0m01:28:48.566297 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:c03c9f7e-f331-4c09-b801-2e547662cc64&page=queryresults
[0m01:28:48.577695 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m01:28:48.578257 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.24s]
[0m01:28:48.579075 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0
[0m01:28:48.579441 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:48.580087 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql.
[0m01:28:48.584407 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m01:28:48.580706 [info ] [Thread-1 (]: 5 of 5 START test not_null_int_sessions_enriched_visitor_id .................... [RUN]
[0m01:28:48.585502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null.da02cbbac0, now test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52)
[0m01:28:48.585846 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:48.589858 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m01:28:48.584946 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [[31mERROR[0m in 2.25s]
[0m01:28:48.591015 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e
[0m01:28:48.591564 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql.
[0m01:28:48.592187 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:48.594187 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"
[0m01:28:48.594997 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:28:48.595367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:48.835669 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:6407bd18-3277-435d-9251-7969116d0964&page=queryresults
[0m01:28:48.936041 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ca4543e3-e33c-450d-bb6c-f710d69750cf&page=queryresults
[0m01:28:50.322072 [info ] [Thread-3 (]: 3 of 5 PASS not_null_int_sessions_enriched_session_date ........................ [[32mPASS[0m in 3.99s]
[0m01:28:50.322941 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da
[0m01:28:50.477888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:1b9ceab1-fd9d-478c-8661-3db86c343515&page=queryresults
[0m01:28:50.579901 [info ] [Thread-4 (]: 4 of 5 PASS not_null_int_sessions_enriched_visit_id ............................ [[32mPASS[0m in 4.25s]
[0m01:28:50.580741 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9
[0m01:28:51.851780 [info ] [Thread-1 (]: 5 of 5 PASS not_null_int_sessions_enriched_visitor_id .......................... [[32mPASS[0m in 3.27s]
[0m01:28:51.852661 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52
[0m01:28:51.854133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:51.855611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:51.855970 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:28:51.856222 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:28:51.856465 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:28:51.856708 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_int_sessions_enriched_visit_id.120c79bee9' was properly closed.
[0m01:28:51.856951 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_int_sessions_enriched_session_date.b4e3b0c9da' was properly closed.
[0m01:28:51.857192 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_int_sessions_enriched_visitor_id.3673967a52' was properly closed.
[0m01:28:51.857437 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.ce09b7871e' was properly closed.
[0m01:28:51.857727 [info ] [MainThread]: 
[0m01:28:51.858104 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m01:28:51.859407 [debug] [MainThread]: Command end result
[0m01:28:51.889088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:28:51.891345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:28:51.897838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:28:51.898152 [info ] [MainThread]: 
[0m01:28:51.898564 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:28:51.898997 [info ] [MainThread]: 
[0m01:28:51.899426 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)[0m
[0m01:28:51.899854 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_local__revenue_local_0_or_revenue_local_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m01:28:51.900224 [info ] [MainThread]: 
[0m01:28:51.900629 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_c453053032466bbfbf2c10e766933b45.sql
[0m01:28:51.900981 [info ] [MainThread]: 
[0m01:28:51.901392 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)[0m
[0m01:28:51.901814 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_int_sessions_enriched_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\intermediate\intermediate_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m01:28:51.902292 [info ] [MainThread]: 
[0m01:28:51.902781 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\intermediate\intermediate_models.yml\dbt_utils_expression_is_true_i_ce0c33ea0cd6953ca1cecc29a0f5be37.sql
[0m01:28:51.903131 [info ] [MainThread]: 
[0m01:28:51.903507 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m01:28:51.904397 [debug] [MainThread]: Command `dbt test` failed at 01:28:51.904297 after 11.73 seconds
[0m01:28:51.904726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4AC140590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D14CAE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4D14CB070>]}
[0m01:28:51.905041 [debug] [MainThread]: Flushing usage events
[0m01:28:53.241198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:21.079927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D90A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DA0E3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DA0E39D0>]}


============================== 01:39:21.084333 | ddb5a681-d73e-40e6-a3b1-086c1209869c ==============================
[0m01:39:21.084333 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:21.084988 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:21.223580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddb5a681-d73e-40e6-a3b1-086c1209869c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D93FF6F0>]}
[0m01:39:21.308434 [debug] [MainThread]: Command `dbt clean` succeeded at 01:39:21.308318 after 0.35 seconds
[0m01:39:21.308776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D9FDDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0D9FDD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0DB370650>]}
[0m01:39:21.309119 [debug] [MainThread]: Flushing usage events
[0m01:39:22.594030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:34.860951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5322B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5332FBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5332FB9D0>]}


============================== 01:39:34.865187 | 579b303b-35e5-4eab-8f0a-78063355581d ==============================
[0m01:39:34.865187 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:34.865863 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:37.807697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '579b303b-35e5-4eab-8f0a-78063355581d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D53260F6F0>]}
[0m01:39:37.870419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '579b303b-35e5-4eab-8f0a-78063355581d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556D1B350>]}
[0m01:39:37.871026 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:39:38.512551 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m01:39:38.513869 [debug] [MainThread]: Command `dbt run` failed at 01:39:38.513760 after 3.78 seconds
[0m01:39:38.514192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556DA9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556DA9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D556CFB890>]}
[0m01:39:38.514508 [debug] [MainThread]: Flushing usage events
[0m01:39:39.618423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:39:51.417565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B51802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B61C3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B61C39D0>]}


============================== 01:39:51.421773 | 71112e7c-7553-4ae4-961d-23dd82fa4592 ==============================
[0m01:39:51.421773 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:39:51.422494 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:39:51.566430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71112e7c-7553-4ae4-961d-23dd82fa4592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B54DF6F0>]}
[0m01:39:51.598442 [debug] [MainThread]: Set downloads directory='C:\Users\dovie\AppData\Local\Temp\dbt-downloads-0u4v5co9'
[0m01:39:51.598817 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:39:53.469772 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:39:53.471071 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:39:53.989916 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:39:53.994061 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:39:55.188655 [info ] [MainThread]: Installed from version 1.3.0
[0m01:39:55.189280 [info ] [MainThread]: Up to date!
[0m01:39:55.189911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '71112e7c-7553-4ae4-961d-23dd82fa4592', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B60BD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B60BE360>]}
[0m01:39:55.191880 [debug] [MainThread]: Command `dbt deps` succeeded at 01:39:55.191765 after 3.89 seconds
[0m01:39:55.192194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B747D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B599B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276B74307D0>]}
[0m01:39:55.192512 [debug] [MainThread]: Flushing usage events
[0m01:39:56.232285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:00.984069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285520802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285530CBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285530CB9D0>]}


============================== 01:40:00.988315 | 8d649b20-ab4a-45c0-ac64-542ddb7d51f2 ==============================
[0m01:40:00.988315 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:40:00.988976 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:40:03.950786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285523DF6F0>]}
[0m01:40:04.010140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028576B0B350>]}
[0m01:40:04.010761 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:40:04.648179 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:40:04.649184 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:40:04.649586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028577B68850>]}
[0m01:40:06.462141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285780CF890>]}
[0m01:40:06.560106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:40:06.579226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:40:06.611062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028577BF7BD0>]}
[0m01:40:06.611484 [info ] [MainThread]: Found 5 models, 22 data tests, 2 sources, 612 macros
[0m01:40:06.611879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285783F7C70>]}
[0m01:40:06.613793 [info ] [MainThread]: 
[0m01:40:06.614178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:40:06.614576 [info ] [MainThread]: 
[0m01:40:06.615066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:06.618775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:40:06.619259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:06.619649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:40:06.620235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:40:06.620532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:06.620925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:08.565310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_stg)
[0m01:40:08.565816 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_stg"
"
[0m01:40:08.581889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_mart)
[0m01:40:08.582542 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_stg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_stg"} */
create schema if not exists `e2e-dbt-project`.`analytics_stg`
  
[0m01:40:08.583294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_e2e-dbt-project, now create_e2e-dbt-project_analytics_int)
[0m01:40:08.583744 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_mart"
"
[0m01:40:08.584111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:08.584719 [debug] [ThreadPool]: Creating schema "database: "e2e-dbt-project"
schema: "analytics_int"
"
[0m01:40:08.586836 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_mart: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_mart"} */
create schema if not exists `e2e-dbt-project`.`analytics_mart`
  
[0m01:40:08.588508 [debug] [ThreadPool]: On create_e2e-dbt-project_analytics_int: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "connection_name": "create_e2e-dbt-project_analytics_int"} */
create schema if not exists `e2e-dbt-project`.`analytics_int`
  
[0m01:40:08.588904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:08.616566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:10.878579 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2d4c6788-804d-4091-af66-cd4bbbae7d98&page=queryresults
[0m01:40:11.079490 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:14883060-6906-4bcd-ad64-837f092cbf67&page=queryresults
[0m01:40:11.080400 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2f7a05d2-20d7-4d03-a714-07bc7feb7087&page=queryresults
[0m01:40:12.172549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:40:12.173035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:12.173412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:40:12.173912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:12.174292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:40:12.174702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:14.072004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285782B0E90>]}
[0m01:40:14.072693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:14.079941 [debug] [Thread-1 (]: Began running node model.ga_retail_project.stg_hits_products
[0m01:40:14.080543 [debug] [Thread-2 (]: Began running node model.ga_retail_project.stg_sessions
[0m01:40:14.081128 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_stg.stg_hits_products .................... [RUN]
[0m01:40:14.082049 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_stg.stg_sessions ......................... [RUN]
[0m01:40:14.083027 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_hits_products'
[0m01:40:14.083812 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions'
[0m01:40:14.084505 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.stg_hits_products
[0m01:40:14.085046 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.stg_sessions
[0m01:40:14.091340 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.stg_hits_products"
[0m01:40:14.095159 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions"
[0m01:40:14.097898 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.stg_sessions
[0m01:40:14.121162 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.stg_hits_products
[0m01:40:14.131796 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions"
[0m01:40:14.133981 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.stg_hits_products"
[0m01:40:14.137595 [debug] [Thread-1 (]: On model.ga_retail_project.stg_hits_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_hits_products"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
  OPTIONS()
  as with raw as (
    select
        parse_date('%Y%m%d', date)              as hit_date,
        fullVisitorId                           as visitor_id,
        visitId                                 as visit_id,
        hits.transaction.transactionId          as transaction_id,
        p.productSKU                            as product_sku,
        p.v2ProductName                         as product_name,
        p.v2ProductCategory                     as product_category,
        p.productQuantity                       as product_quantity,
        p.productPrice / 1e6                    as product_price_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`,
         unnest(hits) as hits,
         unnest(hits.product) as p
    where _table_suffix between '20170801' and '20170831'
      and p.productSKU is not null
)
select *
from raw;


[0m01:40:14.138251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:14.138763 [debug] [Thread-2 (]: On model.ga_retail_project.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
  OPTIONS()
  as with source as (
    select
        parse_date('%Y%m%d', date)                  as session_date,
        geoNetwork.country                         as country,
        fullVisitorId                               as visitor_id,
        visitId                                     as visit_id,
        trafficSource.source                        as traffic_source,
        trafficSource.medium                        as traffic_medium,
        trafficSource.campaign                      as traffic_campaign,
        totals.visits                               as visits,
        totals.transactions                         as transactions,
        safe_divide(totals.transactionRevenue, 1e6) as revenue_usd
    from `bigquery-public-data.google_analytics_sample.ga_sessions_*`
    where _table_suffix between '20170801' and '20170831'
)
select * from source;


[0m01:40:14.139233 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:40:16.031318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:ee47f03d-c390-41b6-82e5-b79c99e2e9b3&page=queryresults
[0m01:40:16.061918 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:257f128c-c5b5-4f98-9734-928306f465f1&page=queryresults
[0m01:40:16.619046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285783B7490>]}
[0m01:40:16.619617 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_stg.stg_sessions .................... [[32mCREATE VIEW (0 processed)[0m in 2.53s]
[0m01:40:16.620440 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.stg_sessions
[0m01:40:16.621093 [debug] [Thread-3 (]: Began running node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:16.621528 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_stg.stg_sessions_with_fx ................. [RUN]
[0m01:40:16.622092 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.ga_retail_project.stg_sessions_with_fx'
[0m01:40:16.622617 [debug] [Thread-3 (]: Began compiling node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:16.625454 [debug] [Thread-3 (]: Writing injected SQL for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:40:16.634890 [debug] [Thread-3 (]: Began executing node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:16.637554 [debug] [Thread-3 (]: Writing runtime sql for node "model.ga_retail_project.stg_sessions_with_fx"
[0m01:40:16.639363 [debug] [Thread-3 (]: On model.ga_retail_project.stg_sessions_with_fx: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.stg_sessions_with_fx"} */


  create or replace view `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
  OPTIONS()
  as with base as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions`
),
ccy as (
    select country, currency
    from `e2e-dbt-project`.`ext`.`country_currency`
),
fx as (
    select rate_date, currency, rate_to_usd
    from `e2e-dbt-project`.`ext`.`fx_rates`
)
select
    b.session_date,
    b.visitor_id,
    b.visit_id,
    b.country,
    b.traffic_source,
    b.traffic_medium,
    b.traffic_campaign,
    b.visits,
    b.transactions,
    b.revenue_usd,
    c.currency,
    case
        when b.revenue_usd is null then null
        when c.currency = 'USD' then b.revenue_usd
        else b.revenue_usd / nullif(f.rate_to_usd, 0)
    end as revenue_local
from base b
left join ccy c
  on c.country = b.country
left join fx f
  on f.rate_date = b.session_date and f.currency = c.currency;


[0m01:40:16.640006 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:40:16.675548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028577D86490>]}
[0m01:40:16.676103 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics_stg.stg_hits_products ............... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m01:40:16.676890 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.stg_hits_products
[0m01:40:18.598370 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:24308039-4a6a-4a35-ae69-1f6f6ce5a385&page=queryresults
[0m01:40:19.159978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578535950>]}
[0m01:40:19.160596 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_stg.stg_sessions_with_fx ............ [[32mCREATE VIEW (0 processed)[0m in 2.54s]
[0m01:40:19.161380 [debug] [Thread-3 (]: Finished running node model.ga_retail_project.stg_sessions_with_fx
[0m01:40:19.162230 [debug] [Thread-4 (]: Began running node model.ga_retail_project.int_sessions_enriched
[0m01:40:19.162693 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_int.int_sessions_enriched ................ [RUN]
[0m01:40:19.163329 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.ga_retail_project.int_sessions_enriched'
[0m01:40:19.163668 [debug] [Thread-4 (]: Began compiling node model.ga_retail_project.int_sessions_enriched
[0m01:40:19.166502 [debug] [Thread-4 (]: Writing injected SQL for node "model.ga_retail_project.int_sessions_enriched"
[0m01:40:19.167668 [debug] [Thread-4 (]: Began executing node model.ga_retail_project.int_sessions_enriched
[0m01:40:19.170399 [debug] [Thread-4 (]: Writing runtime sql for node "model.ga_retail_project.int_sessions_enriched"
[0m01:40:19.171655 [debug] [Thread-4 (]: On model.ga_retail_project.int_sessions_enriched: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.int_sessions_enriched"} */


  create or replace view `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
  OPTIONS()
  as 

with sessions as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_sessions_with_fx`
),

hits as (
    select *
    from `e2e-dbt-project`.`analytics_stg`.`stg_hits_products`
)

select
    s.session_date,
    s.visitor_id,
    s.visit_id,
    s.country,
    s.traffic_source,
    s.traffic_medium,
    s.traffic_campaign,
    s.visits,
    s.transactions,
    s.revenue_usd,
    s.currency,
    s.revenue_local,
    h.transaction_id,
    h.product_sku,
    h.product_name,
    h.product_category,
    h.product_quantity,
    h.product_price_usd
from sessions s
left join hits h
  on s.visit_id = h.visit_id
 and s.visitor_id = h.visitor_id;


[0m01:40:19.172298 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:40:21.297252 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:2affacad-99bc-4c2e-bd23-e4ceb5f6710a&page=queryresults
[0m01:40:21.892225 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578146A50>]}
[0m01:40:21.892784 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_int.int_sessions_enriched ........... [[32mCREATE VIEW (0 processed)[0m in 2.73s]
[0m01:40:21.893551 [debug] [Thread-4 (]: Finished running node model.ga_retail_project.int_sessions_enriched
[0m01:40:21.894291 [debug] [Thread-2 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:40:21.894768 [info ] [Thread-2 (]: 5 of 5 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:40:21.895294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ga_retail_project.stg_sessions, now model.ga_retail_project.fct_sales_item)
[0m01:40:21.895644 [debug] [Thread-2 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:40:21.898104 [debug] [Thread-2 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:40:21.899445 [debug] [Thread-2 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:40:21.928509 [debug] [Thread-2 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:40:21.929894 [debug] [Thread-2 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m01:40:21.930546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:40:23.972921 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:b56a1583-6658-4408-b026-2fa7c2b8b984&page=queryresults
[0m01:40:27.697147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d649b20-ab4a-45c0-ac64-542ddb7d51f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578ACB7D0>]}
[0m01:40:27.697741 [info ] [Thread-2 (]: 5 of 5 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.80s]
[0m01:40:27.698514 [debug] [Thread-2 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:40:27.700000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:27.701924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:27.702198 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_int' was properly closed.
[0m01:40:27.702446 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:40:27.702691 [debug] [MainThread]: Connection 'create_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:40:27.702933 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:40:27.703171 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:40:27.703409 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:40:27.703653 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_hits_products' was properly closed.
[0m01:40:27.703889 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:40:27.704147 [debug] [MainThread]: Connection 'model.ga_retail_project.stg_sessions_with_fx' was properly closed.
[0m01:40:27.704386 [debug] [MainThread]: Connection 'model.ga_retail_project.int_sessions_enriched' was properly closed.
[0m01:40:27.704703 [info ] [MainThread]: 
[0m01:40:27.705128 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 21.09 seconds (21.09s).
[0m01:40:27.706550 [debug] [MainThread]: Command end result
[0m01:40:27.738079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:40:27.740292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:40:27.746330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:40:27.746659 [info ] [MainThread]: 
[0m01:40:27.747284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:40:27.747817 [info ] [MainThread]: 
[0m01:40:27.748344 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:40:27.749415 [debug] [MainThread]: Command `dbt run` succeeded at 01:40:27.749307 after 26.88 seconds
[0m01:40:27.749789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285782F3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578025910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028578174590>]}
[0m01:40:27.750112 [debug] [MainThread]: Flushing usage events
[0m01:40:30.098017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:45:13.578375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885E1102F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885F15BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885F15B9D0>]}


============================== 01:45:13.582697 | c112aaec-2199-49cf-95e2-2d677375d50b ==============================
[0m01:45:13.582697 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:45:13.583386 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m01:45:16.552169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002885E46F6F0>]}
[0m01:45:16.613298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028802BAB350>]}
[0m01:45:16.613923 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:45:17.242937 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:45:17.455749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:45:17.456295 [debug] [MainThread]: Partial parsing: added file: ga_retail_project://models\mart\mart_models.yml
[0m01:45:17.456659 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\fct_sales_item.sql
[0m01:45:17.891891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028802C39450>]}
[0m01:45:17.986768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:45:17.989068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:45:18.019294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028802C71D60>]}
[0m01:45:18.019726 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:45:18.020133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288043E5E10>]}
[0m01:45:18.021702 [info ] [MainThread]: 
[0m01:45:18.022084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:45:18.022420 [info ] [MainThread]: 
[0m01:45:18.023009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:45:18.023910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:45:18.024274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:19.580526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:45:19.581031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:19.581411 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:45:19.581908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:19.582296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:45:19.582810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:21.453429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028804457860>]}
[0m01:45:21.453859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:45:21.459447 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:45:21.460015 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:45:21.460706 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:45:21.461156 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:45:21.473512 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:45:21.475312 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:45:21.491444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:45:22.941913 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:45:22.942848 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      

with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m01:45:23.790654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:feee1bda-a5b1-4735-821e-62b98788f048&page=queryresults
[0m01:45:27.100763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c112aaec-2199-49cf-95e2-2d677375d50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002880439BC50>]}
[0m01:45:27.101347 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.64s]
[0m01:45:27.102159 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:45:27.103848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:45:27.105353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:27.105614 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:45:27.105860 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:45:27.106155 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:45:27.106609 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:45:27.106853 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:45:27.107128 [info ] [MainThread]: 
[0m01:45:27.107628 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m01:45:27.108391 [debug] [MainThread]: Command end result
[0m01:45:27.138680 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:45:27.141040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:45:27.146485 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:45:27.146903 [info ] [MainThread]: 
[0m01:45:27.147324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:45:27.147767 [info ] [MainThread]: 
[0m01:45:27.148139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:45:27.149058 [debug] [MainThread]: Command `dbt run` succeeded at 01:45:27.148959 after 13.75 seconds
[0m01:45:27.149375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288044A6A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028804648730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028804649090>]}
[0m01:45:27.149689 [debug] [MainThread]: Flushing usage events
[0m01:45:28.425193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:25.668653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196128802F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196138CBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196138CB9D0>]}


============================== 01:46:25.672817 | 8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38 ==============================
[0m01:46:25.672817 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:46:25.673462 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt'}
[0m01:46:28.795469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019612BE36F0>]}
[0m01:46:28.859762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196372FB350>]}
[0m01:46:28.860385 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:46:29.528361 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:46:29.736929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:46:29.737301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:46:29.788955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019637388B50>]}
[0m01:46:29.897804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:46:29.900378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:46:29.941058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638AD6B70>]}
[0m01:46:29.941471 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:46:29.941873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638AD26D0>]}
[0m01:46:29.943506 [info ] [MainThread]: 
[0m01:46:29.943898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:46:29.944250 [info ] [MainThread]: 
[0m01:46:29.944748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:46:29.950344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:46:29.950879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:29.951280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:46:29.951897 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:46:29.952173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:29.953591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:31.848659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c7d1a58-dd3f-44c4-a1f8-f4f2f5588c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638B4AA90>]}
[0m01:46:31.849217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:31.855037 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:31.855439 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:31.855877 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:31.856446 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:31.856851 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null  [RUN]
[0m01:46:31.857224 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m01:46:31.857808 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [RUN]
[0m01:46:31.859338 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626'
[0m01:46:31.858413 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null  [RUN]
[0m01:46:31.860217 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m01:46:31.860822 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4'
[0m01:46:31.861423 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:31.862101 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112'
[0m01:46:31.862646 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:31.863133 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:31.890218 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626"
[0m01:46:31.890771 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:31.899830 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:46:31.907385 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4"
[0m01:46:31.916223 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112"
[0m01:46:31.918485 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:31.918890 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:31.941875 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626"
[0m01:46:31.944388 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:46:31.945117 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:31.947260 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4"
[0m01:46:31.948410 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:31.951934 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112"
[0m01:46:31.952926 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd product_price_usd >= 0 or product_price_usd is null)


  
  
      
    ) dbt_internal_test
[0m01:46:31.953697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:31.954262 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:46:31.954640 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd revenue_usd >= 0 or revenue_usd is null)


  
  
      
    ) dbt_internal_test
[0m01:46:31.955164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:46:31.955600 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:46:31.956123 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local revenue_local >= 0 or revenue_local is null)


  
  
      
    ) dbt_internal_test
[0m01:46:31.957629 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:46:33.916656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:60371551-f464-49ab-a1a2-09b367cf3a38&page=queryresults
[0m01:46:33.917162 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:60371551-f464-49ab-a1a2-09b367cf3a38&page=queryresults
[0m01:46:33.926276 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql
[0m01:46:33.926799 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null  [[31mERROR[0m in 2.07s]
[0m01:46:33.927552 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626
[0m01:46:33.927941 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:33.928596 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql.
[0m01:46:33.929198 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m01:46:33.931122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null.6e1fc82626, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m01:46:33.931704 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:33.937411 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:46:33.938399 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:33.940483 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:46:33.941341 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:46:33.941718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:33.967874 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5209b578-16d4-4727-ba3f-7d10e57ac242&page=queryresults
[0m01:46:33.968378 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:5209b578-16d4-4727-ba3f-7d10e57ac242&page=queryresults
[0m01:46:33.975125 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql
[0m01:46:33.975610 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null  [[31mERROR[0m in 2.11s]
[0m01:46:33.976379 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4
[0m01:46:33.977100 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql.
[0m01:46:33.986466 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78b93b30-32ac-4b44-8632-1341b396c01f&page=queryresults
[0m01:46:33.986986 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:78b93b30-32ac-4b44-8632-1341b396c01f&page=queryresults
[0m01:46:33.993463 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql
[0m01:46:33.993979 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null  [[31mERROR[0m in 2.13s]
[0m01:46:33.994710 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112
[0m01:46:33.995379 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql.
[0m01:46:34.377161 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:dd3d8647-a312-4b5c-90bc-1c238754d180&page=queryresults
[0m01:46:35.414073 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.55s]
[0m01:46:35.415267 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:46:36.019039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:136bc500-865a-45c6-814c-da7c46ac4d47&page=queryresults
[0m01:46:36.902084 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.97s]
[0m01:46:36.902916 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:46:36.904529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:36.906010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:36.906278 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:46:36.906527 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:46:36.906771 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:46:36.907015 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m01:46:36.907258 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m01:46:36.907503 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null.8c0f1df5d4' was properly closed.
[0m01:46:36.907750 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null.7f720a6112' was properly closed.
[0m01:46:36.908039 [info ] [MainThread]: 
[0m01:46:36.908416 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m01:46:36.909701 [debug] [MainThread]: Command end result
[0m01:46:36.940452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:46:36.942593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:46:36.949769 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:46:36.950171 [info ] [MainThread]: 
[0m01:46:36.950618 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:46:36.951026 [info ] [MainThread]: 
[0m01:46:36.951455 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)[0m
[0m01:46:36.951886 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_or_product_price_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql
[0m01:46:36.952247 [info ] [MainThread]: 
[0m01:46:36.952657 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_adc93f322feed1ccd9e23e3573145d8e.sql
[0m01:46:36.953010 [info ] [MainThread]: 
[0m01:46:36.953424 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)[0m
[0m01:46:36.953845 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_or_revenue_usd_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql
[0m01:46:36.954198 [info ] [MainThread]: 
[0m01:46:36.954600 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_4c69e3f87e0bfe6e058bc36a94a1736d.sql
[0m01:46:36.954950 [info ] [MainThread]: 
[0m01:46:36.955360 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)[0m
[0m01:46:36.955778 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_or_revenue_local_is_null (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql
[0m01:46:36.956130 [info ] [MainThread]: 
[0m01:46:36.956561 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_7c5dbabc8dcae95f9e2a5d34ef52a1bc.sql
[0m01:46:36.956909 [info ] [MainThread]: 
[0m01:46:36.957285 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m01:46:36.958165 [debug] [MainThread]: Command `dbt test` failed at 01:46:36.958065 after 11.43 seconds
[0m01:46:36.958494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196138A0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638B83B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019638B83D80>]}
[0m01:46:36.958815 [debug] [MainThread]: Flushing usage events
[0m01:46:38.331491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:52:27.945100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C45A02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C55EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C55EB9D0>]}


============================== 01:52:27.950524 | a34f32c1-1e96-431c-b151-13e2f653799c ==============================
[0m01:52:27.950524 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:52:27.951198 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_sales_item', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:52:31.103388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C49036F0>]}
[0m01:52:31.168020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283E901B350>]}
[0m01:52:31.168649 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:52:31.844181 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:52:32.056401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:52:32.057103 [debug] [MainThread]: Partial parsing: updated file: ga_retail_project://models\mart\mart_models.yml
[0m01:52:32.526071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA6B1A50>]}
[0m01:52:32.635722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:32.638220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:32.669730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283E90E1D60>]}
[0m01:52:32.670159 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:52:32.670587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA8527B0>]}
[0m01:52:32.672117 [info ] [MainThread]: 
[0m01:52:32.672524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:52:32.672879 [info ] [MainThread]: 
[0m01:52:32.673532 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:52:32.674410 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project'
[0m01:52:32.674778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:34.298021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:52:34.298577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:34.299485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:52:34.300189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:34.301013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:52:34.301986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:36.557623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA8CF860>]}
[0m01:52:36.558029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:52:36.563226 [debug] [Thread-1 (]: Began running node model.ga_retail_project.fct_sales_item
[0m01:52:36.563820 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_mart.fct_sales_item ..................... [RUN]
[0m01:52:36.564520 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ga_retail_project.fct_sales_item'
[0m01:52:36.564857 [debug] [Thread-1 (]: Began compiling node model.ga_retail_project.fct_sales_item
[0m01:52:36.573146 [debug] [Thread-1 (]: Writing injected SQL for node "model.ga_retail_project.fct_sales_item"
[0m01:52:36.574224 [debug] [Thread-1 (]: Began executing node model.ga_retail_project.fct_sales_item
[0m01:52:36.589965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:52:38.059361 [debug] [Thread-1 (]: Writing runtime sql for node "model.ga_retail_project.fct_sales_item"
[0m01:52:38.060315 [debug] [Thread-1 (]: On model.ga_retail_project.fct_sales_item: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "model.ga_retail_project.fct_sales_item"} */

  
    

    create or replace table `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
      
    
    

    
    OPTIONS()
    as (
      

with base as (
    select *
    from `e2e-dbt-project`.`analytics_int`.`int_sessions_enriched`
)

select
    session_date,
    visitor_id,
    visit_id,
    country,
    traffic_source,
    traffic_medium,
    traffic_campaign,
    transaction_id,
    product_sku,
    product_name,
    product_category,
    product_quantity,
    product_price_usd,
    revenue_usd,
    revenue_local
from base
    );
  
[0m01:52:39.087822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:9252e4ce-8e53-4ecc-8b1c-4d3989a93140&page=queryresults
[0m01:52:41.999514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34f32c1-1e96-431c-b151-13e2f653799c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA5ABA10>]}
[0m01:52:42.001042 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_mart.fct_sales_item ................ [[32mCREATE TABLE (48.6k rows, 3.9 MiB processed)[0m in 5.43s]
[0m01:52:42.001919 [debug] [Thread-1 (]: Finished running node model.ga_retail_project.fct_sales_item
[0m01:52:42.003501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:52:42.005024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:42.005293 [debug] [MainThread]: Connection 'list_e2e-dbt-project' was properly closed.
[0m01:52:42.005546 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:52:42.005796 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:52:42.006043 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:52:42.006289 [debug] [MainThread]: Connection 'model.ga_retail_project.fct_sales_item' was properly closed.
[0m01:52:42.006610 [info ] [MainThread]: 
[0m01:52:42.006991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m01:52:42.007692 [debug] [MainThread]: Command end result
[0m01:52:42.039917 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:52:42.042221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:52:42.047850 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:52:42.048169 [info ] [MainThread]: 
[0m01:52:42.048612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:42.049029 [info ] [MainThread]: 
[0m01:52:42.049496 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:52:42.050754 [debug] [MainThread]: Command `dbt run` succeeded at 01:52:42.050636 after 14.29 seconds
[0m01:52:42.051110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA58F330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA1ECF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EA1EFED0>]}
[0m01:52:42.051450 [debug] [MainThread]: Flushing usage events
[0m01:52:43.411584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:53:55.333700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA08302F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA187BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA187B9D0>]}


============================== 01:53:55.337884 | 8f9e4c07-5cae-4289-9121-c85b93150312 ==============================
[0m01:53:55.337884 [info ] [MainThread]: Running with dbt=1.10.9
[0m01:53:55.338531 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\dovie\\.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test --select fct_sales_item', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Projects\\ga_retail_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:53:58.520891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA0B8F6F0>]}
[0m01:53:58.586350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC52AB350>]}
[0m01:53:58.586960 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m01:53:59.262745 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m01:53:59.475935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:53:59.476287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:53:59.529681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC5338B50>]}
[0m01:53:59.637910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:53:59.641216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:53:59.681942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6B16B70>]}
[0m01:53:59.682382 [info ] [MainThread]: Found 5 models, 27 data tests, 2 sources, 612 macros
[0m01:53:59.682780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6AFE6D0>]}
[0m01:53:59.684466 [info ] [MainThread]: 
[0m01:53:59.684853 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:53:59.685196 [info ] [MainThread]: 
[0m01:53:59.685688 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:53:59.689365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_int'
[0m01:53:59.689957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:59.690672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_mart'
[0m01:53:59.691352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:59.691872 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_e2e-dbt-project_analytics_stg'
[0m01:53:59.693454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:54:01.612077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9e4c07-5cae-4289-9121-c85b93150312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6AA3A00>]}
[0m01:54:01.612524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:54:01.617926 [debug] [Thread-3 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:01.618326 [debug] [Thread-2 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:01.618747 [debug] [Thread-1 (]: Began running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:01.619144 [debug] [Thread-4 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:01.619718 [info ] [Thread-3 (]: 3 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL  [RUN]
[0m01:54:01.620127 [info ] [Thread-2 (]: 2 of 5 START test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL  [RUN]
[0m01:54:01.621830 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2'
[0m01:54:01.620554 [info ] [Thread-1 (]: 1 of 5 START test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL  [RUN]
[0m01:54:01.622778 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755'
[0m01:54:01.620969 [info ] [Thread-4 (]: 4 of 5 START test not_null_fct_sales_item_visit_id ............................. [RUN]
[0m01:54:01.623737 [debug] [Thread-3 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:01.624629 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717'
[0m01:54:01.625292 [debug] [Thread-2 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:01.625888 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d'
[0m01:54:01.649839 [debug] [Thread-3 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2"
[0m01:54:01.650548 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:01.655519 [debug] [Thread-2 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755"
[0m01:54:01.656041 [debug] [Thread-4 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:01.661396 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717"
[0m01:54:01.670292 [debug] [Thread-4 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:54:01.671885 [debug] [Thread-2 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:01.691454 [debug] [Thread-3 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:01.695205 [debug] [Thread-2 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755"
[0m01:54:01.695551 [debug] [Thread-4 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:01.697756 [debug] [Thread-3 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2"
[0m01:54:01.700051 [debug] [Thread-4 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"
[0m01:54:01.700541 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:01.704557 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717"
[0m01:54:01.704984 [debug] [Thread-2 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_local revenue_local >= 0 OR revenue_local IS NULL)


  
  
      
    ) dbt_internal_test
[0m01:54:01.705593 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:54:01.706237 [debug] [Thread-3 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(revenue_usd revenue_usd >= 0 OR revenue_usd IS NULL)


  
  
      
    ) dbt_internal_test
[0m01:54:01.706919 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:54:01.708845 [debug] [Thread-4 (]: On test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:01.709290 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:54:01.785100 [debug] [Thread-1 (]: On test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`

where not(product_price_usd product_price_usd >= 0 OR product_price_usd IS NULL)


  
  
      
    ) dbt_internal_test
[0m01:54:01.785578 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:54:03.689683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:115c46e2-82f4-4a9f-b172-61105b6650ef&page=queryresults
[0m01:54:03.690198 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:115c46e2-82f4-4a9f-b172-61105b6650ef&page=queryresults
[0m01:54:03.699296 [debug] [Thread-1 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql
[0m01:54:03.699831 [error] [Thread-1 (]: 1 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL  [[31mERROR[0m in 2.08s]
[0m01:54:03.700568 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717
[0m01:54:03.700942 [debug] [Thread-1 (]: Began running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:03.701567 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql.
[0m01:54:03.702153 [info ] [Thread-1 (]: 5 of 5 START test not_null_fct_sales_item_visitor_id ........................... [RUN]
[0m01:54:03.703456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL.1bf75c6717, now test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7)
[0m01:54:03.703812 [debug] [Thread-1 (]: Began compiling node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:03.707879 [debug] [Thread-1 (]: Writing injected SQL for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:54:03.709147 [debug] [Thread-1 (]: Began executing node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:03.711454 [debug] [Thread-1 (]: Writing runtime sql for node "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"
[0m01:54:03.712278 [debug] [Thread-1 (]: On test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "ga_retail_project", "target_name": "dev", "node_id": "test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visitor_id
from `e2e-dbt-project`.`analytics_mart`.`fct_sales_item`
where visitor_id is null



  
  
      
    ) dbt_internal_test
[0m01:54:03.712651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:54:03.753055 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f007b27-a51b-49ce-a914-0a3842f115ad&page=queryresults
[0m01:54:03.754010 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc6192ca-8e3e-403f-9df0-01e482ea50a4&page=queryresults
[0m01:54:03.753567 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4f007b27-a51b-49ce-a914-0a3842f115ad&page=queryresults
[0m01:54:03.754435 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:fc6192ca-8e3e-403f-9df0-01e482ea50a4&page=queryresults
[0m01:54:03.764092 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql
[0m01:54:03.764646 [error] [Thread-2 (]: 2 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL  [[31mERROR[0m in 2.14s]
[0m01:54:03.765392 [debug] [Thread-2 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755
[0m01:54:03.766105 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql.
[0m01:54:03.769779 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql
[0m01:54:03.770262 [error] [Thread-3 (]: 3 of 5 ERROR dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL  [[31mERROR[0m in 2.15s]
[0m01:54:03.770998 [debug] [Thread-3 (]: Finished running node test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2
[0m01:54:03.771692 [debug] [Thread-7 (]: Marking all children of 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql.
[0m01:54:04.090513 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:4bb5b302-ab47-4e1b-af43-3c889bef66a9&page=queryresults
[0m01:54:05.098720 [info ] [Thread-4 (]: 4 of 5 PASS not_null_fct_sales_item_visit_id ................................... [[32mPASS[0m in 3.47s]
[0m01:54:05.099553 [debug] [Thread-4 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d
[0m01:54:05.582917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=e2e-dbt-project&j=bq:US:a3d1156a-d966-4f4e-854e-75a0933ab7a7&page=queryresults
[0m01:54:06.445425 [info ] [Thread-1 (]: 5 of 5 PASS not_null_fct_sales_item_visitor_id ................................. [[32mPASS[0m in 2.74s]
[0m01:54:06.446253 [debug] [Thread-1 (]: Finished running node test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7
[0m01:54:06.447961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:54:06.449620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:54:06.449888 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_int' was properly closed.
[0m01:54:06.450138 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_mart' was properly closed.
[0m01:54:06.450383 [debug] [MainThread]: Connection 'list_e2e-dbt-project_analytics_stg' was properly closed.
[0m01:54:06.450627 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL.a55316bac2' was properly closed.
[0m01:54:06.450873 [debug] [MainThread]: Connection 'test.ga_retail_project.dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL.2363916755' was properly closed.
[0m01:54:06.451114 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visitor_id.ac0df6a0b7' was properly closed.
[0m01:54:06.451353 [debug] [MainThread]: Connection 'test.ga_retail_project.not_null_fct_sales_item_visit_id.540f44cc1d' was properly closed.
[0m01:54:06.451640 [info ] [MainThread]: 
[0m01:54:06.452178 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m01:54:06.453447 [debug] [MainThread]: Command end result
[0m01:54:06.484094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Projects\ga_retail_project\target\manifest.json
[0m01:54:06.486317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Projects\ga_retail_project\target\semantic_manifest.json
[0m01:54:06.493803 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Projects\ga_retail_project\target\run_results.json
[0m01:54:06.494145 [info ] [MainThread]: 
[0m01:54:06.494761 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:54:06.495145 [info ] [MainThread]: 
[0m01:54:06.495576 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)[0m
[0m01:54:06.496005 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_product_price_usd__product_price_usd_0_OR_product_price_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "product_price_usd" at [18:29]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql
[0m01:54:06.496360 [info ] [MainThread]: 
[0m01:54:06.496764 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_99cf7b554f78426668c2644b38d53d25.sql
[0m01:54:06.497118 [info ] [MainThread]: 
[0m01:54:06.497530 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)[0m
[0m01:54:06.497949 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_local__revenue_local_0_OR_revenue_local_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_local" at [18:25]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql
[0m01:54:06.498301 [info ] [MainThread]: 
[0m01:54:06.499068 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_982d01cd1db76ff4f9c9b306a4e9f080.sql
[0m01:54:06.499426 [info ] [MainThread]: 
[0m01:54:06.499841 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)[0m
[0m01:54:06.500259 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_fct_sales_item_revenue_usd__revenue_usd_0_OR_revenue_usd_IS_NULL (models\mart\mart_models.yml)
  Syntax error: Expected "," but got identifier "revenue_usd" at [18:23]
  compiled code at target\run\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql
[0m01:54:06.500611 [info ] [MainThread]: 
[0m01:54:06.501014 [info ] [MainThread]:   compiled code at target\compiled\ga_retail_project\models\mart\mart_models.yml\dbt_utils_expression_is_true_f_85a85801be40aa532cbc203356cd8de5.sql
[0m01:54:06.501364 [info ] [MainThread]: 
[0m01:54:06.501737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m01:54:06.502704 [debug] [MainThread]: Command `dbt test` failed at 01:54:06.502599 after 11.30 seconds
[0m01:54:06.503039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BA1850590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6B87B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BC6B87D80>]}
[0m01:54:06.503363 [debug] [MainThread]: Flushing usage events
[0m01:54:08.645642 [debug] [MainThread]: An error was encountered while trying to flush usage events
